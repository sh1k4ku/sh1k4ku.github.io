<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>sh1k4ku&#39;s blog</title>
  
  <subtitle>è®°å½•æˆ‘çš„å­¦ä¹ ä¹‹è·¯</subtitle>
  <link href="http://sh1k4ku.github.io/atom.xml" rel="self"/>
  
  <link href="http://sh1k4ku.github.io/"/>
  <updated>2021-09-27T08:22:10.961Z</updated>
  <id>http://sh1k4ku.github.io/</id>
  
  <author>
    <name>sh1k4ku</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¤©ç¿¼æ¯</title>
    <link href="http://sh1k4ku.github.io/2021/09/27/%E5%A4%A9%E7%BF%BC%E6%9D%AF/"/>
    <id>http://sh1k4ku.github.io/2021/09/27/%E5%A4%A9%E7%BF%BC%E6%9D%AF/</id>
    <published>2021-09-27T05:58:38.000Z</published>
    <updated>2021-09-27T08:22:10.961Z</updated>
    
    <content type="html"><![CDATA[<p>èµ›åé—®äº†åˆ«çš„å¸ˆå‚…å¤ç›˜ä¸€ä¸‹ï¼Œå¥½çš„ä¸œè¥¿éœ€è¦è®°å½•</p><span id="more"></span><h1 id="babypack"><a href="#babypack" class="headerlink" title="babypack"></a>babypack</h1><p>è¿™ä¸€é¢˜çœŸç‰›å•Šï¼Œè€ƒäº†å¾ˆå¤šè€ƒç‚¹ï¼Œè€Œä¸”æ²¡æœ‰å¾ˆåçš„ï¼Œå¾ˆè€ƒéªŒèƒ½åŠ›ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits, randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">signal.alarm(<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">512</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> == b:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    x, y, q = egcd(b, a % b)</span><br><span class="line">    x, y = y, (x - a // b * y)</span><br><span class="line">    <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chinese_remainder</span>(<span class="params">pairs</span>):</span></span><br><span class="line">    mod_list, remainder_list = [p[<span class="number">0</span>] <span class="keyword">for</span> p <span class="keyword">in</span> pairs], [p[<span class="number">1</span>] <span class="keyword">for</span> p <span class="keyword">in</span> pairs]</span><br><span class="line">    mod_product = reduce(<span class="keyword">lambda</span> x, y: x * y, mod_list)</span><br><span class="line">    mi_list = [mod_product//x <span class="keyword">for</span> x <span class="keyword">in</span> mod_list]</span><br><span class="line">    mi_inverse = [egcd(mi_list[i], mod_list[i])[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mi_list))]</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(remainder_list)):</span><br><span class="line">        x += mi_list[i] * mi_inverse[i] * remainder_list[i]</span><br><span class="line">        x %= mod_product</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>():</span></span><br><span class="line">    U = [getrandbits(N)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">    V = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        v = U[i] - <span class="built_in">pow</span>(<span class="number">2</span>, N-i-<span class="number">1</span>)</span><br><span class="line">        V.append(v)</span><br><span class="line"></span><br><span class="line">    s1 = <span class="built_in">sum</span>(U)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(s1.bit_length() + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> p &gt; s1:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    s1 = <span class="number">0</span></span><br><span class="line">    s2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> V:</span><br><span class="line">        <span class="keyword">if</span> i &lt; <span class="number">0</span>:</span><br><span class="line">            s2 += i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s1 += i</span><br><span class="line"></span><br><span class="line">    tmp = <span class="built_in">max</span>(s1, -s2)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(tmp.bit_length() + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> q &gt; tmp:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    A = []</span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(U, V):</span><br><span class="line">        A.append(chinese_remainder([(p, i), (q, j)]))</span><br><span class="line">    <span class="keyword">return</span> A, U, V, p, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">m, n</span>):</span><span class="comment">#æ¯”è¾ƒé«˜ä½</span></span><br><span class="line">    mbin = <span class="built_in">bin</span>(m)[<span class="number">2</span>:]</span><br><span class="line">    nbin = <span class="built_in">bin</span>(n)[<span class="number">2</span>:]</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(mbin, nbin):</span><br><span class="line">        <span class="keyword">if</span> i == j:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">msg, pub</span>):</span><span class="comment">#èƒŒåŒ…åŠ å¯†</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(msg, pub):</span><br><span class="line">        s += i * j</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A, U, V, p, q = keygen()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;your pubkey:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(U[<span class="number">0</span>] + V[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(U[<span class="number">0</span>] * V[<span class="number">0</span>])</span><br><span class="line">Menu = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1.hint</span></span><br><span class="line"><span class="string">2.get flag&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    <span class="built_in">print</span>(Menu)</span><br><span class="line">    op = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">    <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">        m = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">        <span class="built_in">print</span>(check(m, n))</span><br><span class="line">    <span class="keyword">elif</span> op == <span class="number">2</span>:</span><br><span class="line">        msg = [randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">        ct = encrypt(msg, A)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;secret:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(ct)</span><br><span class="line">        secret = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">        ans = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, msg))), <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> ans == secret:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="åˆ†æä»£ç "><a href="#åˆ†æä»£ç " class="headerlink" title="åˆ†æä»£ç "></a>åˆ†æä»£ç </h2><ul><li>é¦–å…ˆä½¿ç”¨getrandbitså‡½æ•°ç”Ÿæˆ512ä¸ª512æ¯”ç‰¹çš„åˆ—è¡¨Uï¼Œå†ç”Ÿæˆåˆ—è¡¨Vï¼Œæœ‰<script type="math/tex">V_i=U_i-2^{511-i}</script></li><li>ç„¶åç”Ÿæˆp,qï¼Œä¸¤ä¸ªå¤§æ¦‚éƒ½æ˜¯520ä½ä¸Šä¸‹</li><li>ä½¿ç”¨CRTç”ŸæˆAï¼Œæ»¡è¶³</li></ul><script type="math/tex; mode=display">A_i=U_i\;mod\;p\\A_i=V_i\;mod\;q</script><ul><li>æœ€åç”¨randint(0, 1)ç”Ÿæˆ01èƒŒåŒ…msgä¸Aåˆæˆå¾—åˆ°ctï¼Œæœ€åæˆ‘ä»¬è¦ä¼ å…¥çš„ç»“æœå°±æ˜¯ä»…å«0å’Œ1çš„msg</li></ul><p>è¿™ä¸€é¢˜æˆ‘ä»¬æœ‰çš„èƒ½æ‹¿åˆ°çš„æ•°æ®æœ‰:<script type="math/tex">A,U_0+V_0,U_0*V_0,ct</script></p><p>æˆ‘ä»¬åœ¨è¿™ä¸€é¢˜èƒ½ä¸oracleè¿›è¡Œä¸€ä¸ªäº¤äº’ï¼Œä¼ å…¥ä¸€ä¸ªæ•°xï¼Œoracleå°†æ¯”è¾ƒxå’ŒnäºŒè¿›åˆ¶çš„è¾ƒé«˜ä½ï¼Œå¹¶è¿”å›ä½ç›¸ç­‰çš„ä¸ªæ•°ã€‚</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¦–å…ˆçœ‹åˆ°01èƒŒåŒ…å¾ˆéš¾ä¸æƒ³åˆ°é€ æ ¼å­ï¼Œä½†æ˜¯å®é™…æ“ä½œåå‘ç°512é˜¶çš„çŸ©é˜µè¿é€ éƒ½é€ ä¸å‡ºæ¥ã€‚å¹¶ä¸”ï¼Œå†ä»”ç»†æƒ³ï¼Œå°±ç®—åˆ†è§£næ‹¿åˆ°pqï¼Œæ¥ç€æ‹¿åˆ°UVï¼Œå¯¹æ±‚è§£01çš„msgæ²¡æœ‰ä»»ä½•å¸®åŠ©ï¼Œæ‰€ä»¥æ”¾å¼ƒé€ æ ¼å­è¿™ä¸€å¥—ã€‚</p><p>è§‚å¯Ÿåˆ°msgæ˜¯ç”¨512æ¬¡randint(0, 1)ç”Ÿæˆçš„ï¼Œå†åŠ ä¸Šå‰é¢ç”ŸæˆUæ—¶ç”¨çš„æ˜¯getrandbitsï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„ç®—æ³•é€»è¾‘éƒ½æ˜¯MT19937ï¼Œè¿™ç§ä¼ªéšæœºæ•°ç”Ÿæˆæ˜¯å¯ä»¥ç ´è§£çš„ï¼Œåªéœ€è¦624ä¸ª32æ¯”ç‰¹çš„æ•°ã€‚åˆç”±Aå’ŒUVå­˜åœ¨åŒä½™å…³ç³»ï¼Œå¦‚æœæ‹¿åˆ°pqå°±èƒ½æ‹¿åˆ°UVï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¦æ€è€ƒå¦‚ä½•factorã€‚</p><p>æœ¬é¢˜ç»™å‡ºäº†<script type="math/tex">A,U_0+V_0,U_0*V_0</script>ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“èƒ½å¤Ÿæ‹¿åˆ°å•ç‹¬çš„<script type="math/tex">U_0ã€V_0</script></p><p>ç”±UVå’ŒAçš„å…³ç³»hæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><script type="math/tex; mode=display">p|A_0-U_0\\q|A_0-v_0\\âˆ´n=pq|(A_0-U_0)(A_0-v_0)</script><p>è§‚å¯Ÿåˆ°ï¼Œå³è¾¹æ˜¯å·²çŸ¥æ¡ä»¶ï¼Œnå¾…æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è·å–nçš„é«˜å¤šå°‘å¤šå°‘ä½ï¼</p><p>å› æ­¤å¯ä»¥è½¬æ¢åˆ°Coppersmith Methodå·²çŸ¥pé«˜ä½çš„æƒ…å†µï¼ï¼</p><p>ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬æœ€å¤šåªèƒ½å’ŒOracleäº¤äº’500æ¬¡ï¼Œç”±ç”Ÿæˆå¯çŸ¥nå¤§æ¦‚ä¸º1040ä½ï¼Œå¦‚æœæ¯æ¬¡åªçˆ†ä¸€ä½ï¼Œæˆ‘ä»¬æœ€å¤šåªèƒ½è·å¾—500ä½ï¼Œè¿™ä¸ªæ¡ä»¶æ˜¯ä¸è¶³ä»¥ä½¿ç”¨coppersmithçš„ã€‚</p><p>è¿™é‡Œå°±å¾ˆè€ƒéªŒæ™ºå•†äº†ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä¸€æ¬¡çˆ†ç ´ä¸¤ä½çš„æ–¹æ³•ï¼Œé‚£ä¹ˆ3æ¬¡å†…å°±ä¸€å®šèƒ½çˆ†ç ´å‡ºä¸¤ä½ï¼Œæ‰€ä»¥ç›¸å½“äº0.75æ¬¡çˆ†ç ´ä¸€ä½ï¼Œé‚£ä¹ˆå‰499æ¬¡äº¤äº’å°±èƒ½è·å–nçš„å‰499*3/2ä½ï¼Œè¿™è¶³å¤Ÿç”¨æ¥æ±‚è§£äº†ã€‚è¿™é‡Œéœ€è¦çŸ¥é“nä¸€å…±æœ‰å¤šå°‘ä½ï¼ˆå› ä¸ºè¦çŸ¥é“nç¼ºå¤±äº†å¤šå°‘ä½ä½ï¼‰ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦æµ‹è¯•æ‰çŸ¥é“nçš„ä½æ•°èŒƒå›´ï¼Œç®—æ˜¯ä¸ªå°ç»†èŠ‚</p><p>ä¹‹åä½¿ç”¨gcdå°±èƒ½å¤Ÿåˆ†è§£å‡ºpå’Œqï¼Œæ¥ä¸‹æ¥å°±èƒ½æ±‚å¾—Uå’ŒVï¼Œç„¶åä½¿ç”¨è°ƒåŒ…randcrackç ´è§£MT19937ã€‚è¿™é‡Œä¹Ÿæœ‰ä¸ªå°ç»†èŠ‚ï¼Œç”±äºrandcrackåªèƒ½é¢„æµ‹è¿ç»­çš„ä¼ªéšæœºæ•°ï¼Œæ‰€ä»¥å¾—å–Uæœ€å624ä¸ª32ä½æ•°æ®ï¼Œä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚</p><p>ä»£ç å¯ä»¥å‚è€ƒæ˜¥å“¥å†™çš„ï¼š<a href="https://zhuanlan.zhihu.com/p/413319231">æ˜¥ä¹</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å›é¡¾ä¸€ä¸‹æ•´ä¸ªæµç¨‹ï¼šné«˜ä½â€”â€”copperâ€”â€”gcdâ€”â€”randcrackï¼Œç®—æ˜¯æ¯”è¾ƒç»¼åˆçš„ä¸€é“é¢˜äº†ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªå•ç‹¬çš„æ¿å—éƒ½æ˜¯å¸¸è§„é¢˜ï¼ˆæ€ä¹ˆæœ‰ç§åšé«˜è€ƒé¢˜çš„æ„Ÿè§‰ï¼Œæ¯”è¾ƒæœ‰æ„æ€</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;èµ›åé—®äº†åˆ«çš„å¸ˆå‚…å¤ç›˜ä¸€ä¸‹ï¼Œå¥½çš„ä¸œè¥¿éœ€è¦è®°å½•&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="randcrack" scheme="http://sh1k4ku.github.io/tags/randcrack/"/>
    
    <category term="coppersmith" scheme="http://sh1k4ku.github.io/tags/coppersmith/"/>
    
    <category term="Tea" scheme="http://sh1k4ku.github.io/tags/Tea/"/>
    
    <category term="Feistel" scheme="http://sh1k4ku.github.io/tags/Feistel/"/>
    
    <category term="Oracle" scheme="http://sh1k4ku.github.io/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>life</title>
    <link href="http://sh1k4ku.github.io/2021/09/20/life/"/>
    <id>http://sh1k4ku.github.io/2021/09/20/life/</id>
    <published>2021-09-20T15:29:54.000Z</published>
    <updated>2021-09-27T08:24:14.790Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c2b748092a17869cd02b67d7700d469bfe97b9e54e42b7026abfb2508ba5e636">b9fd6817f5242136bb9b8b6622c6e49aa20d5400feebab590a553289a884555bfd36bf06d3adb75126cc1482d337ba8c270ad16680b1a58f8ff0635b813d10017d01396f0f3b9c43cde205bdfc60fde71017c6fc659c5292969dfeb98d0a56d47700edbaee4e375c23aedb099d3bb9c0783f0a3155c644a37dd054393de0a4d26cb4c30f5fd1f2148fef2d94980bf2902b9dc679b2e28104d453a81ae7652a5103c60c35615abfa930effb78cf01c54251997f9ea3ddca526e781adcaa7c15c4aabb4c427b57f0a131a79d9de51a569a3fbe1eb19859134e2188c0847b3313f16b42541b3b5245b7eb18decf8c0ae72f93fc633f4650faba246118d6a0bb9379ca165bec81e2d2c9adb67b3a6773e1c05d02391a2a24b7930b7c462ba910990dff0c328568d1035faf38f1f8b3e8cd0f5335e386547fd02136ab360d2c739de4f4aa70cf4d24b663e80dfa7dea870c0779d879bc86c7e2966ba3cd807391adf0dfb7afcbee90cf782d5040c2f8319098ac67b116cb22f98a6d3d29173729bd711f054f8b9e95c3211b045e17b667ef22ba8b9dc41a1522b4ba1b9c1196f60de6edf2c5ef49cae354b66baea4f2bc89e608b488b995ef57acb7b169e429849284ca0305bed84c75847d6e3e93bb771e15a9b8376518dd4e77d11b8a3404dd9b9fe518ca1471425f350f3e3b4a3246a7ce126df4175d263c76fac24157c1f8dc3c17e5fc69815899d6ae89f49a05fa0a320a8ca62202f683de5ce29ea1933a214cd6fa7bcad40dd66eb7c7e8e6ddd29f14dc8b69a9aa2d2caf8d4e430569fd5fe82c3e890eae45578f321538499abf486318e411c857247dbbbce7018b80246d4a3b2196aa5afe1a469b61bfbb658a2a66247f3b0113575eb991e4a3af9b30c91121ce71d79fef8adedbf137f86146c043debdb4155bd63cc7cc5acbd32e5d65aa1ad04a85d6c40889f9071dff82f86f7626f76146bb10b053124056a071f45df54807e2de5ab7be03a526e0b4e2ba1c9cdb6d64f7201a2845d836b9fc4e0a35cd</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">password</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">è®°å½•ä¸€äº›ç‚¹æ»´ï¼Œå¤šåŠæ˜¯è´Ÿé¢æƒ…ç»ª</summary>
    
    
    
    <category term="life" scheme="http://sh1k4ku.github.io/categories/life/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¾ŠåŸæ¯</title>
    <link href="http://sh1k4ku.github.io/2021/09/12/%E7%BE%8A%E5%9F%8E%E6%9D%AF/"/>
    <id>http://sh1k4ku.github.io/2021/09/12/%E7%BE%8A%E5%9F%8E%E6%9D%AF/</id>
    <published>2021-09-12T01:45:35.000Z</published>
    <updated>2021-09-13T10:03:45.079Z</updated>
    
    <content type="html"><![CDATA[<p>zåšäº†äº”é“ã€‚è¯è¯´æœ€åä¸€é¢˜sm4ä¹‹åæ˜¯ä¸ªä»€ä¹ˆç©æ„ï¼Ÿ</p><span id="more"></span><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Bigrsa"><a href="#Bigrsa" class="headerlink" title="Bigrsa"></a>Bigrsa</h2><p>ç­¾åˆ°é¢˜ï¼Œæ¨¡ä¸äº’ç´ ï¼Œgcdæ±‚å…¬å…±å› å­åå°±èƒ½åˆ†è§£äº†ï¼Œä¹‹åå°±æ˜¯æœ€ç®€å•çš„RSA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1=<span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2=<span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=gmpy2.gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line">phi1=(p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2=(p-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line">d1=gmpy2.invert(e,phi1)</span><br><span class="line">d2=gmpy2.invert(e,phi2)</span><br><span class="line">c=<span class="built_in">pow</span>(c,d2,n2)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d1,n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy_RSA"></a>Easy_RSA</h2><p>æ ¹æ®ç”Ÿæˆå¯ä»¥çŸ¥é“p-1å’Œq-1smoothï¼Œå¹¶ä¸”å­˜åœ¨å…¬å…±å› å­ä¹Ÿå°±æ˜¯2gï¼Œçœ‹ä¹¦ä¹‹åäº†è§£åˆ°è¿™ç©æ„å«Common prime RSA<img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912095325832.png" alt="image-20210912095325832"></p><p>å› ä¸ºè¿™ä¸€é¢˜çš„nä¸å¤§ï¼Œæ‰€ä»¥aä¹Ÿä¸å¤§ï¼Œå¹¶ä¸”åœ¨æ¨¡næœ‰é™åŸŸçš„æƒ…å†µä¸‹<script type="math/tex">x^n-1</script>æœ€å¤šå°±åªæœ‰aä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ç”¨Pollard rhoç®—æ³•åˆ†è§£nã€‚å…¶ä¸­få‡½æ•°ä¸º<script type="math/tex">f(x)=x^{n-1}+3\;mod\;n</script>ï¼Œé¦–å…ˆéšæœºç”Ÿæˆä¸€ä¸ªæ•°x1ï¼Œx2å¯ä»¥ç”±f(x1)ç”Ÿæˆï¼Œç„¶åæ¯è½®x1æ‰§è¡Œä¸€æ¬¡fï¼Œx2æ‰§è¡Œä¸¤æ¬¡fï¼ˆæé«˜æ•ˆç‡ï¼‰p=gcd(|x1-x2|,n)ï¼Œå½“pä¸ä¸º1æˆ–næ—¶å¯æˆåŠŸåˆ†è§£nã€‚</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912100142590.png" alt="image-20210912100142590"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span>(<span class="params">n</span>):</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1 = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        x2 = f(x1, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(x1 - x2), n)</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                x1 = f(x1, n)</span><br><span class="line">                x2 = f(f(x2, n), n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line"></span><br><span class="line">p,q=pollard_rho(n)</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="RingRingRing"><a href="#RingRingRing" class="headerlink" title="RingRingRing"></a>RingRingRing</h2><p>ncåç¬¬ä¸€æ­¥æ˜¯çˆ†ç ´md5ï¼Œè¿™é‡Œçˆ†ç ´äº†å››ä½ã€‚</p><p>ä¹‹åæ˜¯è¦è§£ä¸€ä¸ªæ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">a^4+b^4+c^4+d^4=e^2</script><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä»€ä¹ˆè‘—åçš„æ›²çº¿ï¼ŒæŸ¥äº†ä¸€ä¸‹æ²¡æ‰¾åˆ°ã€‚çªç„¶æƒ³åˆ°è¿™ç©æ„æ²¡è¯´abcdä¸èƒ½ç›¸ç­‰å•Šï¼Œç›¸ç­‰æ—¶</p><script type="math/tex; mode=display">4x^4=e^2\\âˆ´e=2x^2</script><p>å—¯ï¼Ÿï¼Ÿï¼Ÿè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Œé‚£ä¼ 1â€”100ä¸å°±å¯ä»¥äº†ğŸï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dehash</span>(<span class="params">s,re</span>):</span></span><br><span class="line">    alphabet = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(s,re)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> alphabet:</span><br><span class="line">                    ss=a+b+c+d+s</span><br><span class="line">                    <span class="keyword">if</span>  md5(ss.encode()).hexdigest().startswith(re):</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">    p=remote(<span class="string">&#x27;192.168.41.60&#x27;</span>,<span class="number">2378</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;md5(str + &quot;</span>)</span><br><span class="line">    s= p.recvuntil(<span class="string">&quot;)[0:5] == &quot;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">    hashre=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(s,hashre)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot; Give me xxxxx:&quot;</span>)</span><br><span class="line">    p.sendline(dehash(s.decode(),hashre.decode()).encode())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;a: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;b: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;c: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;d: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;e: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(<span class="number">2</span>*i**<span class="number">2</span>).encode())</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h2 id="Rsa"><a href="#Rsa" class="headerlink" title="Rsa?"></a>Rsa?</h2><p>æ ¹æ®ä»£ç å‰é¢çš„ç”Ÿæˆæœ‰ï¼š</p><script type="math/tex; mode=display">M_y=flag,M_x=os.urandom(30)\\Z=M_xM_y\;mod \;n\\X=\frac{Z+\frac{1}{Z}}{2}\\Y=M_y\\a=\frac{\frac{1}{Z}-X}{Y},D=a^2</script><p>è¿™é¢˜å®šä¹‰äº†ä¸€ä¸ªæ–°çš„è¿ç®—æ¨¡å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xy = <span class="keyword">lambda</span> (x1,y1),(x2,y2) : ((x1*x2+D*y1*y2)%n, (x1*y2+x2*y1)%n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getloop</span>(<span class="params">(<span class="params">x,y</span>), e</span>):</span></span><br><span class="line">ret = (x, y)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e-<span class="number">1</span>):</span><br><span class="line">ret = xy(ret, (x,y))</span><br><span class="line"><span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure><p>ä¹‹åå¯¹ï¼ˆXï¼ŒYï¼‰è¿›è¡Œäº†eæ¬¡è¿™æ ·çš„è¿ç®—ã€‚</p><p>ä¸€å¼€å§‹æƒ³åˆ°ECCæ˜¯ä¸å¯é€†çš„ï¼Œæ‰€ä»¥é»˜è®¤äº†è¿™ä¸ªè¿ç®—ä¹Ÿæ˜¯ä¸å¯é€†çš„ï¼Œå¯¼è‡´åšäº†å¾ˆå¤šæ— ç”¨åŠŸã€‚åæ¥æµ‹è¯•ä»£ç è‡ªå®šä¹‰æ•°æ®è¿›è¡Œè®¡ç®—çš„æ—¶å€™å‘ç°è¿™ä¸ªè¿ç®—æ˜¯å¯é€†çš„ï¼Œå¹¶ä¸”ä¸aæ— å…³ï¼Œä¹Ÿå°±æ˜¯è¯´aä¸ºä»»ä½•å€¼éƒ½æ˜¯å¯é€†çš„ã€‚æ‰€ä»¥æ¥ä¸‹æ¥åªéœ€è¦æ‹¿åˆ°nçš„é˜¶å°±èƒ½å¤Ÿè¿˜åŸXå’ŒYï¼ˆflagï¼‰ï¼Œç°åœ¨è€ƒè™‘å¦‚ä½•åˆ†è§£nã€‚</p><p>ç”±äºæ²¡æœ‰å…¶ä»–ä¿¡æ¯å¯ç”¨äº†ï¼Œé‚£ä¹ˆåªèƒ½ç¡¬ç€å¤´çš®å¼€æ ¹å·å‘—ï¼Œæ²¡æƒ³åˆ°è¿˜çœŸå‡ºäº†ï¼Œé‚£ä¹ˆä¹‹åå°±å¯ä»¥è§£äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">13390709926509813526471364597371124446888078365567927211781799241724742352679484983709219580483800891886832613684875066109177882219522305348565532970795023</span></span><br><span class="line">x=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> x**<span class="number">2</span>-n&lt;=<span class="number">0</span>:</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">1</span>] :</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line">y=gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p=x+y</span><br><span class="line">q=x-y</span><br><span class="line"><span class="built_in">print</span>(p*q==n)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œå› ä¸ºå¯¹eæ±‚é€†åçš„æ•°æ®å¾ˆå¤§ï¼Œç”¨åŸå§‹çš„loopè·‘çš„å¾ˆæ…¢å¾ˆæ…¢ï¼Œæ‰€ä»¥éœ€è¦æ”¹æˆå¿«é€Ÿå¹‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">a=<span class="number">1762039418842677123086894939949574689744108610561557889235294034870342076452734215004689409493802437034960516295735815195656138656970901855976802991519141</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=<span class="number">13390709926509813526471364597371124446888078365567927211781799241724742352679484983709219580483800891886832613684875066109177882219522305348565532970795023</span></span><br><span class="line">x=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> x**<span class="number">2</span>-n&lt;=<span class="number">0</span>:</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">1</span>] :</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line">y=gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p=x+y</span><br><span class="line">q=x-y</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="keyword">assert</span> p*q==n</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">D=a**<span class="number">2</span>%n</span><br><span class="line"></span><br><span class="line">xy = <span class="keyword">lambda</span> x,y : ((x[<span class="number">0</span>]*y[<span class="number">0</span>]+D*x[<span class="number">1</span>]*y[<span class="number">1</span>])%n, (x[<span class="number">0</span>]*y[<span class="number">1</span>]+y[<span class="number">0</span>]*x[<span class="number">1</span>])%n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getloop</span>(<span class="params">x, e</span>):</span></span><br><span class="line">    res = (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> e!=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> e &amp; <span class="number">1</span>:</span><br><span class="line">            res = xy(res, x)</span><br><span class="line">        x = xy(x, x)</span><br><span class="line">        e = e &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">(xx,yy)=getloop((<span class="number">5404548088049249951619519701935576492239293254135836357417714329205323074367876875480850741613547220698045360461761929952847796420174204143917852624050110</span>, <span class="number">2110372753170830610718226848526649992911771424441223687775304654852191999130502986109306355582366065947895295520226816523397652918227241733632791793362785</span>),d)</span><br><span class="line"></span><br><span class="line">Mx=(<span class="number">2</span>*yy*xx-<span class="number">1</span>)*(gmpy2.invert(yy,n)**<span class="number">2</span>)%n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(yy))</span><br></pre></td></tr></table></figure><p>è¯è¯´è¿™é¢˜flagè§£å‡ºæ¥æ˜¯pellæ–¹ç¨‹å¾ˆæœ‰è¶£ï¼Œå¯æ˜¯é™¤äº†åœ¨loopé‡Œxè¿ç®—ç”¨åˆ°äº†pellæ–¹ç¨‹å¤–ä¼¼ä¹æ²¡æœ‰ç”¨åˆ°äº†å‘€ï¼Œéš¾é“éé¢„æœŸï¼Ÿ</p><h2 id="MISS"><a href="#MISS" class="headerlink" title="MISS"></a>MISS</h2><p>è¿™ä¸€é¢˜å‡ºé¢˜äººè‡ªå·±å†™äº†ä¸ªAESï¼ŒæŸ¥çœ‹ä»£ç åå‘ç°keyä¸€ç‚¹ç”¨ä¹Ÿæ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸»è¦çš„æµç¨‹éƒ½é›†ä¸­åœ¨è¿™é‡Œï¼š<img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912102743034.png" alt="image-20210912102743034"></p><p>é‚£ä¹ˆç†è®ºä¸Šåªéœ€è¦ç®€å•çš„é€†ä¸€ä¸‹AESå°±è¡Œäº†ã€‚</p><p>resæ˜¯16å­—çš„ï¼ŒsubBytesæ“ä½œæ˜¯å››å­—èŠ‚ä¸€èµ·è¿ç®—ï¼Œé‚£ä¹ˆè¿™ä¸€é¢˜å’ŒXmanç»“è¥æ—¶çš„reé¢˜ä¸€æ¨¡ä¸€æ ·ï¼æ€€ç–‘å‡ºé¢˜äººæ˜¯åŒä¸€ä¸ª(</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912103027685.png" alt="image-20210912103027685"></p><p>ä¹‹å‰åšçš„æ—¶å€™å°±æ˜¯ç”¨Cè¯­è¨€çˆ†ç ´ï¼Œå› ä¸º4å­—èŠ‚ä¸€èµ·æ‰€ä»¥è¿ç®—é‡å˜æˆäº†256^4ï¼Œç°ä»£è®¡ç®—æœºå¾ˆå®¹æ˜“å°±èƒ½è·‘å‡ºæ¥</p><p>ï¼ŒæŠŠä¹‹å‰çš„ä»£ç æ”¹ä¸€ä¸‹å°±èƒ½ç”¨äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">é”˜?include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> SBox[] = &#123;</span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line"><span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line"><span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line"><span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line"><span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line"><span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line"><span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line"><span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line"><span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line"><span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line"><span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line"><span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line"><span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> RevSbox[] = &#123;</span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line"><span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line"><span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line"><span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line"><span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line"><span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line"><span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line"><span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line"><span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line"><span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line"><span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line"><span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line"><span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> GF_MULT_1[] = &#123;</span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span>,</span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>, <span class="number">0x2b</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>, <span class="number">0x2e</span>, <span class="number">0x2f</span>,</span><br><span class="line"><span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3a</span>, <span class="number">0x3b</span>, <span class="number">0x3c</span>, <span class="number">0x3d</span>, <span class="number">0x3e</span>, <span class="number">0x3f</span>,</span><br><span class="line"><span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4a</span>, <span class="number">0x4b</span>, <span class="number">0x4c</span>, <span class="number">0x4d</span>, <span class="number">0x4e</span>, <span class="number">0x4f</span>,</span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5a</span>, <span class="number">0x5b</span>, <span class="number">0x5c</span>, <span class="number">0x5d</span>, <span class="number">0x5e</span>, <span class="number">0x5f</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6a</span>, <span class="number">0x6b</span>, <span class="number">0x6c</span>, <span class="number">0x6d</span>, <span class="number">0x6e</span>, <span class="number">0x6f</span>,</span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7a</span>, <span class="number">0x7b</span>, <span class="number">0x7c</span>, <span class="number">0x7d</span>, <span class="number">0x7e</span>, <span class="number">0x7f</span>,</span><br><span class="line"><span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8a</span>, <span class="number">0x8b</span>, <span class="number">0x8c</span>, <span class="number">0x8d</span>, <span class="number">0x8e</span>, <span class="number">0x8f</span>,</span><br><span class="line"><span class="number">0x90</span>, <span class="number">0x91</span>, <span class="number">0x92</span>, <span class="number">0x93</span>, <span class="number">0x94</span>, <span class="number">0x95</span>, <span class="number">0x96</span>, <span class="number">0x97</span>, <span class="number">0x98</span>, <span class="number">0x99</span>, <span class="number">0x9a</span>, <span class="number">0x9b</span>, <span class="number">0x9c</span>, <span class="number">0x9d</span>, <span class="number">0x9e</span>, <span class="number">0x9f</span>,</span><br><span class="line"><span class="number">0xa0</span>, <span class="number">0xa1</span>, <span class="number">0xa2</span>, <span class="number">0xa3</span>, <span class="number">0xa4</span>, <span class="number">0xa5</span>, <span class="number">0xa6</span>, <span class="number">0xa7</span>, <span class="number">0xa8</span>, <span class="number">0xa9</span>, <span class="number">0xaa</span>, <span class="number">0xab</span>, <span class="number">0xac</span>, <span class="number">0xad</span>, <span class="number">0xae</span>, <span class="number">0xaf</span>,</span><br><span class="line"><span class="number">0xb0</span>, <span class="number">0xb1</span>, <span class="number">0xb2</span>, <span class="number">0xb3</span>, <span class="number">0xb4</span>, <span class="number">0xb5</span>, <span class="number">0xb6</span>, <span class="number">0xb7</span>, <span class="number">0xb8</span>, <span class="number">0xb9</span>, <span class="number">0xba</span>, <span class="number">0xbb</span>, <span class="number">0xbc</span>, <span class="number">0xbd</span>, <span class="number">0xbe</span>, <span class="number">0xbf</span>,</span><br><span class="line"><span class="number">0xc0</span>, <span class="number">0xc1</span>, <span class="number">0xc2</span>, <span class="number">0xc3</span>, <span class="number">0xc4</span>, <span class="number">0xc5</span>, <span class="number">0xc6</span>, <span class="number">0xc7</span>, <span class="number">0xc8</span>, <span class="number">0xc9</span>, <span class="number">0xca</span>, <span class="number">0xcb</span>, <span class="number">0xcc</span>, <span class="number">0xcd</span>, <span class="number">0xce</span>, <span class="number">0xcf</span>,</span><br><span class="line"><span class="number">0xd0</span>, <span class="number">0xd1</span>, <span class="number">0xd2</span>, <span class="number">0xd3</span>, <span class="number">0xd4</span>, <span class="number">0xd5</span>, <span class="number">0xd6</span>, <span class="number">0xd7</span>, <span class="number">0xd8</span>, <span class="number">0xd9</span>, <span class="number">0xda</span>, <span class="number">0xdb</span>, <span class="number">0xdc</span>, <span class="number">0xdd</span>, <span class="number">0xde</span>, <span class="number">0xdf</span>,</span><br><span class="line"><span class="number">0xe0</span>, <span class="number">0xe1</span>, <span class="number">0xe2</span>, <span class="number">0xe3</span>, <span class="number">0xe4</span>, <span class="number">0xe5</span>, <span class="number">0xe6</span>, <span class="number">0xe7</span>, <span class="number">0xe8</span>, <span class="number">0xe9</span>, <span class="number">0xea</span>, <span class="number">0xeb</span>, <span class="number">0xec</span>, <span class="number">0xed</span>, <span class="number">0xee</span>, <span class="number">0xef</span>,</span><br><span class="line"><span class="number">0xf0</span>, <span class="number">0xf1</span>, <span class="number">0xf2</span>, <span class="number">0xf3</span>, <span class="number">0xf4</span>, <span class="number">0xf5</span>, <span class="number">0xf6</span>, <span class="number">0xf7</span>, <span class="number">0xf8</span>, <span class="number">0xf9</span>, <span class="number">0xfa</span>, <span class="number">0xfb</span>, <span class="number">0xfc</span>, <span class="number">0xfd</span>, <span class="number">0xfe</span>, <span class="number">0xff</span> </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> GF_MULT_2[] = &#123;</span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x08</span>, <span class="number">0x0a</span>, <span class="number">0x0c</span>, <span class="number">0x0e</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x18</span>, <span class="number">0x1a</span>, <span class="number">0x1c</span>, <span class="number">0x1e</span>,</span><br><span class="line"><span class="number">0x20</span>, <span class="number">0x22</span>, <span class="number">0x24</span>, <span class="number">0x26</span>, <span class="number">0x28</span>, <span class="number">0x2a</span>, <span class="number">0x2c</span>, <span class="number">0x2e</span>, <span class="number">0x30</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x36</span>, <span class="number">0x38</span>, <span class="number">0x3a</span>, <span class="number">0x3c</span>, <span class="number">0x3e</span>,</span><br><span class="line"><span class="number">0x40</span>, <span class="number">0x42</span>, <span class="number">0x44</span>, <span class="number">0x46</span>, <span class="number">0x48</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x4e</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x58</span>, <span class="number">0x5a</span>, <span class="number">0x5c</span>, <span class="number">0x5e</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x68</span>, <span class="number">0x6a</span>, <span class="number">0x6c</span>, <span class="number">0x6e</span>, <span class="number">0x70</span>, <span class="number">0x72</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x78</span>, <span class="number">0x7a</span>, <span class="number">0x7c</span>, <span class="number">0x7e</span>,</span><br><span class="line"><span class="number">0x80</span>, <span class="number">0x82</span>, <span class="number">0x84</span>, <span class="number">0x86</span>, <span class="number">0x88</span>, <span class="number">0x8a</span>, <span class="number">0x8c</span>, <span class="number">0x8e</span>, <span class="number">0x90</span>, <span class="number">0x92</span>, <span class="number">0x94</span>, <span class="number">0x96</span>, <span class="number">0x98</span>, <span class="number">0x9a</span>, <span class="number">0x9c</span>, <span class="number">0x9e</span>,</span><br><span class="line"><span class="number">0xa0</span>, <span class="number">0xa2</span>, <span class="number">0xa4</span>, <span class="number">0xa6</span>, <span class="number">0xa8</span>, <span class="number">0xaa</span>, <span class="number">0xac</span>, <span class="number">0xae</span>, <span class="number">0xb0</span>, <span class="number">0xb2</span>, <span class="number">0xb4</span>, <span class="number">0xb6</span>, <span class="number">0xb8</span>, <span class="number">0xba</span>, <span class="number">0xbc</span>, <span class="number">0xbe</span>,</span><br><span class="line"><span class="number">0xc0</span>, <span class="number">0xc2</span>, <span class="number">0xc4</span>, <span class="number">0xc6</span>, <span class="number">0xc8</span>, <span class="number">0xca</span>, <span class="number">0xcc</span>, <span class="number">0xce</span>, <span class="number">0xd0</span>, <span class="number">0xd2</span>, <span class="number">0xd4</span>, <span class="number">0xd6</span>, <span class="number">0xd8</span>, <span class="number">0xda</span>, <span class="number">0xdc</span>, <span class="number">0xde</span>,</span><br><span class="line"><span class="number">0xe0</span>, <span class="number">0xe2</span>, <span class="number">0xe4</span>, <span class="number">0xe6</span>, <span class="number">0xe8</span>, <span class="number">0xea</span>, <span class="number">0xec</span>, <span class="number">0xee</span>, <span class="number">0xf0</span>, <span class="number">0xf2</span>, <span class="number">0xf4</span>, <span class="number">0xf6</span>, <span class="number">0xf8</span>, <span class="number">0xfa</span>, <span class="number">0xfc</span>, <span class="number">0xfe</span>,</span><br><span class="line"><span class="number">0x1b</span>, <span class="number">0x19</span>, <span class="number">0x1f</span>, <span class="number">0x1d</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x17</span>, <span class="number">0x15</span>, <span class="number">0x0b</span>, <span class="number">0x09</span>, <span class="number">0x0f</span>, <span class="number">0x0d</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x05</span>,</span><br><span class="line"><span class="number">0x3b</span>, <span class="number">0x39</span>, <span class="number">0x3f</span>, <span class="number">0x3d</span>, <span class="number">0x33</span>, <span class="number">0x31</span>, <span class="number">0x37</span>, <span class="number">0x35</span>, <span class="number">0x2b</span>, <span class="number">0x29</span>, <span class="number">0x2f</span>, <span class="number">0x2d</span>, <span class="number">0x23</span>, <span class="number">0x21</span>, <span class="number">0x27</span>, <span class="number">0x25</span>,</span><br><span class="line"><span class="number">0x5b</span>, <span class="number">0x59</span>, <span class="number">0x5f</span>, <span class="number">0x5d</span>, <span class="number">0x53</span>, <span class="number">0x51</span>, <span class="number">0x57</span>, <span class="number">0x55</span>, <span class="number">0x4b</span>, <span class="number">0x49</span>, <span class="number">0x4f</span>, <span class="number">0x4d</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x45</span>,</span><br><span class="line"><span class="number">0x7b</span>, <span class="number">0x79</span>, <span class="number">0x7f</span>, <span class="number">0x7d</span>, <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0x77</span>, <span class="number">0x75</span>, <span class="number">0x6b</span>, <span class="number">0x69</span>, <span class="number">0x6f</span>, <span class="number">0x6d</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x65</span>,</span><br><span class="line"><span class="number">0x9b</span>, <span class="number">0x99</span>, <span class="number">0x9f</span>, <span class="number">0x9d</span>, <span class="number">0x93</span>, <span class="number">0x91</span>, <span class="number">0x97</span>, <span class="number">0x95</span>, <span class="number">0x8b</span>, <span class="number">0x89</span>, <span class="number">0x8f</span>, <span class="number">0x8d</span>, <span class="number">0x83</span>, <span class="number">0x81</span>, <span class="number">0x87</span>, <span class="number">0x85</span>,</span><br><span class="line"><span class="number">0xbb</span>, <span class="number">0xb9</span>, <span class="number">0xbf</span>, <span class="number">0xbd</span>, <span class="number">0xb3</span>, <span class="number">0xb1</span>, <span class="number">0xb7</span>, <span class="number">0xb5</span>, <span class="number">0xab</span>, <span class="number">0xa9</span>, <span class="number">0xaf</span>, <span class="number">0xad</span>, <span class="number">0xa3</span>, <span class="number">0xa1</span>, <span class="number">0xa7</span>, <span class="number">0xa5</span>,</span><br><span class="line"><span class="number">0xdb</span>, <span class="number">0xd9</span>, <span class="number">0xdf</span>, <span class="number">0xdd</span>, <span class="number">0xd3</span>, <span class="number">0xd1</span>, <span class="number">0xd7</span>, <span class="number">0xd5</span>, <span class="number">0xcb</span>, <span class="number">0xc9</span>, <span class="number">0xcf</span>, <span class="number">0xcd</span>, <span class="number">0xc3</span>, <span class="number">0xc1</span>, <span class="number">0xc7</span>, <span class="number">0xc5</span>,</span><br><span class="line"><span class="number">0xfb</span>, <span class="number">0xf9</span>, <span class="number">0xff</span>, <span class="number">0xfd</span>, <span class="number">0xf3</span>, <span class="number">0xf1</span>, <span class="number">0xf7</span>, <span class="number">0xf5</span>, <span class="number">0xeb</span>, <span class="number">0xe9</span>, <span class="number">0xef</span>, <span class="number">0xed</span>, <span class="number">0xe3</span>, <span class="number">0xe1</span>, <span class="number">0xe7</span>, <span class="number">0xe5</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> GF_MULT_3[] = &#123;</span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x0c</span>, <span class="number">0x0f</span>, <span class="number">0x0a</span>, <span class="number">0x09</span>, <span class="number">0x18</span>, <span class="number">0x1b</span>, <span class="number">0x1e</span>, <span class="number">0x1d</span>, <span class="number">0x14</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x11</span>,</span><br><span class="line"><span class="number">0x30</span>, <span class="number">0x33</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x3c</span>, <span class="number">0x3f</span>, <span class="number">0x3a</span>, <span class="number">0x39</span>, <span class="number">0x28</span>, <span class="number">0x2b</span>, <span class="number">0x2e</span>, <span class="number">0x2d</span>, <span class="number">0x24</span>, <span class="number">0x27</span>, <span class="number">0x22</span>, <span class="number">0x21</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x63</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x6c</span>, <span class="number">0x6f</span>, <span class="number">0x6a</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x7b</span>, <span class="number">0x7e</span>, <span class="number">0x7d</span>, <span class="number">0x74</span>, <span class="number">0x77</span>, <span class="number">0x72</span>, <span class="number">0x71</span>,</span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x5c</span>, <span class="number">0x5f</span>, <span class="number">0x5a</span>, <span class="number">0x59</span>, <span class="number">0x48</span>, <span class="number">0x4b</span>, <span class="number">0x4e</span>, <span class="number">0x4d</span>, <span class="number">0x44</span>, <span class="number">0x47</span>, <span class="number">0x42</span>, <span class="number">0x41</span>,</span><br><span class="line"><span class="number">0xc0</span>, <span class="number">0xc3</span>, <span class="number">0xc6</span>, <span class="number">0xc5</span>, <span class="number">0xcc</span>, <span class="number">0xcf</span>, <span class="number">0xca</span>, <span class="number">0xc9</span>, <span class="number">0xd8</span>, <span class="number">0xdb</span>, <span class="number">0xde</span>, <span class="number">0xdd</span>, <span class="number">0xd4</span>, <span class="number">0xd7</span>, <span class="number">0xd2</span>, <span class="number">0xd1</span>,</span><br><span class="line"><span class="number">0xf0</span>, <span class="number">0xf3</span>, <span class="number">0xf6</span>, <span class="number">0xf5</span>, <span class="number">0xfc</span>, <span class="number">0xff</span>, <span class="number">0xfa</span>, <span class="number">0xf9</span>, <span class="number">0xe8</span>, <span class="number">0xeb</span>, <span class="number">0xee</span>, <span class="number">0xed</span>, <span class="number">0xe4</span>, <span class="number">0xe7</span>, <span class="number">0xe2</span>, <span class="number">0xe1</span>,</span><br><span class="line"><span class="number">0xa0</span>, <span class="number">0xa3</span>, <span class="number">0xa6</span>, <span class="number">0xa5</span>, <span class="number">0xac</span>, <span class="number">0xaf</span>, <span class="number">0xaa</span>, <span class="number">0xa9</span>, <span class="number">0xb8</span>, <span class="number">0xbb</span>, <span class="number">0xbe</span>, <span class="number">0xbd</span>, <span class="number">0xb4</span>, <span class="number">0xb7</span>, <span class="number">0xb2</span>, <span class="number">0xb1</span>,</span><br><span class="line"><span class="number">0x90</span>, <span class="number">0x93</span>, <span class="number">0x96</span>, <span class="number">0x95</span>, <span class="number">0x9c</span>, <span class="number">0x9f</span>, <span class="number">0x9a</span>, <span class="number">0x99</span>, <span class="number">0x88</span>, <span class="number">0x8b</span>, <span class="number">0x8e</span>, <span class="number">0x8d</span>, <span class="number">0x84</span>, <span class="number">0x87</span>, <span class="number">0x82</span>, <span class="number">0x81</span>,</span><br><span class="line"><span class="number">0x9b</span>, <span class="number">0x98</span>, <span class="number">0x9d</span>, <span class="number">0x9e</span>, <span class="number">0x97</span>, <span class="number">0x94</span>, <span class="number">0x91</span>, <span class="number">0x92</span>, <span class="number">0x83</span>, <span class="number">0x80</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x8f</span>, <span class="number">0x8c</span>, <span class="number">0x89</span>, <span class="number">0x8a</span>,</span><br><span class="line"><span class="number">0xab</span>, <span class="number">0xa8</span>, <span class="number">0xad</span>, <span class="number">0xae</span>, <span class="number">0xa7</span>, <span class="number">0xa4</span>, <span class="number">0xa1</span>, <span class="number">0xa2</span>, <span class="number">0xb3</span>, <span class="number">0xb0</span>, <span class="number">0xb5</span>, <span class="number">0xb6</span>, <span class="number">0xbf</span>, <span class="number">0xbc</span>, <span class="number">0xb9</span>, <span class="number">0xba</span>,</span><br><span class="line"><span class="number">0xfb</span>, <span class="number">0xf8</span>, <span class="number">0xfd</span>, <span class="number">0xfe</span>, <span class="number">0xf7</span>, <span class="number">0xf4</span>, <span class="number">0xf1</span>, <span class="number">0xf2</span>, <span class="number">0xe3</span>, <span class="number">0xe0</span>, <span class="number">0xe5</span>, <span class="number">0xe6</span>, <span class="number">0xef</span>, <span class="number">0xec</span>, <span class="number">0xe9</span>, <span class="number">0xea</span>,</span><br><span class="line"><span class="number">0xcb</span>, <span class="number">0xc8</span>, <span class="number">0xcd</span>, <span class="number">0xce</span>, <span class="number">0xc7</span>, <span class="number">0xc4</span>, <span class="number">0xc1</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xd0</span>, <span class="number">0xd5</span>, <span class="number">0xd6</span>, <span class="number">0xdf</span>, <span class="number">0xdc</span>, <span class="number">0xd9</span>, <span class="number">0xda</span>,</span><br><span class="line"><span class="number">0x5b</span>, <span class="number">0x58</span>, <span class="number">0x5d</span>, <span class="number">0x5e</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x40</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x4f</span>, <span class="number">0x4c</span>, <span class="number">0x49</span>, <span class="number">0x4a</span>,</span><br><span class="line"><span class="number">0x6b</span>, <span class="number">0x68</span>, <span class="number">0x6d</span>, <span class="number">0x6e</span>, <span class="number">0x67</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x73</span>, <span class="number">0x70</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x7f</span>, <span class="number">0x7c</span>, <span class="number">0x79</span>, <span class="number">0x7a</span>,</span><br><span class="line"><span class="number">0x3b</span>, <span class="number">0x38</span>, <span class="number">0x3d</span>, <span class="number">0x3e</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x23</span>, <span class="number">0x20</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x2f</span>, <span class="number">0x2c</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>,</span><br><span class="line"><span class="number">0x0b</span>, <span class="number">0x08</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x07</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x1f</span>, <span class="number">0x1c</span>, <span class="number">0x19</span>, <span class="number">0x1a</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> final_enc[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0x1d</span>, <span class="number">0xba</span>,<span class="number">0x82</span>,<span class="number">0x39</span>,</span><br><span class="line"><span class="number">0x1c</span>, <span class="number">0x25</span>,<span class="number">0x6b</span>,<span class="number">0x8d</span>,</span><br><span class="line"><span class="number">0x5</span>,  <span class="number">0x20</span>,<span class="number">0x99</span>,<span class="number">0xa2</span>,</span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x6d</span>,<span class="number">0xc</span>, <span class="number">0x4f</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> P1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> P1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> P2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> P2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> P3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> P3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TEST_RDTSC</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RevSubBytes</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* Arr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">Arr[i] = RevSbox[Arr[i]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RevShiftRow</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* Arr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> m[] = &#123; <span class="number">0</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ret[<span class="number">16</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">ret[i] = Arr[m[i]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++) &#123;</span><br><span class="line">Arr[j] = ret[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RevMixColumn</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* Arr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> new_b0, new_b1, new_b2, new_b3;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> b0 = <span class="number">0</span>; b0 &lt; <span class="number">256</span>; b0++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> b1 = <span class="number">0</span>; b1 &lt; <span class="number">256</span>; b1++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> b2 = <span class="number">0</span>; b2 &lt; <span class="number">256</span>; b2++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> b3 = <span class="number">0</span>; b3 &lt; <span class="number">256</span>; b3++)</span><br><span class="line">&#123;</span><br><span class="line">new_b0 = GF_MULT_2[b0] ^ GF_MULT_3[b1] ^ GF_MULT_1[b2] ^ GF_MULT_1[b3];</span><br><span class="line">new_b1 = GF_MULT_1[b0] ^ GF_MULT_2[b1] ^ GF_MULT_3[b2] ^ GF_MULT_1[b3];</span><br><span class="line">new_b2 = GF_MULT_1[b0] ^ GF_MULT_1[b1] ^ GF_MULT_2[b2] ^ GF_MULT_3[b3];</span><br><span class="line">new_b3 = GF_MULT_3[b0] ^ GF_MULT_1[b1] ^ GF_MULT_1[b2] ^ GF_MULT_2[b3];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">(new_b0 == Arr[<span class="number">4</span> * i]) &amp;&amp;</span><br><span class="line">(new_b1 == Arr[<span class="number">4</span> * i + <span class="number">1</span>]) &amp;&amp;</span><br><span class="line">(new_b2 == Arr[<span class="number">4</span> * i + <span class="number">2</span>]) &amp;&amp;</span><br><span class="line">(new_b3 == Arr[<span class="number">4</span> * i + <span class="number">3</span>])</span><br><span class="line">) </span><br><span class="line">&#123;</span><br><span class="line">tmp[<span class="number">4</span> * i] = b0;</span><br><span class="line">tmp[<span class="number">4</span> * i + <span class="number">1</span>] = b1;</span><br><span class="line">tmp[<span class="number">4</span> * i + <span class="number">2</span>] = b2;</span><br><span class="line">tmp[<span class="number">4</span> * i + <span class="number">3</span>] = b3;</span><br><span class="line"><span class="keyword">goto</span> END;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">END:</span><br><span class="line"></span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++) </span><br><span class="line">&#123;</span><br><span class="line">Arr[j] = tmp[j];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Final</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> Final</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> P1</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp2;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> arr2[<span class="number">16</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">0xF</span>; ++k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">tmp2 = *((<span class="keyword">unsigned</span> __int8*)&amp;DwArr[<span class="number">64</span> * k + <span class="number">36864</span>] + i);</span><br><span class="line"><span class="keyword">if</span> (tmp2 == Enc[k]) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//printf(&quot;i:%d\n&quot;, i);</span></span><br><span class="line">arr2[k] = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>, arr2[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> P2</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> tmp;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">256</span>; k++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; <span class="number">256</span>; m++) &#123;</span><br><span class="line">tmp = DwArr[<span class="number">29440</span> + i] ^ DwArr[<span class="number">29184</span> + j] ^ DwArr[<span class="number">28928</span> + k] ^ DwArr[<span class="number">28672</span> + m];</span><br><span class="line"><span class="keyword">if</span> (tmp == <span class="number">0xac110172</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d, %d, %d, %d&quot;</span>, i, j, k, m);</span><br><span class="line"><span class="keyword">goto</span> End;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> P3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> test1[] = &#123;</span><br><span class="line"><span class="number">0x72</span>, <span class="number">0x01</span>, <span class="number">0x11</span>, <span class="number">0xac</span>, </span><br><span class="line"><span class="number">0x65</span>, <span class="number">0x5f</span>, <span class="number">0x18</span>, <span class="number">0x38</span>, </span><br><span class="line"><span class="number">0x30</span>, <span class="number">0xe2</span>, <span class="number">0x67</span>, <span class="number">0xad</span>, </span><br><span class="line"><span class="number">0x5c</span>, <span class="number">0x42</span>, <span class="number">0xe7</span>, <span class="number">0x0d</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> test2[] = &#123;</span><br><span class="line"><span class="number">0x72</span>, <span class="number">0x5f</span>, <span class="number">0x67</span>, <span class="number">0x0d</span>, </span><br><span class="line"><span class="number">0x65</span>, <span class="number">0xe2</span>, <span class="number">0xe7</span>, <span class="number">0xac</span>, </span><br><span class="line"><span class="number">0x30</span>, <span class="number">0x42</span>, <span class="number">0x11</span>, <span class="number">0x38</span>, </span><br><span class="line"><span class="number">0x5c</span>, <span class="number">0x01</span>, <span class="number">0x18</span>, <span class="number">0xad</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">unsigned char test1[] = &#123;</span></span><br><span class="line"><span class="comment">0,  1,  2,  3,</span></span><br><span class="line"><span class="comment">4,  5,  6,  7,</span></span><br><span class="line"><span class="comment">8,  9,  10, 11,</span></span><br><span class="line"><span class="comment">12, 13, 14, 15</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">unsigned char test2[] = &#123;</span></span><br><span class="line"><span class="comment">0, 5,10,15,</span></span><br><span class="line"><span class="comment">4, 9,14, 3,</span></span><br><span class="line"><span class="comment">8,13, 2, 7,</span></span><br><span class="line"><span class="comment">   12, 1, 6, 11</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">RevShiftBytes(test2);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, test1[i] - test2[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> TEST</span></span><br><span class="line"><span class="comment">// SBox + Shift</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> test1[] = &#123; <span class="number">99</span>, <span class="number">107</span>, <span class="number">103</span>, <span class="number">118</span>, <span class="number">242</span>, <span class="number">1</span>, <span class="number">171</span>, <span class="number">123</span>, <span class="number">48</span>, <span class="number">215</span>, <span class="number">119</span>, <span class="number">197</span>, <span class="number">254</span>, <span class="number">124</span>, <span class="number">111</span>, <span class="number">43</span> &#125;;</span><br><span class="line"><span class="comment">// SBox</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> test2[] = &#123; <span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>, <span class="number">48</span>, <span class="number">1</span>, <span class="number">103</span>, <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span> &#125;;</span><br><span class="line"><span class="comment">// SBox + Shift + Mix</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> test3[] = &#123; <span class="number">106</span>, <span class="number">106</span>, <span class="number">92</span>, <span class="number">69</span>, <span class="number">44</span>, <span class="number">109</span>, <span class="number">51</span>, <span class="number">81</span>, <span class="number">176</span>, <span class="number">217</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">39</span>, <span class="number">156</span>, <span class="number">33</span>, <span class="number">92</span> &#125;;</span><br><span class="line"></span><br><span class="line">RevMixColumn(test3);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevMixColumn&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, test3[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">RevShiftRow(test3);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevShiftBytes:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, test3[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">RevSubBytes(test3);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevSubBytes:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, test3[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//for (int i = 0; i &lt; 10; i++) &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> final_enc[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0x1d</span>, <span class="number">0xba</span>,<span class="number">0x82</span>,<span class="number">0x39</span>,</span><br><span class="line"><span class="number">0x1c</span>, <span class="number">0x25</span>,<span class="number">0x6b</span>,<span class="number">0x8d</span>,</span><br><span class="line"><span class="number">0x5</span>,  <span class="number">0x20</span>,<span class="number">0x99</span>,<span class="number">0xa2</span>,</span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x6d</span>,<span class="number">0xc</span>, <span class="number">0x4f</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">RevShiftRow(final_enc);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevShiftRow:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">RevSubBytes(final_enc);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevSubBytes:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) </span><br><span class="line">&#123;</span><br><span class="line">RevMixColumn(final_enc);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevMixColumn&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">RevShiftRow(final_enc);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevShiftRow:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">RevSubBytes(final_enc);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;RevSubBytes:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Finally:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span> ,final_enc[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>((<span class="keyword">const</span> <span class="keyword">char</span>*)final_enc);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> Final</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">8</span>; a &gt;= <span class="number">0</span>; --a) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">3</span>; b &gt;= <span class="number">0</span>; ) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">256</span>; k++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; <span class="number">256</span>; m++) &#123;</span><br><span class="line">tmp = DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">3</span> + <span class="number">16</span> * a) + i] ^<span class="comment">// i == out[4*b + 3]</span></span><br><span class="line">  DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">2</span> + <span class="number">16</span> * a) + j] ^<span class="comment">// j == out[4*b + 2]</span></span><br><span class="line">  DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">1</span> + <span class="number">16</span> * a) + k] ^ <span class="comment">// k == out[4*b + 1]</span></span><br><span class="line">  DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">0</span> + <span class="number">16</span> * a) + m];<span class="comment">// m == out[4*b + 0]</span></span><br><span class="line"><span class="keyword">if</span> (tmp == ((<span class="keyword">unsigned</span> <span class="keyword">int</span>*)Enc)[b]) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;a:%2d; b:%2d | &quot;</span>, a, b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%02x, %02x, %02x, %02x \n&quot;</span>, i, j, k, m);</span><br><span class="line">Enc[<span class="number">4</span> * b] = m;</span><br><span class="line">Enc[<span class="number">4</span> * b + <span class="number">1</span>] = k;</span><br><span class="line">Enc[<span class="number">4</span> * b + <span class="number">2</span>] = j;</span><br><span class="line">Enc[<span class="number">4</span> * b + <span class="number">3</span>] = i;</span><br><span class="line"><span class="keyword">goto</span> Label1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Label1:</span><br><span class="line">--b;</span><br><span class="line">&#125;</span><br><span class="line">RevShiftBytes(Enc);</span><br><span class="line"><span class="comment">//putchar(&#x27;\n&#x27;);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, Enc[h]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šä¸ä¼šæ˜¯å› ä¸ºå½“æ—¶æ²¡äººåšæ‰€ä»¥åˆä¸¢è¿‡æ¥äº†ï¼Ÿ2333å› ä¸ºé˜Ÿé‡Œçš„reå¸ˆå‚…å¤ç›˜äº†è¿™ä¸€é¢˜æ‰€ä»¥å°±æœ‰å°è±¡äº†</p><h2 id="èµ›åšæœ‹å…‹äºº"><a href="#èµ›åšæœ‹å…‹äºº" class="headerlink" title="èµ›åšæœ‹å…‹äºº"></a>èµ›åšæœ‹å…‹äºº</h2><p>ä¹‹å‰æ‰“CTFshowçš„åƒç“œæ¯äº†è§£åˆ°ä¸€ä¸ªåº“å«pycipherï¼Œå†…ç½®äº†enigmaå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912111805833.png" alt="image-20210912111805833"></p><p>è¿™ä¸ªè¡¨æ˜¾ç¤ºäº†9æœˆæ¯ä¸€å¤©çš„å‚æ•°ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥åªéœ€è¦æ‰¾å‡ºæ˜¯å“ªä¸€å¤©çš„å‚æ•°å³å¯</p><p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912111851723.png" alt="image-20210912111851723"></p><p>æ ¹æ®é¢˜ç›®ç»™å‡ºçš„æç¤ºï¼šå½“ä»Šç½‘ç»œä¸–ç•Œæœ‰ç”µå­è¶Šå…±ï¼Œé‚£ä¹ˆä¹Ÿä¼šæœ‰èµ›åšå¾·å›½äººï¼Œè€Œä¸”è¿˜å–œæ¬¢ç”¨ç›¸åŒçš„å¯†ç ï¼Œè¯·æ‰¾å‡ºä»–ä»¬çš„é€šä¿¡å†…å®¹(å†…å®¹æ˜¯å¾·æ–‡ï¼Œflagæ˜¯æ­£å¸¸çš„flagï¼Œè€Œä¸”é€šä¿¡çš„æ ¼å¼è¿˜åŸå†å²ï¼Œä¼ é€’å¯†é’¥çš„æ–¹æ³•ä¸ºäºŒæˆ˜ä¸­åæœŸæ”¹è¿›çš„)ã€‚</p><p>ä¹‹åæŸ¥è¯¢äº†å¤§é‡èµ„æ–™ï¼Œæ€»ç®—æ˜¯è¿˜åŸå‡ºäº†è¿™äº›å†…å®¹æ‰€ä»£è¡¨çš„å«ä¹‰ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0911</span> = <span class="number">1</span>tle = <span class="number">1</span>tl = <span class="number">350</span> = RZS NAJ =</span><br><span class="line">nkfgp roqad <span class="keyword">boprv </span>yrdhy zwamf qsrhb owqvt <span class="keyword">jzotr </span>ffcjq snpqh kpwzm fprru gufez xsuws aohyw xbreu pifbz kagxj <span class="keyword">blbha </span><span class="keyword">jzixj </span>zrasn zxkay lpaza ejwou itcip dfdgp rbjnv xuqzq qhtya xwwik wyybx kdgrc slrkj pgjay aidwa <span class="keyword">jeszp </span>pbqat njojg <span class="keyword">jrplb </span>kkhot <span class="keyword">joqpg </span>vwecj soabm aupsr fenug ybxmr <span class="keyword">jloch </span>kmjgc tznxl tnrqx pbeph fwymn gpoor pjkkb plkwb kxzeq quorp ipuvs utyae qyzgp mqnai iysse gzsht tsrmv crrkr opuxj tqshv ypdrw rvnzt cstlj </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œï¼š9æœˆ11æ—¥çš„å†…å®¹ï¼Œæ€»å…±ä¸€éƒ¨åˆ†ï¼Œè¿™æ˜¯ç¬¬ä¸€éƒ¨åˆ†ï¼Œæœ‰350ä¸ªå­—æ¯ï¼ˆåŒ…æ‹¬ç¬¬ä¸€ç»„çš„buchstabenkennngruppe)ï¼Œæ‰€è°“buchstabenkennngruppe NKFGPæ˜¾ç¤ºå‡ºäº†æ“ä½œè€…çš„é”®ä½è®¾ç½®ï¼Œç”¨äºåŠ å¯†ä¿¡æ¯ã€‚å…¶ä¸­å‰ä¸¤ä¸ªä¸ºéšæœºå­—æ¯ï¼Œåé¢ä¸‰ä¸ªä¸ºæŸä¸€å¤©çš„kennngruppeä¿¡æ¯ï¼Œæ ¹æ®ä¸Šè¡¨å¯ä»¥çŸ¥é“è¿™æ˜¯ç”¨çš„9æœˆ10å·çš„å‚æ•°ã€‚äºæ˜¯å¯ä»¥ç¡®å®šrotors,ringstellung,steckerså‚æ•°ï¼Œé‚£ä¹ˆåˆå§‹è®¾ç½®settingså‘¢ï¼Ÿ</p><p>åˆ«å¿˜äº†ï¼Œæˆ‘ä»¬ç¬¬ä¸€è¡Œè¿˜æœ‰ä¸¤ç»„å­—æ¯ï¼Œå…¶ä¸­RZSæ˜¯æ“ä½œè€…çš„åˆå§‹è®¾ç½®ï¼Œè€ŒNAJä¸ºç»“æœï¼Œé‚£ä¹ˆä»¥RZSä¸ºåˆå§‹é”®ä½è®¾ç½®ï¼Œè§£å¯†NAJåå¾—åˆ°çš„ä¿¡æ¯ä¾¿æ˜¯æ¥æ”¶è€…éœ€è¦è®¾ç½®çš„settingsã€‚reflectorå‚æ•°åªå¯èƒ½æ˜¯ABCï¼Œè¿™é‡Œå¯ä»¥çˆ†ç ´ã€‚</p><p>ç»¼ä¸Šï¼Œæˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†è§£å¯†enigmaæ‰€éœ€è¦çš„å…¨éƒ¨ä¿¡æ¯ã€‚é€ä¸ªå°è¯•åå‘ç°ç”¨Bçš„reflectorè§£å¯†å‡ºæ¥çš„å†…å®¹é‡å¤ç‡å¾ˆé«˜ï¼Œä¸€å¼€å§‹å¡ä½äº†ã€‚é¢˜ç›®æ‰€è¯´çš„æ˜¯å¾·å›½ï¼Œæ­£å¥½æˆ‘æœ‰ä¸ªå®¤å‹ä¼šå¾·è¯­ï¼Œäºæ˜¯è®©ä»–å¸®å¿™çœ‹ä¸€ä¸‹ï¼Œä¸€çœ¼å°±çœ‹å‡ºæ¥æ˜¯å¾·æ–‡æ•°å­—ï¼Œäºæ˜¯ç¿»è¯‘è¿‡æ¥æ‹¿åˆ°ç»“æœä¸€ä¸²å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Enigma</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">dic = string.ascii_uppercase</span><br><span class="line">c=<span class="string">&#x27;roqadboprvyrdhyzwamfqsrhbowqvtjzotrffcjqsnpqhkpwzmfprrugufezxsuwsaohywxbreupifbzkagxjblbhajzixjzrasnzxkaylpazaejwouitcipdfdgprbjnvxuqzqqhtyaxwwikwyybxkdgrcslrkjpgjayaidwajeszppbqatnjojgjrplbkkhotjoqpgvwecjsoabmaupsrfenugybxmrjlochkmjgctznxltnrqxpbephfwymngpoorpjkkbplkwbkxzeqquorpipuvsutyaeqyzgpmqnaiiyssegzshttsrmvcrrkropuxjtqshvypdrwrvnztcstlj&#x27;</span>.upper()</span><br><span class="line">cc=<span class="string">&#x27;NAJ&#x27;</span></span><br><span class="line"></span><br><span class="line">eng=Enigma(settings=(<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;S&#x27;</span>),rotors=(<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>),reflector=<span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">                ringstellung=(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),steckers=[(<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;T&#x27;</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;V&#x27;</span>),</span><br><span class="line">                (<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;F&#x27;</span>),(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;N&#x27;</span>),(<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),(<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;O&#x27;</span>),(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;W&#x27;</span>),(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;U&#x27;</span>),(<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>),(<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;X&#x27;</span>)])</span><br><span class="line"></span><br><span class="line">n = eng.decipher(cc)</span><br><span class="line">eng=Enigma(settings=(n[<span class="number">0</span>],n[<span class="number">1</span>],n[<span class="number">2</span>]),rotors=(<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>),reflector=<span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">                ringstellung=(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),steckers=[(<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;T&#x27;</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;V&#x27;</span>),</span><br><span class="line">                (<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;F&#x27;</span>),(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;N&#x27;</span>),(<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),(<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;O&#x27;</span>),(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;W&#x27;</span>),(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;U&#x27;</span>),(<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>),(<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;X&#x27;</span>)])</span><br><span class="line">flag=eng.decipher(c)</span><br><span class="line">flag=flag.lower()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">## 475748547berta36623936373230356665373537393566313034383537316366346366623730337dora</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°†ertaå’Œoraåˆ å»åï¼Œå†hexè½¬å­—ç¬¦ä¸²å°±å¯ä»¥æ‹¿åˆ°flagäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#GWHT&#123;6b967205fe75795f1048571cf4cfb703&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæ„Ÿè°¢ä¸‡èƒ½çš„çŸ³ç¥ï¼Œæœ‰ä¸ªå°è¯­ç§å®¤å‹çœŸå¥½</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;zåšäº†äº”é“ã€‚è¯è¯´æœ€åä¸€é¢˜sm4ä¹‹åæ˜¯ä¸ªä»€ä¹ˆç©æ„ï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="RSA" scheme="http://sh1k4ku.github.io/tags/RSA/"/>
    
    <category term="Pell Equation" scheme="http://sh1k4ku.github.io/tags/Pell-Equation/"/>
    
    <category term="Enigma" scheme="http://sh1k4ku.github.io/tags/Enigma/"/>
    
  </entry>
  
  <entry>
    <title>ç¦»æ•£å¯¹æ•°</title>
    <link href="http://sh1k4ku.github.io/2021/08/31/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/"/>
    <id>http://sh1k4ku.github.io/2021/08/31/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/</id>
    <published>2021-08-31T03:57:16.000Z</published>
    <updated>2021-09-06T09:19:07.790Z</updated>
    
    <content type="html"><![CDATA[<p>ç¦»æ•£å¯¹æ•°(Discretelogarithm,ç®€ç§°DL)æ˜¯ä¸€ç§åŸºäºåŒä½™è¿ç®—å’ŒåŸæ ¹çš„ä¸€ç§å¯¹æ•°è¿ç®—ã€‚</p><span id="more"></span><h1 id="åŸºæœ¬å®šä¹‰"><a href="#åŸºæœ¬å®šä¹‰" class="headerlink" title="åŸºæœ¬å®šä¹‰"></a>åŸºæœ¬å®šä¹‰</h1><p>åœ¨ç¾¤ G ä¸­ï¼Œg ä¸º G çš„ç”Ÿæˆå…ƒï¼Œä¹Ÿå°±æ˜¯è¯´ç¾¤ G ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥å†™æˆ <script type="math/tex">y=g^k</script>ï¼Œæˆ‘ä»¬ç§° k ä¸º y åœ¨ç¾¤ G ä¸­çš„å¯¹æ•°ï¼Œè®°ä½œ <script type="math/tex">k=log_yg</script>ã€‚</p><script type="math/tex; mode=display">è®¾ mâ‰¥1ï¼Œ(a,m)=1 ï¼Œä½¿å¾— a^dâ‰¡1(mod\;m) æˆç«‹çš„æœ€å°æ­£æ•´æ•° d\\ ç§°ä¸º a å¯¹æ¨¡ m çš„æŒ‡æ•°æˆ–è€…é˜¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬å°†å…¶è®°ä¸º \delta_m(a)ã€‚</script><script type="math/tex; mode=display">å½“ Î´_m(a)=Ï†(m)æ—¶ï¼Œç§° a æ˜¯æ¨¡ m çš„åŸæ ¹ï¼Œç®€ç§° m çš„åŸæ ¹ã€‚</script><h1 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h1><script type="math/tex; mode=display">ä½¿å¾— a^dâ‰¡1(mod\;m) æˆç«‹çš„æœ€å°æ­£æ•´æ•° d ï¼Œæ»¡è¶³dâˆ£Ï†(m)ã€‚</script><script type="math/tex; mode=display">æ¨¡ m å‰©ä½™ç³»å­˜åœ¨åŸæ ¹çš„å……è¦æ¡ä»¶æ˜¯ m=2,4,p^Î±,2p^Î± ï¼Œå…¶ä¸­ p ä¸ºå¥‡ç´ æ•°ï¼Œ Î± ä¸ºæ­£æ•´æ•°ã€‚</script><h1 id="ç¦»æ•£å¯¹æ•°é—®é¢˜"><a href="#ç¦»æ•£å¯¹æ•°é—®é¢˜" class="headerlink" title="ç¦»æ•£å¯¹æ•°é—®é¢˜"></a>ç¦»æ•£å¯¹æ•°é—®é¢˜</h1><h2 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h2><p>ç»™å®š<script type="math/tex">yâ‰¡g^x\;mod\;p</script>ï¼Œ<del>ä¸</del>å¯ä»¥æš´åŠ›æšä¸¾xæ¥æ±‚è§£ã€‚ï¼ˆè¯¯</p><h2 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h2><p>å…¨ç§°æ˜¯Baby-step giant-stepï¼Œä¹Ÿå«å°æ­¥å¤§æ­¥æ³•ï¼Œä½¿ç”¨äº†ä¸­é—´ç›¸é‡çš„æ€æƒ³ã€‚</p><p>ä»¤<script type="math/tex">x=im+jï¼Œå…¶ä¸­m=[\sqrt n]</script>ï¼Œiå’Œjéƒ½åœ¨0åˆ°mçš„èŒƒå›´å†…</p><p>å› æ­¤<script type="math/tex">y=g^x=g^{im+j}</script></p><p>å˜æ¢å¾—<script type="math/tex">y(g^{-m})^i=g^j</script></p><p>ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æšä¸¾æ‰€æ‰€æœ‰çš„jè®¡ç®—ï¼Œå¹¶å­˜åœ¨ä¸€iä¸ªé›†åˆSä¸­ï¼Œç„¶åæˆ‘ä»¬å†æ¬¡æšä¸¾iè®¡ç®—<script type="math/tex">y(g^{-m})^i</script>,åªè¦å‘ç°è®¡ç®—çš„ç»“æœåœ¨Sä¸­åˆ™è¯´æ˜å®Œæˆç¢°æ’ï¼Œå¾—åˆ°äº†iå’Œjã€‚</p><p>BSGSæ˜¯ä¸€ä¸ªæ—¶é—´ä¸ç©ºé—´çš„æŠ˜ä¸­çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ª <script type="math/tex">O(n)</script>çš„æ—¶é—´å¤æ‚åº¦ï¼Œ<script type="math/tex">O(1)</script> ç©ºé—´å¤æ‚åº¦çš„ç®—æ³•è½¬æ¢ä¸ºäº†ä¸€ä¸ª<script type="math/tex">O(\sqrt n)</script> çš„æ—¶é—´å¤æ‚åº¦å’Œ<script type="math/tex">O(\sqrt n)</script> çš„ç©ºé—´å¤æ‚åº¦çš„ç®—æ³•ã€‚</p><p>å…¶ä¸­</p><ol><li>jæ¯æ¬¡å¢åŠ è¡¨ç¤ºâ€œbaby-stepâ€</li><li>iæ¯æ¬¡å¢åŠ è¡¨ç¤ºâ€giant-stepâ€</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bsgs</span>(<span class="params">g,y,p,bound</span>):</span></span><br><span class="line">    m=gmpy2.iroot(bound,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    S=&#123;<span class="built_in">pow</span>(g,j,p):j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m)&#125;</span><br><span class="line">    gs=<span class="built_in">pow</span>(g,-m,p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)ï¼š</span><br><span class="line">    <span class="keyword">if</span> y <span class="keyword">in</span> S:</span><br><span class="line">            <span class="keyword">return</span> i*m+S[y]</span><br><span class="line">        y=y * gs %p</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">g=</span><br><span class="line">y=</span><br><span class="line">p=</span><br><span class="line">bound=</span><br><span class="line">x=bsgs(g,y,p,bound)</span><br></pre></td></tr></table></figure><p>sagemathå†…ç½®å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">bsgs(g,y,bounds,operation)</span><br></pre></td></tr></table></figure><h2 id="Pollardâ€˜s-Rho-algorithm"><a href="#Pollardâ€˜s-Rho-algorithm" class="headerlink" title="Pollardâ€˜s Rho algorithm"></a>Pollardâ€˜s Rho algorithm</h2><p>Pollardâ€™s Rho ç®—æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£åˆå®¹æ˜“ç†è§£çš„æ•´æ•°å› å­åˆ†è§£ç®—æ³•ï¼ŒåŸæœ¬ç”¨äºåˆ†è§£RSAä½“ç³»ä¸­çš„nï¼Œåæ¥åˆåº”ç”¨äºç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚</p><h1 id="åŠ å¯†ç®—æ³•"><a href="#åŠ å¯†ç®—æ³•" class="headerlink" title="åŠ å¯†ç®—æ³•"></a>åŠ å¯†ç®—æ³•</h1><h2 id="Elgamal-PKC"><a href="#Elgamal-PKC" class="headerlink" title="Elgamal PKC"></a>Elgamal PKC</h2><p>è€è§„çŸ©ï¼ŒAliceä¼ æ¶ˆæ¯ç»™Bobï¼š</p><script type="math/tex; mode=display">å…¬å¼€ï¼šå¤§è´¨æ•°på’ŒF^*_pä¸‹çš„ç”Ÿæˆå…ƒg\\1.Aliceéšæœºé€‰æ‹©ä¸€ä¸ªå¯†é’¥aï¼Œè®¡ç®—A=g^a\;mod\;p,å¹¶å°†å…¬é’¥Aä¼ ç»™Bobï¼ˆgå’Œpå…¶å®ä¹Ÿæ˜¯å…¬é’¥ï¼‰\\2.Bobç”Ÿæˆéšæœºæ•°kï¼Œè®¡ç®—c_1=g^k\;mod\;p,c_2=mA^k\;mod\;p\\3.Aliceè¿˜åŸmï¼š(c^a)^{-1}*c_2=(g^{ak})^{-1}*m(A^k)=(g^{ak})^{-1}*mg^{ak}=m\;mod\;p</script><p><img src="/images/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/image-20210906171507054.png" alt="image-20210906171507054"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç¦»æ•£å¯¹æ•°(Discretelogarithm,ç®€ç§°DL)æ˜¯ä¸€ç§åŸºäºåŒä½™è¿ç®—å’ŒåŸæ ¹çš„ä¸€ç§å¯¹æ•°è¿ç®—ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Crypto" scheme="http://sh1k4ku.github.io/categories/Crypto/"/>
    
    
    <category term="ç¦»æ•£å¯¹æ•°" scheme="http://sh1k4ku.github.io/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>ECC</title>
    <link href="http://sh1k4ku.github.io/2021/08/30/ECC/"/>
    <id>http://sh1k4ku.github.io/2021/08/30/ECC/</id>
    <published>2021-08-30T08:14:06.000Z</published>
    <updated>2021-08-30T15:56:59.318Z</updated>
    
    <content type="html"><![CDATA[<p>æŠ„ç‚¹ECCç¬”è®°</p><span id="more"></span><h1 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h1><p>å®šä¹‰ï¼šECC å…¨ç§°ä¸ºæ¤­åœ†æ›²çº¿åŠ å¯†ï¼ŒEllipseCurve Cryptographyï¼Œæ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦çš„å…¬é’¥å¯†ç ã€‚ä¸ä¼ ç»Ÿçš„åŸºäºå¤§è´¨æ•°å› å­åˆ†è§£å›°éš¾æ€§çš„åŠ å¯†æ–¹æ³•ä¸åŒï¼ŒECC ä¾èµ–äºè§£å†³æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å›°éš¾æ€§ã€‚å®ƒçš„ä¼˜åŠ¿ä¸»è¦åœ¨äºç›¸å¯¹äºå…¶å®ƒæ–¹æ³•ï¼Œå®ƒå¯ä»¥åœ¨ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„åŒæ—¶ä¿æŒç›¸åŒçš„å¯†ç å¼ºåº¦ã€‚ç›®å‰æ¤­åœ†æ›²çº¿ä¸»è¦é‡‡ç”¨çš„æœ‰é™åŸŸæœ‰:</p><ol><li>ä»¥ç´ æ•°ä¸ºæ¨¡çš„æ•´æ•°åŸŸ GF(p)ï¼Œé€šå¸¸åœ¨é€šç”¨å¤„ç†å™¨ä¸Šæ›´ä¸ºæœ‰æ•ˆã€‚</li><li>ç‰¹å¾ä¸º 2 çš„ä¼½ç½—ååŸŸ GFï¼ˆ2^mï¼‰ï¼Œå¯ä»¥è®¾è®¡ä¸“é—¨çš„ç¡¬ä»¶ã€‚</li></ol><p>ï¼ˆfrom CTF Wikiï¼‰</p><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><p>å®šä¹‰å¼ï¼š<script type="math/tex">y^2+axy+by=x^3+cx^2+dx+e</script>ï¼Œå…¶ä¸­çš„æ‰€æœ‰ç³»æ•°éƒ½æ˜¯åœ¨æŸä¸ªæœ‰é™åŸŸGF(p)ä¸­çš„å…ƒç´ ï¼Œpæ˜¯ä¸€ä¸ªå¤§ç´ æ•°ï¼›</p><p>æœ€å¸¸ç”¨çš„æ–¹ç¨‹ä¸ºï¼š<script type="math/tex">y^2=x^3+ax+b</script>ï¼Œéœ€è¦æ»¡è¶³æ¡ä»¶<script type="math/tex">4a^3+27b^2\;mod\; p \neq 0</script></p><p>è¯¥å®šä¹‰è¦æ±‚æ›²çº¿æ˜¯éå¥‡å¼‚çš„ï¼Œæ„å‘³ç€æ›²çº¿ä¸ä¼šè‡ªæˆ‘ç›¸äº¤æˆ–æ²¡æœ‰é¡¶ç‚¹ã€‚</p><h2 id="ç¾¤æ“ä½œ"><a href="#ç¾¤æ“ä½œ" class="headerlink" title="ç¾¤æ“ä½œ"></a>ç¾¤æ“ä½œ</h2><p>å‡è®¾ç”¨åŠ æ³•ç¬¦å·â€œ+â€è¡¨ç¤ºå®ƒçš„ç¾¤æ“ä½œï¼Œäº‹å®ä¸Šï¼ŒE(Fp)å¯¹äºè¿ç®—+æ„æˆä¸€ä¸ªé˜¿è´å°”ç¾¤ï¼ˆäº¤æ¢ç¾¤ï¼Œæ»¡è¶³é€†å…ƒå­˜åœ¨ï¼Œå°é—­æ€§ç­‰ï¼‰ï¼Œå­˜åœ¨æ— ç©·è¿œç‚¹O</p><h3 id="é€†å…ƒ"><a href="#é€†å…ƒ" class="headerlink" title="é€†å…ƒ"></a>é€†å…ƒ</h3><p>å®šä¹‰ç¾¤å…ƒç´ Pçš„é€†å…ƒ-Pï¼Œåˆ™P+(-P)=O</p><script type="math/tex; mode=display">è‹¥P=(x_p,y_p)\;\;\;åˆ™-P=(x_p,p-y_p)</script><h3 id="æ•°ä¹˜"><a href="#æ•°ä¹˜" class="headerlink" title="æ•°ä¹˜"></a>æ•°ä¹˜</h3><script type="math/tex; mode=display">å®šä¹‰Q=kPï¼Œå¯ä»¥çœ‹ä½œkä¸ªPç›¸åŠ å¾—åˆ°Q    \\è‹¥O=tP,åˆ™ç§°Pçš„é˜¶æ˜¯t</script><h3 id="ç›¸å¼‚ç‚¹ç›¸åŠ "><a href="#ç›¸å¼‚ç‚¹ç›¸åŠ " class="headerlink" title="ç›¸å¼‚ç‚¹ç›¸åŠ "></a>ç›¸å¼‚ç‚¹ç›¸åŠ </h3><script type="math/tex; mode=display">P(x_1,y_1),Q(x_2,y_2),R(x_3,y_3)\;\;P+Q=R</script><p><img src="/images/ECC/1.png" alt></p><script type="math/tex; mode=display">x_3=(\frac{y_2-y_1}{x_2-x_1})^2-x_1-x_2\;mod\;p\\y_3=\frac{y_2-y_1}{x_2-x_1}(x_1-x_3)-y_1\;mod\;p</script><h3 id="ç›¸åŒç‚¹ç›¸åŠ "><a href="#ç›¸åŒç‚¹ç›¸åŠ " class="headerlink" title="ç›¸åŒç‚¹ç›¸åŠ "></a>ç›¸åŒç‚¹ç›¸åŠ </h3><p><img src="/images/ECC/2.png" alt></p><script type="math/tex; mode=display">x_3=(\frac{3x_1^2+a}{2y_1})^2-x_1-x_2\;mod\;p\\y_3=\frac{3x_1^2+a}{2y_1}(x_1-x_3)-y_1\;mod\;p</script><h2 id="åŠ è§£å¯†"><a href="#åŠ è§£å¯†" class="headerlink" title="åŠ è§£å¯†"></a>åŠ è§£å¯†</h2><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>Bå‘Aå‘é€mï¼Œå…¶ä¸­må·²ç»è¢«ç¼–ç ä¸ºæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼š</p><ol><li>æŸ¥è¯¢Açš„å…¬é’¥<script type="math/tex">E_q(a,b),q,P,Gï¼Œå…¶ä¸­P=kGã€‚kä¸ºç§é’¥</script>ã€‚</li><li>åœ¨<script type="math/tex">ï¼ˆ1ï¼Œnï¼‰</script>å†…é€‰æ‹©éšæœºæ•°rï¼ˆå…¶ä¸­nä¸ºGçš„é˜¶æ•°ï¼‰ã€‚</li><li>æ ¹æ®Açš„å…¬é’¥è®¡ç®—<script type="math/tex">(x_1,y_1)=rG</script>ã€‚</li><li>è®¡ç®—<script type="math/tex">(x_2,y_2)=kP</script>ã€‚å¦‚æœä¸ºOï¼Œåˆ™ä»ç¬¬äºŒæ­¥é‡æ–°å¼€å§‹ã€‚</li><li>è®¡ç®—<script type="math/tex">C=m+(x_2,y_2)</script>ã€‚</li><li>å°†<script type="math/tex">(x_1,y_1)å’ŒC</script>å‘é€ç»™A</li></ol><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><script type="math/tex; mode=display">m=C-(x_2,y_2)=C-kP=C-rkG=C-k(x_1,y_1)</script>]]></content>
    
    
    <summary type="html">&lt;p&gt;æŠ„ç‚¹ECCç¬”è®°&lt;/p&gt;</summary>
    
    
    
    <category term="Crypto" scheme="http://sh1k4ku.github.io/categories/Crypto/"/>
    
    
    <category term="ECC" scheme="http://sh1k4ku.github.io/tags/ECC/"/>
    
  </entry>
  
  <entry>
    <title>ç¥¥äº‘æ¯</title>
    <link href="http://sh1k4ku.github.io/2021/08/21/%E7%A5%A5%E4%BA%91%E6%9D%AF/"/>
    <id>http://sh1k4ku.github.io/2021/08/21/%E7%A5%A5%E4%BA%91%E6%9D%AF/</id>
    <published>2021-08-21T04:19:38.000Z</published>
    <updated>2021-08-30T08:18:37.891Z</updated>
    
    <content type="html"><![CDATA[<p>è¿˜è¦å†åŠ æ²¹ã€‚</p><span id="more"></span><h1 id="Guess"><a href="#Guess" class="headerlink" title="Guess"></a>Guess</h1><p>è¿™ä¸€é¢˜æ˜¯ä¸ªPaillieråŠ å¯†æ–¹æ¡ˆï¼ŒåŠ è§£å¯†å‡½æ•°éƒ½ç»™å‡ºäº†</p><script type="math/tex; mode=display">c=g^mr^n\;mod\;n^2</script><h2 id="åŒæ€"><a href="#åŒæ€" class="headerlink" title="åŒæ€"></a>åŒæ€</h2><p>PaillieråŠ å¯†å…·æœ‰<strong>åŒæ€</strong>çš„æ€§è´¨ï¼Œæ»¡è¶³:<script type="math/tex">D(c_1c_2)=m_1+m_2</script>ï¼Œproofï¼š</p><script type="math/tex; mode=display">c_1=g^{m_1}r1^n\;mod \;n\\c_2=g^{m_1}r2^n\;mod \;n\\âˆ´c_1c_2=g^{m_1m_2}(r_1r_2)^n\;mod\;n\\å³c=c_1c_2,m=m_1+m_2</script><p>æ‰€ä»¥<script type="math/tex">D(c^2)=2m</script></p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><ol><li>ç»™å‡ºå…¬é’¥nã€gï¼›</li><li>ä¼ å…¥ä¸€ä¸ªciphertextï¼Œç»™å‡ºç›¸åº”çš„plaintextï¼›</li><li><script type="math/tex">ä¼ å…¥m_1å’Œm_2ï¼Œå‡å¤§äº2ä¸”æ¯”ç‰¹ä½ç›¸åŒï¼Œéšæœºè¿”å›E(m_1m_2KEY_R) or E(m_1m_2KEY_{R+1})</script>ï¼›</li><li>å†ä¼ å…¥ä¸€ä¸ªciphertextï¼Œç»™å‡ºç›¸åº”çš„plaintextï¼›</li><li>çŒœæµ‹æ­¥éª¤3è¿”å›çš„æ˜¯å¯†æ–‡æ‰€å¯¹åº”çš„æ˜æ–‡æ˜¯å“ªä¸€ä¸ªï¼›</li><li>å¾ªç¯ä¸Šè¿°æ­¥éª¤32è½®ï¼›</li></ol><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><p>ä¼ å…¥<script type="math/tex">m_1å’Œm_2</script>åæ‹¿åˆ°çš„å¯†æ–‡è®°ä¸ºcã€‚åœ¨æ­¥éª¤5ä¸­ä¼ å…¥<script type="math/tex">c^2</script>ï¼Œåˆ™å¯è·å¾—åŠ å¯†æ˜æ–‡çš„ä¸¤å€ã€‚é‚£ä¹ˆç°åœ¨è¦è§£å†³çš„é—®é¢˜æ˜¯keyï¼Œè¿™ä¸ªåˆ©ç”¨LLLå’ŒBKZç®—æ³•èƒ½çˆ†å‡ºæ¥ã€‚</p><h1 id="myRSA"><a href="#myRSA" class="headerlink" title="myRSA"></a>myRSA</h1><p>åŠ å¯†çš„å…³é”®ä»£ç :</p><script type="math/tex; mode=display">x=p^2(p+3q-1)+q^2(q+3p-1)\\y=2pq+p+q\\z\\c=m^e\; mod\;n\\âˆ´xc+yc+z=[(p+q)^3-(p-q)^2+(p+q)]c+z\\âˆµ n=pq\\âˆ´ä¸Šå¼=[(p+q)^3-(p+q)^2+(p+q)+4n]c+z\\ä»¤p+q=a\\âˆ´cc=(a^3-a^2+a+4n)c+z</script><p>ç„¶åå°±æ‹¿åˆ°äº†ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ï¼Œå…¶ä¸­cçš„ç³»æ•°æ˜¯1500+ä½çš„ï¼Œzæ˜¯1040ä½æ•°ï¼Œcå¯ä»¥è‡ªå·±æ„é€ ï¼Œè¿™é‡Œä¸ºäº†è®©cå°½å¯èƒ½å¤§æ‰€ä»¥é€‰æ‹©m1=n-1ã€‚</p><p>ç°åœ¨è¦åšçš„æ˜¯åˆ†è§£nï¼Œæ‰€ä»¥ä¸¤è¾¹åŒé™¤cï¼Œé‚£ä¹ˆå³è¾¹å‰©ä¸‹1500ä½+16ä½ï¼Œæµ‹è¯•åå‘ç°<script type="math/tex">\sqrt{x+y}{3}=p+q-1</script>ï¼Œé‚£ä¹ˆå°±å¾—åˆ°äº†p+qçš„å€¼ï¼Œå†åˆ©ç”¨<script type="math/tex">p-q=\sqrt{(p+q)^2-4n}{2}</script>å°±å¯ä»¥åˆ†è§£pqäº†ã€‚</p><p>æœ€å<script type="math/tex">ccc=(x+y)flag^e+z</script>å› ä¸ºx+yçš„ä½æ•°å¤§äºzï¼Œæ‰€ä»¥ä¸¤è¾¹æ•´é™¤x+yå³å¯è·å¾—flagåŠ å¯†åçš„å€¼ï¼Œæœ€åè§£å‡ºflagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> gmtime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dehash</span>(<span class="params">s,re</span>):</span></span><br><span class="line">    alphabet = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(s,re)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> alphabet:</span><br><span class="line">                    ss=a+b+c+d+s</span><br><span class="line">                    <span class="keyword">if</span>  sha256(ss.encode()).hexdigest()==re:</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpq</span>(<span class="params">c,n</span>):</span></span><br><span class="line">    c1=gmpy2.iroot(c,<span class="number">3</span>)[<span class="number">0</span>]+<span class="number">1</span><span class="comment">#c1=p+q</span></span><br><span class="line">    c2=gmpy2.iroot(c1**<span class="number">2</span>-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> (c1+c2)//<span class="number">2</span>,(c1-c2)//<span class="number">2</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">    p=remote(<span class="string">&#x27;47.104.85.225&#x27;</span>,<span class="number">49877</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;SHA-256(?+&quot;</span>)</span><br><span class="line">    s=p.recvuntil(<span class="string">&quot;) == &quot;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    hashre=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">    p.sendline(dehash(s.decode(),hashre.decode()))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;n = &#x27;</span>)</span><br><span class="line">    n=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>])</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;e = &#x27;</span>)</span><br><span class="line">    e=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>])</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvline()</span><br><span class="line">    message=n-<span class="number">1</span></span><br><span class="line">    p.sendline(long_to_bytes(message))</span><br><span class="line">    p.recvline()</span><br><span class="line">    cc=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>].decode())</span><br><span class="line">    p0,q0=getpq(cc//message,n)</span><br><span class="line">    <span class="keyword">assert</span> p0*q0==n</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    ccc=p.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    ccc=<span class="built_in">int</span>(ccc)</span><br><span class="line">    </span><br><span class="line">    x=p0**<span class="number">2</span> * (p0 + <span class="number">3</span>*q0 - <span class="number">1</span> ) + q0**<span class="number">2</span> * (q0 + <span class="number">3</span>*p0 - <span class="number">1</span>) </span><br><span class="line">    y=<span class="number">2</span>*p0*q0 + p0 + q0</span><br><span class="line">    flag=ccc//(x+y)</span><br><span class="line">    phi=(p0-<span class="number">1</span>)*(q0-<span class="number">1</span>)</span><br><span class="line">    d=gmpy2.invert(e,phi)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(flag,d,n)))</span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Random-RSA"><a href="#Random-RSA" class="headerlink" title="Random_RSA"></a>Random_RSA</h1><p>é¢˜ç›®åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œå‰åŠéƒ¨åˆ†æ˜¯RSAçš„dpã€cã€næ¨¡å¼ï¼ŒååŠéƒ¨åˆ†æ˜¯ç”Ÿæˆç§å­åç”Ÿæˆä¼ªéšæœºæ•°ï¼Œå†é€šè¿‡Feistalç½‘ç»œåŠ å¯†dpã€‚</p><p>è¿™ä¸€é¢˜è¦ä½¿ç”¨py2æ¥è§£ä¼ªéšæœºæ•°ï¼Œè·å–dpååœ¨(1,e)çˆ†ç ´iæ»¡è¶³<script type="math/tex">(dpâ‹…eâˆ’1)%i==0(dpâ‹…eâˆ’1)%i==0å’Œn%((dpâ‹…eâˆ’1)//i+1)==0æ—¶n%((dpâ‹…eâˆ’1)//i+1)==0æ—¶</script>ï¼ŒNæˆåŠŸåˆ†è§£ï¼Œè¯æ˜åœ¨å¤§ä½¬çš„åšå®¢é‡Œæœ‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> pwnlib <span class="keyword">import</span> encoders</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">e, dp, n</span>):</span></span><br><span class="line">    _ = dp * e - <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _ % i:</span><br><span class="line">            p = _ // i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> n % p:</span><br><span class="line">                q = n // p</span><br><span class="line">                phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">                d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">                <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">n=<span class="number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span></span><br><span class="line">ct=<span class="number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">seeds=[<span class="number">4827</span>, <span class="number">9522</span>, <span class="number">552</span>, <span class="number">880</span>, <span class="number">7467</span>, <span class="number">7742</span>, <span class="number">9425</span>, <span class="number">4803</span>, <span class="number">6146</span>, <span class="number">4366</span>, <span class="number">1126</span>, <span class="number">4707</span>, <span class="number">1138</span>, <span class="number">2367</span>, <span class="number">1081</span>, <span class="number">5577</span>, <span class="number">4592</span>, <span class="number">5897</span>, <span class="number">4565</span>, <span class="number">2012</span>, <span class="number">2700</span>, <span class="number">1331</span>, <span class="number">9638</span>, <span class="number">7741</span>, <span class="number">50</span>, <span class="number">824</span>, <span class="number">8321</span>, <span class="number">7411</span>, <span class="number">6145</span>, <span class="number">1271</span>, <span class="number">7637</span>, <span class="number">5481</span>, <span class="number">8474</span>, <span class="number">2085</span>, <span class="number">2421</span>, <span class="number">590</span>, <span class="number">7733</span>, <span class="number">9427</span>, <span class="number">3278</span>, <span class="number">5361</span>, <span class="number">1284</span>, <span class="number">2280</span>, <span class="number">7001</span>, <span class="number">8573</span>, <span class="number">5494</span>, <span class="number">7431</span>, <span class="number">2765</span>, <span class="number">827</span>, <span class="number">102</span>, <span class="number">1419</span>, <span class="number">6528</span>, <span class="number">735</span>, <span class="number">5653</span>, <span class="number">109</span>, <span class="number">4158</span>, <span class="number">5877</span>, <span class="number">5975</span>, <span class="number">1527</span>, <span class="number">3027</span>, <span class="number">9776</span>, <span class="number">5263</span>, <span class="number">5211</span>, <span class="number">1293</span>, <span class="number">5976</span>, <span class="number">7759</span>, <span class="number">3268</span>, <span class="number">1893</span>, <span class="number">6546</span>, <span class="number">4684</span>, <span class="number">419</span>, <span class="number">8334</span>, <span class="number">7621</span>, <span class="number">1649</span>, <span class="number">6840</span>, <span class="number">2975</span>, <span class="number">8605</span>, <span class="number">5714</span>, <span class="number">2709</span>, <span class="number">1109</span>, <span class="number">358</span>, <span class="number">2858</span>, <span class="number">6868</span>, <span class="number">2442</span>, <span class="number">8431</span>, <span class="number">8316</span>, <span class="number">5446</span>, <span class="number">9356</span>, <span class="number">2817</span>, <span class="number">2941</span>, <span class="number">3177</span>, <span class="number">7388</span>, <span class="number">4149</span>, <span class="number">4634</span>, <span class="number">4316</span>, <span class="number">5377</span>, <span class="number">4327</span>, <span class="number">1774</span>, <span class="number">6613</span>, <span class="number">5728</span>, <span class="number">1751</span>, <span class="number">8478</span>, <span class="number">3132</span>, <span class="number">4680</span>, <span class="number">3308</span>, <span class="number">9769</span>, <span class="number">8341</span>, <span class="number">1627</span>, <span class="number">3501</span>, <span class="number">1046</span>, <span class="number">2609</span>, <span class="number">7190</span>, <span class="number">5706</span>, <span class="number">3627</span>, <span class="number">8867</span>, <span class="number">2458</span>, <span class="number">607</span>, <span class="number">642</span>, <span class="number">5436</span>, <span class="number">6355</span>, <span class="number">6326</span>, <span class="number">1481</span>, <span class="number">9887</span>, <span class="number">205</span>, <span class="number">5511</span>, <span class="number">537</span>, <span class="number">8576</span>, <span class="number">6376</span>, <span class="number">3619</span>, <span class="number">6609</span>, <span class="number">8473</span>, <span class="number">2139</span>, <span class="number">3889</span>, <span class="number">1309</span>, <span class="number">9878</span>, <span class="number">2182</span>, <span class="number">8572</span>, <span class="number">9275</span>, <span class="number">5235</span>, <span class="number">6989</span>, <span class="number">6592</span>, <span class="number">4618</span>, <span class="number">7883</span>, <span class="number">5702</span>, <span class="number">3999</span>, <span class="number">925</span>, <span class="number">2419</span>, <span class="number">7838</span>, <span class="number">3073</span>, <span class="number">488</span>, <span class="number">21</span>, <span class="number">3280</span>, <span class="number">9915</span>, <span class="number">3672</span>, <span class="number">579</span>]</span><br><span class="line"></span><br><span class="line">res=[<span class="number">55</span>,<span class="number">5</span>,<span class="number">183</span>,<span class="number">192</span>,<span class="number">103</span>, <span class="number">32</span>, <span class="number">211</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">118</span>, <span class="number">54</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">185</span>, <span class="number">254</span>, <span class="number">77</span>, <span class="number">144</span>, <span class="number">70</span>, <span class="number">54</span>, <span class="number">193</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">244</span>, <span class="number">190</span>, <span class="number">23</span>, <span class="number">215</span>, <span class="number">187</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">27</span>, <span class="number">138</span>, <span class="number">42</span>, <span class="number">89</span>, <span class="number">158</span>, <span class="number">254</span>, <span class="number">159</span>, <span class="number">133</span>, <span class="number">78</span>, <span class="number">11</span>, <span class="number">155</span>, <span class="number">163</span>, <span class="number">145</span>, <span class="number">248</span>, <span class="number">14</span>, <span class="number">179</span>, <span class="number">23</span>, <span class="number">226</span>, <span class="number">220</span>, <span class="number">201</span>, <span class="number">5</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">195</span>, <span class="number">75</span>, <span class="number">191</span>, <span class="number">237</span>, <span class="number">108</span>, <span class="number">141</span>, <span class="number">141</span>, <span class="number">185</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">191</span>, <span class="number">48</span>, <span class="number">135</span>, <span class="number">139</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">242</span>, <span class="number">21</span>, <span class="number">143</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">146</span>, <span class="number">119</span>, <span class="number">173</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">173</span>, <span class="number">2</span>, <span class="number">224</span>, <span class="number">205</span>, <span class="number">68</span>, <span class="number">10</span>, <span class="number">77</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">196</span>, <span class="number">205</span>, <span class="number">108</span>, <span class="number">28</span>, <span class="number">243</span>, <span class="number">80</span>, <span class="number">140</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">76</span>, <span class="number">217</span>, <span class="number">70</span>, <span class="number">208</span>, <span class="number">202</span>, <span class="number">78</span>, <span class="number">177</span>, <span class="number">124</span>, <span class="number">10</span>, <span class="number">168</span>, <span class="number">165</span>, <span class="number">223</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">152</span>, <span class="number">48</span>, <span class="number">152</span>, <span class="number">51</span>, <span class="number">133</span>, <span class="number">190</span>, <span class="number">202</span>, <span class="number">136</span>, <span class="number">204</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">71</span>, <span class="number">150</span>, <span class="number">68</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">218</span>, <span class="number">173</span>, <span class="number">19</span>, <span class="number">201</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">85</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">186</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">147</span>, <span class="number">219</span>, <span class="number">22</span>, <span class="number">81</span>]</span><br><span class="line">dp=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#rands=[[2, 58, 53, 122], [145, 54, 124, 244], [5, 19, 128, 192], [255, 23, 64, 242], [87, 57, 113, 194], [246, 16, 205, 162], [112, 87, 228, 95], [215, 147, 105, 64], [84, 16, 131, 38], [234, 78, 36, 46], [68, 61, 71, 146], [148, 61, 9, 0], [73, 139, 77, 32], [96, 160, 56, 160], [121, 76, 128, 17], [114, 246, 92, 200], [124, 178, 206, 60], [168, 165, 147, 26], [168, 41, 114, 68], [24, 93, 84, 2], [241, 175, 43, 88], [147, 124, 97, 153], [42, 94, 118, 45], [150, 103, 127, 52], [127, 68, 163, 62], [165, 193, 37, 89], [219, 248, 142, 59], [241, 182, 8, 35], [230, 140, 211, 146], [88, 138, 226, 2], [48, 150, 5, 56], [87, 109, 255, 135], [40, 227, 216, 65], [23, 188, 190, 10], [5, 25, 28, 64], [6, 12, 124, 108], [167, 53, 113, 124], [255, 207, 192, 158], [61, 239, 166, 5], [62, 108, 86, 181], [127, 123, 44, 64], [195, 51, 192, 30], [30, 82, 168, 95], [56, 178, 165, 146], [168, 68, 77, 239], [106, 204, 247, 226], [17, 46, 62, 114], [91, 71, 156, 134], [37, 157, 43, 182], [146, 219, 6, 42], [148, 143, 234, 161], [108, 33, 139, 255], [50, 139, 169, 157], [71, 117, 140, 25], [28, 153, 194, 26], [241, 221, 235, 243], [124, 28, 131, 141], [159, 137, 111, 184], [47, 206, 221, 11], [220, 152, 157, 88], [188, 41, 213, 97], [4, 191, 220, 10], [77, 13, 143, 248], [94, 140, 110, 122], [49, 25, 250, 226], [218, 64, 102, 109], [189, 238, 143, 66], [91, 18, 131, 8], [190, 23, 239, 190], [159, 184, 33, 72], [183, 78, 85, 208], [209, 213, 101, 102], [236, 111, 50, 220], [166, 196, 104, 233], [170, 144, 34, 10], [187, 87, 175, 183], [207, 195, 59, 104], [165, 157, 179, 179], [99, 247, 160, 153], [195, 61, 100, 79], [153, 223, 159, 165], [230, 202, 93, 184], [87, 28, 184, 35], [35, 122, 38, 244], [157, 158, 188, 163], [229, 48, 192, 222], [12, 12, 211, 192], [207, 95, 224, 255], [113, 127, 113, 137], [22, 58, 114, 143], [13, 45, 117, 144], [70, 140, 211, 131], [33, 57, 101, 42], [132, 36, 62, 129], [40, 128, 246, 124], [1, 132, 161, 250], [85, 164, 33, 133], [252, 41, 201, 32], [8, 18, 203, 247], [1, 88, 55, 101], [189, 201, 135, 186], [101, 50, 254, 125], [236, 196, 81, 39], [148, 24, 103, 127], [233, 101, 29, 253], [97, 114, 156, 64], [90, 103, 233, 91], [50, 48, 80, 251], [118, 206, 22, 93], [11, 137, 114, 174], [61, 132, 76, 247], [215, 32, 232, 61], [158, 95, 128, 90], [57, 144, 35, 228], [163, 143, 233, 107], [178, 250, 28, 80], [169, 64, 107, 225], [106, 174, 115, 207], [85, 134, 1, 21], [118, 201, 76, 172], [4, 234, 34, 22], [241, 176, 236, 122], [111, 185, 137, 127], [1, 26, 164, 255], [186, 254, 57, 117], [243, 244, 27, 32], [161, 88, 28, 80], [50, 165, 93, 17], [12, 87, 182, 216], [184, 55, 159, 63], [167, 166, 246, 123], [37, 78, 33, 235], [127, 186, 81, 58], [48, 167, 3, 239], [70, 186, 114, 13], [56, 108, 178, 154], [151, 54, 55, 235], [105, 235, 180, 105], [16, 194, 155, 98], [136, 11, 41, 39], [252, 18, 203, 79], [185, 83, 114, 170], [148, 181, 87, 223], [118, 57, 160, 97], [255, 23, 250, 181], [235, 47, 219, 228], [106, 253, 14, 44], [44, 151, 38, 143], [28, 185, 224, 134], [42, 176, 162, 122], [3, 9, 164, 158], [129, 245, 2, 235], [35, 66, 241, 92], [80, 102, 124, 36]]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">    random.seed(seeds[i])</span><br><span class="line">    rand=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        rand.append(random.randint)</span><br><span class="line">    dp+=<span class="built_in">chr</span>(res[i]^rand[i%<span class="number">4</span>]).encode()</span><br><span class="line">dp=<span class="built_in">int</span>(dp)</span><br><span class="line">d=decrypt(e,dp,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(ct,d,n)))</span><br></pre></td></tr></table></figure><h1 id="share-secret"><a href="#share-secret" class="headerlink" title="share secret"></a>share secret</h1><p>â€¦</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;è¿˜è¦å†åŠ æ²¹ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="RSA" scheme="http://sh1k4ku.github.io/tags/RSA/"/>
    
    <category term="random" scheme="http://sh1k4ku.github.io/tags/random/"/>
    
    <category term="paillier" scheme="http://sh1k4ku.github.io/tags/paillier/"/>
    
  </entry>
  
  <entry>
    <title>åƒç“œæ¯</title>
    <link href="http://sh1k4ku.github.io/2021/08/19/%E5%90%83%E7%93%9C%E6%9D%AF/"/>
    <id>http://sh1k4ku.github.io/2021/08/19/%E5%90%83%E7%93%9C%E6%9D%AF/</id>
    <published>2021-08-19T12:46:11.000Z</published>
    <updated>2021-08-28T04:06:32.885Z</updated>
    
    <content type="html"><![CDATA[<p>åšäº†ä¸‹é—ªç”µäº”è¿é­ï¼Œé¢˜å‡ºçš„å¾ˆæœ‰æ„æ€ï¼Œæ˜¥å“¥ä»å›½å¤–æ¯”èµ›æ‰’çš„é¢˜ï¼ˆ<a href="https://github.com/BCACTF/bcactf-2.0">BCACTF</a>ï¼‰,éš¾åº¦ä¸å¤§ï¼Œç»“åˆäº†RSAå’Œç›¸ä¼¼çŸ©é˜µ</p><span id="more"></span><h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><blockquote><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">æœ‹å‹ä»¬å¥½ã€‚</span><br><span class="line"></span><br><span class="line">ä»Šå¤©ï¼Œå’Œå¤§å®¶ï¼Œæ¢è®¨ä¸€ä¸‹ï¼Œæ€æ ·æ‰“RSAç½®æ¢é—ªç”µé­ã€‚</span><br><span class="line"></span><br><span class="line">è¦åšåˆ°ä¸‰ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">ä¸€ï¼šè¦åšåˆ°é—®é¢˜çœŸæ­£çš„æ”¾æ¾ã€‚ä½†æ˜¯çº¿æ€§ä»£æ•°åŸºæœ¬çŸ¥è¯†è¦ç”¨å¥½ã€‚è¿™é‡Œé¢ï¼Œè¯¥æ¾çš„æ¾ï¼Œè¯¥ç´§çš„ç´§ã€‚æ¾ä¸­æœ‰ç´§ï¼Œç´§ä¸­æœ‰æ¾ã€‚è¿™ä¸ªé—®é¢˜éå¸¸å¤æ‚ï¼Œåœ¨è¿™é‡Œä¸å¤šè¯´ã€‚åœ¨é—®é¢˜çš„æè¿°ä¸­æœ‰è¯¦ç»†çš„è§£é‡Šï¼›</span><br><span class="line"></span><br><span class="line">äºŒï¼šè¦ç»ƒå¥½å†…åŠŸï¼Œä½ æ‰èƒ½ä»£ç ä¸­å‘åŠ›ï¼Œæ‰“å‡ºRSAç½®æ¢åŠ²å„¿ã€‚æ…¢ç»ƒï¼Œè¿™æ˜¯ç­¾åˆ°çš„â€¦â€¦å¿«ç»ƒï¼ä¸‹åˆä¸Šå¼€ï¼Œä¸Šåˆä¸‹å¼€ï¼æ‰€ä»¥ï¼Œè¿™ä¸ªRSAç½®æ¢åŠ²å„¿å•Šâ€¦â€¦è¿™ä¸ªRSAå’Œç½®æ¢éƒ½åœ¨åŠ¨å•Šâ€¦â€¦</span><br><span class="line"></span><br><span class="line">ä¸‰ï¼šè¦ç”¨é«˜ç»´çš„RSAç½®æ¢åŠ²å„¿ï¼Œæ‰èƒ½æ‰“å‡ºRSAç½®æ¢é—ªç”µé­ã€‚å› ä¸ºè¿™ä¸ªé­çš„åŠ²å„¿ï¼Œä½ çœ‹â€¦â€¦æ˜¯ä¸æ˜¯ï¼Œä½ çœ‹â€¦â€¦éƒ½æ˜¯é«˜ç»´çš„å•Šâ€¦â€¦</span><br><span class="line"></span><br><span class="line">ä¸‹é¢æˆ‘æ‰“ä¸€ä¸ªè¿äº”é­å•Šâ€¦â€¦æ‰“äº†äº”é­ï¼šä¸€é­ï¼Œä¸¤é­ï¼Œä¸‰é­ï¼Œå››é­ï¼Œäº”é­ã€‚è¿™äº”é­è¦è¿æ¬¡æ‰“ï¼Œä½ çœ‹ï¼šå®æˆ˜æ—¶é—´ï¼Œä¸€å®šè¦åŠ¨æ­¦ï¼Œå…¨èº«æ¾å¥½ï¼Œç”¨é«˜ç»´çš„åŠ²ï¼ŒRSAç½®æ¢åŠ²å„¿ï¼æ‰èƒ½æ‰“å‡º<span class="built_in">flag</span>ï¼Œæ‰“å‡ºRSAç½®æ¢é—ªç”µé­ï¼</span><br><span class="line"></span><br><span class="line">è°¢è°¢æœ‹å‹ä»¬ã€‚</span><br></pre></td></tr></table></figure></blockquote><h1 id="1bian"><a href="#1bian" class="headerlink" title="1bian"></a>1bian</h1><h2 id="é¢˜"><a href="#é¢˜" class="headerlink" title="é¢˜"></a>é¢˜</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n = 8870619487339789349033932217513908953609539651949986489986889710933094577873155191810742828503059670650154455297603719</span><br><span class="line">e = 3</span><br><span class="line"></span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    m = bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line">assert n &gt; m</span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(&#x27;(1,6)(2,3,5)(4,7)&#x27;)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line"></span><br><span class="line">def encrypt(m):</span><br><span class="line">    C = (m * P) ^ e</span><br><span class="line">    return C.list()</span><br><span class="line"></span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">[0, 0, 0, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 0, 0, 0, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231, 0, 0, 0]</script><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>é¢˜ç›®ç”Ÿæˆäº†ä¸€ä¸ªç½®æ¢ç¾¤å’Œå¯¹åº”çš„çŸ©é˜µPï¼ŒåŠ å¯†ç®—æ³•ä¸º</p><script type="math/tex; mode=display">C=(mP)^e=m^eP^e\\P^3åŒæ ·æ˜¯ä¸ªç½®æ¢çŸ©é˜µï¼Œå¹¶ä¸”å…ƒç´ å…¨ä¸º1ã€‚æ‰€ä»¥Cä¸­çš„å…ƒç´ å³ä¸ºc=m^3</script><p>åˆç”±äºnæ˜“åˆ†è§£ï¼Œæ‰€ä»¥å°±å°±åŒ–ä¸ºäº†æœ€ç®€å•çš„RSA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c=<span class="number">6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231</span></span><br><span class="line">n = <span class="number">8870619487339789349033932217513908953609539651949986489986889710933094577873155191810742828503059670650154455297603719</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">a=[<span class="number">35200554341</span> , <span class="number">35592761021</span> , <span class="number">48105446183</span> , <span class="number">48479007809</span> , <span class="number">50240938337</span> , <span class="number">50769514811</span> , <span class="number">62183036099</span> , <span class="number">63345654131</span> , <span class="number">66104249843</span> , <span class="number">67515121673</span> , <span class="number">67704082961</span>]</span><br><span class="line">p=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">   p*=i-<span class="number">1</span></span><br><span class="line">d=gmpy2.invert(e,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"><span class="comment">#ctfshow&#123;W4r_Dull_Eeeee_LLL3333_A_n0_F14sH_@w@&#125;</span></span><br></pre></td></tr></table></figure><h1 id="2bian"><a href="#2bian" class="headerlink" title="2bian"></a>2bian</h1><h2 id="é¢˜-1"><a href="#é¢˜-1" class="headerlink" title="é¢˜"></a>é¢˜</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">3950848271664122675439855009329233027357977239695163232943132810210035583520735079984423511153607529820284200137188647</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    m = bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> n &gt; m</span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,14,25,8,23,15)(2,22,17)(3,18,13,33,11,30,26,27,10,6,16,31,28,21,29,36,7,9)(4,35,12,32,20,5,24)(19,34)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m</span>):</span></span><br><span class="line">    C = (m * B) ^ e</span><br><span class="line">    <span class="keyword">return</span> C.<span class="built_in">list</span>()</span><br></pre></td></tr></table></figure><script type="math/tex; mode=display">Aæ˜¯ä¸€ä¸ªéšæœºçŸ©é˜µï¼Œä½†éšæœºæ•°ç§å­æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥Aæ˜¯ç¡®å®šçš„\\æ‰€ä»¥B=APA^{-1}ä¹Ÿæ˜¯ç¡®å®šçš„\\åŠ å¯†ç®—æ³•C=(mB)^e=m^eB^e\\é‚£ä¹ˆCB^{-3}çš„å…ƒç´ å³ä¸ºm^3\\ç„¶åå°±åŒ–åˆ°äº†ç¬¬ä¸€é—®ä¸Š</script><h2 id="è§£-1"><a href="#è§£-1" class="headerlink" title="è§£"></a>è§£</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">import</span> random</span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">random</span>.seed(<span class="number">0</span>x<span class="number">36</span>D)</span><br><span class="line"></span><br><span class="line"><span class="attribute">n</span> = <span class="number">3950848271664122675439855009329233027357977239695163232943132810210035583520735079984423511153607529820284200137188647</span></span><br><span class="line"><span class="attribute">e</span>=<span class="number">3</span></span><br><span class="line"><span class="attribute">Zn</span> = Zmod(n)</span><br><span class="line"><span class="attribute">P</span> = PermutationGroupElement(&#x27;(<span class="number">1</span>,<span class="number">14</span>,<span class="number">25</span>,<span class="number">8</span>,<span class="number">23</span>,<span class="number">15</span>)(<span class="number">2</span>,<span class="number">22</span>,<span class="number">17</span>)(<span class="number">3</span>,<span class="number">18</span>,<span class="number">13</span>,<span class="number">33</span>,<span class="number">11</span>,<span class="number">30</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">16</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">36</span>,<span class="number">7</span>,<span class="number">9</span>)(<span class="number">4</span>,<span class="number">35</span>,<span class="number">12</span>,<span class="number">32</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">24</span>)(<span class="number">19</span>,<span class="number">34</span>)&#x27;)</span><br><span class="line"><span class="attribute">P</span> = Matrix(Zn, P.matrix())</span><br><span class="line"><span class="attribute">A</span> = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, lambda x, y: random.randint(<span class="number">0</span>, <span class="number">0</span>x<span class="number">36</span>D))</span><br><span class="line"><span class="attribute">B</span> = A * P * A^-<span class="number">1</span></span><br><span class="line"><span class="attribute">C</span>#Cå¤ªå¤ªå¤ªå¤§äº†ï¼Œä¸ä¸¢äº†</span><br><span class="line"><span class="attribute">c</span>=<span class="number">788338113035295195878123865420815134674503086857319693837443675089195439938279689750424184012172121716196117254817680</span></span><br><span class="line"><span class="attribute">phi</span>=euler_phi(n)</span><br><span class="line"></span><br><span class="line"><span class="attribute">d</span>=inverse_mod(e,phi)</span><br><span class="line"><span class="attribute">print</span>((C*B^-<span class="number">3</span>).trace())</span><br><span class="line"><span class="attribute">print</span>(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure><h1 id="3bian"><a href="#3bian" class="headerlink" title="3bian"></a>3bian</h1><p>ä¹‹åéƒ½å˜æˆäº†ncé¢˜ï¼Œå¹¶ä¸”èƒ½ç»™æˆ‘æ¡ä»¶æ˜¯çŸ©é˜µçš„è¿¹</p><h2 id="é¢˜-2"><a href="#é¢˜-2" class="headerlink" title="é¢˜"></a>é¢˜</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    m = bytes_to_long(f.read())</span><br><span class="line"><span class="keyword">assert</span> n &gt; m</span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,3,6,29,25,34,22,33,10,16,7)(2,21,19,17,31,9,5,30,27,35,32,11)(4,20,28,23,18,15)(8,26,14,12)(36,24,13)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m</span>):</span></span><br><span class="line">    C = (m * B) ^ e</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">matrix_map = &#123;<span class="string">&quot;I&quot;</span>: Matrix(Zn, matrix.identity(<span class="number">36</span>)), <span class="string">&quot;B&quot;</span>: B, <span class="string">&quot;C&quot;</span>: encrypt(m)&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_add</span>(<span class="params">matrix_map</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬ä¸€ä¸ªçŸ©é˜µï¼š&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬äºŒä¸ªçŸ©é˜µï¼š&quot;</span>)</span><br><span class="line">    B = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    C = matrix_map[A]+matrix_map[B]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;è¿™ä¸¤ä¸ªçŸ©é˜µä¹‹å’Œçš„è¿¹æ˜¯ï¼š<span class="subst">&#123;C.trace()&#125;</span>ï¼Œè¿¹ä½ å®åœ¨æ˜¯å¤ªç¾~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_product</span>(<span class="params">matrix_map</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬ä¸€ä¸ªçŸ©é˜µï¼š&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬äºŒä¸ªçŸ©é˜µï¼š&quot;</span>)</span><br><span class="line">    B = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    C = matrix_map[A]*matrix_map[B]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;è¿™ä¸¤ä¸ªçŸ©é˜µä¹‹ç§¯çš„è¿¹æ˜¯ï¼š<span class="subst">&#123;C.trace()&#125;</span>ï¼Œè¿¹ä½ å®åœ¨æ˜¯å¤ªç¾~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_kproduct</span>(<span class="params">matrix_map</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;çŸ©é˜µï¼š&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ä¹˜æ•°ï¼š&quot;</span>)</span><br><span class="line">    k = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    k = <span class="built_in">int</span>(k)</span><br><span class="line">    B = k * matrix_map[A]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ•°ä¹˜ç»“æœçš„è¿¹æ˜¯ï¼š<span class="subst">&#123;B.trace()&#125;</span>ï¼Œè¿¹ä½ å®åœ¨æ˜¯å¤ªç¾~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_power</span>(<span class="params">matrix_map</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;çŸ©é˜µï¼š&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¹‚æ¬¡ï¼š&quot;</span>)</span><br><span class="line">    k = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    k = <span class="built_in">int</span>(k)</span><br><span class="line">    B = matrix_map[A] ^ k</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ±‚å¹‚ç»“æœçš„è¿¹æ˜¯ï¼š<span class="subst">&#123;B.trace()&#125;</span>ï¼Œè¿¹ä½ å®åœ¨æ˜¯å¤ªç¾~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">server_save</span>(<span class="params">A, matrix_map</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å­˜ä¸ªå°æ¡£ï¼Ÿ (Y/N)&quot;</span>)</span><br><span class="line">    s = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip().upper()</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">&quot;Y&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¿ç®—ç»“æœå«å•¥åå‘¢ï¼Ÿ&quot;</span>)</span><br><span class="line">        S = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">        matrix_map[S] = A</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å­˜ä¸Šæ¡£å’¯ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ¬¢è¿æ¥æ‰“ç¬¬ä¸‰é­ï¼</span></span><br><span class="line"><span class="string">åœ¨è¿™ä¸€é­ä¸­ï¼Œä½ å¯ä»¥å°è¯•æ‰“å‡ºä¸¤ä¸ªçŸ©é˜µçš„å’Œï¼Œç§¯ã€‚</span></span><br><span class="line"><span class="string">æˆ–è€…ä¸€ä¸ªçŸ©é˜µçš„æ•°ä¹˜ï¼Œå¹‚æ¬¡ã€‚</span></span><br><span class="line"><span class="string">ä½†æ˜¯ç”±äºav50183113ï¼Œæ‰€ä»¥æˆ‘åªä¼šå‘Šè¯‰ä½ è¿ç®—ç»“æœçš„è¿¹ï¼Œå› ä¸ºè¿¹ä½ å¤ªç¾ã€‚</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">MENU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">è¯·å¼€å§‹ä½ çš„è¡¨æ¼”ï¼š</span></span><br><span class="line"><span class="string">[S] æ‰“å°çŸ©é˜µ</span></span><br><span class="line"><span class="string">[+] ä¸¤çŸ©é˜µç›¸åŠ </span></span><br><span class="line"><span class="string">[*] ä¸¤çŸ©é˜µç›¸ä¹˜</span></span><br><span class="line"><span class="string">[K] ä¸€çŸ©é˜µæ•°ä¹˜</span></span><br><span class="line"><span class="string">[^] ä¸€çŸ©é˜µæ±‚å¹‚</span></span><br><span class="line"><span class="string">[Q] 886</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(MENU)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        opt = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip().upper()</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="string">&quot;S&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;è¿¹ä½ å¤ªç¾â€¦â€¦babyâ€¦â€¦è¿¹ä½ å®åœ¨æ˜¯å¤ªç¾â€¦â€¦&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> k, v <span class="keyword">in</span> matrix_map.items():</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;k&#125;</span>: <span class="subst">&#123;v.trace()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;+&quot;</span>):</span><br><span class="line">            M = server_add(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;*&quot;</span>):</span><br><span class="line">            M = server_product(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;K&quot;</span>):</span><br><span class="line">            M = server_kproduct(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;^&quot;</span>):</span><br><span class="line">            M = server_power(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;Q&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å†è§ï¼&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æåœ¨â€¦â€¦èµ£ç¥é­”ï¼Ÿ&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¿™æ³¢å’Œé—ªç”µé­é…åˆå¾—ä¸æ˜¯å¾ˆå¥½â€¦â€¦&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç«¯å£é‚£è¾¹åˆå§‹å‚¨å­˜äº†ä¸‰ä¸ªçŸ©é˜µï¼ŒBã€Cå’ŒIï¼ŒIå³å•ä½çŸ©é˜µï¼Œèƒ½å¤Ÿè¿›è¡ŒçŸ©é˜µç›¸åŠ ã€ç›¸ä¹˜ã€æ•°ä¹˜ã€æ±‚å¹‚ã€å±•ç¤ºçš„æ“ä½œå¹¶ä¸”ç»™å‡ºçš„æ˜¯ç»“æœçŸ©é˜µçš„è¿¹ï¼Œä¹Ÿå°±æ˜¯å¯¹è§’çº¿ä¸Šå…ƒç´ çš„å’Œ</p><h2 id="æˆ‘çš„è§£"><a href="#æˆ‘çš„è§£" class="headerlink" title="æˆ‘çš„è§£"></a>æˆ‘çš„è§£</h2><p>ç”±ç¬¬äºŒé—®å¯ä»¥çŸ¥é“ï¼Œå¾—åˆ°çš„<script type="math/tex">C*B^{-3}</script>çš„æ˜¯ä¸€ä¸ªå¯¹è§’é˜µï¼Œè€Œä¸”å¯¹è§’çº¿ä¸Šçš„å…ƒç´ å…¨ä¸º<script type="math/tex">m^3</script>ï¼Œå·²çŸ¥çŸ©é˜µæ˜¯36x36çš„å¤§å°ï¼Œæ‰€ä»¥è¿¹=36*cï¼Œç„¶åå°±å¯ä»¥è§£å‡ºmäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,3,6,29,25,34,22,33,10,16,7)(2,21,19,17,31,9,5,30,27,35,32,11)(4,20,28,23,18,15)(8,26,14,12)(36,24,13)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>((P^<span class="number">12</span>).trace())</span><br><span class="line">D=B^<span class="number">3</span></span><br><span class="line"></span><br><span class="line">c=(<span class="number">9857562962643282087288501924102632185114609865442470151120627871503036282427052725871725631485463201834546369527295236</span>*inverse_mod(<span class="number">36</span>,n))%n</span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><h2 id="å‡ºé¢˜äººçš„wp"><a href="#å‡ºé¢˜äººçš„wp" class="headerlink" title="å‡ºé¢˜äººçš„wp"></a>å‡ºé¢˜äººçš„wp</h2><p><img src="/images/%E5%90%83%E7%93%9C%E6%9D%AF/3bian1.png" alt="å‡ºé¢˜äººæƒ³æ³•"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># Put the trace of the cipher here</span></span><br><span class="line">tr = <span class="number">14813573939127972566346276778703360636838383920024039547829404416974023159738670520401495234532257783312488372282988720</span></span><br><span class="line"><span class="comment"># 3 * m^3</span></span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">fac = factor(n)</span><br><span class="line">cs = []</span><br><span class="line">ns = []</span><br><span class="line"><span class="keyword">for</span> p, alpha <span class="keyword">in</span> fac:Â  Â  </span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(p))Â  Â </span><br><span class="line">    f = <span class="number">3</span> * x^<span class="number">3</span> - trÂ  Â  </span><br><span class="line">    cs.append(<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>]))Â  Â  </span><br><span class="line">    ns.append(p)</span><br><span class="line">m = crt(cs, ns)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>ç”¨CRTçš„æ€æƒ³å°±æ˜¯å°†ä¸€ä¸ªå¤§é—®é¢˜æ‹†åˆ†æˆå‡ ä¸ªå°é—®é¢˜ï¼Œç„¶åæ±‚è§£å‡ºæ›´æ˜“æ±‚å¾—çš„å°é—®é¢˜ï¼Œå†ç”¨CRTç®—æ³•æ±‚å‡ºåŸé—®é¢˜çš„è§£ï¼Œå­¦åˆ°äº†</p><h1 id="4bian"><a href="#4bian" class="headerlink" title="4bian"></a>4bian</h1><p>è¿™ä¸€é¢˜e=17ï¼Œæ¯æ¬¡ncånéšæœºç»™å‡ºï¼Œnè¿˜æ˜¯æ»¡è¶³æ˜“åˆ†è§£çš„ç‰¹ç‚¹ï¼›</p><p>è¿™æ¬¡æ²¡æœ‰ç»™å‡ºçŸ©é˜µBçš„ç”Ÿæˆæ–¹å¼ï¼Œä½†æ˜¯é€šå…³trace(I)=88å¯ä»¥åˆ¤æ–­å‡ºçŸ©é˜µçš„é˜¶æ•°æ˜¯88ï¼›</p><p>ä½†æ˜¯å¾—åˆ°çš„trace(B)=trace(C)=0ï¼Œæµ‹è¯•åå‘ç°<script type="math/tex">trace(CB^{-17})!=0</script>ï¼Œæ‰€ä»¥å°±è½¬æ¢åˆ°3bianä¸Šäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">3517510500012578106622165513758529071479627734667631280414059054641298876493975288768988113516424615888881460323558373</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">c=(<span class="number">1085260800784001954133584897165283180613148497110186223344717673152088774523221770328958058661702434339964578373746248</span>*inverse_mod(<span class="number">88</span>,n))%n</span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><h2 id="å‡ºé¢˜äººçš„WP"><a href="#å‡ºé¢˜äººçš„WP" class="headerlink" title="å‡ºé¢˜äººçš„WP"></a>å‡ºé¢˜äººçš„WP</h2><p><img src="/images/%E5%90%83%E7%93%9C%E6%9D%AF/4bian-16301230564112.png" alt="4bian"></p><p>æ€è·¯æ˜¯è¯•å‡ºä½¿å¾—Cçš„è¿¹ä¸ä¸º0çš„å¹‚æ¬¡ï¼Œç„¶åä½¿ç”¨ç›¸å…³æ˜æ–‡æ”»å‡»è¿›è¡Œå¤šé¡¹å¼è¾—è½¬ç›¸é™¤ï¼Œæ„é€ æ‹¿åˆ°å¯†æ–‡cã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">3525391383893454949178974275545607641708362073574956727334904966529494223283130893750994940957609615705033001171886177</span></span><br><span class="line">tr1 = <span class="number">3049270810698445654099605477449981251458767119860329568250296940497378143674701051415025737368773161813012045690902750</span></span><br><span class="line">tr2 = <span class="number">2188079608695802322451864004898125123944812594307497345389217291001509103650388567869655694926044170369531992486933204</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f1 = <span class="number">12</span> * x^<span class="number">12</span> - tr1</span><br><span class="line">f2 = <span class="number">49</span> * x^<span class="number">49</span> - tr2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compositeModulusGCD</span>(<span class="params">a, b</span>):</span>Â  Â  </span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>):Â  Â  Â  Â  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(-a.monic().coefficients()[<span class="number">0</span>])Â  Â  </span><br><span class="line">    <span class="keyword">else</span>:Â  Â  Â  Â  </span><br><span class="line">        <span class="keyword">return</span> compositeModulusGCD(b, a % b)</span><br><span class="line">c = compositeModulusGCD(f1, f2)</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">d = inverse_mod(e, euler_phi(n))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h1 id="5bian"><a href="#5bian" class="headerlink" title="5bian"></a>5bian</h1><p>åœ¨4biançš„åŸºç¡€ä¸Šï¼Œä½¿å¾—æ¯ä¸€ä¸ªæ“ä½œåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼›</p><p>ä½†æ˜¯trace(C)ä¸ä¸º0ï¼Œå› æ­¤æ‰¾åˆ°trace(B)ä¸ä¸º0çš„ä¸€ç»„ï¼Œç”±<script type="math/tex">trace(C)=m^etrace(B)</script>ï¼Œç›´æ¥æ‹¿åˆ°c</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">3292011909327659421775049456711303402369135799358104929999970787062175640424891481702884769338853356800690265327619267</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#c=(1085260800784001954133584897165283180613148497110186223344717673152088774523221770328958058661702434339964578373746248*inverse_mod(88,n))%n</span></span><br><span class="line">c=<span class="number">2507485887326570401463415497945317383847101547433009173857509227786381170695740614311577886312431809984908609722898546</span></span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;åšäº†ä¸‹é—ªç”µäº”è¿é­ï¼Œé¢˜å‡ºçš„å¾ˆæœ‰æ„æ€ï¼Œæ˜¥å“¥ä»å›½å¤–æ¯”èµ›æ‰’çš„é¢˜ï¼ˆ&lt;a href=&quot;https://github.com/BCACTF/bcactf-2.0&quot;&gt;BCACTF&lt;/a&gt;ï¼‰,éš¾åº¦ä¸å¤§ï¼Œç»“åˆäº†RSAå’Œç›¸ä¼¼çŸ©é˜µ&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="RSA" scheme="http://sh1k4ku.github.io/tags/RSA/"/>
    
    <category term="matrix" scheme="http://sh1k4ku.github.io/tags/matrix/"/>
    
  </entry>
  
  <entry>
    <title>åšé¢˜éšè®°</title>
    <link href="http://sh1k4ku.github.io/2021/08/11/2021-8-11-%E5%81%9A%E9%A2%98%E9%9A%8F%E8%AE%B0/"/>
    <id>http://sh1k4ku.github.io/2021/08/11/2021-8-11-%E5%81%9A%E9%A2%98%E9%9A%8F%E8%AE%B0/</id>
    <published>2021-08-11T10:00:00.000Z</published>
    <updated>2021-08-30T08:12:15.795Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€é“æµ®ç‚¹ä½æ•°å¾ˆé«˜çš„é¢˜ç›®ã€‚ã€‚</p><span id="more"></span><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line">getcontext().prec = <span class="number">300</span> <span class="comment">#ç»™å®šç²¾ç¡®åº¦ä¸º300ä½</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pi</span>():</span><span class="comment">#ç”Ÿæˆä¸‰ç™¾ä½æ•°çš„pi,å°æ•°ç‚¹å299ä½</span></span><br><span class="line">    lasts, t, s, n, na, d, da = <span class="number">0</span>, Decimal(<span class="number">3</span>), <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">24</span></span><br><span class="line">    <span class="keyword">while</span> s != lasts:</span><br><span class="line">        lasts = s</span><br><span class="line">        n, na = n + na, na + <span class="number">8</span></span><br><span class="line">        d, da = d + da, da + <span class="number">32</span></span><br><span class="line">        t = (t * n) / d</span><br><span class="line">        s += t</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sin</span>(<span class="params">x</span>):</span></span><br><span class="line">    x = Decimal(x) % pi()</span><br><span class="line">    p, factor = <span class="number">0</span>, x</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):<span class="comment">#sinxçš„æ³°å‹’å±•å¼€</span></span><br><span class="line">        p += factor</span><br><span class="line">        factor *= - (x ** <span class="number">2</span>) / ((<span class="number">2</span> * n + <span class="number">2</span>) * (<span class="number">2</span> * n + <span class="number">3</span>))</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">int</span>.from_bytes(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read(), byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span>(flag &lt; <span class="number">2</span> ** <span class="number">500</span>)</span><br><span class="line"><span class="built_in">print</span>(sin(flag))</span><br><span class="line"><span class="comment"># 0.0244671923862258387777329311304061726117292338164472101939417405767980930400528701470775326212479053586551379126483335032568358369085951301715103743247208229702075426052832758137520953914256336461357368653604728080035204833015365117280775229337006339154544638317547072102876405128588259546493517773166</span></span><br><span class="line"><span class="comment">#å®é™…ä¸Šè¿™ä¸ªç»“æœæ˜¯å°æ•°ç‚¹å301ä½ã€‚ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>pi()å‡½æ•°ç”¨ä¸€ä¸ªä¸çŸ¥é“æ˜¯ä»€ä¹ˆçš„ç®—æ³•ç”Ÿæˆäº†300ä½ï¼ˆå°æ•°ç‚¹å299ä½ï¼‰çš„Î ï¼Œsin(x)å‡½æ•°ç”¨æ³°å‹’å±•å¼€åˆ°ç¬¬9999è½®æ¥è®¡ç®—sinxçš„ç»“æœï¼ˆåæ­£å¯¹300ä½çš„ç»“æœæ¥è¯´ç»°ç»°æœ‰ä½™äº†ï¼‰ï¼Œç„¶åç»™å‡ºäº†sin(flag)çš„ç»“æœï¼Œæ˜¯å°æ•°ç‚¹å301ä½çš„ã€‚ä¹‹å‰å¼ºç½‘æ¯çš„ezmathä¹Ÿæ˜¯ç”¨é«˜ç²¾åº¦çš„æµ®ç‚¹æ•°ï¼Œå¹¶ä¸”ä¹Ÿç”¨äº†e^xçš„æ³°å‹’å±•å¼€ã€‚</p><h1 id="å°è¯•1"><a href="#å°è¯•1" class="headerlink" title="å°è¯•1"></a>å°è¯•1</h1><p>æ—¢ç„¶åŠ å¯†æ˜¯ç”¨sinxçš„æ³°å‹’å±•å¼€ï¼Œæœ€åˆæƒ³åˆ°ç”¨arcsinçš„å±•å¼€å¼å»æ±‚å›å»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">double_factorial</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">__import__</span>(<span class="string">&quot;functools&quot;</span>).reduce(<span class="keyword">lambda</span> x, y: x * y, <span class="built_in">range</span>(n, <span class="number">0</span>, -<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arcsin</span>(<span class="params">x</span>):</span></span><br><span class="line">    x = Decimal(x) % pi()</span><br><span class="line">    p = x</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">3000</span>):</span><br><span class="line">        f=x</span><br><span class="line">        p+=double_factorial(<span class="number">2</span>*i-<span class="number">1</span>)*(f**(<span class="number">2</span>*i+<span class="number">1</span>))/((<span class="number">2</span>*i+<span class="number">1</span>)*double_factorial(<span class="number">2</span>*i))</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="comment">#0.0244696342317182955380167878859997878648849860507225686198324843880327826384968171815366236530238829279631100698854243103679784022302933149263781311340548493687767140548481414565508236688055024007324091848224931595200235667864586900877342501435623376419548532684797634337279346936509642695145952284863</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç»“æœsinè¿˜åŸå›å»æœ€åä¸€ä½å’Œç»“æœä¸åŒï¼ŒçŒœä¸€ä½å°±èƒ½å¾—åˆ°æ­£ç¡®çš„ä½™æ•°</p><h1 id="å°è¯•2"><a href="#å°è¯•2" class="headerlink" title="å°è¯•2"></a>å°è¯•2</h1><p>ç‰›é¡¿æ³•ä¹Ÿèƒ½æ±‚æ ¹ï¼Œå´å¸ˆå‚…çˆ†äº†3ä¸ªå°æ—¶æ‰çˆ†å‡ºæ¥ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sin</span>(<span class="params">x</span>):</span></span><br><span class="line">    p, factor = <span class="number">0</span>, x</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):  <span class="comment"># æ„Ÿè§‰åƒæ³°å‹’</span></span><br><span class="line">        p += factor</span><br><span class="line">        factor *= - (x ** <span class="number">2</span>) / ((<span class="number">2</span> * n + <span class="number">2</span>) * (<span class="number">2</span> * n + <span class="number">3</span>))</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l = Decimal(<span class="number">0</span>)</span><br><span class="line">r = Decimal(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">des = Decimal(</span><br><span class="line">    <span class="string">&#x27;0.0244671923862258387777329311304061726117292338164472101939417405767980930400528701470775326212479053586551379126&#x27;</span></span><br><span class="line">    <span class="string">&#x27;483335032568358369085951301715103743247208229702075426052832758137520953914256336461357368653604728080035204833015&#x27;</span></span><br><span class="line">    <span class="string">&#x27;365117280775229337006339154544638317547072102876405128588259546493517773166&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    mid2 = (l + r) / <span class="number">2</span></span><br><span class="line">    mid1 = (l + mid2) / <span class="number">2</span></span><br><span class="line">    mid3 = (mid2 + r) / <span class="number">2</span></span><br><span class="line">    p = multiprocessing.Pool(<span class="number">3</span>)</span><br><span class="line">    res = [p.apply_async(sin, args=(mid1,)), p.apply_async(sin, args=(mid2,)), p.apply_async(sin, args=(mid3,))]</span><br><span class="line">    p.close()</span><br><span class="line">    p.join()</span><br><span class="line">    values = [i.get() <span class="keyword">for</span> i <span class="keyword">in</span> res]</span><br><span class="line">    <span class="keyword">if</span> des &lt; values[<span class="number">0</span>]:</span><br><span class="line">        r = mid1</span><br><span class="line">    <span class="keyword">elif</span> values[<span class="number">0</span>] &lt; des &lt; values[<span class="number">1</span>]:</span><br><span class="line">        l = mid1</span><br><span class="line">        r = mid2</span><br><span class="line">    <span class="keyword">elif</span> values[<span class="number">1</span>] &lt; des &lt; values[<span class="number">2</span>]:</span><br><span class="line">        l = mid2</span><br><span class="line">        r = mid3</span><br><span class="line">    <span class="keyword">elif</span> values[<span class="number">2</span>] &lt; des:</span><br><span class="line">        l = mid3</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;l=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;sin(x)=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(values[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(mid1)</span><br><span class="line"><span class="built_in">print</span>(mid2)</span><br><span class="line"><span class="built_in">print</span>(mid3)</span><br><span class="line"><span class="built_in">print</span>(values[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(values[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(values[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#0.0244696342317182955380167878859997878648849860507225686198324843880327826384968171815366236530238829279631100698854243103679784022302933149263781311340548493687767140548481414565508236688055024007324091848224931595200235667864586900877342501435623376419548532684797634337279346936509642695145952284864</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå€¼ç”¨sinåå±•å¼€å›å»å’Œç»“æœæ˜¯ä¸€æ ·çš„ï¼Œniceï¼Œæ‰€ä»¥ç°åœ¨å¾—åˆ°äº†flagå’Œpiæ±‚ä½™çš„ç»“æœäº†ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯æ€ä¹ˆæ±‚flagï¼š</p><script type="math/tex; mode=display">âˆµn\%pi=x\\âˆ´n=x+m*pi</script><p>å› ä¸ºnæ˜¯æ•´æ•°ï¼Œæ‰€ä»¥å¯ä»¥çˆ†ç ´ï¼Œä½†æ˜¯flagçš„èŒƒå›´å¤ªå¤§äº†ï¼Œæ„Ÿè§‰ä¸å¤ªç°å®ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæƒ³æ³•ï¼šåˆ©ç”¨næ˜¯æ•´æ•°è¿™ä¸€ç‚¹ï¼Œxå’Œpiéƒ½æœ‰å°æ•°éƒ¨åˆ†ï¼Œå¯ä»¥è½¬æ¢æˆåŒä½™æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">ä¾‹å¦‚å½“ç²¾åº¦æ˜¯2çš„æ—¶å€™ï¼Œ3.14*m+0.02=nä½æ•´æ•°\\âˆ´14*m\%100=98...ç±»æ¨åˆ°300ä½ä¹Ÿæ˜¯å¦‚æ­¤</script><p>ä½†æ˜¯æœ€åç®—å‡ºæ¥çš„må¤§å°è¿œè¶…2**500ï¼Œæ‰€ä»¥æ²¡èƒ½åšå‡ºæ¥ã€‚</p><p>å¯¹äºè¿™ä¸€é¢˜è¿˜æœ‰ä¸ªç–‘é—®ï¼Œé¢˜ç›®ç»™çš„ç»“æœå°æ•°ç‚¹åæœ‰301ä½çš„ï¼Œä½†æ˜¯piå°æ•°ç‚¹ååªæœ‰299ä½ï¼Œè¿™æ ·ç”¨åŸå§‹çš„piæ˜¯ä¸å¯èƒ½å‡ºè§£çš„ï¼ˆè¯•è¿‡å°†piä¹Ÿå¢åŠ åˆ°301ä½ï¼Œä½†ä¹Ÿæ²¡å‡ºï¼‰ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸€é“æµ®ç‚¹ä½æ•°å¾ˆé«˜çš„é¢˜ç›®ã€‚ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="decimal" scheme="http://sh1k4ku.github.io/tags/decimal/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€â€¦â€¦äºŒâ€¦â€¦å¼€é—¨ï¼</title>
    <link href="http://sh1k4ku.github.io/2021/07/28/%E4%B8%80%E2%80%A6%E2%80%A6%E4%BA%8C%E2%80%A6%E2%80%A6%E5%BC%80%E9%97%A8%EF%BC%81/"/>
    <id>http://sh1k4ku.github.io/2021/07/28/%E4%B8%80%E2%80%A6%E2%80%A6%E4%BA%8C%E2%80%A6%E2%80%A6%E5%BC%80%E9%97%A8%EF%BC%81/</id>
    <published>2021-07-28T08:37:40.000Z</published>
    <updated>2021-08-30T08:12:30.154Z</updated>
    
    <content type="html"><![CDATA[<p>CTFshowä¸Šçš„æ–°é¢˜ï¼Œæäº†ä¸€å¤©</p><span id="more"></span><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> door_sum <span class="keyword">import</span> door_sum</span><br><span class="line"></span><br><span class="line"><span class="comment"># door_sum(l, d, n): calculate the sum of an arithmetic sequence</span></span><br><span class="line"><span class="comment"># with `l` being the first number, `d` being the common difference,</span></span><br><span class="line"><span class="comment"># and `n` being the number of terms</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sanity check:</span></span><br><span class="line"><span class="keyword">assert</span> door_sum(<span class="number">1</span>, <span class="number">1</span>, <span class="number">100</span>) == <span class="number">5050</span></span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;HELLO!</span></span><br><span class="line"><span class="string">Open the door, and I&#x27;ll show you my flag!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line">n_1 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;n_1 = &#x27;</span>))</span><br><span class="line">n_2 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;n_2 = &#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> (n_1 &gt; <span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> n_2 &gt; <span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> door_sum(<span class="number">1</span>, <span class="number">1</span>, n_1) == <span class="number">0x1337</span> * door_sum(<span class="number">1</span>, <span class="number">2</span>, n_2)):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;OKOK! YOU GOT THE FLAG:&#x27;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="built_in">print</span>(f.read())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Uh-Oh, the door is not opened...&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;NONONO!&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>door_sumå¯ä»¥å†™æˆç­‰å·®æ•°åˆ—çš„å’Œ</p><p>æ³¨æ„door_sumé‡Œçš„næ˜¯é¡¹æ•°ï¼ï¼ï¼</p><p>é¢˜ç›®çš„è¦æ±‚æ˜¯ä¸¤ä¸ªæ•°å‡å¤§äº2**4919å¹¶ä¸”ç¬¬ä¸€ä¸ªæ•°çš„æ•°åˆ—å’Œæ˜¯ç¬¬äºŒä¸ªæ•°åˆ—å’Œçš„4919å€</p><script type="math/tex; mode=display">x_n=x_1+d(n-1)\\ S_n=\frac{x_1+x_n}{2}n=(\frac{d(n-1)+2x_1}{2})n=\frac{d(n^2-n)+2x_1n}{2}\\åˆ™S_{n1}=\frac{d_1(n_1^2-n_1)+2x_1n_1}{2}\\S_{n2}=\frac{d_2(n_2^2-n_2)+2x_1n_2}{2}\\å·²çŸ¥S_{n1}=4919*S_{n2},ä¸”d_1=1,d_2=2,x_1=1\\åˆ™\frac{n_1^2+n_1}{2}=4919n_2^2\\ \sqrt{\frac{n_1^2+n_1}{9838}}=n2</script><p>èµ°åˆ°è¿™é‡Œå‘ç°èµ°ä¸é€šäº†ï¼Œæ¯•ç«Ÿæ˜¯è¦çˆ†ç ´çš„ï¼Œå¯¹äºè¿™ä¸ªæ•°é‡çº§ä¾æ—§å¾ˆéš¾å‡ºè§£ã€‚å› ä¸ºè¦åŠ å¿«çˆ†ç ´é€Ÿåº¦ï¼Œäº†è§£åˆ°ä½©å°”æ–¹ç¨‹ï¼š</p><h2 id="ä½©å°”æ–¹ç¨‹"><a href="#ä½©å°”æ–¹ç¨‹" class="headerlink" title="ä½©å°”æ–¹ç¨‹"></a>ä½©å°”æ–¹ç¨‹</h2><script type="math/tex; mode=display">å®šä¹‰ï¼šå½¢å¦‚x^2 âˆ’ d y^2=1(d>1,ä¸”dä¸æ˜¯å®Œå…¨å¹³æ–¹æ•°)\\è¦æ±‚ç¬¬ä¸€ç±»ä½©å°”æ–¹ç¨‹çš„è§£éƒ½æ˜¯æ­£æ•´æ•°è§£,ä¹Ÿå³( x , y ) , x > 0 , y > 0</script><p>æ˜¾ç„¶æ–¹ç¨‹æœ‰æ— æ•°ç»„è§£ï¼Œå¦‚ä½•æ±‚æœ€å°è§£ï¼Ÿ</p><script type="math/tex; mode=display">æŠŠæ–¹ç¨‹åŒ–ä¸ºx=\sqrt{1+dy^2}\\ä»y=1å¼€å§‹æšä¸¾ï¼Œå¦‚æœ\sqrt{1+dy^2}æ˜¯æ•´æ•°ï¼Œé‚£ä¹ˆæ­¤æ—¶(x,y)å°±æ˜¯æœ€å°æ•´æ•°è§£(x_1,y_1)</script><p>å¦‚ä½•å¾—åˆ°æ‰€æœ‰çš„è§£ï¼Ÿ</p><p>è¿­ä»£å…¬å¼ï¼š</p><script type="math/tex; mode=display">x_n=x_{n-1}x_1+dy_{n-1}y_1\\y_n=x_{n-1}y_1+y_{n-1}x_1</script><p>ä½†å¦‚æœç”¨è¿™ä¸ªå…¬å¼æ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦ä¾æ—§æ˜¯O(n)ï¼Œå½“nå¾ˆå¤§æ—¶è¿˜æ˜¯è·‘ä¸å‡ºæ¥ï¼Œæ‰€ä»¥ä½¿ç”¨çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œä»¥O(logn)çš„æ—¶é—´å¤æ‚åº¦æ±‚è§£ï¼š</p><script type="math/tex; mode=display">\left[ \begin{matrix} x_n\\ y_n \end{matrix}  \right] \tag{2}=   \left[ \begin{matrix} x_1&d*y_1\\ y_1&x_1 \end{matrix}  \right]^{n-1}    \left[ \begin{matrix} x_1\\ y_1 \end{matrix}  \right]</script><h2 id="è§£"><a href="#è§£" class="headerlink" title="è§£"></a>è§£</h2><p>æ”¹å˜ä¸€ä¸‹æ¨æ³•ï¼š</p><script type="math/tex; mode=display">\frac{n_1^2+n_1}{2}=4919n_2^2\\(n_1+\frac{1}{2})^2-\frac{1}{2}=9838n_2^2\\(2n_1+1)^2-4*9838n_2^2=1</script><p>å¾—åˆ°äº†ä½©å°”æ–¹ç¨‹çš„è¡¨è¾¾å¼ï¼Œä¹‹åä½¿ç”¨è¿åˆ†æ•°çš„æ€§è´¨è®¡ç®—å¾—åˆ°äº†æœ€å°è§£ï¼š</p><script type="math/tex; mode=display">(x_1,y_1)=\\(2662019309411216232806345449321879270495478346383, 26838472360889124413883226557207387537524821524)</script><p>å¯ä»¥çœ‹åˆ°è¿˜æ˜¯å¾ˆå°çš„ï¼ˆæ¯”èµ·2^0x1337)</p><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_mini_solution</span>(<span class="params">d</span>):</span></span><br><span class="line">    m=<span class="built_in">int</span>(d**<span class="number">0.5</span>)</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    a=[]</span><br><span class="line">    a.append(m)</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    b=m</span><br><span class="line">    c=<span class="number">1</span></span><br><span class="line">    sq=d**<span class="number">0.5</span></span><br><span class="line">    <span class="keyword">while</span>(a[i-<span class="number">1</span>]!=<span class="number">2</span>*a[<span class="number">0</span>]):</span><br><span class="line">        c=(d-b*b)/c</span><br><span class="line">        tmp=(sq+b)/c</span><br><span class="line">        a.append(<span class="built_in">int</span>(tmp))</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">        b=a[i-<span class="number">1</span>]*c-b</span><br><span class="line">    <span class="keyword">del</span> a[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    p=[m]</span><br><span class="line">    q=[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">1</span>:</span><br><span class="line">            p.append(a[j]*p[<span class="number">0</span>]+<span class="number">1</span>)</span><br><span class="line">            q.append(a[j]*q[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            p.append(a[j]*p[j-<span class="number">1</span>]+p[j-<span class="number">2</span>])</span><br><span class="line">            q.append(a[j]*q[j-<span class="number">1</span>]+q[j-<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a)%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> p[-<span class="number">1</span>],q[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">         <span class="keyword">return</span> <span class="number">2</span>*p[-<span class="number">1</span>]**<span class="number">2</span>,<span class="number">2</span>*p[-<span class="number">1</span>]*q[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mulMatrix</span>(<span class="params">x,y</span>):</span>     <span class="comment">#äºŒé˜¶çŸ©é˜µä¹˜æ³•</span></span><br><span class="line">    ans = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                ans[i][j] += x[i][k] * y[k][j]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quickMatrix</span>(<span class="params">m,n</span>):</span></span><br><span class="line">    E = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]        <span class="comment">#å…ˆå®šä¹‰ä¸€ä¸ªå•ä½çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        E[i][i] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(n):</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            E = mulMatrix(E,m)</span><br><span class="line">        m = mulMatrix(m,m)</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> E</span><br><span class="line"></span><br><span class="line">d=<span class="number">9838</span>*<span class="number">4</span></span><br><span class="line">x1,y1=find_mini_solution(d)</span><br><span class="line"><span class="built_in">print</span>((x1,y1))</span><br><span class="line">basis_matrix=[[x1,d*y1],[y1,x1]]</span><br><span class="line"></span><br><span class="line">cnt=<span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    tmp=quickMatrix(basis_matrix,cnt)</span><br><span class="line">    xn=tmp[<span class="number">0</span>][<span class="number">0</span>]*x1+tmp[<span class="number">0</span>][<span class="number">1</span>]*y1</span><br><span class="line">    yn=tmp[<span class="number">1</span>][<span class="number">0</span>]*x1+tmp[<span class="number">1</span>][<span class="number">1</span>]*y1</span><br><span class="line">    <span class="keyword">if</span> xn &gt;<span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> yn &gt; <span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> xn**<span class="number">2</span>-d*yn**<span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(cnt)</span><br><span class="line">        <span class="built_in">print</span>((xn-<span class="number">1</span>)//<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(yn)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    cnt+=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰ç”¨sageä¼šæ–¹ä¾¿å¾ˆå¤š0.0</p><p>sageæœç„¶æ–¹ä¾¿ï¼Œè¿åˆ†æ•°æœ‰å†…ç½®çš„å‡½æ•°ï¼Œè¡¥ä¸Šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def solve_pell(N, numTry = 100):</span><br><span class="line">cf= continued_fraction(sqrt(N))</span><br><span class="line">for i in range(numTry):</span><br><span class="line">denom = cf.denominator(i)</span><br><span class="line">numer = cf.numerator(i)</span><br><span class="line">if numer^2-N*denom^2 == 1:</span><br><span class="line">return numer,denom</span><br><span class="line">print(solve_pell(9838)) </span><br><span class="line">#(2662019309411216232806345449321879270495478346383, 26838472360889124413883226557207387537524821524)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;CTFshowä¸Šçš„æ–°é¢˜ï¼Œæäº†ä¸€å¤©&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="Continued Fractions" scheme="http://sh1k4ku.github.io/tags/Continued-Fractions/"/>
    
    <category term="Pell Equation" scheme="http://sh1k4ku.github.io/tags/Pell-Equation/"/>
    
  </entry>
  
  <entry>
    <title>lattice_learning</title>
    <link href="http://sh1k4ku.github.io/2021/07/27/lattice-learning/"/>
    <id>http://sh1k4ku.github.io/2021/07/27/lattice-learning/</id>
    <published>2021-07-27T08:51:43.000Z</published>
    <updated>2021-08-30T08:11:32.669Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰å…³æ ¼ç†è®ºçš„å­¦ä¹ è®°å½•ã€‚</p><span id="more"></span><h1 id="æ ¼çš„å®šä¹‰"><a href="#æ ¼çš„å®šä¹‰" class="headerlink" title="æ ¼çš„å®šä¹‰"></a>æ ¼çš„å®šä¹‰</h1><p>æ ¼çš„å®šä¹‰å¯ä»¥ä»å‘é‡ç©ºé—´å¼•ç”³å‡ºæ¥ï¼š</p><pre><code>ä¸€ç»„çº¿æ€§æ— å…³çš„çš„å‘é‡v1ï¼Œv2ï¼Œ...ï¼Œvnï¼Œå®ƒä»¬çš„çº¿æ€§ç»„åˆa1v1+a2v2+...+anvnå¯ä»¥è¡¨ç¤ºä¸€ä¸ªç©ºé—´ï¼Œå¦‚æœa1,a2ï¼Œ...ï¼Œanå…¨ä¸ºæ•´æ•°ï¼Œåˆ™ç”Ÿæˆäº†ä¸€ä¸ªæ ¼Lã€‚åˆ™è¿™ç»„å‘é‡ç§°ä¸ºæ ¼çš„åŸºï¼Œå‘é‡ä¸ªæ•°ç§°ä¸ºæ ¼çš„ç»´æ•°ã€‚</code></pre><h2 id="åŸºç¡€åŒºåŸŸ"><a href="#åŸºç¡€åŒºåŸŸ" class="headerlink" title="åŸºç¡€åŒºåŸŸ"></a>åŸºç¡€åŒºåŸŸ</h2><p>æ ¼çš„åŸºç¡€åŒºåŸŸä¸ºå³å½“a1ï¼Œanï¼Œ,,,ï¼Œanä¸º0æˆ–1ç»„æˆçš„ä¸€ä¸ªåŒºåŸŸã€‚æ ¼ä¸­ä»»æ„ä¸€ä¸ªå‘é‡å¯ä»¥ç”±æ ¼çš„åŸºç¡€åŒºåŸŸå’Œå”¯ä¸€æ ¼å¤–çš„ä¸€ä¸ªå‘é‡è¡¨ç¤ºã€‚åŸºç¡€åŒºåŸŸæ˜¯æ ¼å¾ˆé‡è¦çš„æ¦‚å¿µã€‚</p><h2 id="æ ¼çš„è¡Œåˆ—å¼"><a href="#æ ¼çš„è¡Œåˆ—å¼" class="headerlink" title="æ ¼çš„è¡Œåˆ—å¼"></a>æ ¼çš„è¡Œåˆ—å¼</h2><p>æ ¼çš„è¡Œåˆ—å¼å°±æ˜¯åŸºç¡€åŒºåŸŸçš„nç»´ä½“ç§¯ï¼Œè®°ä½œï¼š</p><script type="math/tex; mode=display">det(L)</script><h2 id="åŸºçš„è½¬æ¢"><a href="#åŸºçš„è½¬æ¢" class="headerlink" title="åŸºçš„è½¬æ¢"></a>åŸºçš„è½¬æ¢</h2><p>è®¾ä»¥v1ï¼Œv2ï¼Œâ€¦ï¼Œvnä¸ºè¡Œå‘é‡æ„æˆçš„né˜¶çŸ©é˜µä¸ºAï¼ŒæŸä¸€è¡Œåˆ—å¼ç­‰äº1çš„né˜¶çŸ©é˜µä¸º    Uï¼Œåˆ™çŸ©é˜µB=UAä¸­çš„è¡Œå‘é‡ä¹Ÿæ˜¯æ ¼Lçš„ä¸€ç»„åŸºã€‚<br>ä»<strong>çº¿æ€§å˜æ¢</strong>çš„æœ¬è´¨æ¥çœ‹ï¼Œçº¿æ€§å˜æ¢æ˜¯å¯¹ç©ºé—´è¿›è¡Œä¼¸ç¼©æˆ–è€…ç¿»è½¬çš„æ“ä½œï¼ˆå¯æƒœå¤§å¤šæ•°é«˜æ ¡çš„éæ•°å­¦ä¸“ä¸šæ˜¯ä¸ä¼šè®²è¿™äº›çš„ï¼Œå…·ä½“å¯ä»¥çœ‹bç«™3b1bçš„æ¬è¿ï¼Œæœ‰å…³çº¿æ€§ä»£æ•°çš„æœ¬è´¨çš„ä»‹ç»ï¼Œå¯ä»¥ç»™æˆ‘ä»¬å¾ˆç›´è§‚çš„ç†è§£ï¼‰ï¼Œç”±äºUçš„è¡Œåˆ—å¼ä¸º1ï¼Œé‚£ä¹ˆå˜æ¢åçš„åŸºç¡€åŒºåŸŸä½“ç§¯ä¸å˜ã€‚</p><h2 id="æ ¼çš„ä¸¤å¤§éš¾é¢˜"><a href="#æ ¼çš„ä¸¤å¤§éš¾é¢˜" class="headerlink" title="æ ¼çš„ä¸¤å¤§éš¾é¢˜"></a>æ ¼çš„ä¸¤å¤§éš¾é¢˜</h2><p>å‡ä¸ºNPå®Œå…¨é—®é¢˜</p><h3 id="æœ€çŸ­å‘é‡é—®é¢˜"><a href="#æœ€çŸ­å‘é‡é—®é¢˜" class="headerlink" title="æœ€çŸ­å‘é‡é—®é¢˜"></a>æœ€çŸ­å‘é‡é—®é¢˜</h3><p>ç®€ç§°<strong>SVP</strong>ï¼Œåœ¨æ ¼ä¸­å¯»æ‰¾ä¸€ä¸ªéé›¶å‘é‡ï¼Œä½¿å®ƒçš„èŒƒæ•°æœ€å°ã€‚</p><h3 id="æœ€è¿‘å‘é‡é—®é¢˜"><a href="#æœ€è¿‘å‘é‡é—®é¢˜" class="headerlink" title="æœ€è¿‘å‘é‡é—®é¢˜"></a>æœ€è¿‘å‘é‡é—®é¢˜</h3><p>ç®€ç§°<strong>CVP</strong>ï¼Œç»™å®šä¸€ä¸ªä¸åœ¨æ ¼ä¸­çš„å‘é‡ï¼Œæ‰¾åˆ°æ ¼ä¸­ä¸€ä¸ªå‘é‡ä½¿å®ƒæœ€æ¥è¿‘ç»™å®šçš„å‘é‡ï¼Œå³æ¬§å‡ é‡Œå¾—èŒƒæ•°æœ€å°ã€‚</p><h1 id="é‡è¦å®šç†"><a href="#é‡è¦å®šç†" class="headerlink" title="é‡è¦å®šç†"></a>é‡è¦å®šç†</h1><h2 id="Hadamardä¸ç­‰å¼"><a href="#Hadamardä¸ç­‰å¼" class="headerlink" title="Hadamardä¸ç­‰å¼"></a>Hadamardä¸ç­‰å¼</h2><p>æ ¼Lçš„åŸºç¡€åŒºåŸŸä¸ºFï¼Œå¯¹äºå®ƒä»»æ„ä¸€ä¸ªåŸº</p><script type="math/tex; mode=display">v_1,v_2,...,v_n</script><p>æœ‰ï¼š</p><script type="math/tex; mode=display">det(L)=vol(F)\leq||v_1||*||v_2||*...*||v_n||</script><p>åŸºå‘é‡è¶Šæ¥è¿‘æ­£äº¤ï¼Œåˆ™ä¸Šå¼è¶Šæ¥è¿‘ç­‰å¼</p><h3 id="Hadamardæ¯”ç‡"><a href="#Hadamardæ¯”ç‡" class="headerlink" title="Hadamardæ¯”ç‡"></a>Hadamardæ¯”ç‡</h3><script type="math/tex; mode=display">H(L)=(\frac{det(L)}{||v_1||*||v_2||*...*||v_n||})^{1/n}</script><p>å½“è¿™ä¸ªå€¼è¶Šæ¥è¿‘1ï¼Œåˆ™åŸºè¶Šæ¥è¿‘ä¸¤ä¸¤æ­£äº¤</p><h2 id="Hermiteå®šç†"><a href="#Hermiteå®šç†" class="headerlink" title="Hermiteå®šç†"></a>Hermiteå®šç†</h2><p>æ‰€æœ‰nç»´çš„æ ¼Léƒ½åŒ…å«ä¸€ä¸ªé0å‘é‡</p><script type="math/tex; mode=display">v\in Lï¼Œæ»¡è¶³||v||\leq\gamma_ndet(L)^{1/n}</script><p>å¯¹äºç»™å®šçš„ç»´åº¦n</p><script type="math/tex; mode=display">Hermiteå¸¸é‡\gamma_næ˜¯ä¸€ä¸ªæœ€å°å€¼ï¼Œ</script><p>å®ƒå¯ä»¥ä½¿æ‰€æœ‰nç»´æ ¼Léƒ½åŒ…å«éé›¶å‘é‡</p><script type="math/tex; mode=display">v\in Læ»¡è¶³ä¸Šå¼ã€‚</script><p>å…¶ä¸­Hertmiteå¸¸é‡</p><script type="math/tex; mode=display">\gamma_næ»¡è¶³ï¼š\frac{n}{2Î e}\leq\gamma_n\leq\frac{n}{Î e}</script><h2 id="Minkowskiå®šç†"><a href="#Minkowskiå®šç†" class="headerlink" title="Minkowskiå®šç†"></a>Minkowskiå®šç†</h2><script type="math/tex; mode=display">è®¾L\subset R^næ˜¯ä¸€ä¸ªnç»´çš„æ ¼ï¼ŒS\subset R^næ˜¯ä¸€ä¸ªå¯¹ç§°å‡¸é¢é›†åˆï¼Œå…¶ä½“ç§¯æ»¡è¶³ï¼š</script><script type="math/tex; mode=display">vol(S)>2^ndet(L)$</script><p>å¦‚æœSæ»¡è¶³å°é—­æ€§ï¼Œåˆ™ä¸Šå¼ç­‰å¼æˆç«‹ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ‰å…³æ ¼ç†è®ºçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Crypto" scheme="http://sh1k4ku.github.io/categories/Crypto/"/>
    
    
    <category term="Lattice" scheme="http://sh1k4ku.github.io/tags/Lattice/"/>
    
  </entry>
  
  <entry>
    <title>Hello Hexo</title>
    <link href="http://sh1k4ku.github.io/2021/07/26/Test/"/>
    <id>http://sh1k4ku.github.io/2021/07/26/Test/</id>
    <published>2021-07-26T09:43:59.903Z</published>
    <updated>2021-08-12T02:55:02.508Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hello-Hexo"><a href="#Hello-Hexo" class="headerlink" title="Hello Hexo"></a>Hello Hexo</h1><p>Iâ€™m sh1k4ku</p><span id="more"></span><p>å›å¿†å‰å‡ ä¸ªæœˆï¼Œè‡ª4æœˆè¿›å…¥401åï¼Œå¤§å¤§å°å°ä¹Ÿæ‰“äº†ä¸å°‘æ¯”èµ›ï¼Œå¤§éƒ¨åˆ†çš„é¢˜éƒ½æ˜¯æ²¡æœ‰è§£å‡ºçš„ï¼Œæ¯æ¬¡è‡ªå·±ä¹Ÿä¼šå¾ˆè‡ªè´£ï¼Œä½†ä¼¼ä¹åˆæ— èƒ½ä¸ºåŠ›ã€‚</p><p>ä¸€å¼€å§‹çš„ä¹ æƒ¯ä¸å¥½ï¼Œæ²¡æœ‰åœ¨èµ›åå³ä½¿å¤ç°ï¼Œå½“æ—¶æƒ³ç€ä¹‹åå­¦åˆ°ä¸€å®šç¨‹åº¦äº†è‡ªç„¶ä¼šåšäº†ï¼Œå¯¼è‡´è¿›æ­¥ç¼“æ…¢ã€‚</p><p>ä¸ä¹…å‰æ‰æ„è¯†åˆ°è¿™æ˜¯å¤§é”™ç‰¹é”™çš„ï¼Œæ‰€ä»¥å¼€äº†æ­¤blogï¼Œæ¬²æ”¹å˜è‡ªå·±çš„æ‡’æƒ°ï¼Œä¸è¦æ‹–é˜Ÿé‡Œå¸ˆå‚…ä»¬çš„åè…¿ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Hello-Hexo&quot;&gt;&lt;a href=&quot;#Hello-Hexo&quot; class=&quot;headerlink&quot; title=&quot;Hello Hexo&quot;&gt;&lt;/a&gt;Hello Hexo&lt;/h1&gt;&lt;p&gt;Iâ€™m sh1k4ku&lt;/p&gt;</summary>
    
    
    
    <category term="hexo" scheme="http://sh1k4ku.github.io/categories/hexo/"/>
    
    
    <category term="-hexo" scheme="http://sh1k4ku.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>SCUCTF</title>
    <link href="http://sh1k4ku.github.io/2021/06/04/6.4SCUCTF/"/>
    <id>http://sh1k4ku.github.io/2021/06/04/6.4SCUCTF/</id>
    <published>2021-06-04T07:40:24.000Z</published>
    <updated>2021-09-12T15:42:54.493Z</updated>
    
    <content type="html"><![CDATA[<p>ç”¨ä»¥å‰çš„çš„åšå®¢æµ‹è¯•ä¸€ä¸‹</p><span id="more"></span><h1 id="è´æ–¯æ‰‹"><a href="#è´æ–¯æ‰‹" class="headerlink" title="è´æ–¯æ‰‹"></a>è´æ–¯æ‰‹</h1><p>é¢˜ç›®æš—ç¤ºäº†æ˜¯baseå®¶æ—ï¼Œå…ˆåä½¿ç”¨base64 32 long_to_bytes 85å’Œ58è§£å¯†å³å¯è·å¾—flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base58</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">&#x27;R1EzVElOQlRHSTNVSU5aVUdRNERNTlpWR0UyREVOS0dHWTJES01aVUlZMkRHTkJSR1JCVE9OUlhHNDNFSU5CWUdSRERNUUpXR00yVElOQlNHUTNUTU1aV0dBMkRPTkJSR1laVE9OSldHQTNES01SV0dZMkRLTVJXSU0zRE9OSlFHVTRETVJCVUdRWlVHTVpVR1VaVE9SQlhJUTJETz09PQ==&#x27;</span></span><br><span class="line"></span><br><span class="line">res=b64decode(cipher)</span><br><span class="line"></span><br><span class="line">res=b32decode(res)</span><br><span class="line"></span><br><span class="line">res=long_to_bytes(<span class="built_in">int</span>(res,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">res=b85decode(res)</span><br><span class="line"></span><br><span class="line">res=base58.b58decode(res)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>flagï¼šscuctf{M4ny_k1nds_0f_13a5e!}</strong></p><h1 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h1><p>é¢„æµ‹éšæœºæ•°ï¼Œæœ‰ç°æˆçš„åº“å¯ä»¥ç”¨ã€‚è¦å°†312ä¸ª64ä½æ•°æ‹†æˆ624ä¸ª32ä½æ•°ï¼Œå› ä¸º32ä½è¾“å‡ºé¡ºåºæ˜¯<strong>abcd</strong>,è€Œ64ä½çš„é¡ºåºæ˜¯<strong>badc</strong>ï¼Œæ‰€ä»¥è¦åè¿‡æ¥å–ï¼Œæ³¨æ„è¿˜è¦å¡«å……ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;./test&quot;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">rc=RandCrack()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    a=<span class="built_in">int</span>(f.readline())</span><br><span class="line">    a=<span class="built_in">bin</span>(a)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    c=<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+a[:<span class="number">32</span>],<span class="number">2</span>)</span><br><span class="line">    b=<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+a[<span class="number">32</span>:],<span class="number">2</span>)</span><br><span class="line">    rc.submit(c)</span><br><span class="line">    rc.submit(b)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">res=rc.predict_getrandbits(<span class="number">128</span>)</span><br><span class="line">key1=(long_to_bytes(res))</span><br><span class="line"></span><br><span class="line">res=<span class="built_in">open</span>(<span class="string">&#x27;./out&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">aes = AES.new(key1, AES.MODE_CBC, <span class="string">b&quot;\x00&quot;</span>*<span class="number">16</span>)</span><br><span class="line">flag=aes1.decrypt(res)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>flagï¼šscuctf{af0sd_f8}</strong></p><h1 id="crypto2"><a href="#crypto2" class="headerlink" title="crypto2"></a>crypto2</h1><p>ç®€å•çš„CopperSmith<br>pæ˜¯512ä½çš„ï¼Œxæ˜¯128ä½ï¼Œå°†xé¦–å…ƒå˜ä¸º1ï¼Œè½¬åŒ–åp_æ˜¯1019ä½çš„ï¼ŒæœªçŸ¥ä½128ä½ï¼Œé‚£ä¹ˆç”¨CopperSmith Methodå³å¯è§£å†³ã€‚å¾—åˆ°çš„på†åœ¨æ¨¡nä¸‹å’Œ2^exç›¸ä¹˜å³å¯å¾—åˆ°çœŸæ­£çš„pã€‚é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;sage</span></span><br><span class="line"><span class="string">n = 85016144249518040150910227120120655178858680112497903474795846550337648959184474608344455198424753002209821827392389091448043545937173891641586356377876821641241033232828279439195610943286663032638048058568003136520988549470764306016674503217880123290623177055115638997384030786304744623796469032887028528817</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 83724265903365973936178131138176403586796491037282811488797349096425411605088349291193550728134684573063610685342590513444340298881918101517014943046522979731970278182306111863948764449232289625176702192589838375986050458189860493609407060988207562417247647655585368569618561494059816502622854344519538215287</span></span><br><span class="line"><span class="string">pbar = 4450463823628350893648746241337847373556196959762621885713665365237037340874488165755826348254697529157574566792939002187459776672801308978738078688091668148118673194644809701286264701999481650571431714684293423463355990167658855533422964048092514208406515703766237697665676941598677911363439038209842058509</span></span><br><span class="line"><span class="string">kbits = 128</span></span><br><span class="line"><span class="string">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="string">f = x + pbar</span></span><br><span class="line"><span class="string">x0 = f.small_roots(X=2^kbits, beta=0.5)[0]  </span></span><br><span class="line"><span class="string">p = x0 + pbar</span></span><br><span class="line"><span class="string">print(p)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line">leak=<span class="number">1145141920069</span></span><br><span class="line">n=   <span class="number">85016144249518040150910227120120655178858680112497903474795846550337648959184474608344455198424753002209821827392389091448043545937173891641586356377876821641241033232828279439195610943286663032638048058568003136520988549470764306016674503217880123290623177055115638997384030786304744623796469032887028528817</span></span><br><span class="line">c=   <span class="number">83724265903365973936178131138176403586796491037282811488797349096425411605088349291193550728134684573063610685342590513444340298881918101517014943046522979731970278182306111863948764449232289625176702192589838375986050458189860493609407060988207562417247647655585368569618561494059816502622854344519538215287</span></span><br><span class="line">pbar=<span class="number">4450463823628350893648746241337847373556196959762621885713665365237037340874488165755826348254697529157574566792939002187459776672801308978738078688091668148118673194644809701286264701999481650571431714684293423463355990167658855533422964048092514208406515703766237697665676941598677911363439038209842058509</span></span><br><span class="line">ex = <span class="number">384</span></span><br><span class="line">p_=<span class="number">4450463823628350893648746241337847373556196959762621885713665365237037340874488165755826348254697529157574566792939002187459776672801308978738078688091668148118673194644809701286264701999481650571431714684293423463355990167658855533422964048092514208406515703766237697896644308153471350247313227602240058029</span></span><br><span class="line">p=p_*<span class="number">2</span>**ex%n</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m=gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p><strong>flag:scuctf{f05fe93d159b398fe25f280d94241261}</strong></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç”¨ä»¥å‰çš„çš„åšå®¢æµ‹è¯•ä¸€ä¸‹&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://sh1k4ku.github.io/categories/CTF/"/>
    
    
    <category term="randcrack" scheme="http://sh1k4ku.github.io/tags/randcrack/"/>
    
    <category term="coppersmith" scheme="http://sh1k4ku.github.io/tags/coppersmith/"/>
    
  </entry>
  
</feed>
